# 【応用情報技術者試験：午後問題解説】令和5年秋期 問1 情報セキュリティ

## 導入

本記事では、令和5年秋期の応用情報技術者試験、午後問1「情報セキュリティ」を徹底解説する。この問題は、多くの企業で慣習的に利用されてきたメール送信手法「PPAP」の脆弱性に焦点を当て、その代替策としての「S/MIME」の仕組みを問う、非常に実践的な内容だ。

この問題を解くことで、以下の知識が身につく。
- PPAPがなぜ危険視されるのか、その具体的なリスク
- 公開鍵暗号基盤（PKI）の基本である「電子署名」と「暗号化」の仕組み
- S/MIMEを用いたセキュアなメール通信の実現方法

単なる知識だけでなく、セキュリティ対策の「なぜ」を理解し、応用力を養うことを目指そう。

### 問題の全体像

まず、問題文の全体像を把握する。

- **登場人物（組織）と関係性:**
    - **K社:** IT製品の卸売会社。今回のセキュリティ見直しの主体。
    - **販売店:** K社が製品を卸している300社の取引先。
    - **L主任:** K社の情報セキュリティリーダー。PPAPの問題点を洗い出し、S/MIME導入を推進する。

- **インシデントや事象の時系列:**
    1.  **8年前:** 従業員がメールを誤送信するセキュリティ事故が発生。
    2.  **対策:** この事故を機に、添付ファイルを自動でパスワード付きZIPファイル化して送る「PPAP」方式を導入。
    3.  **現在:** 政府機関などでPPAPを廃止する動きが広まり、K社でも運用の見直しが決定。L主任が代替策としてS/MIMEを調査・提案する。

- **システム構成:**
    - **現状:** 添付ファイル圧縮サーバを導入し、PPAPを実現している。
    - **提案:** PCのメーラが対応しているS/MIMEを導入し、電子署名とメール暗号化を行う。

この全体像から、「PPAPの運用に潜むリスクを理解し、それを解決するS/MIMEの技術的仕組みを正しく答えさせる」のが問題の核心だと読み取れる。

---

## 設問ごとの詳細解説

### 設問1

#### (1)
- **問われていること:**
    PPAP運用において、本文メールの宛先を確認せずにパスワード（PW）メールを同じ宛先に送ることで、どのような情報漏えいリスクが発生するか。

- **【解答】:**
    本文メールを誤送信すると、DPWも誤送信した相手に届いてしまう。（30字）

- **【思考プロセス】:**
    1.  **結論ファースト:**
        本文メールとPWメールを同じ宛先に送る運用では、誤送信時にファイルとパスワードが両方とも漏えいする。

    2.  **根拠の提示:**
        問題文の下線①部分`「本文メールの宛先を確認せずに、本文メールと同じ宛先に対してPWメールを送信している従業員が多い」`という記述が直接的な根拠となる。

    3.  **論理展開:**
        PPAPは、添付ファイル（本文メール）とパスワード（PWメール）を分離することで、片方が盗聴されても情報が漏れないようにすることを意図している。しかし、運用者が本文メールの宛先を間違え、その間違いに気づかずに同じ宛先へPWメールも送ってしまえば、誤った受信者の元に「暗号化されたファイル」と「それを解く鍵」の両方が届いてしまう。これは、金庫と鍵を同じ箱に入れて送るようなものであり、分離した意味が全くなくなってしまう。したがって、情報漏えいにつながる。

    4.  **補足知識と周辺情報:**
        これが「PPAPは意味がない」と批判される最大の理由の一つである。ヒューマンエラーによって、仕組みが意図したセキュリティレベルを維持できなくなる典型例だ。

#### (2)
- **問われていること:**
    本文メールとPWメールが同じ経路で盗聴されるリスクを低減させるための、運用上の改善策は何か。

- **【解答】:**
    DPWを、電話や携帯メールなど異なった手段で伝える。（26字）

- **【思考プロセス】:**
    1.  **結論ファースト:**
        パスワードをメールとは全く異なる経路（アウトオブバンド）で伝達することで、盗聴リスクを低減させる。

    2.  **根拠の提示:**
        問題文に`「本文メールが通信経路上で何らかの手段によって盗聴された場合, PWメールも盗聴されるおそれがある」`とある。このリスクは、2つのメールが「同じメールシステム」という同一経路で送られているために生じる。

    3.  **論理展開:**
        同一経路上を流れる通信は、まとめて盗聴される危険性がある。このリスクを避けるには、一方の通信を全く別の経路に乗せればよい。例えば、ファイルは会社のメールで送り、パスワードは個人の携帯電話へのSMSや、直接の電話で口頭で伝える、といった方法が考えられる。これにより、仮にメール経路が丸ごと盗聴されても、パスワードは漏えいしない。

    4.  **陥りがちな罠（学習メモより）:**
        学習メモにある`「本文メールとPWメールを別々の経路で送信する」`という解答は、方向性としては正しい。しかし、「別々の経路」が何を指すかが曖昧である。例えば、単に別のメールサーバを経由するだけでは、インターネットという大きな枠組みの中では同じ経路を通過する可能性が残り、リスク低減効果は限定的だ。採点講評でも求められているように、「電話」や「携帯メール（キャリアメール）」といった、PCのメールシステムとは**明確に異なる伝達手段**を具体的に挙げることが、より確実な正解となる。

---

### 設問2

#### (1)
- **問われていること:**
    メール内容の改ざんが検知されるのは、表1、2のどの手順か。

- **【解答】:**
    1.6

- **【思考プロセス】:**
    1.  **結論ファースト:**
        改ざん検知は、受信側で元データのハッシュ値と、受信データから再計算したハッシュ値を比較する工程で行われる。

    2.  **根拠の提示:**
        表1の電子署名の検証プロセスに注目する。
        - 手順1.4: 受信した電子署名を復号し、元のハッシュ値`x`を取り出す。
        - 手順1.5: 受信したメール内容から、同じハッシュ関数`h`でハッシュ値`y`を再計算する。
        - 手順1.6: `「手順1.4で取り出したハッシュ値xと手順1.5で生成したハッシュ値yとを比較する」`。

    3.  **論理展開:**
        ハッシュ値は、データが1ビットでも異なれば全く違う値になるという特性を持つ。もし配送途中でメール内容が改ざんされていれば、手順1.5で生成されるハッシュ値`y`は、送信者が元データから生成したハッシュ値`x`とは異なる値になる。したがって、手順1.6の比較処理によってはじめて、改ざんの事実を検知できる。

    4.  **補足知識と周辺情報:**
        - **電子署名(Digital Signature):** 「誰が送ったか（認証）」と「改ざんされていないか（完全性）」を保証する技術。ハッシュ関数と公開鍵暗号を組み合わせて実現される。
        - **ハッシュ関数:** 任意の長さのデータを、固定長の不可逆なデータ（ハッシュ値）に変換する関数。データの指紋（フィンガープリント）のようなもの。

#### (2)
- **問われていること:**
    表1、2の空欄 `a` 〜 `d` に入る適切な鍵の種類は何か。

- **【解答】:**
    - a: カ (送信者の秘密鍵)
    - b: オ (送信者の公開鍵)
    - c: ウ (受信者の公開鍵)
    - d: エ (受信者の秘密鍵)

- **【思考プロセス】:**
    1.  **結論ファースト:**
        公開鍵暗号の基本ルール「秘密鍵で署名し、公開鍵で検証」「公開鍵で暗号化し、秘密鍵で復号」を正確に適用する。

    2.  **論理展開:**
        - **a (電子署名の生成):** 電子署名は、「送信者本人であること」を証明するためのもの。本人しか持ち得ない**`カ：送信者の秘密鍵`**でハッシュ値を暗号化することで、署名としての効力を持つ。
        - **b (電子署名の検証):** 送信者の秘密鍵で暗号化された署名は、対となる**`オ：送信者の公開鍵`**でのみ正しく復号できる。これにより、受信者は署名が本物か検証できる。
        - **c (共通鍵の暗号化):** メール本文の暗号化に使う共通鍵を、安全に受信者に渡す必要がある。不特定多数に知られてもよい**`ウ：受信者の公開鍵`**で共通鍵を暗号化すれば、受信者以外は中身を見ることができない。
        - **d (共通鍵の復号):** 受信者の公開鍵で暗号化された共通鍵は、受信者本人しか持っていない**`エ：受信者の秘密鍵`**でのみ復号できる。

    3.  **補足知識と周辺情報:**
        この問題で問われているのは、電子署名と**ハイブリッド暗号**の仕組みそのものである。公開鍵暗号は処理が遅いため、本文のような大きなデータは高速な共通鍵暗号で暗号化する。そして、その共通鍵自体を、安全な公開鍵暗号でやり取りする。この両者の「いいとこ取り」をするのがハイブリッド暗号だ。

#### (3)
- **問われていること:**
    メール内容の暗号化に、公開鍵暗号ではなく共通鍵暗号を利用する理由は何か。

- **【解答】:**
    暗号化と復号の処理速度が速いから。（18字）

- **【思考プロセス】:**
    1.  **結論ファースト:**
        公開鍵暗号方式と共通鍵暗号方式の最も大きな性能差は「処理速度」である。

    2.  **論理展開:**
        公開鍵暗号は、複雑な数学的計算（素因数分解など）を基にしているため、暗号化・復号の処理に時間がかかる。一方、共通鍵暗号は比較的単純な計算（ビット演算など）で済むため、非常に高速に動作する。メール本文のようなサイズの大きいデータを公開鍵暗号で直接暗号化すると、非常に時間がかかり実用的ではない。そのため、高速な共通鍵暗号が利用される。

    3.  **陥りがちな罠（学習メモより）:**
        学習メモにある`「単一の共通鍵でメールの暗号・復号が可能になるため」`は、共通鍵暗号の「仕組み」を説明しているに過ぎず、「なぜ公開鍵暗号ではなく共通鍵暗号を**利用するのか**」という「理由」になっていない。比較対象である公開鍵暗号との**優位性**を述べる必要がある。その最大の優位性が**処理速度**である。この点は採点講評でも指摘されており、技術選択の「理由」を問われた際は、メリット・デメリットを比較する視点が重要だ。

---

### 設問3

- **問われていること:**
    受信メールに添付された電子証明書の正当性を検証するために必要となる鍵は何か。

- **【解答】:**
    ア (CAの公開鍵)

- **【思考プロセス】:**
    1.  **結論ファースト:**
        電子証明書は、その正しさを保証するために認証局（CA）によって電子署名されている。このCAの署名を検証するために、CA自身の公開鍵が必要となる。

    2.  **根拠の提示:**
        問題文に`「S/MIMEを使用...するために、認証局(以下, CAという)が発行した電子証明書を取得してインストールする...必要がある」`とある。これは、CAという第三者機関が本人性を保証するモデル（PKI）を前提としていることを示している。

    3.  **論理展開:**
        電子証明書とは、「この公開鍵は、確かにこの持ち主のものである」ということをCAが証明する文書である。この証明は、CAが自身の秘密鍵で電子証明書全体に電子署名を行うことで実現される。
        受信者は、この電子証明書が本当に信頼できるCAによって発行され、改ざんされていないかを確認する必要がある。その確認方法は、まさに電子署名の検証プロセスそのものである。つまり、**CAの公開鍵**を使って、証明書に付与されたCAの署名を復号・検証するのである。

    4.  **陥りがちな罠（学習メモより）:**
        学習メモにあるように、`「ウ：送信者の公開鍵」`と誤答しやすい。これは、「送信者のメールの署名」を検証する話（設問2(2)のb）と、「送信者の証明書の署名」を検証する話とを混同している場合に起こる。
        - **メールの署名**を検証する → **送信者**の公開鍵を使う
        - **証明書の署名**を検証する → **CA**の公開鍵を使う
        この違いを明確に区別することが重要だ。

---

## まとめ：この問題から盗むべき「思考の型」

1.  **セキュリティ技術は「目的」と「手段」と「弱点」をセットで覚えよ。**
    PPAPという手段は「経路分離による盗聴対策」が目的だったが、「誤送信」というヒューマンエラーや「同一経路での盗聴」に弱いという弱点があった。S/MIMEは「電子署名と暗号化」という手段で「認証・完全性・機密性」を目的とする。このように、技術を多角的に理解することで、未知の技術が出てきても類推が効くようになる。

2.  **公開鍵暗号の役割は「鍵のペア」で理解せよ。**
    「秘密鍵でやる操作」と「公開鍵でやる操作」は常にペアである。
    - **署名（本人証明）:** 送信者が**秘密鍵**で署名し、受信者が**公開鍵**で検証する。
    - **暗号化（秘匿）:** 送信者が**受信者の公開鍵**で暗号化し、受信者が**自身の秘密鍵**で復号する。
    この2パターンを呪文のように覚えておけば、応用問題にも対応できる。

3.  **「何を」「誰が」検証するのかを明確にせよ。**
    設問3は典型例だ。「メール本文の正当性」を検証するのか、それとも「本人性を証明する証明書自体の正当性」を検証するのか。主語と目的語を明確にすることで、使うべき鍵（送信者の公開鍵か、CAの公開鍵か）が自ずと決まる。これは、セキュリティ問題の読解における非常に重要な思考法である。
