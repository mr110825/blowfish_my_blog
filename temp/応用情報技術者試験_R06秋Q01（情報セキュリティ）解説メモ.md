### 【応用情報技術者試験：午後問題解説メモ】令和6年秋期 問1 情報セキュリティ

本稿では、令和6年度秋期 応用情報技術者試験の午後問題 問1「情報セキュリティ」を対象に、解答に至る思考プロセスと関連知識を詳述する。

この問題は、ECサイトにおける**「パスワードの安全な管理」**をテーマに、ペネトレーションテストの結果を通じて、具体的な攻撃手法と防御策の理解を問う内容である。SQLインジェジェクション、レインボーテーブル攻撃、そしてそれらに対抗するためのソルト、ペッパーといった、現代のWebセキュリティにおいて必須の知識が網羅されている。

個々の設問を丁寧に読み解き、合格に必要な知識を習得することが本稿の目的である。

### 問題の全体像の把握

解答に着手する前に、まず以下の3点を正確に把握することが極めて重要である。

1.  **登場人物（組織）と関係性:**
    *   **F社:** 日用雑貨を販売するECサイト（本システム）の開発・運営主体。
    *   **D社:** 本システムが構築されているクラウドサービスの提供者。
    *   **U社:** F社がペネトレーションテストを依頼したセキュリティベンダー。

2.  **システム構成:**
    問題文の「図1 本システムの開発環境のネットワーク構成（抜粋）」から、システムがクラウド上に構築され、外部からのアクセスはFW（ファイアウォール）とWAF（Web Application Firewall）を経由することを理解する。

3.  **攻撃のシナリオ（時系列）:**
    ペネトレーションテストで確認された攻撃シナリオは、以下の通りである。
    *   **① データ窃取:** SQLインジェクション攻撃により、会員テーブルの全データ（パスワードのハッシュ値を含む）を窃取する。
    *   **② パスワード推測:** 窃取したハッシュ値に対し、レインボーテーブル攻撃を行い、元のパスワードを割り出す。
    *   **③ 不正ログイン:** 割り出したパスワードを利用し、会員になりすましてシステムにログインする。

この全体像を念頭に、各設問を解説する。

---

### 設問ごとの詳細解説

#### 設問1：ハッシュ化のメリット
> **問われていること:** パスワードをハッシュ化して保存するメリットは、ハッシュ値のどのような特性によるものか。

**【解答】 ハッシュ値からパスワードの割出しは難しい。（または、一方向性を持つため元の値を復元できない。）**

**【思考プロセス】**
ハッシュ関数は、入力値から固定長のハッシュ値を生成するが、そのハッシュ値から元の入力値を復元することは計算上極めて困難である。この性質を**「一方向性」**と呼ぶ。
万が一、データベースが漏えいしても、パスワードそのものではなくハッシュ値が漏れるだけなので、直ちにパスワードが知られることはない。この点がハッシュ化の最大のメリットである。
「復元が困難」「割り出しが難しい」「一方向性」といったキーワードを用いて、25字以内で簡潔にまとめる。

#### 設問2：侵害される情報セキュリティの3要素
> **問われていること:** SQLインジェクション攻撃で会員データが漏えいした場合、情報セキュリティの3要素のうち、どれが直接的に侵害されるか。

**【解答】 機密性**

**【思考プロセス】**
まず、情報セキュリティの3要素（CIA）を正確に理解する必要がある。
*   **機密性 (Confidentiality):** 認可された者だけが情報にアクセスできること。
*   **完全性 (Integrity):** 情報が破壊、改ざんされていないこと。
*   **可用性 (Availability):** 認可された者が、必要な時に情報にアクセスできること。

本件のSQLインジェクション攻撃では、攻撃者が不正に会員テーブルのデータを**「取得」**している。これは、アクセス権限のない者が情報にアクセスしたことを意味し、機密性が侵害された状態である。

#### 設問3：攻撃手法と対策の専門用語
> **問われていること:** 空欄`a`および`b`に入る適切な字句は何か。

**【解答】 a: オ（ブルートフォース） / b: カ（プレースホルダ）**

**【思考プロセス】**
**[空欄 a について]**
問題文に「パスワードを**総当たりで試行する**」とある。考えられる全ての組み合わせを試す攻撃は**「ブルートフォース攻撃（総当たり攻撃）」**である。これは基本的な用語であり、確実に正解したい。

**[空欄 b について]**
SQLインジェクション攻撃への対策として、最も標準的で効果的な手法を選ぶ。
> 外部からの入力値が埋め込まれる箇所を専用の記号に置き換えたSQL文の雛形をあらかじめ作成しておき、…DB管理システム側で外部からの入力値を割り当てる。

これは**「プレースホルダ」**を用いた実装（バインド機構）の説明そのものである。
学習メモで「サニタイズ」と迷われていたが、両者には明確な違いがある。
*   **サニタイズ:** SQL文として特別な意味を持つ文字（`'`や`--`など）を無害化（エスケープ）する手法。実装に漏れが生じやすい。
*   **プレースホルダ:** SQL文の「構造」と「値」を完全に分離して扱うため、原理的にSQLインジェクションが発生しない、より安全な対策である。

#### 設問4：同じパスワードの利用者の特定
> **問われていること:** 会員番号 "21717202" のパスワードが推測された場合、同様にリスクが最も高い他の会員は誰か。

**【解答】 イ（30781985）**

**【思考プロセス】**
レインボーテーブル攻撃は、特定のパスワードから生成されるハッシュ値を事前に計算しておくことで、ハッシュ値から元のパスワードを高速に特定する手法である。
会員番号 "21717202" のパスワードが特定されたということは、そのハッシュ値に対応する元のパスワードが判明したということである。
表1を見ると、会員番号 "30781985" のパスワードのハッシュ値が "21717202" と全く同一である。これは、両者が**同じパスワードを設定している**ことを意味する。したがって、"30781985" のパスワードも同様に判明しており、不正アクセスのリスクが最も高い。

#### 設問5：セキュリティ対策の基本原則
> **問われていること:** 複数の対策を組み合わせ、一つの対策が破られても他の対策で攻撃を防ぐという考え方を漢字4字で何というか。

**【解答】 多層防御**

**【思考プロセス】**
問題文では「WAFでSQLインジェクション攻撃が検知できていたが、仮にそれが破られても、本システム自体でも対策を行う」と記述されている。
このように、単一の防御策に依存せず、複数の異なる防御壁を幾重にも設けることで、全体のセキュリティ強度を高める考え方を**「多層防御」**または「深層防御（Defense in Depth）」と呼ぶ。これはセキュリティ設計の基本原則の一つである。

#### 設問6：ソルトとペッパー、そして計算
> **問われていること:** (1) ペッパーがレインボーテーブル攻撃に有効な理由をソルトとの違いに着目して答えよ。(2) パスワード長を6文字から10文字に変更した場合、パターンは何倍になるか。

**【解答】**
*   **(1) 会員テーブルの窃取だけではペッパーを得ることができないから。** (35字以内)
*   **(2) 70⁴**

**【思考プロセス】**
**(1) ペッパーの有効性**
ソルトとペッパーは共にレインボーテーブル攻撃対策だが、管理方法が決定的に異なる。
*   **ソルト:** ユーザーごとに異なるランダムな文字列。パスワードと結合してハッシュ化され、**DBの会員テーブル内に一緒に保存される**。
*   **ペッパー:** 全ユーザーで共通の秘密の文字列。パスワードと結合してハッシュ化されるが、**DBとは別の安全な場所（設定ファイルなど）に保存される**。

この違いにより、攻撃者が会員テーブルを窃取した場合、ソルトは入手できるがペッパーは入手できない。攻撃者はペッパーを知らないため、正しいハッシュ値を計算できず、事前に用意したレインボーテーブルが無意味になる。この点を簡潔に記述する。

**(2) パターン数の計算**
これは数学の基礎的な計算である。
*   使用可能な文字種: 70種類
*   6文字の場合のパターン数: 70⁶ 通り
*   10文字の場合のパターン数: 70¹⁰ 通り
*   何倍になったか = (10文字のパターン数) / (6文字のパターン数) = 70¹⁰ / 70⁶ = 70⁽¹⁰⁻⁶⁾ = **70⁴** 倍

指数法則 `aᵐ / aⁿ = aᵐ⁻ⁿ` を適用する。

---

### この問題から学ぶべきポイントまとめ

本問は、パスワード管理とWebアプリケーションの脆弱性に関する、非常に実践的で重要な知識を問う良問であった。今後の学習のために、以下の3点は確実に押さえておきたい。

1.  **パスワード保護技術の正確な理解:** ハッシュ化（一方向性）、ソルト（対レインボーテーブル）、ペッパー（対DB漏えい）、ストレッチング（対ブルートフォース）の4つの技術は、それぞれの目的と仕組みをセットで正確に理解することが不可欠である。
2.  **SQLインジェクション対策の王道:** 現代のWebアプリケーション開発において、SQLインジェクション対策としてプレースホルダ（バインド機構）を利用することはもはや常識である。サニタイズとの違いも含めて、その原理を理解しておく必要がある。
3.  **多層防御の考え方:** 単一の完璧なセキュリティ対策は存在しない。WAFのような外部対策と、アプリケーション自身の堅牢化といった内部対策を組み合わせる「多層防御」が、セキュリティの基本原則であることを再認識することが重要である。