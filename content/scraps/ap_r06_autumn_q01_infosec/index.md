+++
date = '2025-09-12T14:30:49+09:00'
draft = false
title = '応用情報技術者試験 R06秋Q01（情報セキュリティ）解説'
tags = ["情報セキュリティ", "応用情報技術者試験", "サイバー攻撃"]
+++
## はじめに

応用情報技術者試験は、IT業界において広く認知されている国家資格であり、その午後問題では実践的なセキュリティ知識が問われます。本稿では、令和6年度秋期の問1「情報セキュリティ」について、合格に必要な思考プロセスと関連知識を体系的に解説します。

この問題は、ECサイトにおけるパスワードの安全な管理をテーマに、ペネトレーションテストの結果を通じて、SQLインジェクション、レインボーテーブル攻撃、そして多層防御といった現代のWebセキュリティにおいて必須の知識を網羅した良問です。

## 問題の全体像

### 登場人物と関係性

| 組織名 | 役割 | 詳細 |
| :--- | :--- | :--- |
| **F社** | ECサイト運営主体 | 日用雑貨を販売するECサイトの開発・運営 |
| **D社** | クラウドサービス提供者 | 本システムが構築されているクラウド基盤 |
| **U社** | セキュリティベンダー | F社からペネトレーションテストを受託 |

### システム構成の理解

問題文の「図1 本システムの開発環境のネットワーク構成（抜粋）」から重要なポイント：

- **クラウド環境**: システムはクラウド上に構築
- **多層防御**: FW（ファイアウォール）とWAF（Web Application Firewall）による保護
- **外部アクセス**: インターネットからのアクセスは防護装置を経由

### 攻撃シナリオの時系列

1. **データ窃取**: SQLインジェクション攻撃により会員テーブル全データを窃取
2. **パスワード推測**: 窃取したハッシュ値にレインボーテーブル攻撃を実行
3. **不正ログイン**: 推測したパスワードで会員になりすましてログイン

---

## 設問別解説

### 設問1：ハッシュ化のメリット

**問題**: パスワードをハッシュ化して保存するメリットは、ハッシュ値のどのような特性によるものか。

**解答**: ハッシュ値からパスワードの割出しは難しい。

**解説**:
ハッシュ関数の**一方向性**がポイントです。

| 特性 | 説明 | セキュリティへの影響 |
| :--- | :--- | :--- |
| **一方向性** | 入力値からハッシュ値は容易に計算可能 | パスワード照合が可能 |
| **非可逆性** | ハッシュ値から入力値の復元は困難 | データ漏えい時の影響を軽減 |

万が一データベースが漏えいしても、パスワードそのものではなくハッシュ値のみが漏れるため、直ちにパスワードが判明することはありません。

### 設問2：情報セキュリティの3要素

**問題**: SQLインジェクション攻撃で会員データが漏えいした場合、情報セキュリティの3要素のうち、どれが直接的に侵害されるか。

**解答**: 機密性

**解説**:
情報セキュリティの3要素（CIA）の理解が必要です。

| 要素 | 英語 | 定義 | 本件での状況 |
| :--- | :--- | :--- | :--- |
| **機密性** | Confidentiality | 認可された者のみがアクセス可能 | ❌ 不正な者がデータを取得 |
| **完全性** | Integrity | 情報が破壊・改ざんされていない | ⭕ データ自体は改ざんされていない |
| **可用性** | Availability | 必要時にアクセス可能 | ⭕ システムは正常に稼働 |

SQLインジェクション攻撃によるデータ**窃取**は、アクセス権限のない者による情報取得であり、**機密性**の侵害に該当します。

### 設問3：攻撃手法と対策の専門用語

**問題**: 空欄a、bに入る適切な字句は何か。

**解答**: 
- a: オ（ブルートフォース）
- b: カ（プレースホルダ）

**解説**:

**[空欄a: 攻撃手法]**
「パスワードを総当たりで試行する」→ **ブルートフォース攻撃**

**[空欄b: SQLインジェクション対策]**
「外部入力値が埋め込まれる箇所を専用の記号に置き換えた雛形」→ **プレースホルダ**

| 対策手法 | 仕組み | 効果 | 実装の注意点 |
| :--- | :--- | :--- | :--- |
| **プレースホルダ** | SQL構造と値を完全分離 | 原理的にSQLインジェクション不可 | 推奨される手法 |
| **サニタイズ** | 特殊文字のエスケープ処理 | 部分的な対策 | 実装漏れのリスクあり |

### 設問4：同一パスワードユーザーの特定

**問題**: 会員番号"21717202"のパスワードが推測された場合、同様にリスクが高い他の会員は？

**解答**: イ（30781985）

**解説**:
レインボーテーブル攻撃の理解がポイントです。

1. **会員番号21717202のパスワードが判明** = そのハッシュ値に対応する元パスワードが特定
2. **表1を確認** = 会員番号30781985のハッシュ値が21717202と同一
3. **結論** = 同じパスワードを使用しているため、同様に判明済み

この現象は、複数のユーザーが同じパスワードを設定していることを示しており、**パスワードポリシーの重要性**を物語っています。

### 設問5：多層防御の概念

**問題**: 複数の対策を組み合わせ、一つの対策が破られても他の対策で攻撃を防ぐ考え方を漢字4字で何というか。

**解答**: 多層防御

**解説**:
セキュリティ設計の基本原則です。

**多層防御の例**:
- **外部対策**: WAF（Web Application Firewall）
- **内部対策**: アプリケーション自体の堅牢化
- **データ保護**: ハッシュ化、暗号化

単一の完璧なセキュリティ対策は存在しないため、複数の異なる防御壁を設けることで全体のセキュリティ強度を高めます。

### 設問6：ソルトとペッパー、パターン計算

**問題**: 
1. ペッパーがレインボーテーブル攻撃に有効な理由をソルトとの違いに着目して答えよ
2. パスワード長を6文字から10文字に変更した場合、パターンは何倍になるか

**解答**:
1. 会員テーブルの窃取だけではペッパーを得ることができないから。
2. 70⁴

**解説**:

**1. ソルトとペッパーの違い**

| | ソルト | ペッパー |
| :--- | :--- | :--- |
| **用途** | ユーザーごとに異なる値 | 全ユーザー共通の秘密値 |
| **保存場所** | DBの会員テーブル内 | 設定ファイルなど別の安全な場所 |
| **攻撃者の入手可能性** | DBを窃取すれば入手可能 | DB窃取だけでは入手不可 |
| **レインボーテーブル対策効果** | 部分的（テーブルを無力化） | 完全（正しいハッシュ値を計算不可） |

ペッパーは攻撃者がDBを窃取しても入手できないため、事前に作成したレインボーテーブルが無意味になります。

**2. パターン数計算**

使用可能文字種: 70種類

- 6文字の場合: 70⁶ 通り
- 10文字の場合: 70¹⁰ 通り
- 倍率計算: 70¹⁰ ÷ 70⁶ = 70⁴ 倍

指数法則 `aᵐ ÷ aⁿ = aᵐ⁻ⁿ` を適用します。

---

## この問題から学ぶべき重要ポイント

### 1. パスワード保護技術の体系的理解

| 技術 | 目的 | 効果 |
| :--- | :--- | :--- |
| **ハッシュ化** | 一方向性による保護 | 平文パスワードの漏えい防止 |
| **ソルト** | レインボーテーブル対策 | 事前計算攻撃の無力化 |
| **ペッパー** | DB漏えい時の追加保護 | ソルトも漏えいした場合の対策 |
| **ストレッチング** | ブルートフォース対策 | 計算コストの増大による攻撃困難化 |

### 2. SQLインジェクション対策の王道

プレースホルダ（バインド機構）による対策は現代のWebアプリケーション開発における標準手法です。

```sql
-- 危険な例（文字列結合）
SELECT * FROM users WHERE id = '" + userId + "'

-- 安全な例（プレースホルダ）
SELECT * FROM users WHERE id = ?
```

### 3. 多層防御の実践

- **ネットワーク層**: ファイアウォール、WAF
- **アプリケーション層**: 入力検証、プレースホルダ
- **データ層**: ハッシュ化、暗号化
- **運用層**: 監視、ログ分析

## 参考リンク

- [IPA情報処理推進機構 応用情報技術者試験](https://www.jitec.ipa.go.jp/1_11seido/ap.html)
- [OWASP Top 10](https://owasp.org/www-project-top-ten/)
- [安全なウェブサイトの作り方（IPA）](https://www.ipa.go.jp/security/vuln/websecurity.html)