---
title: "【応用情報技術者試験】【午後問題解説】令和3年春期 問1 情報セキュリティ"
date: "2025-09-13T12:00:00+09:00"
draft: false
tags:
  - 応用情報技術者試験
  - 情報セキュリティ
---
## 導入

本記事では、応用情報技術者試験の令和3年度春期 午後問題の問1「情報セキュリティ」について、その思考プロセスから解答のポイントまでを詳細に解説する。

この問題は、インターネットの根幹を支えるDNS（Domain Name System）サーバへのサイバー攻撃を題材としており、DNSの仕組み、脆弱性管理、そしてインシデント発生後のキャッシュの影響といった、実務に直結する重要な知識が問われる。

この問題を解き明かすことで、DNSセキュリティの具体的な対策と、インシデント発生時に考慮すべき技術的ポイントを深く理解することができる。

まず、問題の全体像を把握することから始めよう。

*   **登場人物（組織）と関係性:**
    *   **R社:** Webサイト開発会社。自社の権威DNSサーバを運用している。
    *   **Y社:** R社の顧客。PCがマルウェアに感染する被害を受ける。
    *   **Z社:** Y社が利用するISP（インターネットサービスプロバイダ）。キャッシュDNSサーバを運用している。
*   **インシデントの概要:**
    1.  攻撃者がR社の権威DNSサーバの脆弱性を突き、Aレコードを不正に書き換える。
    2.  Y社のPCが、Z社のキャッシュDNSサーバ経由で偽のAレコード情報を取得し、偽サイトへ誘導されマルウェアに感染する。
    3.  R社がAレコードを修正するも、Z社のキャッシュDNSサーバには古い情報が残り続けたため、Y社ではしばらく正常なサイトにアクセスできない状態が続いた。

## 設問ごとの詳細解説

### 設問1

*   **問われていること:**
    DNSレコードが改ざんされた結果として発生した事象は何か。
*   **【解答】:**
    ウ、エ
*   **【思考プロセス】:**
    *(注: 本解説はIPAが公開している問題の要約に基づいており、選択肢（ア〜オ）の具体的な内容は記載されていない。ここでは、問題文の記述から正解となる事象を特定し、その論理を解説する。)*

    1.  **結論ファースト:**
        DNSのAレコードが改ざんされると、利用者は偽のWebサイトへ誘導され、その結果としてマルウェア感染などの被害に遭う。また、DNSキャッシュの影響で、正規の状態への復旧後も問題が継続することがある。
    2.  **根拠の提示:**
        問題文には、インシデントの現象として`「①Y社のPCがR社の偽サイトに誘導された」`こと、そして`「③Aレコード修正後も、Z社のDNSサーバに偽情報のキャッシュが残っていたため、Y社のPCが正常にアクセスできるようになるまで時間がかかった」`ことが明確に記述されている。
    3.  **論理展開:**
        DNSのAレコードは、ドメイン名に対応するIPアドレスを定義する最も基本的なレコードである。このレコードが攻撃者によって偽サイトのIPアドレスに書き換えられると、DNSを信じてアクセスしてくる利用者は、意図せず偽サイトに接続させられてしまう。これが`「偽サイトに誘導された」`という事象である。
        また、DNSの応答は効率化のために各所のキャッシュDNSサーバに一時保存（キャッシュ）される。一度キャッシュされると、その情報の有効期間（TTL: Time To Live）が切れるまで、たとえ大元の権威DNSサーバの情報が修正されても、キャッシュサーバは古い情報を応答し続ける。これが`「正常にアクセスできるようになるまで時間がかかった」`原因である。
        したがって、これら2つの事象が直接的な結果として発生したと言える。

### 設問2

#### (1) 空欄a

*   **問われていること:**
    DNSソフトウェアの脆弱性を突かれて奪取された権限は何か。
*   **【解答】:**
    ア (管理者権限)
*   **【思考プロセス】:**
    1.  **結論ファースト:**
        サーバ上の設定ファイル（DNSのゾーン情報など）を書き換えるためには、そのサーバにおける最も強力な権限、すなわち管理者権限が必要である。
    2.  **根拠の提示:**
        問題文には`「権威DNSサーバのAレコードが改ざんされ」`たとあり、その原因が`「DNSソフトウェアのバージョンが古く、a を奪取される脆弱性があった」`とされている。
    3.  **論理展開:**
        Aレコードの改ざんは、DNSサーバの設定ファイルを直接編集する行為に等しい。このようなシステム根幹の設定変更は、一般ユーザ権限では実行不可能である。攻撃者が目的を達成するためには、OS上で任意の操作が可能となる「管理者権限」（Linux/UNIX系OSではroot権限、Windows ServerではAdministrator権限）を奪取する必要がある。したがって、空欄aには「管理者権限」が入る。

#### (2) アクセスがなかった理由

*   **問われていること:**
    マルウェア感染時期に、R社の正規サイトへのアクセスがほとんどなかった理由は何か。
*   **【解答】:**
    顧客がR社の偽サイトに誘導されたから
*   **【思考プロセス】:**
    1.  **結論ファースト:**
        DNSの名前解決が偽サイトのIPアドレスを返していたため、利用者の通信が正規のサイトに到達すること自体がなかったからである。
    2.  **根拠の提示:**
        問題文には`「①Y社のPCがR社の偽サイトに誘導された」`という現象と、`「②Y社のPCがマルウェア感染した時期、R社の正規サイトへのアクセスはほとんどなかった」`という事実が記述されている。
    3.  **論理展開:**
        Webサイトへのアクセスは、①ブラウザがDNSサーバにドメイン名のIPアドレスを問い合わせ、②返ってきたIPアドレスに対してHTTP(S)通信を行う、という流れで進む。今回のインシデントでは、手順①の段階で偽サイトのIPアドレスが返されている。そのため、利用者のブラウザは手順②で正規のサイトではなく、偽サイトへアクセスしにいく。結果として、正規のサイト側から見れば、アクセスが全く来ない（ほとんどない）状態となる。

#### (3) キャッシュが残っていたサーバ

*   **問われていること:**
    Aレコード修正後も偽情報のキャッシュが残っていたサーバはどれか。
*   **【解答】:**
    エ (Z社のDNSサーバ)
*   **【思考プロセス】:**
    1.  **結論ファースト:**
        利用者が直接問い合わせを行うキャッシュDNSサーバに、改ざん後の偽情報がTTLの間保持されていたからである。
    2.  **根拠の提示:**
        問題文には`「Y社はISPであるZ社のDNSサーバを利用している」`とあり、`「③Aレコード修正後も、Z社のDNSサーバに偽情報のキャッシュが残っていた」`と直接的に記述されている。
    3.  **論理展開:**
        DNSの名前解決の仕組みを理解することが鍵となる。
        *   **権威DNSサーバ（R社）:** ドメインの情報を管理する「大元」のサーバ。
        *   **キャッシュDNSサーバ（Z社）:** 利用者からの問い合わせを受け付け、権威DNSサーバに代理で問い合わせ、結果を一時的に保存（キャッシュ）するサーバ。
        利用者のPC（Y社）は、まず身近なキャッシュDNSサーバ（Z社）に問い合わせる。Z社のサーバはR社の権威DNSサーバに問い合わせ、得られた（偽の）情報をY社のPCに返すと同時に、自身のキャッシュに保存する。R社がAレコードを修正しても、Z社のサーバはTTLが切れるまでキャッシュ内の古い（偽の）情報を参照し続けるため、Y社のPCはしばらくの間、偽サイトへ誘導され続けたのである。

### 設問3

#### (1) 再発防止策

*   **問われていること:**
    インシデントの根本原因に対する再発防止策は何か。
*   **【解答】:**
    エ (定期的に脆弱性検査と対策を実施する)
*   **【思考プロセス】:**
    1.  **結論ファースト:**
        インシデントの根本原因は「ソフトウェアの既知の脆弱性」であったため、その脆弱性を日頃から発見し、修正するプロセスを確立することが直接的な再発防止策となる。
    2.  **根拠の提示:**
        原因調査の結果として`「権威DNSサーバのDNSソフトウェアのバージョンが古く、...脆弱性があった」`と特定されている。
    3.  **論理展開:**
        攻撃者は、この「古いバージョン」に存在した「脆弱性」を悪用して管理者権限を奪取した。したがって、このような事態を未然に防ぐためには、自組織のシステムにどのような脆弱性が存在するかを定期的に把握し（脆弱性検査）、セキュリティパッチの適用などの対策を継続的に実施する体制が不可欠である。

#### (2) 空欄b

*   **問われていること:**
    EV証明書を導入することで、Webブラウザで確認できるようになる情報は何か。
*   **【解答】:**
    ア (会社名)
*   **【思考プロセス】:**
    1.  **結論ファースト:**
        EV証明書の最大の特徴は、厳格な審査を経て発行され、サイトを運営する組織の法的な実在性を示すことにある。これにより、ブラウザのアドレスバーなどに組織名（会社名）が表示される。
    2.  **根拠の提示:**
        対策強化策として`「Webサイトの信頼性向上のため、EV証明書を導入。これによりWebブラウザで b が確認できるようになる」`とある。また、採点講評には`「EV証明書によってサイト運営組織の実在性を示し、利用者がそれをブラウザ上で確認できるというセキュリティ対策上の意義を理解してほしい」`とある。
    3.  **論理展開:**
        SSL/TLS証明書にはいくつかの認証レベルがある。
        *   **DV (Domain Validation):** ドメインの所有権のみを認証。最も手軽。
        *   **OV (Organization Validation):** 組織の実在性を認証。
        *   **EV (Extended Validation):** 最も厳格な基準で組織の実在性を認証。
        EV証明書を導入したサイトにアクセスすると、ブラウザはアドレスバーを緑色にしたり、鍵マークの横に認証された組織名（会社名）を表示したりする。これにより、利用者はフィッシングサイトなどではないことを視覚的に確認しやすくなり、サイトの信頼性が向上する。

#### (3) 空欄c

*   **問われていること:**
    社内のキャッシュDNSサーバがインターネットからの問い合わせに応答可能な状態（オープンリゾルバ）である場合に引き起こされる脅威は何か。
*   **【解答】:**
    DNSキャッシュポイズニング
*   **【思考プロセス】:**
    1.  **結論ファースト:**
        不特定多数からの問い合わせを受け付けるDNSサーバ（オープンリゾルバ）は、外部の攻撃者によってキャッシュに偽のDNS情報を注入される「DNSキャッシュポイズニング」攻撃を受けるリスクが高まる。
    2.  **根拠の提示:**
        問題文には`「社内のキャッシュDNSサーバがインターネットからの問合せに応答可能な状態は、c の脅威があるため、FW設定を変更し、社内LANからのみの問合せに限定する」`とある。
    3.  **論理展開:**
        キャッシュDNSサーバは、本来、組織内の利用者からの問い合わせのみを受け付けるべきである。これがインターネット全体に公開されている状態（オープンリゾルバ）だと、攻撃者に悪用される危険がある。
        その代表的な脅威が**DNSキャッシュポイズニング**である。攻撃者は、オープンリゾルバに対して巧妙なDNS問い合わせを送りつけ、その応答を偽装することで、キャッシュに意図的に偽のDNSレコード（例: `www.example.com`のIPアドレスは攻撃者のサーバ、など）を登録させることができる。一度キャッシュが汚染されると、そのサーバを利用する正規のユーザは、意図せず攻撃者のサイトへ誘導されてしまう。

## まとめ：この問題から盗むべき「思考の型」

本問は、DNSという基本的ながら奥深い技術要素を題材に、セキュリティの多面的な知識を問う良問である。今後の学習や実務に活かすべき「思考の型」を3点に絞って提示する。

1.  **DNSの役割を「権威」と「キャッシュ」に分けて考えるべし**
    インシデントを分析する際、「どこで情報が作られ（権威DNS）」「どこで情報が利用・保持されるのか（キャッシュDNS）」を区別することが極めて重要だ。特に障害発生時、「修正したはずなのに直らない」という事象の裏には、キャッシュのTTLが潜んでいることが多い。この2つの役割を常に意識することで、問題の所在を正確に切り分けることができる。

2.  **インシデントの原因は「脆弱性」と「設定不備」の両面から探るべし**
    今回の根本原因は「ソフトウェアの脆弱性」だったが、設問3(4)では「オープンリゾルバという設定不備」もリスクとして問われた。セキュリティインシデントは、パッチ未適用の脆弱性だけでなく、意図しない設定が原因で発生することも多い。問題文を読む際は、この両方の観点からリスクを探す癖をつけることが、解答の精度を高める。

3.  **対策は「技術」と「運用」のセットで捉えるべし**
    EV証明書という「技術的対策」と、脆弱性検査の定期実施という「運用的対策」が問われたように、セキュリティは技術を導入するだけで完結しない。それを正しく維持・管理する運用プロセスがあって初めて実効性を持つ。問題で対策が問われた際は、「どんなモノを入れるか？」だけでなく、「それをどう使い続けるか？」という視点も持つことが、より深い理解につながる。

## 参考資料
- [情報処理推進機構（IPA）：過去問](https://www.ipa.go.jp/shiken/mondai-kaiotu/index.html)