---
title: "【応用情報技術者試験】【午後問題解説】令和4年秋期 問1 情報セキュリティ"
date: 2025-09-13T06:35:21+09:00
draft: false
tags: ["応用情報技術者試験", "情報セキュリティ"]
---
## 導入

本記事では、令和4年秋期の応用情報技術者試験、午後問題の問1「情報セキュリティ」について、詳細な解説を行う。

この問題は、近年猛威を振るったマルウェア「EMOTET」を彷彿とさせる巧妙なマルウェア「マルウェアX」への対応を題材としている。単なる知識だけでなく、問題文からインシデントの全体像を正確に読み解き、論理的に解答を導き出す実践的な能力が問われる。

この問題を解くことで、以下の実践的知識が身につく。
- ファイアウォール（FW）、プロキシ、メールサーバといった基本的なセキュリティ機器の役割の再確認
- マルウェアの侵入・内部活動（偵察、ポートスキャン）の手口の理解
- SPFやEDRといった、特定の脅威に対抗するための技術的対策の仕組み

問題を解き始める前に、まずは問題の「全体像」を把握することが重要である。

- **登場人物（組織）と関係性:**
    - **P社:** IT関連製品の卸売会社。今回のインシデント対応の主体。
    - **S社:** セキュリティサービス会社。P社にEDRの導入を提案する。
- **ネットワークやシステムの構成:**
    - インターネット、DMZ、内部LANの3層構造。
    - FWが各セグメント間の通信を制御。
    - メール中継サーバ、外部DNSサーバ、プロキシサーバなどが設置されている。
    - パッチは検証LANでテスト後、配布サーバ経由で適用される。
- **インシデントや事象の時系列:**
    1.  社外で「マルウェアX」の被害が多発。
    2.  P社のR主任がマルウェアXの活動内容と自社の現状を調査。
    3.  調査結果に基づき、S社からEDR導入の提案を受ける。

---

## 設問ごとの詳細解説

### 設問1

#### (1)
- **問われていること:**
    問題文中の空欄 a, b, c に入る適切な機器名を、選択肢から選ぶこと。

- **【解答】:**
    - a: ア (FW)
    - b: ケ (メール中継サーバ)
    - c: ク (配布サーバ)

- **【思考プロセス】:**
    1.  **結論ファースト:**
        各空欄の前後の文章が示す役割と、選択肢にある各サーバの機能を結びつけることで解答を導く。

    2.  **根拠の提示:**
        - **空欄a:** 問題文には「**a** は、インターネットとDMZとの間、及び内部LANとDMZとの間の通信をそれぞれ制御し」とある。
        - **空欄b:** 問題文には「**b** は、SPF機能を有効にしており、送信元ドメインが詐称されている電子メール（なりすましメール）を検知した場合には、その電子メールを隔離する」とある。
        - **空欄c:** 問題文には「更新プログラムは、ベンダーのWebサイトで公開されると、まず検証LANで動作検証を行い、問題がないことを確認した上で、**c** を経由して、各サーバ及び従業員のPCに適用される」とある。

    3.  **論理展開:**
        - **空欄a:** ネットワークセグメント間の通信制御を行うのは、ファイアウォール（FW）の基本的な役割である。したがって、aには「ア (FW)」が入る。
        - **空欄b:** SPF（Sender Policy Framework）は、電子メールの送信元ドメインが詐称されていないかを検証する仕組みであり、これはメールサーバ（特に外部からのメールを受け取る中継サーバ）が担う機能である。したがって、bには「ケ (メール中継サーバ)」が入る。
        - **空欄c:** 検証済みのプログラムを社内のPCやサーバへ展開（配布）する役割を持つのは、「配布サーバ」である。したがって、cには「ク (配布サーバ)」が入る。

    4.  **補足知識と周辺情報:**
        - **SPF (Sender Policy Framework):** 送信元IPアドレスを基に、ドメインの正当性を検証する技術。DNSに「このドメインからのメールは、このIPアドレスのサーバから送ります」という情報を登録しておくことで、受信側はそれと異なるIPアドレスから来たメールを「なりすまし」と判断できる。
        - **学習メモより:** `b`で「検証用サーバー」と迷われた点は、非常に惜しい。問題文の「なりすましの検証」という言葉に注目されたのは良い着眼点である。しかし、ここでは「セキュリティ上の検証（SPFによるチェック）」と「更新プログラムの動作検証」という、2種類の「検証」が登場している。前者はメール中継サーバの機能、後者が検証用サーバの役割である。このように、同じ言葉が異なる文脈で使われることがあるため、**「誰が」「何を」検証しているのか**を正確に捉えることが重要である。

#### (2)
- **問われていること:**
    外部DNSサーバで実施しているDDoS攻撃対策の名称を選ぶこと。

- **【解答】:**
    イ (DNSキャッシュポイズニング)

- **【思考プロセス】**
    1.  **結論ファースト:**
        問題文の「DDoSの踏み台攻撃対策」と、DNSサーバの仕組みを組み合わせると、DNSリフレクション攻撃が該当する。

    2.  **根拠の提示:**
        問題文には「外部DNSサーバでは、管理するドメインのゾーン情報に対する問合せだけに応答を返すように設定し、DDoSの踏み台攻撃対策を実施している」とある。

    3.  **論理展開:**
        DNSサーバを踏み台にするDDoS攻撃の代表例が「DNSリフレクション攻撃」である。これは、攻撃者が送信元IPアドレスを偽装してDNSサーバに問い合わせを行い、その応答が偽装されたIPアドレス（つまり攻撃対象）に大量に送りつけられることで、攻撃対象のネットワーク帯域を枯渇させる攻撃である。
        対策として、自身の管理するドメイン情報への問い合わせ（権威DNSサーバとしての役割）のみに応答し、それ以外の再帰的な問い合わせを拒否する設定（オープンリゾルバの無効化）が有効である。問題文の記述はこの対策に合致する。

    4.  **補足知識と周辺情報:**
        - **DNSリフレクション攻撃:** 小さな問い合わせ（リクエスト）をDNSサーバに送り、何倍も大きな応答（レスポンス）を攻撃対象に送りつけることで、攻撃を「増幅（Amplify）」させる。そのため「DNSリフレクター（反射）攻撃」や「DNS増幅攻撃」とも呼ばれる。

---

### 設問2

#### (1)
- **問われていること:**
    マルウェアXの活動(a)「ICMPエコー要求パケットを連続送信」によって、攻撃者が取得しようとしている情報を答えること。

- **【解答】:**
    稼働中のホストのIPアドレス

- **【思考プロセス】:**
    1.  **結論ファースト:**
        ICMPエコー要求（ping）は、ネットワーク上で特定のIPアドレスを持つ機器が応答するかどうか、つまり「生きているか（稼働しているか）」を確認するための基本的なコマンドである。

    2.  **根拠の提示:**
        問題文には「PCが接続するセグメント内のホストに対し、ICMPエコー要求パケットを連続送信して情報を取得」とある。

    3.  **論理展開:**
        マルウェアが内部ネットワークに侵入した後、次なる攻撃対象を探すために、まずは「どのIPアドレスを持つ機器が現在ネットワーク上で活動しているか」を調査する。この活動は「内部偵察（Internal Reconnaissance）」と呼ばれる。ICMPエコー要求パケットを送信し、応答（ICMPエコー応答）が返ってきたIPアドレスをリストアップすることで、攻撃可能なターゲット候補（稼働中のホスト）の一覧を作成できる。

    4.  **陥りがちな罠（あれば）:**
        - **学習メモより:** 「社内ネットワークのIPアドレス」という解答は、方向性としては正しいが、試験の解答としては少しだけ精度が足りない。「IPアドレス」そのものは単なる識別子であり、攻撃者が本当に知りたいのは「そのIPアドレスを持つ機器が、今、攻撃可能な状態で稼働しているか」という情報である。したがって、「稼働中のホストの」という部分が重要なポイントとなる。

#### (2)
- **問われていること:**
    マルウェアXの活動(b)「TCPのSYNパケットを送信してポートスキャンを実施」する目的を選ぶこと。

- **【解答】:**
    ウ (攻撃対象のサービスの稼働状況を知るため)

- **【思考プロセス】:**
    1.  **結論ファースト:**
        ポートスキャンは、特定のホストでどのTCP/UDPポートが待ち受け状態（LISTEN）になっているか、つまり「どのようなサービスが稼働しているか」を調査するための手法である。

    2.  **根拠の提示:**
        問題文には「取得したホストに対し、TCPのSYNパケットを送信してポートスキャンを実施」とある。

    3.  **論理展開:**
        設問2(1)で稼働中のホストを特定した後、攻撃者は次に「そのホスト上で、侵入に使えそうな脆弱なサービスが動いていないか」を探す。各サービスは特定のポート番号（例: HTTPは80番, SSHは22番）で通信を待ち受けている。SYNパケットを様々なポートに送信し、その応答（SYN/ACKが返ってくるか、RSTが返ってくるかなど）を見ることで、どのポートが開いているか（＝サービスが稼働しているか）を特定できる。

    4.  **補足知識と周辺情報:**
        - **TCP SYNスキャン:** ステルススキャンとも呼ばれる。完全なTCPコネクションを確立せず、SYNパケットへの応答のみでポートの開閉を判断するため、相手側のログに記録が残りにくいという特徴がある。

#### (3)
- **問われていること:**
    下線部④「社外のPCから送られてくるマルウェアX付きメールは、SPF機能ではなりすましを検知できない」理由を選ぶこと。

- **【解答】:**
    ア (送信者のドメインが詐称されたものでないから)

- **【思考プロセス】:**
    1.  **結論ファースト:**
        SPFは、メールを送信してきた「サーバのIPアドレス」が、そのドメインの正当な送信サーバとして登録されているかを検証する仕組みである。メール本文の差出人（Fromヘッダ）が本物かどうかは直接検証しない。

    2.  **根拠の提示:**
        問題文には「過去の電子メールのやり取りを悪用し、その内容に含まれる氏名、メールアドレス、件名、本文などを流用して、取引先などにマルウェアX付きの電子メールを送信する」とある。

    3.  **論理展開:**
        EMOTETなどで見られる手口は、正規のメールサービス（例: GmailやMicrosoft 365）のアカウントを乗っ取り、そのアカウントを使ってマルウェアメールを送信するというものである。
        この場合、メールはGmailの**正規のメールサーバ**から送信される。受信側がSPFをチェックすると、送信サーバのIPアドレスはGmailの正当なものとしてDNSに登録されているため、SPF認証は「成功（Pass）」してしまう。
        つまり、**送信サーバのドメインは詐称されていない**ため、SPFでは検知できない。攻撃者は、メールの「差出人名」や「件名」を過去のやり取りから流用して受信者を騙すが、SPFの検証レイヤーではそこまで見ていない。

    4.  **陥りがちな罠（あれば）:**
        - **学習メモより:** この問題はSPFの限界を理解しているかを問う良問である。SPFはあくまで「エンベロープFrom（通信レベルでの送信元）」のドメインと送信サーバIPの整合性をチェックするものである。私たちが普段メールソフトで見る「ヘッダFrom（表示上の差出人）」のなりすましを直接防ぐものではない。この違いを補完するために、DKIM（電子署名による検証）やDMARC（SPFとDKIMの結果をどう扱うかのポリシー）といった技術が併用される。

---

### 設問3

#### (1)
- **問われていること:**
    EDRが検知すべき、マルウェアXの活動を示す「PC上の不審な動作」を具体的に答えること。

- **【解答】:**
    ICMPエコー要求パケットの連続した送信

- **【思考プロセス】:**
    1.  **結論ファースト:**
        EDRはPC上の「振る舞い」を監視する。マルウェアXの活動の中で、通常の業務利用では考えにくい異常な振る舞いを抜き出す。

    2.  **根拠の提示:**
        問題文のマルウェアXの活動内容として「(a) PCが接続するセグメント内のホストに対し、ICMPエコー要求パケットを連続送信して情報を取得。」と明記されている。

    3.  **論理展開:**
        EDR（Endpoint Detection and Response）は、個々のPCやサーバ（エンドポイント）の内部動作を詳細に監視し、既知のシグネチャに合致しない「不審な振る舞い」を検知する技術である。
        通常のPCが、短時間に内部ネットワークの多数のホストに対して連続的にping（ICMPエコー要求）を送信することは、まずない。これは明らかにネットワーク偵察活動であり、EDRが検知すべき典型的な「不審な動作」である。

    4.  **陥りがちな罠（あれば）:**
        - **学習メモより:** 「連続したICMPでホストの情報を取得しようとしている」という解答は、意図としては完全に正しい。ただし、応用情報技術者試験の記述問題では、**「問題文中の言葉をできるだけ正確に使う」**ことが、より確実な得点に繋がる。この場合、「ICMPエコー要求パケットの連続した送信」と記述することで、解答の精度がさらに高まる。

#### (2)
- **問われていること:**
    EDRが実行できる緊急措置の具体例を答えること。

- **【解答】:**
    マルウェアに感染したPCを隔離する。

- **【思考プロセス】:**
    1.  **結論ファースト:**
        マルウェア感染が疑われるPCに対して最も有効な緊急措置は、被害拡大を防ぐためにネットワークから切り離すことである。

    2.  **根拠の提示:**
        問題文には「PC上の不審な動作を検知し、管理者に通知するとともに、内部ネットワークの探索を防ぐなどの緊急措置を実施できる」とある。

    3.  **論理展開:**
        「内部ネットワークの探索を防ぐ」ための最も直接的で効果的な方法は、探索活動を行っているPCそのものをネットワークから遮断（隔離）することである。EDR製品の多くは、管理サーバからの遠隔指示により、エージェントが導入されたPCのネットワーク通信を（特定の通信を除き）強制的にブロックする機能を持つ。これにより、マルウェアが他の機器へ感染を広げたり、C&Cサーバと通信したりするのを防ぐことができる。

#### (3)
- **問われていること:**
    EDR導入によって可能になる、マルウェアXの感染経路や被害範囲の調査方法を答えること。

- **【解答】:**
    EDRが保存するログの分析

- **【思考プロセス】:**
    1.  **結論ファースト:**
        EDRの"R"（Response）は、インシデント対応を指す。その対応の基礎となるのが、"E"（Endpoint）で収集・記録された詳細なアクティビティログである。

    2.  **根拠の提示:**
        EDRは「PCに導入するエージェントと管理サーバで構成」され、「PC上の不審な動作を検知」する仕組みである。これは、PC上の動作を常に記録・監視していることを意味する。

    3.  **論理展開:**
        従来のログ（FWやプロキシ）だけでは、PC「内部」で何が起こったかの詳細までは分からない。EDRは、PC上で「どのプロセスが起動し」「どのファイルにアクセスし」「どこに通信しようとしたか」といった詳細なログを時系列で記録している。
        このログを分析することで、
        - マルウェアが最初に実行されたのはいつか？
        - どのファイルを開いたことがきっかけか？
        - 実行後、どのような内部偵察活動を行ったか？
        - どの外部サーバと通信しようとしたか？
        といった感染の全容を解明することが可能になる。これが、EDRがインシデント調査（デジタルフォレンジック）において強力なツールとなる理由である。

    4.  **補足知識と周辺情報:**
        - **学習メモより:** この問題が未回答だったとのことなので、EDRの核心的な価値について補足する。EDRの価値は、単に「検知（Detection）」するだけでなく、検知後の「対応（Response）」を迅速かつ正確に行うための情報を提供することにある。その情報の源泉こそが、エンドポイントで常時収集されている詳細な「ログ」なのである。

---

## まとめ：この問題から盗むべき「思考の型」

この一問から、今後の学習に活かせる普遍的な思考法を3つ抽出する。

1.  **セキュリティ機器の「守備範囲」を正確に把握せよ**
    FWはセグメント間の通信を制御し、プロキシはWebアクセスを中継・記録し、メールサーバはメールの送受信を担う。そしてSPFは「送信サーバの正当性」を検証するが、EDRは「PC内部の振る舞い」を監視する。それぞれの技術が「何を」「どこで」守っているのか、その守備範囲と限界を明確に区別することが、適切な対策を選択する上で不可欠である。

2.  **攻撃者の視点で「侵入後の行動」をトレースせよ**
    マルウェアは侵入したら終わりではない。そこから「内部偵察（ping、ポートスキャン）」「権限昇格」「情報窃取」「感染拡大」といった一連の活動を行う。攻撃者が次に何をするかを予測しながら問題文を読むことで、「ICMPの連続送信」や「SYNスキャン」といった記述が、単なる文字列ではなく、攻撃者の意図を持った行動として立体的に見えてくる。

3.  **記述解答は「問題文の言葉」で書くことを意識せよ**
    設問3(1)のように、自分の言葉で意図を説明できても、満点の解答を得るためには、問題文で使われている技術的なキーワードを正確に引用することが極めて有効である。「連続したICMP」ではなく「ICMPエコー要求パケットの連続した送信」と書く。この一手間が、採点者に対して「私は問題文を正確に理解しています」という明確なメッセージとなる。

---

## 参考資料
- [情報処理推進機構（IPA）：過去問](https://www.ipa.go.jp/shiken/mondai-kaiotu/index.html)