+++
date = '2025-09-12T14:30:49+09:00'
draft = false
title = '応用情報技術者試験 R05秋Q01（情報セキュリティ）解説'
tags = ["応用情報技術者試験", "情報セキュリティ", "サイバー攻撃", "PPAP", "S/MIME", "公開鍵暗号", "電子署名"]
+++

## はじめに

応用情報技術者試験の情報セキュリティ分野は、実際のセキュリティインシデントに基づく実践的な問題が出題される重要な領域である。本稿では、令和5年秋期午後問題の問1「情報セキュリティ」を詳細に解説する。

この問題は、多くの企業で慣習的に利用されてきたメール送信手法「**PPAP**」の脆弱性に焦点を当て、その代替策としての「**S/MIME**」の仕組みを問う、非常に実践的な内容となっている。

この問題を通じて以下の知識を習得できる：

- PPAPがなぜ危険視されるのか、その具体的なリスク
- 公開鍵暗号基盤（PKI）の基本である「電子署名」と「暗号化」の仕組み
- S/MIMEを用いたセキュアなメール通信の実現方法

合格に必要な知識の習得と、実際のセキュリティ業務で活かせる思考プロセスの理解を目指す。

## 問題の全体像

### 登場人物と組織

| 組織・人物 | 役割 |
|-----------|------|
| **K社** | IT製品の卸売会社。今回のセキュリティ見直しの主体 |
| **販売店** | K社が製品を卸している300社の取引先 |
| **L主任** | K社の情報セキュリティリーダー。PPAPの問題点を洗い出し、S/MIME導入を推進 |

### システム構成の概要

- **現状**: 添付ファイル圧縮サーバを導入し、PPAPを実現
- **提案**: PCのメーラが対応しているS/MIMEを導入し、電子署名とメール暗号化を実施

### 攻撃シナリオの時系列

1. **8年前**: 従業員がメールを誤送信するセキュリティ事故が発生
2. **対策**: この事故を機に、添付ファイルを自動でパスワード付きZIPファイル化して送る「PPAP」方式を導入
3. **現在**: 政府機関などでPPAPを廃止する動きが広まり、K社でも運用の見直しが決定。L主任が代替策としてS/MIMEを調査・提案

この全体像から、「**PPAPの運用に潜むリスクを理解し、それを解決するS/MIMEの技術的仕組みを正しく理解する**」ことが問題の核心である。

## 設問ごとの解説

### 設問1

#### (1) PPAPの誤送信リスク

**問題**: PPAP運用において、本文メールの宛先を確認せずにパスワード（PW）メールを同じ宛先に送ることで、どのような情報漏えいリスクが発生するか。

**解答**: 本文メールを誤送信すると、DPWも誤送信した相手に届いてしまう。（30字）

**解説**:
PPAPは、添付ファイル（本文メール）とパスワード（PWメール）を分離することで、片方が盗聴されても情報が漏れないようにすることを意図しています。

しかし、運用者が本文メールの宛先を間違え、その間違いに気づかずに同じ宛先へPWメールも送ってしまえば、誤った受信者の元に「**暗号化されたファイル**」と「**それを解く鍵**」の両方が届いてしまいます。これは、金庫と鍵を同じ箱に入れて送るようなものであり、分離した意味が全くなくなってしまいます。

これが「**PPAPは意味がない**」と批判される最大の理由の一つです。

#### (2) 盗聴リスク低減策

**問題**: 本文メールとPWメールが同じ経路で盗聴されるリスクを低減させるための、運用上の改善策は何か。

**解答**: DPWを、電話や携帯メールなど異なった手段で伝える。（26字）

**解説**:
同一経路上を流れる通信は、まとめて盗聴される危険性があります。このリスクを避けるには、一方の通信を全く別の経路に乗せることが有効です。

具体的には：
- ファイルは会社のメールで送信
- パスワードは個人の携帯電話へのSMSや、直接の電話で口頭で伝達

これにより、仮にメール経路が丸ごと盗聴されても、パスワードは漏えいしません。

**重要ポイント**: 単に「別々の経路」と答えるのではなく、「電話」や「携帯メール（キャリアメール）」といった、PCのメールシステムとは**明確に異なる伝達手段**を具体的に挙げることが重要です。

### 設問2

#### (1) メール改ざん検知のタイミング

**問題**: メール内容の改ざんが検知されるのは、表1、2のどの手順か。

**解答**: 1.6

**解説**:
改ざん検知は、受信側で元データのハッシュ値と、受信データから再計算したハッシュ値を比較する工程で行われます。

電子署名の検証プロセス：
- **手順1.4**: 受信した電子署名を復号し、元のハッシュ値`x`を取り出す
- **手順1.5**: 受信したメール内容から、同じハッシュ関数`h`でハッシュ値`y`を再計算する  
- **手順1.6**: 手順1.4で取り出したハッシュ値`x`と手順1.5で生成したハッシュ値`y`とを比較する

**ハッシュ値**は、データが1ビットでも異なれば全く違う値になるという特性を持ちます。配送途中でメール内容が改ざんされていれば、手順1.5で生成されるハッシュ値`y`は、送信者が元データから生成したハッシュ値`x`とは異なる値になります。したがって、手順1.6の比較処理によってはじめて、改ざんの事実を検知できます。

#### (2) 暗号化・署名に使用する鍵

**問題**: 表1、2の空欄 `a` 〜 `d` に入る適切な鍵の種類は何か。

**解答**:
- a: カ (送信者の秘密鍵)
- b: オ (送信者の公開鍵)  
- c: ウ (受信者の公開鍵)
- d: エ (受信者の秘密鍵)

**解説**:
公開鍵暗号の基本ルール「**秘密鍵で署名し、公開鍵で検証**」「**公開鍵で暗号化し、秘密鍵で復号**」を正確に適用します。

| 用途 | 使用する鍵 | 理由 |
|------|----------|------|
| **a (電子署名の生成)** | 送信者の秘密鍵 | 本人しか持ち得ない秘密鍵でハッシュ値を暗号化することで、署名としての効力を持つ |
| **b (電子署名の検証)** | 送信者の公開鍵 | 送信者の秘密鍵で暗号化された署名は、対となる公開鍵でのみ正しく復号できる |
| **c (共通鍵の暗号化)** | 受信者の公開鍵 | 不特定多数に知られてもよい公開鍵で共通鍵を暗号化すれば、受信者以外は中身を見ることができない |
| **d (共通鍵の復号)** | 受信者の秘密鍵 | 受信者の公開鍵で暗号化された共通鍵は、受信者本人しか持っていない秘密鍵でのみ復号できる |

この問題で問われているのは、電子署名と**ハイブリッド暗号**の仕組みです。公開鍵暗号は処理が遅いため、本文のような大きなデータは高速な共通鍵暗号で暗号化し、その共通鍵自体を安全な公開鍵暗号でやり取りする「いいとこ取り」の方式です。

#### (3) 共通鍵暗号を使用する理由

**問題**: メール内容の暗号化に、公開鍵暗号ではなく共通鍵暗号を利用する理由は何か。

**解答**: 暗号化と復号の処理速度が速いから。（18字）

**解説**:
公開鍵暗号方式と共通鍵暗号方式の最も大きな性能差は「**処理速度**」です。

| 暗号方式 | 特徴 |
|---------|------|
| **公開鍵暗号** | 複雑な数学的計算（素因数分解など）を基にしているため、暗号化・復号の処理に時間がかかる |
| **共通鍵暗号** | 比較的単純な計算（ビット演算など）で済むため、非常に高速に動作 |

メール本文のようなサイズの大きいデータを公開鍵暗号で直接暗号化すると、非常に時間がかかり実用的ではありません。そのため、高速な共通鍵暗号が利用されます。

### 設問3

**問題**: 受信メールに添付された電子証明書の正当性を検証するために必要となる鍵は何か。

**解答**: ア (CAの公開鍵)

**解説**:
電子証明書は、その正しさを保証するために認証局（**CA**）によって電子署名されています。このCAの署名を検証するために、CA自身の公開鍵が必要となります。

電子証明書とは、「**この公開鍵は、確かにこの持ち主のものである**」ということをCAが証明する文書です。この証明は、CAが自身の秘密鍵で電子証明書全体に電子署名を行うことで実現されます。

受信者は、この電子証明書が本当に信頼できるCAによって発行され、改ざんされていないかを確認する必要があります。その確認方法は、まさに電子署名の検証プロセスそのものです。つまり、**CAの公開鍵**を使って、証明書に付与されたCAの署名を復号・検証するのです。

**混同しやすいポイント**:
- **メールの署名**を検証する → **送信者**の公開鍵を使う
- **証明書の署名**を検証する → **CA**の公開鍵を使う

この違いを明確に区別することが重要です。

## まとめ

この問題から学ぶべき重要なポイントを整理します：

### 1. セキュリティ技術は「目的」と「手段」と「弱点」をセットで理解する

PPAPという手段は「経路分離による盗聴対策」が目的でしたが、「誤送信」というヒューマンエラーや「同一経路での盗聴」に弱いという弱点がありました。S/MIMEは「電子署名と暗号化」という手段で「認証・完全性・機密性」を目的とします。

### 2. 公開鍵暗号の役割は「鍵のペア」で理解する

「秘密鍵でやる操作」と「公開鍵でやる操作」は常にペアです：

| 用途 | 操作 |
|------|------|
| **署名（本人証明）** | 送信者が**秘密鍵**で署名し、受信者が**公開鍵**で検証する |
| **暗号化（秘匿）** | 送信者が**受信者の公開鍵**で暗号化し、受信者が**自身の秘密鍵**で復号する |

### 3. 「何を」「誰が」検証するのかを明確にする

設問3は典型例です。「メール本文の正当性」を検証するのか、それとも「本人性を証明する証明書自体の正当性」を検証するのか。主語と目的語を明確にすることで、使うべき鍵（送信者の公開鍵か、CAの公開鍵か）が自ずと決まります。

### 4. 実践的な学習価値

この問題は単なる暗記問題ではなく、現在多くの組織で課題となっているPPAPの問題点と、その解決策としてのS/MIMEについて実践的な知識を問うています。セキュリティ技術の「なぜ」を理解することで、未知の技術が出てきても類推が効くようになります。

## 参考リンク

- [S/MIMEの概要 - IPA](https://www.ipa.go.jp/security/vuln/websecurity.html)
- [電子署名とPKI - 総務省](https://www.soumu.go.jp/main_sosiki/cybersecurity/kokumin/index.html)
- [応用情報技術者試験対策 - IPA](https://www.jitec.ipa.go.jp/1_11seido/ap.html)