
[{"content":"","date":"2025å¹´ 12æœˆ 10æ—¥","externalUrl":null,"permalink":"/posts/","section":"Posts","summary":"","title":"Posts","type":"posts"},{"content":" ä»Šæ—¥å­¦ã‚“ã ã“ã¨ # Terraformã‚’ä½¿ã†ä¸Šã§é »ç¹ã«å‚ç…§ã™ã‚‹ã‚³ãƒãƒ³ãƒ‰ã€ãƒ–ãƒ­ãƒƒã‚¯æ§‹æ–‡ã€é–¢æ•°ã€ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’1ã¤ã®è¨˜äº‹ã«ã¾ã¨ã‚ã¾ã—ãŸã€‚ä½œæ¥­ä¸­ã«ã€Œã‚ã‚Œã€ã©ã†æ›¸ãã‚“ã ã£ã‘ï¼Ÿã€ã¨ãªã£ãŸã¨ãã«ã™ãå‚ç…§ã§ãã‚‹ãƒãƒ¼ãƒˆã‚·ãƒ¼ãƒˆã§ã™ã€‚\nå­¦ç¿’å†…å®¹ # åŸºæœ¬ã‚³ãƒãƒ³ãƒ‰ # åˆæœŸåŒ–ãƒ»å®Ÿè¡Œã‚³ãƒãƒ³ãƒ‰ ã‚³ãƒãƒ³ãƒ‰ èª¬æ˜ ã‚ˆãä½¿ã†ã‚ªãƒ—ã‚·ãƒ§ãƒ³ terraform init åˆæœŸåŒ–ï¼ˆProviderå–å¾—ï¼‰ -upgradeï¼ˆProvideræ›´æ–°ï¼‰ terraform plan å·®åˆ†ç¢ºèªï¼ˆãƒ‰ãƒ©ã‚¤ãƒ©ãƒ³ï¼‰ -out=plan.tfplanï¼ˆè¨ˆç”»ã‚’ä¿å­˜ï¼‰ terraform apply å¤‰æ›´ã‚’é©ç”¨ -auto-approveï¼ˆç¢ºèªã‚¹ã‚­ãƒƒãƒ—ï¼‰ terraform destroy å…¨ãƒªã‚½ãƒ¼ã‚¹å‰Šé™¤ -target=xxxï¼ˆç‰¹å®šãƒªã‚½ãƒ¼ã‚¹ã®ã¿ï¼‰ ç¢ºèªãƒ»æ¤œè¨¼ã‚³ãƒãƒ³ãƒ‰ ã‚³ãƒãƒ³ãƒ‰ èª¬æ˜ terraform validate æ§‹æ–‡ãƒã‚§ãƒƒã‚¯ terraform fmt ã‚³ãƒ¼ãƒ‰æ•´å½¢ï¼ˆã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆç­‰ï¼‰ terraform fmt -check æ•´å½¢ãŒå¿…è¦ã‹ç¢ºèªã®ã¿ terraform show ç¾åœ¨ã®Stateã‚’è¡¨ç¤º terraform output Outputå€¤ã‚’è¡¨ç¤º Stateæ“ä½œã‚³ãƒãƒ³ãƒ‰ ã‚³ãƒãƒ³ãƒ‰ èª¬æ˜ terraform state list ç®¡ç†ä¸­ãƒªã‚½ãƒ¼ã‚¹ä¸€è¦§ terraform state show \u0026lt;ãƒªã‚½ãƒ¼ã‚¹\u0026gt; ç‰¹å®šãƒªã‚½ãƒ¼ã‚¹ã®è©³ç´° terraform state rm \u0026lt;ãƒªã‚½ãƒ¼ã‚¹\u0026gt; Stateã‹ã‚‰å‰Šé™¤ï¼ˆå®Ÿãƒªã‚½ãƒ¼ã‚¹ã¯æ®‹ã‚‹ï¼‰ terraform state mv \u0026lt;æ—§\u0026gt; \u0026lt;æ–°\u0026gt; ãƒªã‚½ãƒ¼ã‚¹åå¤‰æ›´ terraform force-unlock \u0026lt;LOCK_ID\u0026gt; ãƒ­ãƒƒã‚¯å¼·åˆ¶è§£é™¤ ãã®ä»–ã®ã‚³ãƒãƒ³ãƒ‰ ã‚³ãƒãƒ³ãƒ‰ èª¬æ˜ terraform graph ä¾å­˜é–¢ä¿‚ã‚’DOTå½¢å¼ã§å‡ºåŠ› terraform console å¯¾è©±ãƒ¢ãƒ¼ãƒ‰ï¼ˆå¼ã®è©•ä¾¡ãƒ†ã‚¹ãƒˆï¼‰ terraform import \u0026lt;ãƒªã‚½ãƒ¼ã‚¹\u0026gt; \u0026lt;ID\u0026gt; æ—¢å­˜ãƒªã‚½ãƒ¼ã‚¹ã‚’Stateã«å–ã‚Šè¾¼ã¿ terraform apply -replace=\u0026lt;ãƒªã‚½ãƒ¼ã‚¹\u0026gt; æ¬¡å›applyæ™‚ã«å†ä½œæˆå¯¾è±¡ã«ã™ã‚‹ Note: terraform taintã¯éæ¨å¥¨ã€‚-replaceã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ä½¿ç”¨ã™ã‚‹ã€‚\nãƒ–ãƒ­ãƒƒã‚¯æ§‹æ–‡ # terraform ãƒ–ãƒ­ãƒƒã‚¯ï¼ˆè¨­å®šï¼‰ ```hcl terraform { required_version = \"\u003e= 1.0.0\" required_providers { aws = { source = \u0026ldquo;hashicorp/aws\u0026rdquo; version = \u0026ldquo;~\u0026gt; 5.0\u0026rdquo; } }\nbackend \u0026ldquo;s3\u0026rdquo; { bucket = \u0026ldquo;my-tfstate-bucket\u0026rdquo; key = \u0026ldquo;terraform.tfstate\u0026rdquo; region = \u0026ldquo;ap-northeast-1\u0026rdquo; dynamodb_table = \u0026ldquo;my-tfstate-lock\u0026rdquo; encrypt = true } }\n\u0026lt;/details\u0026gt; \u0026lt;details\u0026gt; \u0026lt;summary\u0026gt;provider ãƒ–ãƒ­ãƒƒã‚¯\u0026lt;/summary\u0026gt; ```hcl provider \u0026#34;aws\u0026#34; { region = \u0026#34;ap-northeast-1\u0026#34; default_tags { tags = { Project = \u0026#34;my-project\u0026#34; ManagedBy = \u0026#34;terraform\u0026#34; } } } # è¤‡æ•°ãƒªãƒ¼ã‚¸ãƒ§ãƒ³å¯¾å¿œï¼ˆaliasï¼‰ provider \u0026#34;aws\u0026#34; { alias = \u0026#34;us_east_1\u0026#34; region = \u0026#34;us-east-1\u0026#34; } resource ãƒ–ãƒ­ãƒƒã‚¯ ```hcl resource \"aws_instance\" \"web\" { ami = \"ami-12345678\" instance_type = \"t3.micro\" subnet_id = aws_subnet.public.id tags = { Name = \u0026ldquo;web-server\u0026rdquo; }\ndepends_on = [aws_internet_gateway.main]\nlifecycle { create_before_destroy = true prevent_destroy = false ignore_changes = [tags] } }\n\u0026lt;/details\u0026gt; \u0026lt;details\u0026gt; \u0026lt;summary\u0026gt;data ãƒ–ãƒ­ãƒƒã‚¯ï¼ˆæ—¢å­˜ãƒªã‚½ãƒ¼ã‚¹å‚ç…§ï¼‰\u0026lt;/summary\u0026gt; ```hcl data \u0026#34;aws_ami\u0026#34; \u0026#34;amazon_linux\u0026#34; { most_recent = true owners = [\u0026#34;amazon\u0026#34;] filter { name = \u0026#34;name\u0026#34; values = [\u0026#34;al2023-ami-*-x86_64\u0026#34;] } } resource \u0026#34;aws_instance\u0026#34; \u0026#34;web\u0026#34; { ami = data.aws_ami.amazon_linux.id } variable ãƒ–ãƒ­ãƒƒã‚¯ï¼ˆå…¥åŠ›å¤‰æ•°ï¼‰ ```hcl variable \"instance_type\" { type = string default = \"t3.micro\" description = \"EC2 instance type\" } variable \u0026ldquo;environment\u0026rdquo; { type = string validation { condition = contains([\u0026ldquo;dev\u0026rdquo;, \u0026ldquo;stg\u0026rdquo;, \u0026ldquo;prod\u0026rdquo;], var.environment) error_message = \u0026ldquo;environment must be dev, stg, or prod\u0026rdquo; } }\nvariable \u0026ldquo;password\u0026rdquo; { type = string sensitive = true }\n\u0026lt;/details\u0026gt; \u0026lt;details\u0026gt; \u0026lt;summary\u0026gt;output / locals ãƒ–ãƒ­ãƒƒã‚¯\u0026lt;/summary\u0026gt; ```hcl output \u0026#34;instance_id\u0026#34; { value = aws_instance.web.id description = \u0026#34;EC2 instance ID\u0026#34; } output \u0026#34;db_password\u0026#34; { value = aws_db_instance.main.password sensitive = true } locals { common_tags = { Project = var.project_name Environment = var.environment ManagedBy = \u0026#34;terraform\u0026#34; } name_prefix = \u0026#34;${var.project_name}-${var.environment}\u0026#34; } module ãƒ–ãƒ­ãƒƒã‚¯ ```hcl module \"vpc\" { source = \"./modules/vpc\" vpc_cidr = \u0026ldquo;10.0.0.0/16\u0026rdquo; environment = var.environment }\nmodule \u0026ldquo;s3\u0026rdquo; { source = \u0026ldquo;terraform-aws-modules/s3-bucket/aws\u0026rdquo; version = \u0026ldquo;3.0.0\u0026rdquo;\nbucket = \u0026ldquo;my-bucket\u0026rdquo; }\nãƒãƒ«ãƒãƒªãƒ¼ã‚¸ãƒ§ãƒ³ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã‚’æ¸¡ã™ # module \u0026ldquo;acm\u0026rdquo; { source = \u0026ldquo;./modules/acm\u0026rdquo;\nproviders = { aws = aws.us_east_1 } }\n\u0026lt;/details\u0026gt; \u0026lt;details\u0026gt; \u0026lt;summary\u0026gt;moved ãƒ–ãƒ­ãƒƒã‚¯ï¼ˆãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ï¼‰\u0026lt;/summary\u0026gt; ```hcl moved { from = aws_s3_bucket.content to = module.s3_content.aws_s3_bucket.this } moved { from = aws_instance.web to = aws_instance.web_server } ã‚ˆãä½¿ã†å‹ # å‹ ä¾‹ string \u0026quot;hello\u0026quot; number 123 bool true, false list(string) [\u0026quot;a\u0026quot;, \u0026quot;b\u0026quot;, \u0026quot;c\u0026quot;] set(string) toset([\u0026quot;a\u0026quot;, \u0026quot;b\u0026quot;]) map(string) { key1 = \u0026quot;value1\u0026quot;, key2 = \u0026quot;value2\u0026quot; } object({...}) { name = string, port = number } any ä»»æ„ã®å‹ ã‚ˆãä½¿ã†é–¢æ•° # æ–‡å­—åˆ—é–¢æ•° é–¢æ•° èª¬æ˜ ä¾‹ format() æ›¸å¼åŒ– format(\u0026quot;Hello, %s!\u0026quot;, var.name) join() çµåˆ join(\u0026quot;, \u0026quot;, [\u0026quot;a\u0026quot;, \u0026quot;b\u0026quot;, \u0026quot;c\u0026quot;]) â†’ \u0026quot;a, b, c\u0026quot; split() åˆ†å‰² split(\u0026quot;,\u0026quot;, \u0026quot;a,b,c\u0026quot;) â†’ [\u0026quot;a\u0026quot;, \u0026quot;b\u0026quot;, \u0026quot;c\u0026quot;] lower() å°æ–‡å­—åŒ– lower(\u0026quot;HELLO\u0026quot;) â†’ \u0026quot;hello\u0026quot; upper() å¤§æ–‡å­—åŒ– upper(\u0026quot;hello\u0026quot;) â†’ \u0026quot;HELLO\u0026quot; replace() ç½®æ› replace(\u0026quot;hello\u0026quot;, \u0026quot;l\u0026quot;, \u0026quot;L\u0026quot;) trimspace() ç©ºç™½é™¤å» trimspace(\u0026quot; hello \u0026quot;) â†’ \u0026quot;hello\u0026quot; ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³é–¢æ•° é–¢æ•° èª¬æ˜ ä¾‹ length() è¦ç´ æ•° length([\u0026quot;a\u0026quot;, \u0026quot;b\u0026quot;]) â†’ 2 element() ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹å‚ç…§ element([\u0026quot;a\u0026quot;, \u0026quot;b\u0026quot;], 0) â†’ \u0026quot;a\u0026quot; concat() ãƒªã‚¹ãƒˆçµåˆ concat([\u0026quot;a\u0026quot;], [\u0026quot;b\u0026quot;]) â†’ [\u0026quot;a\u0026quot;, \u0026quot;b\u0026quot;] flatten() ãƒã‚¹ãƒˆè§£é™¤ flatten([[\u0026quot;a\u0026quot;], [\u0026quot;b\u0026quot;]]) â†’ [\u0026quot;a\u0026quot;, \u0026quot;b\u0026quot;] merge() ãƒãƒƒãƒ—çµåˆ merge({a=1}, {b=2}) â†’ {a=1, b=2} lookup() ãƒãƒƒãƒ—æ¤œç´¢ lookup({a=1}, \u0026quot;a\u0026quot;, 0) â†’ 1 keys() ã‚­ãƒ¼ä¸€è¦§ keys({a=1, b=2}) â†’ [\u0026quot;a\u0026quot;, \u0026quot;b\u0026quot;] values() å€¤ä¸€è¦§ values({a=1, b=2}) â†’ [1, 2] contains() è¦ç´ å­˜åœ¨ç¢ºèª contains([\u0026quot;a\u0026quot;, \u0026quot;b\u0026quot;], \u0026quot;a\u0026quot;) â†’ true distinct() é‡è¤‡é™¤å» distinct([\u0026quot;a\u0026quot;, \u0026quot;a\u0026quot;, \u0026quot;b\u0026quot;]) â†’ [\u0026quot;a\u0026quot;, \u0026quot;b\u0026quot;] ãƒ•ã‚¡ã‚¤ãƒ«é–¢æ•° é–¢æ•° èª¬æ˜ ä¾‹ file() ãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿è¾¼ã¿ file(\u0026quot;./scripts/init.sh\u0026quot;) pathexpand() ~ã‚’ãƒ›ãƒ¼ãƒ ãƒ‘ã‚¹ã«å±•é–‹ pathexpand(\u0026quot;~/.ssh/id_rsa.pub\u0026quot;) filebase64() Base64ã§èª­ã¿è¾¼ã¿ filebase64(\u0026quot;image.png\u0026quot;) templatefile() ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆé©ç”¨ templatefile(\u0026quot;user_data.sh\u0026quot;, {name = \u0026quot;web\u0026quot;}) æ¡ä»¶ãƒ»å‹å¤‰æ›é–¢æ•° é–¢æ•° èª¬æ˜ ä¾‹ coalesce() æœ€åˆã®énullå€¤ coalesce(null, \u0026quot;default\u0026quot;) â†’ \u0026quot;default\u0026quot; try() ã‚¨ãƒ©ãƒ¼æ™‚ã®ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ try(var.optional, \u0026quot;default\u0026quot;) tostring() æ–‡å­—åˆ—å¤‰æ› tostring(123) â†’ \u0026quot;123\u0026quot; tonumber() æ•°å€¤å¤‰æ› tonumber(\u0026quot;123\u0026quot;) â†’ 123 tobool() çœŸå½å€¤å¤‰æ› tobool(\u0026quot;true\u0026quot;) â†’ true tolist() ãƒªã‚¹ãƒˆå¤‰æ› tolist(toset([\u0026quot;a\u0026quot;, \u0026quot;b\u0026quot;])) toset() ã‚»ãƒƒãƒˆå¤‰æ› toset([\u0026quot;a\u0026quot;, \u0026quot;a\u0026quot;, \u0026quot;b\u0026quot;]) æ¡ä»¶åˆ†å²ãƒ»ãƒ«ãƒ¼ãƒ— # ä¸‰é …æ¼”ç®—å­ãƒ»count ```hcl # ä¸‰é …æ¼”ç®—å­ instance_type = var.environment == \"prod\" ? \"t3.large\" : \"t3.micro\" countï¼ˆã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ãƒ™ãƒ¼ã‚¹ï¼‰ # resource \u0026ldquo;aws_instance\u0026rdquo; \u0026ldquo;web\u0026rdquo; { count = 3 tags = { Name = \u0026ldquo;web-${count.index}\u0026rdquo; } }\næ¡ä»¶ä»˜ãä½œæˆ # resource \u0026ldquo;aws_eip\u0026rdquo; \u0026ldquo;nat\u0026rdquo; { count = var.create_nat ? 1 : 0 }\n\u0026lt;/details\u0026gt; \u0026lt;details\u0026gt; \u0026lt;summary\u0026gt;for_each\u0026lt;/summary\u0026gt; ```hcl # ãƒãƒƒãƒ— resource \u0026#34;aws_subnet\u0026#34; \u0026#34;private\u0026#34; { for_each = { \u0026#34;a\u0026#34; = \u0026#34;10.0.1.0/24\u0026#34; \u0026#34;c\u0026#34; = \u0026#34;10.0.2.0/24\u0026#34; } availability_zone = \u0026#34;ap-northeast-1${each.key}\u0026#34; cidr_block = each.value } # ã‚»ãƒƒãƒˆ resource \u0026#34;aws_security_group_rule\u0026#34; \u0026#34;ports\u0026#34; { for_each = toset([\u0026#34;80\u0026#34;, \u0026#34;443\u0026#34;, \u0026#34;22\u0026#34;]) from_port = tonumber(each.value) to_port = tonumber(each.value) } forå¼ãƒ»dynamic ãƒ–ãƒ­ãƒƒã‚¯ ```hcl # forå¼ locals { upper_names = [for name in var.names : upper(name)] instance_ids = {for inst in aws_instance.web : inst.tags.Name =\u003e inst.id} prod_instances = [for inst in var.instances : inst if inst.env == \"prod\"] } dynamic ãƒ–ãƒ­ãƒƒã‚¯ # resource \u0026ldquo;aws_security_group\u0026rdquo; \u0026ldquo;main\u0026rdquo; { name = \u0026ldquo;main\u0026rdquo;\ndynamic \u0026ldquo;ingress\u0026rdquo; { for_each = var.ingress_rules content { from_port = ingress.value.from_port to_port = ingress.value.to_port protocol = ingress.value.protocol cidr_blocks = ingress.value.cidr_blocks } } }\n\u0026lt;/details\u0026gt; --- ### ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆä¾‹ \u0026lt;details\u0026gt; \u0026lt;summary\u0026gt;ã‚·ãƒ³ãƒ—ãƒ«æ§‹æˆ\u0026lt;/summary\u0026gt; project/ â”œâ”€â”€ main.tf â”œâ”€â”€ variables.tf â”œâ”€â”€ outputs.tf â”œâ”€â”€ versions.tf â””â”€â”€ terraform.tfvars\n\u0026lt;/details\u0026gt; \u0026lt;details\u0026gt; \u0026lt;summary\u0026gt;ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«æ§‹æˆ\u0026lt;/summary\u0026gt; project/ â”œâ”€â”€ modules/ â”‚ â”œâ”€â”€ vpc/ â”‚ â”‚ â”œâ”€â”€ main.tf â”‚ â”‚ â”œâ”€â”€ variables.tf â”‚ â”‚ â””â”€â”€ outputs.tf â”‚ â””â”€â”€ ec2/ â”œâ”€â”€ environments/ â”‚ â”œâ”€â”€ dev/ â”‚ â”‚ â”œâ”€â”€ main.tf â”‚ â”‚ â”œâ”€â”€ backend.tf â”‚ â”‚ â””â”€â”€ terraform.tfvars â”‚ â””â”€â”€ prod/ â””â”€â”€ backend-setup/ â””â”€â”€ main.tf\n\u0026lt;/details\u0026gt; --- ### ã‚ˆãä½¿ã†ãƒ‘ã‚¿ãƒ¼ãƒ³ \u0026lt;details\u0026gt; \u0026lt;summary\u0026gt;ã‚¿ã‚°ã®å…±é€šåŒ–\u0026lt;/summary\u0026gt; ```hcl locals { common_tags = { Project = \u0026#34;my-project\u0026#34; Environment = var.environment ManagedBy = \u0026#34;terraform\u0026#34; } } resource \u0026#34;aws_instance\u0026#34; \u0026#34;web\u0026#34; { tags = merge(local.common_tags, { Name = \u0026#34;web-server\u0026#34; Role = \u0026#34;web\u0026#34; }) } æ¡ä»¶ä»˜ããƒªã‚½ãƒ¼ã‚¹ä½œæˆ ```hcl resource \"aws_nat_gateway\" \"main\" { count = var.enable_nat_gateway ? 1 : 0 allocation_id = aws_eip.nat[0].id subnet_id = aws_subnet.public.id }\noutput \u0026ldquo;nat_gateway_id\u0026rdquo; { value = var.enable_nat_gateway ? aws_nat_gateway.main[0].id : null }\n\u0026lt;/details\u0026gt; \u0026lt;details\u0026gt; \u0026lt;summary\u0026gt;user_data / ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚°ãƒ«ãƒ¼ãƒ—å‚ç…§\u0026lt;/summary\u0026gt; ```hcl # user_data resource \u0026#34;aws_instance\u0026#34; \u0026#34;web\u0026#34; { user_data = \u0026lt;\u0026lt;-EOF #!/bin/bash dnf update -y dnf install -y httpd systemctl start httpd EOF } # SGã‚’ã‚½ãƒ¼ã‚¹ã«æŒ‡å®š resource \u0026#34;aws_vpc_security_group_ingress_rule\u0026#34; \u0026#34;rds\u0026#34; { security_group_id = aws_security_group.rds.id referenced_security_group_id = aws_security_group.web.id from_port = 3306 to_port = 3306 ip_protocol = \u0026#34;tcp\u0026#34; } æ³¨æ„ç‚¹ãƒ»ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ # ã‚„ã‚‹ã¹ãã“ã¨ # terraform fmt ã§ã‚³ãƒ¼ãƒ‰æ•´å½¢ terraform validate ã§æ§‹æ–‡ãƒã‚§ãƒƒã‚¯ .terraform.lock.hcl ã‚’Gitç®¡ç†ï¼ˆProviderãƒãƒ¼ã‚¸ãƒ§ãƒ³å›ºå®šï¼‰ terraform.tfvars ã¯Gitç®¡ç†å¤–ï¼ˆæ©Ÿå¯†æƒ…å ±å«ã‚€å ´åˆï¼‰ sensitive = true ã§ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ç­‰ã‚’ãƒã‚¹ã‚¯ ãƒªãƒ¢ãƒ¼ãƒˆãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ï¼ˆS3 + DynamoDBï¼‰ã§çŠ¶æ…‹ç®¡ç† é¿ã‘ã‚‹ã¹ãã“ã¨ # æœ¬ç•ªç’°å¢ƒã§ -auto-approve ã‚’ä½¿ã‚ãªã„ ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‰ã•ã‚ŒãŸAMI IDï¼ˆdata sourceã§å–å¾—ï¼‰ ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‰ã•ã‚ŒãŸãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ï¼ˆvariables or Secrets Managerï¼‰ terraform state rm ã®å®‰æ˜“ãªä½¿ç”¨ force-unlock ã¯ä»–ã®æ“ä½œãŒãªã„ã“ã¨ã‚’ç¢ºèªã—ã¦ã‹ã‚‰ ã¾ã¨ã‚ # ç”¨é€” å‚ç…§ã‚»ã‚¯ã‚·ãƒ§ãƒ³ ã‚³ãƒãƒ³ãƒ‰ã‚’èª¿ã¹ãŸã„ åŸºæœ¬ã‚³ãƒãƒ³ãƒ‰ æ›¸ãæ–¹ã‚’ç¢ºèªã—ãŸã„ ãƒ–ãƒ­ãƒƒã‚¯æ§‹æ–‡ é–¢æ•°ã®ä½¿ã„æ–¹ã‚’èª¿ã¹ãŸã„ ã‚ˆãä½¿ã†é–¢æ•° ãƒ«ãƒ¼ãƒ—ã®æ›¸ãæ–¹ã‚’ç¢ºèªã—ãŸã„ æ¡ä»¶åˆ†å²ãƒ»ãƒ«ãƒ¼ãƒ— å®Ÿè£…ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’å‚è€ƒã«ã—ãŸã„ ã‚ˆãä½¿ã†ãƒ‘ã‚¿ãƒ¼ãƒ³ terraform init â†’ plan â†’ apply ãŒåŸºæœ¬ãƒ•ãƒ­ãƒ¼ countã¯ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã€for_eachã¯ã‚­ãƒ¼ã§ãƒªã‚½ãƒ¼ã‚¹ã‚’è­˜åˆ¥ localsã§å…±é€šå€¤ã‚’å®šç¾©ã€merge()ã§ã‚¿ã‚°ã‚’çµåˆ å‚è€ƒ # Terraformå…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ AWS Provider Terraformé–¢æ•°ä¸€è¦§ Terraform Best Practices ","date":"2025å¹´ 12æœˆ 10æ—¥","externalUrl":null,"permalink":"/posts/251210221100_terraform-cheatsheet-commands-syntax-quick-reference/","section":"Posts","summary":"","title":"Terraformãƒãƒ¼ãƒˆã‚·ãƒ¼ãƒˆï¼šã‚³ãƒãƒ³ãƒ‰ãƒ»æ§‹æ–‡ãƒ»é–¢æ•°ã‚¯ã‚¤ãƒƒã‚¯ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹","type":"posts"},{"content":"","date":"2025å¹´ 12æœˆ 10æ—¥","externalUrl":null,"permalink":"/","section":"æ¯æ—¥.log","summary":"","title":"æ¯æ—¥.log","type":"page"},{"content":"","date":"2025å¹´ 12æœˆ 10æ—¥","externalUrl":null,"permalink":"/tags/aws/","section":"Tags","summary":"","title":"AWS","type":"tags"},{"content":" ä»Šæ—¥å­¦ã‚“ã ã“ã¨ # Terraformã§RDSï¼ˆMySQLï¼‰ã‚’æ§‹ç¯‰ã—ã¾ã—ãŸã€‚DBã‚µãƒ–ãƒãƒƒãƒˆã‚°ãƒ«ãƒ¼ãƒ—ã«ã¯ã‚·ãƒ³ã‚°ãƒ«AZæ§‹æˆã§ã‚‚2ã¤ã®ç•°ãªã‚‹AZã®ã‚µãƒ–ãƒãƒƒãƒˆãŒå¿…é ˆã§ã‚ã‚‹ã“ã¨ã€ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ç®¡ç†ã®æœ¬ç•ªå‘ã‘æ‰‹æ³•ã‚’å­¦ã³ã¾ã—ãŸã€‚\nå­¦ç¿’å†…å®¹ # èƒŒæ™¯ # ã€ŒAmazon Web Services åŸºç¤ã‹ã‚‰ã®ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯\u0026amp;ã‚µãƒ¼ãƒãƒ¼æ§‹ç¯‰ã€ã§ã¯EC2ä¸Šã«MariaDBã‚’æ§‹ç¯‰ã—ã¦ã„ã¾ã—ãŸãŒã€å®Ÿå‹™ã§ã¯ãƒãƒãƒ¼ã‚¸ãƒ‰ã‚µãƒ¼ãƒ“ã‚¹ã®RDSã‚’ä½¿ã†ã“ã¨ãŒå¤šã„ãŸã‚ã€Terraformã§æ§‹ç¯‰ã—ã¾ã—ãŸã€‚\næ§‹ç¯‰ã™ã‚‹ãƒªã‚½ãƒ¼ã‚¹ # ãƒªã‚½ãƒ¼ã‚¹ åå‰ èª¬æ˜ DB Subnet Group practice-db-subnet-group RDSé…ç½®ç”¨ï¼ˆ2AZå¿…é ˆï¼‰ RDS Instance practice-db-instance MySQL 8.0 DBã‚µãƒ–ãƒãƒƒãƒˆã‚°ãƒ«ãƒ¼ãƒ—ã®ä½œæˆ # resource \u0026#34;aws_db_subnet_group\u0026#34; \u0026#34;main\u0026#34; { name = \u0026#34;practice-db-subnet-group\u0026#34; subnet_ids = [aws_subnet.private_1.id, aws_subnet.private_2.id] tags = { Name = \u0026#34;practice-db-subnet-group\u0026#34; } } RDSã¯DBã‚µãƒ–ãƒãƒƒãƒˆã‚°ãƒ«ãƒ¼ãƒ—ã«æœ€ä½2ã¤ã®ç•°ãªã‚‹AZã®ã‚µãƒ–ãƒãƒƒãƒˆã‚’è¦æ±‚ã—ã¾ã™ã€‚ã“ã‚Œã¯ãƒãƒ«ãƒAZé…ç½®ã§ãªãã¦ã‚‚å¿…é ˆã§ã™ã€‚\nè¨­å®š ã‚µãƒ–ãƒãƒƒãƒˆè¦ä»¶ ç†ç”± ã‚·ãƒ³ã‚°ãƒ«AZ 2AZå¿…é ˆ å°†æ¥ã®ãƒãƒ«ãƒAZåŒ–ã«å‚™ãˆãŸè¨­è¨ˆ ãƒãƒ«ãƒAZ 2AZå¿…é ˆ ã‚¹ã‚¿ãƒ³ãƒã‚¤ã‚’åˆ¥AZã«é…ç½® RDSã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®ä½œæˆ # resource \u0026#34;aws_db_instance\u0026#34; \u0026#34;main\u0026#34; { identifier = \u0026#34;practice-db-instance\u0026#34; engine = \u0026#34;mysql\u0026#34; engine_version = \u0026#34;8.0\u0026#34; instance_class = \u0026#34;db.t3.micro\u0026#34; allocated_storage = 20 storage_type = \u0026#34;gp2\u0026#34; db_name = \u0026#34;wordpress\u0026#34; username = \u0026#34;admin\u0026#34; password = \u0026#34;YourPassword123!\u0026#34; # å­¦ç¿’ç”¨ db_subnet_group_name = aws_db_subnet_group.main.name vpc_security_group_ids = [aws_security_group.rds.id] publicly_accessible = false skip_final_snapshot = true # å­¦ç¿’ç”¨ tags = { Name = \u0026#34;practice-db-instance\u0026#34; } } è¨­å®šé …ç›®ã®è§£èª¬ # åŸºæœ¬è¨­å®š # é …ç›® å€¤ èª¬æ˜ identifier practice-db-instance RDSã®è­˜åˆ¥å­ï¼ˆã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆåã«ä½¿ç”¨ï¼‰ engine mysql DBã‚¨ãƒ³ã‚¸ãƒ³ï¼ˆmysql, postgres, mariadbç­‰ï¼‰ engine_version 8.0 ãƒ¡ã‚¸ãƒ£ãƒ¼ãƒãƒ¼ã‚¸ãƒ§ãƒ³æŒ‡å®šï¼ˆãƒã‚¤ãƒŠãƒ¼ã¯è‡ªå‹•ï¼‰ ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹è¨­å®š # é …ç›® å€¤ èª¬æ˜ instance_class db.t3.micro ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚¿ã‚¤ãƒ—ï¼ˆç„¡æ–™æ å¯¾è±¡ï¼‰ allocated_storage 20 ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸å®¹é‡ï¼ˆGBï¼‰ storage_type gp2 æ±ç”¨SSDï¼ˆgp3ã‚‚é¸æŠå¯ï¼‰ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¨­å®š # é …ç›® å€¤ èª¬æ˜ publicly_accessible false ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã‹ã‚‰ç›´æ¥ã‚¢ã‚¯ã‚»ã‚¹ä¸å¯ vpc_security_group_ids [rds-sg] SGã§ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡ publicly_accessible = false ã‚’è¨­å®šã™ã‚‹ã¨ãƒ‘ãƒ–ãƒªãƒƒã‚¯IPãŒä»˜ä¸ã•ã‚Œãšã€VPCå†…ã‹ã‚‰ã®ã¿æ¥ç¶šå¯èƒ½ã«ãªã‚Šã¾ã™ã€‚æœ¬ç•ªç’°å¢ƒã§ã¯åŸºæœ¬çš„ã«falseã‚’è¨­å®šã—ã¾ã™ã€‚\nå­¦ç¿’ç”¨ã¨æœ¬ç•ªç”¨ã®è¨­å®šã®é•ã„ # é …ç›® å­¦ç¿’ç”¨ æœ¬ç•ªæ¨å¥¨ password ç›´æ›¸ã Secrets Manager or å¤‰æ•° skip_final_snapshot true falseï¼ˆå‰Šé™¤æ™‚ã«ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆä½œæˆï¼‰ deletion_protection ãªã— trueï¼ˆèª¤å‰Šé™¤é˜²æ­¢ï¼‰ multi_az false trueï¼ˆé«˜å¯ç”¨æ€§ï¼‰ backup_retention_period 0 7ä»¥ä¸Šï¼ˆè‡ªå‹•ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ï¼‰ ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ç®¡ç†ï¼ˆæœ¬ç•ªå‘ã‘ï¼‰ # æ–¹æ³•1: å¤‰æ•°ã§å¤–éƒ¨åŒ– # variable \u0026#34;db_password\u0026#34; { type = string sensitive = true } resource \u0026#34;aws_db_instance\u0026#34; \u0026#34;main\u0026#34; { # ... password = var.db_password } # å®Ÿè¡Œæ™‚ã«æŒ‡å®š terraform apply -var=\u0026#34;db_password=SecurePassword123!\u0026#34; æ–¹æ³•2: Secrets Managerï¼ˆæ¨å¥¨ï¼‰ # data \u0026#34;aws_secretsmanager_secret_version\u0026#34; \u0026#34;db\u0026#34; { secret_id = \u0026#34;prod/db/password\u0026#34; } resource \u0026#34;aws_db_instance\u0026#34; \u0026#34;main\u0026#34; { # ... password = jsondecode(data.aws_secretsmanager_secret_version.db.secret_string)[\u0026#34;password\u0026#34;] } Security Groupè¨­è¨ˆï¼ˆå¾©ç¿’ï¼‰ # resource \u0026#34;aws_vpc_security_group_ingress_rule\u0026#34; \u0026#34;rds_mysql\u0026#34; { security_group_id = aws_security_group.rds.id description = \u0026#34;MySQL from web server\u0026#34; from_port = 3306 to_port = 3306 ip_protocol = \u0026#34;tcp\u0026#34; referenced_security_group_id = aws_security_group.web.id } Webã‚µãƒ¼ãƒãƒ¼ã®SGã‚’ã‚½ãƒ¼ã‚¹ã«æŒ‡å®šã™ã‚‹ã“ã¨ã§ã€Webã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰ã®ã¿æ¥ç¶šã‚’è¨±å¯ã—ã¾ã™ã€‚\nä½œæˆã«ã‹ã‹ã‚‹æ™‚é–“ # RDSã¯ä½œæˆã«5ã€œ10åˆ†ã‹ã‹ã‚Šã¾ã™ã€‚terraform apply å®Ÿè¡Œå¾Œã€æ°—é•·ã«å¾…ã¡ã¾ã™ã€‚\naws_db_instance.main: Still creating... [5m0s elapsed] aws_db_instance.main: Still creating... [5m10s elapsed] aws_db_instance.main: Creation complete after 5m15s æ¥ç¶šç¢ºèª # Webã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰RDSã«æ¥ç¶šã—ã¾ã™ã€‚\n# Webã‚µãƒ¼ãƒãƒ¼ã«SSHæ¥ç¶šå¾Œ mysql -h practice-db-instance.xxxxx.ap-northeast-1.rds.amazonaws.com \\ -u admin -p # ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å…¥åŠ›å¾Œ mysql\u0026gt; use wordpress; ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã¯ terraform output ã¾ãŸã¯AWSã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã§ç¢ºèªã§ãã¾ã™ã€‚\noutput \u0026#34;rds_endpoint\u0026#34; { value = aws_db_instance.main.endpoint } EC2ä¸Šã®DB vs RDS # è¦³ç‚¹ EC2ä¸Šã®DB RDS ç®¡ç†è² æ‹… é«˜ï¼ˆãƒ‘ãƒƒãƒã€ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—è‡ªå‰ï¼‰ ä½ï¼ˆãƒãƒãƒ¼ã‚¸ãƒ‰ï¼‰ å¯ç”¨æ€§ è‡ªå‰ã§æ§‹ç¯‰ ãƒãƒ«ãƒAZã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚ã‚Š ã‚³ã‚¹ãƒˆ ä½ã‚ é«˜ã‚ æŸ”è»Ÿæ€§ é«˜ï¼ˆä½•ã§ã‚‚ã§ãã‚‹ï¼‰ åˆ¶é™ã‚ã‚Š åŸºæœ¬ã¯RDSæ¨å¥¨ã§ã™ã€‚ç‰¹æ®Šãªè¦ä»¶ãŒã‚ã‚‹å ´åˆã®ã¿EC2ã‚’æ¤œè¨ã—ã¾ã™ã€‚\nã¾ã¨ã‚ # ãƒˆãƒ”ãƒƒã‚¯ å†…å®¹ DBã‚µãƒ–ãƒãƒƒãƒˆã‚°ãƒ«ãƒ¼ãƒ— 2AZå¿…é ˆï¼ˆã‚·ãƒ³ã‚°ãƒ«AZæ§‹æˆã§ã‚‚ï¼‰ publicly_accessible false ã§VPCå†…ã‹ã‚‰ã®ã¿æ¥ç¶š skip_final_snapshot å­¦ç¿’ç”¨ã¯trueã€æœ¬ç•ªã¯false ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ç®¡ç† ç›´æ›¸ãã¯å­¦ç¿’ã®ã¿ã€‚æœ¬ç•ªã¯Secrets Manager ä½œæˆæ™‚é–“ 5ã€œ10åˆ†ã‹ã‹ã‚‹ å‚è€ƒ # Amazon Web Services åŸºç¤ã‹ã‚‰ã®ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ï¼†ã‚µãƒ¼ãƒãƒ¼æ§‹ç¯‰ æ”¹è¨‚4ç‰ˆ Terraform AWS Provider - RDS Instance Terraform AWS Provider - DB Subnet Group AWS RDS ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ ","date":"2025å¹´ 12æœˆ 10æ—¥","externalUrl":null,"permalink":"/posts/251210215023_rds-mysql-with-terraform/","section":"Posts","summary":"","title":"RDSï¼ˆMySQLï¼‰ã‚’Terraformã§æ§‹ç¯‰","type":"posts"},{"content":"","date":"2025å¹´ 12æœˆ 10æ—¥","externalUrl":null,"permalink":"/tags/","section":"Tags","summary":"","title":"Tags","type":"tags"},{"content":"","date":"2025å¹´ 12æœˆ 10æ—¥","externalUrl":null,"permalink":"/tags/terraform/","section":"Tags","summary":"","title":"Terraform","type":"tags"},{"content":"","date":"2025å¹´ 12æœˆ 10æ—¥","externalUrl":null,"permalink":"/tags/%E3%82%A4%E3%83%B3%E3%83%95%E3%83%A9/","section":"Tags","summary":"","title":"ã‚¤ãƒ³ãƒ•ãƒ©","type":"tags"},{"content":"","date":"2025å¹´ 12æœˆ 10æ—¥","externalUrl":null,"permalink":"/tags/%E3%83%8F%E3%83%B3%E3%82%BA%E3%82%AA%E3%83%B3%E3%83%81%E3%83%A5%E3%83%BC%E3%83%88%E3%83%AA%E3%82%A2%E3%83%AB/","section":"Tags","summary":"","title":"ãƒãƒ³ã‚ºã‚ªãƒ³ãƒ»ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«","type":"tags"},{"content":" ä»Šæ—¥å­¦ã‚“ã ã“ã¨ # ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆã‚µãƒ–ãƒãƒƒãƒˆã®EC2ã‹ã‚‰ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ãŸã‚ã®NAT Gatewayã‚’Terraformã§æ§‹ç¯‰ã—ã¾ã—ãŸã€‚NAT Gatewayã¯ãƒ‘ãƒ–ãƒªãƒƒã‚¯ã‚µãƒ–ãƒãƒƒãƒˆã«é…ç½®ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã“ã¨ã€depends_on ã§æš—é»™çš„ãªä¾å­˜é–¢ä¿‚ã‚’æ˜ç¤ºã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã“ã¨ã‚’å­¦ã³ã¾ã—ãŸã€‚\nå­¦ç¿’å†…å®¹ # NAT Gatewayã®å½¹å‰² # ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆã‚µãƒ–ãƒãƒƒãƒˆã®EC2 â†“ (é€ä¿¡) NAT Gatewayï¼ˆãƒ‘ãƒ–ãƒªãƒƒã‚¯ã‚µãƒ–ãƒãƒƒãƒˆï¼‰ â†“ Internet Gateway â†“ ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆ ã‚¢ã‚¦ãƒˆãƒã‚¦ãƒ³ãƒ‰: ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆ â†’ ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆï¼ˆè¨±å¯ï¼‰ ã‚¤ãƒ³ãƒã‚¦ãƒ³ãƒ‰: ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆ â†’ ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆï¼ˆæ‹’å¦ï¼‰ ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆã‚µãƒ–ãƒãƒƒãƒˆã®EC2ã‹ã‚‰yum/dnf updateç­‰ã‚’å®Ÿè¡Œã—ãŸã„ãŒã€ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã‹ã‚‰ã®ç›´æ¥ã‚¢ã‚¯ã‚»ã‚¹ã¯è¨±å¯ã—ãŸããªã„å ´åˆã«ä½¿ç”¨ã—ã¾ã™ã€‚\næ§‹ç¯‰ã™ã‚‹ãƒªã‚½ãƒ¼ã‚¹ # ãƒªã‚½ãƒ¼ã‚¹ åå‰ èª¬æ˜ Elastic IP practice-nat-eip NAT Gatewayç”¨ã®å›ºå®šIP NAT Gateway practice-nat ãƒ‘ãƒ–ãƒªãƒƒã‚¯ã‚µãƒ–ãƒãƒƒãƒˆã«é…ç½® Route - ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆRT â†’ NAT Gateway Elastic IPã®ä½œæˆ # resource \u0026#34;aws_eip\u0026#34; \u0026#34;nat\u0026#34; { domain = \u0026#34;vpc\u0026#34; tags = { Name = \u0026#34;practice-nat-eip\u0026#34; } depends_on = [aws_internet_gateway.main] } domain = \u0026quot;vpc\u0026quot; ã§VPCç”¨ã®Elastic IPã‚’ä½œæˆã—ã¾ã™ã€‚æ—§æ§‹æ–‡ã® vpc = true ã¯éæ¨å¥¨ã§ã™ã€‚\nNAT Gatewayã®ä½œæˆ # resource \u0026#34;aws_nat_gateway\u0026#34; \u0026#34;main\u0026#34; { allocation_id = aws_eip.nat.id subnet_id = aws_subnet.public.id tags = { Name = \u0026#34;practice-nat\u0026#34; } depends_on = [aws_internet_gateway.main] } NAT Gatewayã¯Internet Gatewayï¼ˆIGWï¼‰çµŒç”±ã§ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã«æ¥ç¶šã™ã‚‹ãŸã‚ã€IGWãŒã‚¢ã‚¿ãƒƒãƒã•ã‚ŒãŸVPCå†…ã®ãƒ‘ãƒ–ãƒªãƒƒã‚¯ã‚µãƒ–ãƒãƒƒãƒˆã«é…ç½®ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚\nãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãƒ«ãƒ¼ãƒˆãƒ†ãƒ¼ãƒ–ãƒ«ã«ãƒ«ãƒ¼ãƒˆè¿½åŠ  # resource \u0026#34;aws_route\u0026#34; \u0026#34;private_nat\u0026#34; { route_table_id = aws_route_table.private.id destination_cidr_block = \u0026#34;0.0.0.0/0\u0026#34; nat_gateway_id = aws_nat_gateway.main.id } ãƒ«ãƒ¼ãƒˆãƒ†ãƒ¼ãƒ–ãƒ« 0.0.0.0/0 ã®å®›å…ˆ çµæœ ãƒ‘ãƒ–ãƒªãƒƒã‚¯ Internet Gateway ç›´æ¥ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆé€šä¿¡ ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆ NAT Gateway NATçµŒç”±ã§ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆé€šä¿¡ depends_onã®æ„å‘³ # depends_on = [aws_internet_gateway.main] Terraformã¯é€šå¸¸ã€ãƒªã‚½ãƒ¼ã‚¹é–“ã®ä¾å­˜é–¢ä¿‚ã‚’è‡ªå‹•æ¤œå‡ºã—ã¾ã™ã€‚ã—ã‹ã—ã€NAT Gateway â†’ IGWã®ä¾å­˜é–¢ä¿‚ã¯æš—é»™çš„ï¼ˆã‚³ãƒ¼ãƒ‰ä¸Šã®å‚ç…§ãŒãªã„ï¼‰ãªãŸã‚ã€æ˜ç¤ºçš„ã«æŒ‡å®šã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚\nçŠ¶æ³ depends_onã®è¦å¦ subnet_id = aws_subnet.public.id ä¸è¦ï¼ˆå‚ç…§ã‚ã‚Šï¼‰ IGWãŒå­˜åœ¨ã—ãªã„ã¨NATãŒå‹•ä½œã—ãªã„ å¿…è¦ï¼ˆå‚ç…§ãªã—ï¼‰ ã‚³ã‚¹ãƒˆã«æ³¨æ„ # é …ç›® æ–™é‡‘ï¼ˆæ±äº¬ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ã€2024å¹´12æœˆæ™‚ç‚¹ï¼‰ NAT Gatewayæ™‚é–“æ–™é‡‘ ç´„$0.062/æ™‚ï¼ˆç´„$45/æœˆï¼‰ ãƒ‡ãƒ¼ã‚¿å‡¦ç†æ–™é‡‘ $0.062/GB å­¦ç¿’ç’°å¢ƒã§ã¯ä½¿ã‚ãªã„æ™‚é–“å¸¯ã¯ terraform destroy ã§å‰Šé™¤ã™ã‚‹ã“ã¨ã‚’æ¨å¥¨ã—ã¾ã™ã€‚\nä»£æ›¿æ‰‹æ®µã¨ã®æ¯”è¼ƒ # æ–¹æ³• ã‚³ã‚¹ãƒˆ ç®¡ç†è² æ‹… å¯ç”¨æ€§ NAT Gateway é«˜ ä½ï¼ˆãƒãƒãƒ¼ã‚¸ãƒ‰ï¼‰ é«˜ NATã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ ä½ é«˜ï¼ˆè‡ªå‰EC2ï¼‰ ä¸­ VPCã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ ä½ ä½ é«˜ï¼ˆAWSã‚µãƒ¼ãƒ“ã‚¹ã®ã¿ï¼‰ æœ¬ç•ªç’°å¢ƒã§ã¯NAT Gatewayæ¨å¥¨ã€å­¦ç¿’/é–‹ç™ºã§ã‚³ã‚¹ãƒˆé‡è¦–ãªã‚‰NATã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚‚é¸æŠè‚¢ã«ãªã‚Šã¾ã™ã€‚S3/DynamoDBç­‰ã®AWSã‚µãƒ¼ãƒ“ã‚¹ã®ã¿ãªã‚‰VPCã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã§ååˆ†ã§ã™ã€‚\nå‹•ä½œç¢ºèª # ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆã‚µãƒ–ãƒãƒƒãƒˆã®EC2ã«SSHæ¥ç¶šï¼ˆè¸ã¿å°çµŒç”±ï¼‰ã—ã¦ç¢ºèªã—ã¾ã™ã€‚\n# ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆæ¥ç¶šç¢ºèª ping -c 3 google.com # NAT GatewayçµŒç”±ã§é€šä¿¡ã—ã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèª curl ifconfig.me # â†’ Elastic IPãŒè¡¨ç¤ºã•ã‚Œã‚Œã°NAT GatewayçµŒç”± # ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸æ›´æ–°ãŒå¯èƒ½ã‹ç¢ºèª sudo dnf check-update ã¾ã¨ã‚ # ãƒˆãƒ”ãƒƒã‚¯ å†…å®¹ NAT Gatewayã®é…ç½® ãƒ‘ãƒ–ãƒªãƒƒã‚¯ã‚µãƒ–ãƒãƒƒãƒˆï¼ˆIGWã¸ã®ãƒ«ãƒ¼ãƒˆãŒå¿…è¦ï¼‰ depends_on æš—é»™çš„ãªä¾å­˜é–¢ä¿‚ã‚’æ˜ç¤ºçš„ã«æŒ‡å®š Elastic IP domain = \u0026quot;vpc\u0026quot; ã§ä½œæˆ ã‚³ã‚¹ãƒˆ ç´„$45/æœˆã€‚å­¦ç¿’æ™‚ã¯å‰Šé™¤æ¨å¥¨ ä»£æ›¿æ‰‹æ®µ NATã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã€VPCã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ å‚è€ƒ # Amazon Web Services åŸºç¤ã‹ã‚‰ã®ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ï¼†ã‚µãƒ¼ãƒãƒ¼æ§‹ç¯‰ æ”¹è¨‚4ç‰ˆ Terraform AWS Provider - NAT Gateway AWS NAT Gateway ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ NAT Gateway æ–™é‡‘ ","date":"2025å¹´ 12æœˆ 10æ—¥","externalUrl":null,"permalink":"/posts/251210214738_nat-gateway-with-terraform/","section":"Posts","summary":"","title":"NAT Gatewayã‚’Terraformã§æ§‹ç¯‰","type":"posts"},{"content":" ä»Šæ—¥å­¦ã‚“ã ã“ã¨ # Terraformã® user_data ã‚’ä½¿ã£ã¦ã€EC2èµ·å‹•æ™‚ã«Apacheã‚’è‡ªå‹•ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹æ–¹æ³•ã‚’å­¦ã³ã¾ã—ãŸã€‚æ‰‹å‹•ã§SSHæ¥ç¶šã—ã¦ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã™ã‚‹æ‰‹é–“ã‚’çœãã€ã‚¤ãƒ³ãƒ•ãƒ©æ§‹ç¯‰ã‚’å®Œå…¨ã«è‡ªå‹•åŒ–ã§ãã¾ã™ã€‚\nå­¦ç¿’å†…å®¹ # user_dataã¨ã¯ # EC2ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®åˆå›èµ·å‹•æ™‚ã«å®Ÿè¡Œã•ã‚Œã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§ã™ã€‚OSã®åˆæœŸè¨­å®šã‚„ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã‚’è‡ªå‹•åŒ–ã§ãã¾ã™ã€‚\nTerraformã‚³ãƒ¼ãƒ‰ # resource \u0026#34;aws_instance\u0026#34; \u0026#34;web\u0026#34; { ami = data.aws_ami.amazon_linux_2023.id instance_type = \u0026#34;t3.micro\u0026#34; subnet_id = aws_subnet.public.id vpc_security_group_ids = [aws_security_group.web.id] key_name = aws_key_pair.main.key_name user_data = \u0026lt;\u0026lt;-EOF #!/bin/bash dnf update -y dnf install -y httpd systemctl start httpd systemctl enable httpd EOF tags = { Name = \u0026#34;practice-web\u0026#34; } } ãƒ’ã‚¢ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ§‹æ–‡ # user_data = \u0026lt;\u0026lt;-EOF #!/bin/bash ã‚³ãƒãƒ³ãƒ‰1 ã‚³ãƒãƒ³ãƒ‰2 EOF è¦ç´  èª¬æ˜ \u0026lt;\u0026lt;-EOF ãƒ’ã‚¢ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆé–‹å§‹ã€‚- ãŒã‚ã‚‹ã¨å…ˆé ­ã®ã‚¿ãƒ–ã‚’é™¤å» #!/bin/bash ã‚·ã‚§ãƒãƒ³ã€‚Bashã§å®Ÿè¡Œã™ã‚‹ã“ã¨ã‚’æŒ‡å®š EOF ãƒ’ã‚¢ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆçµ‚äº†ï¼ˆä»»æ„ã®æ–‡å­—åˆ—ã§OKï¼‰ \u0026lt;\u0026lt;EOF ã¨ \u0026lt;\u0026lt;-EOF ã®é•ã„ # # \u0026lt;\u0026lt;EOFï¼ˆãƒã‚¤ãƒ•ãƒ³ãªã—ï¼‰: ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆãŒãã®ã¾ã¾å«ã¾ã‚Œã‚‹ user_data = \u0026lt;\u0026lt;EOF #!/bin/bash echo \u0026#34;hello\u0026#34; EOF # \u0026lt;\u0026lt;-EOFï¼ˆãƒã‚¤ãƒ•ãƒ³ã‚ã‚Šï¼‰: å…ˆé ­ã®ã‚¿ãƒ–ã‚’é™¤å» user_data = \u0026lt;\u0026lt;-EOF #!/bin/bash echo \u0026#34;hello\u0026#34; EOF Terraformã‚³ãƒ¼ãƒ‰ã®ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆã‚’æƒãˆãŸã„å ´åˆã¯ \u0026lt;\u0026lt;-EOF ã‚’ä½¿ã„ã¾ã™ã€‚\nğŸ’¡ è£œè¶³ï¼šæ¨™æº–ã®ã‚·ã‚§ãƒ«ã§ã¯ - ã¯ã‚¿ãƒ–ã®ã¿é™¤å»ã—ã¾ã™ãŒã€Terraform/HCLã§ã¯ç‹¬è‡ªå‡¦ç†ã§ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆã‚’é©åˆ‡ã«å‡¦ç†ã—ã¾ã™ã€‚\nã‚¹ã‚¯ãƒªãƒ—ãƒˆã®å†…å®¹ # #!/bin/bash dnf update -y # ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’æœ€æ–°åŒ– dnf install -y httpd # Apacheã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« systemctl start httpd # Apacheã‚’èµ·å‹• systemctl enable httpd # OSå†èµ·å‹•æ™‚ã«è‡ªå‹•èµ·å‹• Amazon Linux 2023ã§ã¯ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ãŒ dnf ã«ãªã£ã¦ã„ã¾ã™ï¼ˆæ—§Amazon Linux 2ã¯ yumï¼‰ã€‚\nå‹•ä½œç¢ºèª # EC2ä½œæˆå¾Œã€ãƒ‘ãƒ–ãƒªãƒƒã‚¯IPã«HTTPã‚¢ã‚¯ã‚»ã‚¹ã—ã¾ã™ã€‚\nhttp://\u0026lt;ãƒ‘ãƒ–ãƒªãƒƒã‚¯IP\u0026gt; ã€ŒIt works!ã€ãŒè¡¨ç¤ºã•ã‚Œã‚Œã°æˆåŠŸã§ã™ã€‚\nãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚° # æ¥ç¶šã§ããªã„å ´åˆã®ç¢ºèªãƒã‚¤ãƒ³ãƒˆï¼š\nã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚°ãƒ«ãƒ¼ãƒ—: ãƒãƒ¼ãƒˆ80ï¼ˆHTTPï¼‰ãŒè¨±å¯ã•ã‚Œã¦ã„ã‚‹ã‹ user_dataãƒ­ã‚°: SSHæ¥ç¶šã—ã¦ä»¥ä¸‹ã§ç¢ºèª sudo cat /var/log/cloud-init-output.log ApacheçŠ¶æ…‹: systemctl status httpd ã§èµ·å‹•çŠ¶æ…‹ã‚’ç¢ºèª user_dataã®æ³¨æ„ç‚¹ # æ³¨æ„ç‚¹ è©³ç´° åˆå›èµ·å‹•æ™‚ã®ã¿ å†èµ·å‹•ã—ã¦ã‚‚å†å®Ÿè¡Œã•ã‚Œãªã„ å¤‰æ›´æ™‚ã¯å†ä½œæˆ user_dataã‚’å¤‰æ›´ã™ã‚‹ã¨ã€EC2ã¯destroyâ†’createã«ãªã‚‹ ãƒ­ã‚°ç¢ºèª /var/log/cloud-init-output.log ã§å®Ÿè¡Œçµæœã‚’ç¢ºèªå¯èƒ½ å®Ÿè¡Œå®Œäº†ã‚’å¾…ãŸãªã„ EC2ãŒã€Œrunningã€ã§ã‚‚ã‚¹ã‚¯ãƒªãƒ—ãƒˆå®Ÿè¡Œä¸­ã®å ´åˆãŒã‚ã‚‹ å¿œç”¨ï¼šå¤‰æ•°ã‚’åŸ‹ã‚è¾¼ã‚€ # variable \u0026#34;app_name\u0026#34; { default = \u0026#34;myapp\u0026#34; } resource \u0026#34;aws_instance\u0026#34; \u0026#34;web\u0026#34; { # ... user_data = \u0026lt;\u0026lt;-EOF #!/bin/bash echo \u0026#34;Deploying ${var.app_name}\u0026#34; \u0026gt; /var/www/html/index.html EOF } ãƒ’ã‚¢ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆå†…ã§ã‚‚ ${var.xxx} ã§å¤‰æ•°å±•é–‹ãŒå¯èƒ½ã§ã™ã€‚\nã¾ã¨ã‚ # ãƒˆãƒ”ãƒƒã‚¯ å†…å®¹ user_data EC2åˆå›èµ·å‹•æ™‚ã«å®Ÿè¡Œã•ã‚Œã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆ ãƒ’ã‚¢ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ \u0026lt;\u0026lt;-EOF ... EOF ã§è¤‡æ•°è¡Œæ–‡å­—åˆ—ã‚’è¨˜è¿° - ã®æ„å‘³ å…ˆé ­ã®ã‚¿ãƒ–ã‚’é™¤å»ï¼ˆTerraformã§ã¯ã‚¹ãƒšãƒ¼ã‚¹ã‚‚å‡¦ç†ã•ã‚Œã‚‹ï¼‰ åˆå›ã®ã¿ å†èµ·å‹•ã§ã¯å†å®Ÿè¡Œã•ã‚Œãªã„ã€‚å¤‰æ›´æ™‚ã¯EC2å†ä½œæˆ å‚è€ƒ # Amazon Web Services åŸºç¤ã‹ã‚‰ã®ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ï¼†ã‚µãƒ¼ãƒãƒ¼æ§‹ç¯‰ æ”¹è¨‚4ç‰ˆ Terraform AWS Provider - EC2 Instance user_data AWS EC2 User Data ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ ","date":"2025å¹´ 12æœˆ 10æ—¥","externalUrl":null,"permalink":"/posts/251210213639_ec2-startup-apache-auto-install-with-user-data/","section":"Posts","summary":"","title":"user_dataã§EC2èµ·å‹•æ™‚ã«Apacheã‚’è‡ªå‹•ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«","type":"posts"},{"content":"","date":"2025å¹´ 12æœˆ 10æ—¥","externalUrl":null,"permalink":"/tags/%E5%AE%9F%E8%B7%B5/","section":"Tags","summary":"","title":"å®Ÿè·µ","type":"tags"},{"content":" ä»Šæ—¥å­¦ã‚“ã ã“ã¨ # ã€ŒAmazon Web Services åŸºç¤ã‹ã‚‰ã®ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯\u0026amp;ã‚µãƒ¼ãƒãƒ¼æ§‹ç¯‰ã€ã®ãƒãƒ³ã‚ºã‚ªãƒ³ã‚’Terraformã§å†æ§‹ç¯‰ã—ã¾ã—ãŸã€‚Security Groupã§ã¯ã€ŒSGã‚’ã‚½ãƒ¼ã‚¹ã«æŒ‡å®šã™ã‚‹ã€è¨­è¨ˆãƒ‘ã‚¿ãƒ¼ãƒ³ã€EC2ã§ã¯data sourceã‚’ä½¿ã£ãŸæœ€æ–°AMIã®å‹•çš„å–å¾—ã‚’å­¦ã³ã¾ã—ãŸã€‚\nå­¦ç¿’å†…å®¹ # æ§‹ç¯‰ã™ã‚‹ãƒªã‚½ãƒ¼ã‚¹ # ãƒªã‚½ãƒ¼ã‚¹ åå‰ ç”¨é€” Security Group practice-web-sg Webã‚µãƒ¼ãƒãƒ¼ç”¨ï¼ˆSSH, HTTPï¼‰ Security Group practice-db-sg è¸ã¿å°çµŒç”±DBæ¥ç¶šç”¨ï¼ˆSSH, ICMP, MySQLï¼‰ Security Group practice-rds-sg RDSç”¨ï¼ˆMySQLã‚’Webã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰ã®ã¿è¨±å¯ï¼‰ EC2 practice-web ãƒ‘ãƒ–ãƒªãƒƒã‚¯ã‚µãƒ–ãƒãƒƒãƒˆã«é…ç½® EC2 practice-db ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆã‚µãƒ–ãƒãƒƒãƒˆã«é…ç½®ï¼ˆè¸ã¿å°ï¼‰ Security Groupã®ä½œæˆ # åŸºæœ¬æ§‹é€  # resource \u0026#34;aws_security_group\u0026#34; \u0026#34;web\u0026#34; { name = \u0026#34;practice-web-sg\u0026#34; description = \u0026#34;Security group for practice web server\u0026#34; vpc_id = aws_vpc.main.id tags = { Name = \u0026#34;practice-web-sg\u0026#34; } } resource \u0026#34;aws_vpc_security_group_ingress_rule\u0026#34; \u0026#34;web_ssh\u0026#34; { security_group_id = aws_security_group.web.id description = \u0026#34;SSH access\u0026#34; from_port = 22 to_port = 22 ip_protocol = \u0026#34;tcp\u0026#34; cidr_ipv4 = \u0026#34;0.0.0.0/0\u0026#34; } resource \u0026#34;aws_vpc_security_group_ingress_rule\u0026#34; \u0026#34;web_http\u0026#34; { security_group_id = aws_security_group.web.id description = \u0026#34;HTTP access\u0026#34; from_port = 80 to_port = 80 ip_protocol = \u0026#34;tcp\u0026#34; cidr_ipv4 = \u0026#34;0.0.0.0/0\u0026#34; } resource \u0026#34;aws_vpc_security_group_egress_rule\u0026#34; \u0026#34;web_all\u0026#34; { security_group_id = aws_security_group.web.id ip_protocol = \u0026#34;-1\u0026#34; cidr_ipv4 = \u0026#34;0.0.0.0/0\u0026#34; } aws_vpc_security_group_ingress_rule ã¯AWS Provider 5.xã§æ¨å¥¨ã•ã‚Œã‚‹æ–°ã—ã„ãƒªã‚½ãƒ¼ã‚¹ã‚¿ã‚¤ãƒ—ã§ã™ã€‚ãƒ«ãƒ¼ãƒ«ã”ã¨ã«å€‹åˆ¥ãƒªã‚½ãƒ¼ã‚¹ã«ãªã‚‹ãŸã‚ã€å¤‰æ›´æ™‚ã«ä»–ãƒ«ãƒ¼ãƒ«ã¸å½±éŸ¿ã—ã¾ã›ã‚“ã€‚ip_protocol = \u0026quot;-1\u0026quot; ã¯å…¨ãƒ—ãƒ­ãƒˆã‚³ãƒ«è¨±å¯ã‚’æ„å‘³ã—ã¾ã™ã€‚\næ³¨æ„: ä¸Šè¨˜ã® cidr_ipv4 = \u0026quot;0.0.0.0/0\u0026quot; ã¯å­¦ç¿’ç”¨ã®è¨­å®šã§ã™ã€‚æœ¬ç•ªç’°å¢ƒã§ã¯SSHã‚¢ã‚¯ã‚»ã‚¹ã‚’è‡ªåˆ†ã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ã«åˆ¶é™ã—ã¦ãã ã•ã„ã€‚\nSGã‚’ã‚½ãƒ¼ã‚¹ã«æŒ‡å®šã™ã‚‹ # RDSã¸ã®æ¥ç¶šå…ƒã‚’IPã§ã¯ãªãSGã§æŒ‡å®šã™ã‚‹ã“ã¨ã§ã€æŸ”è»Ÿãªã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡ã‚’å®Ÿç¾ã—ã¾ã™ã€‚\nresource \u0026#34;aws_security_group\u0026#34; \u0026#34;rds\u0026#34; { name = \u0026#34;practice-rds-sg\u0026#34; description = \u0026#34;Security group for practice RDS\u0026#34; vpc_id = aws_vpc.main.id tags = { Name = \u0026#34;practice-rds-sg\u0026#34; } } resource \u0026#34;aws_vpc_security_group_ingress_rule\u0026#34; \u0026#34;rds_mysql\u0026#34; { security_group_id = aws_security_group.rds.id description = \u0026#34;MySQL from web server\u0026#34; from_port = 3306 to_port = 3306 ip_protocol = \u0026#34;tcp\u0026#34; referenced_security_group_id = aws_security_group.web.id } referenced_security_group_id ã§IPã‚¢ãƒ‰ãƒ¬ã‚¹ã§ã¯ãªãSGã‚’ã‚½ãƒ¼ã‚¹ã«æŒ‡å®šã—ã¦ã„ã¾ã™ã€‚\næ–¹æ³• ãƒ¡ãƒªãƒƒãƒˆ ãƒ‡ãƒ¡ãƒªãƒƒãƒˆ IPã‚¢ãƒ‰ãƒ¬ã‚¹æŒ‡å®š ã‚·ãƒ³ãƒ—ãƒ« EC2ã®IPå¤‰æ›´æ™‚ã«SGæ›´æ–°ãŒå¿…è¦ SGæŒ‡å®š IPå¤‰æ›´ã«å¼·ã„ã€ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°ã«å¯¾å¿œ è¨­è¨ˆã®ç†è§£ãŒå¿…è¦ Auto Scalingã§EC2ãŒå¢—æ¸›ã—ã¦ã‚‚ã€åŒã˜SGãŒä»˜ä¸ã•ã‚Œã¦ã„ã‚Œã°è‡ªå‹•çš„ã«ã‚¢ã‚¯ã‚»ã‚¹è¨±å¯ã•ã‚Œã¾ã™ã€‚\nICMPãƒ«ãƒ¼ãƒ«ï¼ˆpingç”¨ï¼‰ # resource \u0026#34;aws_vpc_security_group_ingress_rule\u0026#34; \u0026#34;db_icmp\u0026#34; { security_group_id = aws_security_group.db.id description = \u0026#34;Ping\u0026#34; from_port = -1 to_port = -1 ip_protocol = \u0026#34;icmp\u0026#34; cidr_ipv4 = \u0026#34;0.0.0.0/0\u0026#34; } ICMPã¯ from_port = -1, to_port = -1 ã§å…¨ICMPã‚¿ã‚¤ãƒ—ã‚’è¨±å¯ã—ã¾ã™ã€‚\nEC2ã®ä½œæˆ # æœ€æ–°AMIã‚’å‹•çš„å–å¾— # data \u0026#34;aws_ami\u0026#34; \u0026#34;amazon_linux_2023\u0026#34; { most_recent = true owners = [\u0026#34;amazon\u0026#34;] filter { name = \u0026#34;name\u0026#34; values = [\u0026#34;al2023-ami-*-x86_64\u0026#34;] } filter { name = \u0026#34;virtualization-type\u0026#34; values = [\u0026#34;hvm\u0026#34;] } } AMI IDã‚’ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‰ã—ãªã„ç†ç”±ã¯ä»¥ä¸‹ã®ã¨ãŠã‚Šã§ã™ã€‚\nAMI IDã¯ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ã”ã¨ã«ç•°ãªã‚‹ æ–°ã—ã„AMIãŒãƒªãƒªãƒ¼ã‚¹ã•ã‚Œã‚‹ã¨å¤ã„IDã¯éæ¨å¥¨ã«ãªã‚‹ data sourceã§å¸¸ã«æœ€æ–°ã‚’å–å¾—ã™ã‚Œã°ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ä¸è¦ EC2ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ # resource \u0026#34;aws_instance\u0026#34; \u0026#34;web\u0026#34; { ami = data.aws_ami.amazon_linux_2023.id instance_type = \u0026#34;t3.micro\u0026#34; subnet_id = aws_subnet.public.id vpc_security_group_ids = [aws_security_group.web.id] key_name = aws_key_pair.main.key_name tags = { Name = \u0026#34;practice-web\u0026#34; } } resource \u0026#34;aws_instance\u0026#34; \u0026#34;db\u0026#34; { ami = data.aws_ami.amazon_linux_2023.id instance_type = \u0026#34;t3.micro\u0026#34; subnet_id = aws_subnet.private_1.id vpc_security_group_ids = [aws_security_group.db.id] key_name = aws_key_pair.main.key_name tags = { Name = \u0026#34;practice-db\u0026#34; } } vpc_security_group_ids ã¯ãƒªã‚¹ãƒˆå½¢å¼ã§ã€è¤‡æ•°SGã‚’ä»˜ä¸ã§ãã¾ã™ã€‚ãƒ‘ãƒ–ãƒªãƒƒã‚¯ã‚µãƒ–ãƒãƒƒãƒˆã®EC2ã¯è‡ªå‹•ã§ãƒ‘ãƒ–ãƒªãƒƒã‚¯IPã‚’å–å¾—ã—ã€ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆã‚µãƒ–ãƒãƒƒãƒˆã®EC2ã¯ãƒ‘ãƒ–ãƒªãƒƒã‚¯IPãªã—ã¨ãªã‚Šã¾ã™ã€‚\nã‚­ãƒ¼ãƒšã‚¢ # resource \u0026#34;aws_key_pair\u0026#34; \u0026#34;main\u0026#34; { key_name = \u0026#34;practice-keypair\u0026#34; public_key = file(\u0026#34;~/.ssh/practice-keypair.pub\u0026#34;) tags = { Name = \u0026#34;practice-keypair\u0026#34; } } äº‹å‰ã«ãƒ­ãƒ¼ã‚«ãƒ«ã§SSHéµã‚’ç”Ÿæˆã—ã¦ãŠãã¾ã™ã€‚\nssh-keygen -t rsa -b 4096 -f ~/.ssh/practice-keypair -N \u0026#34;\u0026#34; Terraformã«ã¯å…¬é–‹éµã®ã¿ç™»éŒ²ã—ã€ç§˜å¯†éµã¯ãƒ­ãƒ¼ã‚«ãƒ«ã§ç®¡ç†ã—ã¾ã™ã€‚\nã¾ã¨ã‚ # ãƒˆãƒ”ãƒƒã‚¯ å†…å®¹ æ–°ã—ã„SGãƒªã‚½ãƒ¼ã‚¹ aws_vpc_security_group_ingress_rule ãŒæ¨å¥¨ï¼ˆãƒ«ãƒ¼ãƒ«å€‹åˆ¥ç®¡ç†ï¼‰ SGã‚’ã‚½ãƒ¼ã‚¹ã«æŒ‡å®š referenced_security_group_id ã§IPå¤‰æ›´ãƒ»ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°ã«å¼·ã„è¨­è¨ˆ data source data \u0026quot;aws_ami\u0026quot; ã§æœ€æ–°AMIã‚’å‹•çš„å–å¾— ICMPãƒ«ãƒ¼ãƒ« from_port = -1, to_port = -1 ã§å…¨ICMPè¨±å¯ ã‚­ãƒ¼ãƒšã‚¢ å…¬é–‹éµã®ã¿AWSã«ç™»éŒ²ã€ç§˜å¯†éµã¯ãƒ­ãƒ¼ã‚«ãƒ«ç®¡ç† å‚è€ƒ # Amazon Web Services åŸºç¤ã‹ã‚‰ã®ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ï¼†ã‚µãƒ¼ãƒãƒ¼æ§‹ç¯‰ æ”¹è¨‚4ç‰ˆ Terraform AWS Provider - Security Group Terraform AWS Provider - EC2 Instance AWS Security Group ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ ","date":"2025å¹´ 12æœˆ 10æ—¥","externalUrl":null,"permalink":"/posts/251210212221_ec2-security-group-terraform-setup/","section":"Posts","summary":"","title":"EC2 + Security Groupã‚’Terraformã§æ§‹ç¯‰","type":"posts"},{"content":" ä»Šæ—¥å­¦ã‚“ã ã“ã¨ # ã€ŒAmazon Web Services åŸºç¤ã‹ã‚‰ã®ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯\u0026amp;ã‚µãƒ¼ãƒãƒ¼æ§‹ç¯‰ã€ã®ãƒãƒ³ã‚ºã‚ªãƒ³ã‚’Terraformã§å†æ§‹ç¯‰ã—ã¾ã—ãŸã€‚VPCã¨ã‚µãƒ–ãƒãƒƒãƒˆã®è¨­è¨ˆã‹ã‚‰ã€ãƒ‘ãƒ–ãƒªãƒƒã‚¯/ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆã®é•ã„ãŒãƒ«ãƒ¼ãƒˆãƒ†ãƒ¼ãƒ–ãƒ«ã®è¨­å®šã§æ±ºã¾ã‚‹ã“ã¨ã‚’å®Ÿè·µã‚’é€šã˜ã¦ç†è§£ã—ã¾ã—ãŸã€‚\nå­¦ç¿’å†…å®¹ # æ§‹ç¯‰ã™ã‚‹ãƒªã‚½ãƒ¼ã‚¹ # ãƒªã‚½ãƒ¼ã‚¹ åå‰ CIDR / AZ VPC practice-vpc 10.0.0.0/16 ãƒ‘ãƒ–ãƒªãƒƒã‚¯ã‚µãƒ–ãƒãƒƒãƒˆ practice-public-subnet 10.0.1.0/24 (ap-northeast-1a) ãƒ‘ãƒ–ãƒªãƒƒã‚¯ã‚µãƒ–ãƒãƒƒãƒˆ2 practice-public-subnet-2 10.0.4.0/24 (ap-northeast-1c) ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆã‚µãƒ–ãƒãƒƒãƒˆ practice-private-subnet 10.0.2.0/24 (ap-northeast-1a) ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆã‚µãƒ–ãƒãƒƒãƒˆ2 practice-private-subnet-2 10.0.3.0/24 (ap-northeast-1c) Internet Gateway practice-igw - ãƒ«ãƒ¼ãƒˆãƒ†ãƒ¼ãƒ–ãƒ«ï¼ˆãƒ‘ãƒ–ãƒªãƒƒã‚¯ï¼‰ practice-public-rt 0.0.0.0/0 â†’ IGW ãƒ«ãƒ¼ãƒˆãƒ†ãƒ¼ãƒ–ãƒ«ï¼ˆãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆï¼‰ practice-private-rt ãƒ­ãƒ¼ã‚«ãƒ«ã®ã¿ VPCã®ä½œæˆ # resource \u0026#34;aws_vpc\u0026#34; \u0026#34;main\u0026#34; { cidr_block = \u0026#34;10.0.0.0/16\u0026#34; enable_dns_hostnames = true enable_dns_support = true tags = { Name = \u0026#34;practice-vpc\u0026#34; } } enable_dns_hostnames = true ã‚’è¨­å®šã™ã‚‹ã“ã¨ã§ã€EC2ã«ãƒ‘ãƒ–ãƒªãƒƒã‚¯DNSåãŒå‰²ã‚Šå½“ã¦ã‚‰ã‚Œã¾ã™ã€‚AWSã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã§ã¯ã€ŒVPCã®è¨­å®šã‚’ç·¨é›†ã€ã‹ã‚‰æœ‰åŠ¹åŒ–ã™ã‚‹æ“ä½œãŒå¿…è¦ã§ã™ãŒã€Terraformã§ã¯å±æ€§1ã¤ã§å®Œçµã—ã¾ã™ã€‚\nã‚µãƒ–ãƒãƒƒãƒˆã®ä½œæˆ # resource \u0026#34;aws_subnet\u0026#34; \u0026#34;public\u0026#34; { vpc_id = aws_vpc.main.id cidr_block = \u0026#34;10.0.1.0/24\u0026#34; availability_zone = \u0026#34;ap-northeast-1a\u0026#34; map_public_ip_on_launch = true tags = { Name = \u0026#34;practice-public-subnet\u0026#34; } } resource \u0026#34;aws_subnet\u0026#34; \u0026#34;private_1\u0026#34; { vpc_id = aws_vpc.main.id cidr_block = \u0026#34;10.0.2.0/24\u0026#34; availability_zone = \u0026#34;ap-northeast-1a\u0026#34; tags = { Name = \u0026#34;practice-private-subnet\u0026#34; } } map_public_ip_on_launch = true ã¯ãƒ‘ãƒ–ãƒªãƒƒã‚¯ã‚µãƒ–ãƒãƒƒãƒˆã®ã¿ã«è¨­å®šã—ã¾ã™ã€‚ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆã‚µãƒ–ãƒãƒƒãƒˆã«ã¯ãƒ‘ãƒ–ãƒªãƒƒã‚¯IPãŒä¸è¦ãªãŸã‚è¨­å®šã—ã¾ã›ã‚“ã€‚\nInternet Gatewayã®ä½œæˆ # resource \u0026#34;aws_internet_gateway\u0026#34; \u0026#34;main\u0026#34; { vpc_id = aws_vpc.main.id tags = { Name = \u0026#34;practice-igw\u0026#34; } } Terraformã§ã¯ vpc_id ã‚’æŒ‡å®šã™ã‚‹ã ã‘ã§IGWä½œæˆã¨VPCã¸ã®ã‚¢ã‚¿ãƒƒãƒãŒåŒæ™‚ã«å®Ÿè¡Œã•ã‚Œã¾ã™ã€‚AWSã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã§ã¯ã€Œä½œæˆã€â†’ã€ŒVPCã«ã‚¢ã‚¿ãƒƒãƒã€ã®2ã‚¹ãƒ†ãƒƒãƒ—ãŒå¿…è¦ãªæ“ä½œã§ã™ã€‚\nãƒ«ãƒ¼ãƒˆãƒ†ãƒ¼ãƒ–ãƒ«ã®ä½œæˆ # # ãƒ‘ãƒ–ãƒªãƒƒã‚¯ç”¨ resource \u0026#34;aws_route_table\u0026#34; \u0026#34;public\u0026#34; { vpc_id = aws_vpc.main.id route { cidr_block = \u0026#34;0.0.0.0/0\u0026#34; gateway_id = aws_internet_gateway.main.id } tags = { Name = \u0026#34;practice-public-rt\u0026#34; } } resource \u0026#34;aws_route_table_association\u0026#34; \u0026#34;public\u0026#34; { subnet_id = aws_subnet.public.id route_table_id = aws_route_table.public.id } # ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆç”¨ resource \u0026#34;aws_route_table\u0026#34; \u0026#34;private\u0026#34; { vpc_id = aws_vpc.main.id tags = { Name = \u0026#34;practice-private-rt\u0026#34; } } resource \u0026#34;aws_route_table_association\u0026#34; \u0026#34;private_1\u0026#34; { subnet_id = aws_subnet.private_1.id route_table_id = aws_route_table.private.id } ãƒ‘ãƒ–ãƒªãƒƒã‚¯ãƒ«ãƒ¼ãƒˆãƒ†ãƒ¼ãƒ–ãƒ«ã«ã¯ 0.0.0.0/0 â†’ IGW ã®ãƒ«ãƒ¼ãƒˆã‚’è¨­å®šã—ã€ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãƒ«ãƒ¼ãƒˆãƒ†ãƒ¼ãƒ–ãƒ«ã«ã¯ãƒ­ãƒ¼ã‚«ãƒ«ãƒ«ãƒ¼ãƒˆï¼ˆ10.0.0.0/16ï¼‰ã®ã¿ã‚’è¨­å®šã—ã¾ã™ã€‚ã“ã®IGWã¸ã®ãƒ«ãƒ¼ãƒˆãŒã‚ã‚‹ã‹ã©ã†ã‹ãŒãƒ‘ãƒ–ãƒªãƒƒã‚¯/ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆã®é•ã„ã«ãªã‚Šã¾ã™ã€‚\nãªãœ2AZæ§‹æˆã«ã—ãŸã‹ # ALBã¯æœ€ä½2ã¤ã®AZãŒå¿…è¦ã§ã‚ã‚Šã€RDSã®DBã‚µãƒ–ãƒãƒƒãƒˆã‚°ãƒ«ãƒ¼ãƒ—ã‚‚2AZå¿…é ˆã§ã™ã€‚æœ¬ç•ªç’°å¢ƒã‚’æ„è­˜ã—ãŸè¨­è¨ˆã¨ã—ã¦ã€æœ€åˆã‹ã‚‰2AZæ§‹æˆã«ã—ã¾ã—ãŸã€‚\nã¾ã¨ã‚ # ãƒˆãƒ”ãƒƒã‚¯ å†…å®¹ ãƒ‘ãƒ–ãƒªãƒƒã‚¯/ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆã®é•ã„ ã‚µãƒ–ãƒãƒƒãƒˆä½œæˆæ™‚ç‚¹ã§ã¯åŒã˜ã€‚ãƒ«ãƒ¼ãƒˆãƒ†ãƒ¼ãƒ–ãƒ«ã«IGWã¸ã®ãƒ«ãƒ¼ãƒˆãŒã‚ã‚‹ã‹ã§æ±ºã¾ã‚‹ DNSè¨­å®š enable_dns_hostnames = true ã§ãƒ‘ãƒ–ãƒªãƒƒã‚¯DNSåãŒå‰²ã‚Šå½“ã¦ã‚‰ã‚Œã‚‹ IGWã‚¢ã‚¿ãƒƒãƒ Terraformã§ã¯ vpc_id æŒ‡å®šã§ã‚¢ã‚¿ãƒƒãƒã¾ã§å®Œäº† æ˜ç¤ºçš„ãªé–¢é€£ä»˜ã‘ ãƒ«ãƒ¼ãƒˆãƒ†ãƒ¼ãƒ–ãƒ«ã«ã‚µãƒ–ãƒãƒƒãƒˆã‚’é–¢é€£ä»˜ã‘ãªã„ã¨ã€ãƒ¡ã‚¤ãƒ³ãƒ«ãƒ¼ãƒˆãƒ†ãƒ¼ãƒ–ãƒ«ãŒé©ç”¨ã•ã‚Œã‚‹ å‚è€ƒ # Amazon Web Services åŸºç¤ã‹ã‚‰ã®ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ï¼†ã‚µãƒ¼ãƒãƒ¼æ§‹ç¯‰ æ”¹è¨‚4ç‰ˆ Terraform AWS Provider - VPC AWS VPC ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ ","date":"2025å¹´ 12æœˆ 10æ—¥","externalUrl":null,"permalink":"/posts/251210211505_vpc-and-subnet-design-with-terraform/","section":"Posts","summary":"","title":"VPCã¨ã‚µãƒ–ãƒãƒƒãƒˆè¨­è¨ˆã‚’Terraformã§æ§‹ç¯‰ã™ã‚‹","type":"posts"},{"content":" ä»Šæ—¥å­¦ã‚“ã ã“ã¨ # Raycast Windowsç‰ˆã‚’å°å…¥ã—ã¾ã—ãŸã€‚ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰æ“ä½œã§æ§˜ã€…ãªä½œæ¥­ã‚’é«˜é€Ÿã«è¡Œãˆã‚‹ãƒ©ãƒ³ãƒãƒ£ãƒ¼ã‚¢ãƒ—ãƒªã§ã€App Launcherã€Clipboard Historyã€Snippetsã€Quicklinksã€Calculatorã®5ã¤ã®åŸºæœ¬æ©Ÿèƒ½ã‚’è¦šãˆã‚‹ã“ã¨ã§ã€æ—¥å¸¸æ¥­å‹™ã®åŠ¹ç‡åŒ–ãŒæœŸå¾…ã§ãã¾ã™ã€‚\nå­¦ç¿’å†…å®¹ # Raycastã¨ã¯ # ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰æ“ä½œã§æ§˜ã€…ãªä½œæ¥­ã‚’é«˜é€Ÿã«è¡Œãˆã‚‹ãƒ©ãƒ³ãƒãƒ£ãƒ¼ã‚¢ãƒ—ãƒªã§ã™ã€‚Macã§äººæ°—ã ã£ãŸãƒ„ãƒ¼ãƒ«ãŒWindowsç‰ˆã¨ã—ã¦ãƒªãƒªãƒ¼ã‚¹ã•ã‚Œã¾ã—ãŸã€‚\né …ç›® å†…å®¹ å¯¾å¿œOS Windows 10ï¼ˆ21H2ä»¥é™ï¼‰ã€Windows 11 æ–™é‡‘ åŸºæœ¬æ©Ÿèƒ½ã¯ç„¡æ–™ï¼ˆPro/Teamsãƒ—ãƒ©ãƒ³ã¯æœ‰æ–™ï¼‰ ç¾çŠ¶ ãƒ™ãƒ¼ã‚¿ç‰ˆï¼ˆv0.39.1.0ï¼‰ å°å…¥æ–¹æ³• # ä»¥ä¸‹ã®ã„ãšã‚Œã‹ã®æ–¹æ³•ã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚\næ–¹æ³•1ï¼šMicrosoft Store\nhttps://www.raycast.com/windows ã‹ã‚‰ã€ŒDownload on Microsoft Storeã€ã‚’ã‚¯ãƒªãƒƒã‚¯\næ–¹æ³•2ï¼šWinget\nwinget install raycast ä¸»ãªæ©Ÿèƒ½ä¸€è¦§ # æ©Ÿèƒ½ å†…å®¹ App Launcher ã‚¢ãƒ—ãƒªåã‚’æ•°æ–‡å­—å…¥åŠ›ã™ã‚‹ã ã‘ã§å³èµ·å‹• File Search ãƒ­ãƒ¼ã‚«ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é«˜é€Ÿæ¤œç´¢ Clipboard History ã‚³ãƒ”ãƒ¼å±¥æ­´ã‚’ä¿å­˜ãƒ»æ¤œç´¢ãƒ»å†åˆ©ç”¨ Snippets å®šå‹æ–‡ã‚’ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã§å³æŒ¿å…¥ Quicklinks ã‚ˆãä½¿ã†URLã«å³ã‚¢ã‚¯ã‚»ã‚¹ Calculator è‡ªç„¶è¨€èªã§è¨ˆç®— Emoji Picker çµµæ–‡å­—ã‚’ç´ æ—©ãæ¤œç´¢ãƒ»å…¥åŠ› Quick AI ãƒ–ãƒ©ã‚¦ã‚¶ã‚’é–‹ã‹ãšã«AIã«è³ªå• ã¾ãšè¦šãˆã‚‹5ã¤ã®æ©Ÿèƒ½ # 1. App Launcherï¼ˆã‚¢ãƒ—ãƒªèµ·å‹•ï¼‰ # Alt + Spaceã§Raycastã‚’èµ·å‹• ã‚¢ãƒ—ãƒªåã®ä¸€éƒ¨ã‚’å…¥åŠ›ï¼ˆä¾‹ï¼šchr â†’ Chromeï¼‰ Enterã§èµ·å‹• å®Œå…¨ä¸€è‡´ã¯ä¸è¦ã§ã€teã§Teamsã€ouã§Outlookãªã©ã€ã‚ã„ã¾ã„æ¤œç´¢ã«å¯¾å¿œã—ã¦ã„ã¾ã™ã€‚ä½¿ç”¨é »åº¦ãŒé«˜ã„ã‚¢ãƒ—ãƒªã¯è‡ªå‹•ã§ä¸Šä½ã«è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚\nã€Œã‚¹ã‚¿ãƒ¼ãƒˆãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’é–‹ããã†ã«ãªã£ãŸã‚‰Raycastã€ã¨æ„è­˜ã™ã‚‹ã¨å®šç€ã—ã‚„ã™ã„ã§ã™ã€‚\n2. Clipboard Historyï¼ˆã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰å±¥æ­´ï¼‰ # Alt + Space â†’ clipã¨å…¥åŠ› â†’ Enter éå»ã«ã‚³ãƒ”ãƒ¼ã—ãŸå±¥æ­´ä¸€è¦§ãŒè¡¨ç¤º ä½¿ã„ãŸã„é …ç›®ã‚’é¸ã‚“ã§Enterã§ãƒšãƒ¼ã‚¹ãƒˆ Settings â†’ Extensions â†’ Clipboard Historyã«ãƒ›ãƒƒãƒˆã‚­ãƒ¼ã‚’è¨­å®šã™ã‚‹ã¨ã€ç›´æ¥å±¥æ­´ç”»é¢ã‚’é–‹ã‘ã¾ã™ï¼ˆä¾‹ï¼šCtrl + Shift + Vï¼‰ã€‚\nã€Œã•ã£ãã‚³ãƒ”ãƒ¼ã—ãŸIPã©ã“ã ã£ã‘ã€ã¨ã„ã†å ´é¢ã§æ´»èºã—ã¾ã™ã€‚\n3. Snippetsï¼ˆå®šå‹æ–‡ç™»éŒ²ï¼‰ # Alt + Space â†’ create snippetã¨å…¥åŠ› â†’ Enter ç™»éŒ²ç”»é¢ã§ä»¥ä¸‹ã‚’å…¥åŠ› Name: ç”¨é€”ãŒã‚ã‹ã‚‹åå‰ï¼ˆä¾‹ï¼šã€Œå¯¾å¿œå®Œäº†ãƒ¡ãƒ¼ãƒ«ã€ï¼‰ Snippet: æœ¬æ–‡ Keyword: å‘¼ã³å‡ºã™ãƒˆãƒªã‚¬ãƒ¼ï¼ˆä¾‹ï¼š!doneï¼‰ ä¿å­˜å¾Œã€ã©ã®ã‚¢ãƒ—ãƒªã§ã‚‚!doneã¨æ‰“ã¤ã¨è‡ªå‹•å±•é–‹ ç™»éŒ²ä¾‹ï¼š\nKeyword å†…å®¹ !done å¯¾å¿œå®Œäº†ã„ãŸã—ã¾ã—ãŸã€‚ã”ç¢ºèªã‚’ãŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚ !ack ãŠå•ã„åˆã‚ã›ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚ç¢ºèªæ¬¡ç¬¬ã”é€£çµ¡ã„ãŸã—ã¾ã™ã€‚ !sig è‡ªåˆ†ã®ç½²å 4. Quicklinksï¼ˆã‚ˆãä½¿ã†URLã®ç™»éŒ²ï¼‰ # Alt + Space â†’ create quicklinkã¨å…¥åŠ› â†’ Enter ç™»éŒ²ç”»é¢ã§ä»¥ä¸‹ã‚’å…¥åŠ› Name: ã‚ã‹ã‚Šã‚„ã™ã„åå‰ï¼ˆä¾‹ï¼šã€Œç›£è¦–ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã€ï¼‰ Link: URL ä»¥é™ã¯Alt + Space â†’ ç™»éŒ²ã—ãŸåå‰ã®ä¸€éƒ¨ã‚’å…¥åŠ› â†’ Enterã§å³ã‚¢ã‚¯ã‚»ã‚¹ ç™»éŒ²ä¾‹ï¼š\nName Link AWS Console https://console.aws.amazon.com/ GitHub https://github.com/ ãƒ–ãƒ©ã‚¦ã‚¶ã‚’é–‹ã„ã¦ãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯ã‚’æ¢ã™æ‰‹é–“ã‚’çœç•¥ã§ãã¾ã™ã€‚\n5. Calculatorï¼ˆè¨ˆç®—æ©Ÿï¼‰ # Alt + Spaceã§Raycastã‚’èµ·å‹• ãã®ã¾ã¾è¨ˆç®—å¼ã‚’å…¥åŠ›ï¼ˆä¾‹ï¼š1024 * 8ï¼‰ çµæœãŒå³è¡¨ç¤ºã•ã‚Œã€Enterã§ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼ å¯¾å¿œã—ã¦ã„ã‚‹è¨ˆç®—ï¼š\nå…¥åŠ›ä¾‹ ç”¨é€” 100 + 200 * 3 å››å‰‡æ¼”ç®— 100 USD to JPY å˜ä½å¤‰æ› 0xFF to decimal é€²æ•°å¤‰æ› 0b11111111 2é€²æ•°â†’10é€²æ•°ï¼ˆã‚µãƒ–ãƒãƒƒãƒˆãƒã‚¹ã‚¯ç¢ºèªï¼‰ 1024 * 1024 * 1024 GBâ†’ãƒã‚¤ãƒˆå¤‰æ› é›»å“ã‚¢ãƒ—ãƒªã‚’èµ·å‹•ã›ãšã«ãã®å ´ã§è¨ˆç®—ã§ãã¾ã™ã€‚\næ‹¡å¼µæ©Ÿèƒ½ # ã‚¹ãƒˆã‚¢ã‹ã‚‰è¿½åŠ å¯èƒ½ãªæ‹¡å¼µæ©Ÿèƒ½ã‚‚ç”¨æ„ã•ã‚Œã¦ã„ã¾ã™ã€‚\nGitHub - PRãƒ»Issueãƒ»é€šçŸ¥ç¢ºèª Slack - ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹å¤‰æ›´ãƒ»æœªèª­ç¢ºèª Notion - ãƒšãƒ¼ã‚¸æ¤œç´¢ãƒ»ä½œæˆ Todoist - ã‚¿ã‚¹ã‚¯ç®¡ç† ã¾ã¨ã‚ # Raycastã¯ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰æ“ä½œã§ä½œæ¥­ã‚’é«˜é€ŸåŒ–ã™ã‚‹ãƒ©ãƒ³ãƒãƒ£ãƒ¼ã‚¢ãƒ—ãƒª Windowsç‰ˆã¯ãƒ™ãƒ¼ã‚¿ç‰ˆã ãŒã€åŸºæœ¬æ©Ÿèƒ½ã¯ã™ã¹ã¦ç„¡æ–™ã§ä½¿ãˆã‚‹ ã¾ãšè¦šãˆã‚‹5ã¤ã®æ©Ÿèƒ½ï¼šApp Launcherã€Clipboard Historyã€Snippetsã€Quicklinksã€Calculator æ™®æ®µã®ä½œæ¥­ã®ä¸­ã§ã€Œã“ã‚Œã£ã¦Raycastã§åŠ¹ç‡åŒ–ã§ããªã„ã‹ãªï¼Ÿã€ã¨è€ƒãˆãªãŒã‚‰å°‘ã—ãšã¤æ´»ç”¨ç¯„å›²ã‚’åºƒã’ã¦ã„ã å‚è€ƒ # Raycast Windowsç‰ˆ å…¬å¼ã‚µã‚¤ãƒˆ Raycast å…¬å¼ãƒãƒ‹ãƒ¥ã‚¢ãƒ« Raycastã®ä½¿ã„æ–¹ï¼ˆZennï¼‰ ","date":"2025å¹´ 12æœˆ 10æ—¥","externalUrl":null,"permalink":"/posts/251210142726_raycast-windows-installation-and-5-core-features/","section":"Posts","summary":"","title":"Raycast Windowsç‰ˆã®å°å…¥ã¨åŸºæœ¬æ©Ÿèƒ½5ã¤","type":"posts"},{"content":"","date":"2025å¹´ 12æœˆ 10æ—¥","externalUrl":null,"permalink":"/tags/windows/","section":"Tags","summary":"","title":"Windows","type":"tags"},{"content":"","date":"2025å¹´ 12æœˆ 10æ—¥","externalUrl":null,"permalink":"/tags/%E3%83%84%E3%83%BC%E3%83%AB/","section":"Tags","summary":"","title":"ãƒ„ãƒ¼ãƒ«","type":"tags"},{"content":"","date":"2025å¹´ 12æœˆ 10æ—¥","externalUrl":null,"permalink":"/tags/%E5%85%A5%E9%96%80/","section":"Tags","summary":"","title":"å…¥é–€","type":"tags"},{"content":" ä»Šæ—¥å­¦ã‚“ã ã“ã¨ # å€‹äººãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆï¼ˆæŠ€è¡“ãƒ–ãƒ­ã‚°ã®AWSç§»è¡Œï¼‰ã®ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£å›³ã‚’draw.ioã§ä½œæˆã—ã¾ã—ãŸã€‚\nãƒ¡ãƒ³ã‚¿ãƒ¼ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’é€šã˜ã¦ã€ã€Œæ“ä½œä¸»ä½“ã‚’æ˜ç¢ºã«ã™ã‚‹ã€ã€Œåˆ†ã‹ã‚Šã«ãã„ãƒ•ãƒ­ãƒ¼ã¯å‡¡ä¾‹ã§è£œè¶³ã™ã‚‹ã€ã¨ã„ã£ãŸæ§‹æˆå›³ä½œæˆã®ãƒã‚¤ãƒ³ãƒˆã‚’å­¦ã³ã¾ã—ãŸã€‚\nå­¦ç¿’å†…å®¹ # ãªãœdraw.ioã‚’é¸ã‚“ã ã‹ # æœ€åˆã¯Mermaidã§æ§‹æˆå›³ã‚’æ›¸ã„ã¦ã„ã¾ã—ãŸãŒã€é¢æ¥ã§ã®èª¬æ˜ã‚’è€ƒãˆã¦draw.ioã«å¤‰æ›´ã—ã¾ã—ãŸã€‚\né¸æŠè‚¢ ãƒ¡ãƒªãƒƒãƒˆ ãƒ‡ãƒ¡ãƒªãƒƒãƒˆ Mermaid ã‚³ãƒ¼ãƒ‰ã§ç®¡ç†ã§ãã‚‹ã€GitHubã§ç›´æ¥è¡¨ç¤º AWSã‚¢ã‚¤ã‚³ãƒ³ãŒä½¿ãˆãªã„ã€è¦‹ãŸç›®ãŒç°¡ç´  draw.io AWSå…¬å¼ã‚¢ã‚¤ã‚³ãƒ³ã€è¦–è¦šçš„ã«åˆ†ã‹ã‚Šã‚„ã™ã„ ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦ç®¡ç† æ§‹æˆå›³ã‚’ä½¿ã£ãŸèª¬æ˜ã‚’æ±‚ã‚ã‚‰ã‚Œã‚‹ç¢ºç‡ã¯é«˜ã„ãŸã‚ã€AWSå…¬å¼ã‚¢ã‚¤ã‚³ãƒ³ã‚’ä½¿ãˆã‚‹\ndraw.io ã‚’é¸æŠã—ã¾ã—ãŸã€‚è‡ªåˆ†ã§é…ç½®ã‚’è€ƒãˆã¦æ›¸ã„ãŸå›³ãªã‚‰ã€ç´°éƒ¨ã¾ã§èª¬æ˜ã§ãã¾ã™ã€‚\nAWSå…¬å¼ã‚¢ã‚¤ã‚³ãƒ³ã®å°å…¥æ‰‹é † # draw.ioã§ã¯ã€ŒAWS 2025ã€ã®ã‚¢ã‚¤ã‚³ãƒ³ã‚»ãƒƒãƒˆãŒä½¿ãˆã¾ã™ã€‚\ndraw.ioã‚’é–‹ãï¼ˆhttps://app.diagrams.net/ï¼‰ å·¦å´ãƒ‘ãƒãƒ«ã®ã€Œ+ More Shapesã€ã‚’ã‚¯ãƒªãƒƒã‚¯ ã€ŒAWSã€ã‚«ãƒ†ã‚´ãƒªã‹ã‚‰ã€ŒAWS 2025ã€ã‚’é¸æŠ ã€ŒApplyã€ã§è¿½åŠ å®Œäº† ã“ã‚Œã§S3ã€CloudFrontã€Route53ãªã©ã®AWSã‚µãƒ¼ãƒ“ã‚¹ã‚¢ã‚¤ã‚³ãƒ³ãŒä½¿ãˆã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚\nä½œæˆæ™‚ã«æ„è­˜ã—ãŸãƒã‚¤ãƒ³ãƒˆ # 1. å¯¾è±¡è€…ã‚’æ„è­˜ã™ã‚‹ # ã“ã®æ§‹æˆå›³ã‚’è¦‹ã‚‹äººã¯èª°ã‹ï¼ˆé¢æ¥å®˜ã€è‡ªåˆ†ï¼‰ã‚’è€ƒãˆã€éåº¦ã«è©³ç´°ã«ã›ãšã€ä¸»è¦ãªã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¨æµã‚ŒãŒåˆ†ã‹ã‚‹ãƒ¬ãƒ™ãƒ«ã«ç•™ã‚ã¾ã—ãŸã€‚\n2. çŸ¢å°ã‚’äº¤å·®ã•ã›ãªã„ # çŸ¢å°ãŒäº¤å·®ã™ã‚‹ã¨ã€ã©ã“ã‹ã‚‰ã©ã“ã¸ã®é€šä¿¡ã‹åˆ†ã‹ã‚Šã«ãããªã‚Šã¾ã™ã€‚é…ç½®ã‚’å·¥å¤«ã—ã¦äº¤å·®ã‚’é¿ã‘ã¾ã—ãŸã€‚\n3. ä¸€è²«ã—ãŸå‘½å # æ§‹æˆå›³å†…ã®ãƒ©ãƒ™ãƒ«ã¨Terraformã®ãƒªã‚½ãƒ¼ã‚¹åã‚’ä¸€è‡´ã•ã›ã‚‹ã¨ã€ã‚³ãƒ¼ãƒ‰ã¨ã®å¯¾å¿œãŒå–ã‚Šã‚„ã™ããªã‚Šã¾ã™ã€‚\n4. å‡¡ä¾‹ã‚’è¿½åŠ ã™ã‚‹ # çŸ¢å°ã®æ„å‘³ãŒè‡ªæ˜ã§ãªã„å ´åˆã¯å‡¡ä¾‹ã§è£œè¶³ã—ã¾ã™ã€‚\nä»Šå›ã¯ã€Œãƒ‡ãƒ¼ã‚¿ã®æµã‚Œï¼ˆå®Ÿç·šï¼‰ã€ã€Œãƒ¡ãƒˆãƒªã‚¯ã‚¹/ãƒ­ã‚°ï¼ˆç ´ç·šï¼‰ã€ã‚’å·¦ä¸Šã«é…ç½®ã—ã¾ã—ãŸã€‚\nãƒ¡ãƒ³ã‚¿ãƒ¼ã‹ã‚‰ã®ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ # æ‰€å±ã—ã¦ã„ã‚‹ã‚¹ã‚¯ãƒ¼ãƒ«ï¼ˆRareTECHï¼‰ã§ãƒ¡ãƒ³ã‚¿ãƒ¼ã«ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’ä¾é ¼ã—ã¾ã—ãŸã€‚\nå…¨ä½“è©•ä¾¡ # ã€Œã¨ã¦ã‚‚ç¶ºéº—ã€ã€Œã“ã®ã¾ã¾å‡ºã—ã¦ã‚‚é•å’Œæ„Ÿãªã„ã€\næŒ‡æ‘˜ã•ã‚ŒãŸç‚¹ # CI/CDãƒ•ãƒ­ãƒ¼ã®çŸ¢å°ãŒåˆ†ã‹ã‚Šã«ãã„\nä¿®æ­£å‰ã¯ã€ŒIAM â†’ S3ã€ã€ŒIAM â†’ CloudFrontã€ã¨ã„ã†çŸ¢å°ã‚’å¼•ã„ã¦ã„ã¾ã—ãŸã€‚ã“ã‚Œã ã¨ã€ŒIAMãŒS3ã‚’æ“ä½œã™ã‚‹ã€ã‚ˆã†ã«è¦‹ãˆã¦ã—ã¾ã„ã¾ã™ã€‚\nå®Ÿéš›ã®æµã‚Œã¯ä»¥ä¸‹ã®é€šã‚Šã§ã™ã€‚\nGitHub ActionsãŒIAMãƒ­ãƒ¼ãƒ«ã‚’å¼•ãå—ã‘ã‚‹ï¼ˆOIDCèªè¨¼ï¼‰ GitHub ActionsãŒS3ã«ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’åŒæœŸã™ã‚‹ GitHub ActionsãŒCloudFrontã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ç„¡åŠ¹åŒ–ã™ã‚‹ ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ å½¹å‰² GitHub Actions æ“ä½œã®å®Ÿè¡Œä¸»ä½“ï¼ˆAPIã‚³ãƒ¼ãƒ«ã‚’è¡Œã†ï¼‰ IAM ãƒ­ãƒ¼ãƒ« èªè¨¼ãƒ»èªå¯ï¼ˆæ¨©é™ä»˜ä¸ï¼‰ S3 / CloudFront æ“ä½œå¯¾è±¡ IAMã¯ã€Œéµã€ã§ã‚ã£ã¦ã€Œæ“ä½œè€…ã€ã§ã¯ãªã„ãŸã‚ã€çŸ¢å°ã®èµ·ç‚¹ã‚’ä¿®æ­£ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã—ãŸã€‚\nä¿®æ­£å†…å®¹ # ä¿®æ­£é …ç›® å†…å®¹ çŸ¢å°å‰Šé™¤ IAM â†’ S3 / IAM â†’ CloudFront çŸ¢å°è¿½åŠ  GitHub Actions â†’ S3ï¼ˆã‚³ãƒ³ãƒ†ãƒ³ãƒ„åŒæœŸï¼‰ çŸ¢å°è¿½åŠ  GitHub Actions â†’ CloudFrontï¼ˆã‚­ãƒ£ãƒƒã‚·ãƒ¥ç„¡åŠ¹åŒ–ï¼‰ å‡¡ä¾‹è¿½åŠ  ã€ŒGitHub Actionsã¯IAMã«ã‚ˆã‚‹OIDCèªè¨¼å¾Œã€S3ãƒ»CloudFrontã‚’æ“ä½œã€ èª¬æ˜é †åº # æ§‹æˆå›³ã‚’ä½¿ã£ã¦èª¬æ˜ã™ã‚‹ã¨ãã®é †åºã¯ä¸‹è¨˜ã€‚\nãƒ¡ã‚¤ãƒ³ãƒ•ãƒ­ãƒ¼: ãƒ¦ãƒ¼ã‚¶ãƒ¼ â†’ Route53 â†’ CloudFront â†’ S3ï¼ˆã‚³ãƒ³ãƒ†ãƒ³ãƒ„é…ä¿¡ã®åŸºæœ¬çµŒè·¯ï¼‰ CI/CD: GitHub Actions â†’ IAMï¼ˆOIDCï¼‰â†’ S3/CloudFrontï¼ˆãƒ‡ãƒ—ãƒ­ã‚¤ã®æµã‚Œï¼‰ ç›£è¦–: CloudWatch â†’ SNS â†’ ãƒ¡ãƒ¼ãƒ«é€šçŸ¥ï¼ˆé‹ç”¨è¦–ç‚¹ï¼‰ ä¸Šã‹ã‚‰ä¸‹ã€å·¦ã‹ã‚‰å³ã«æµã‚Œã‚‹ã‚ˆã†ã«é…ç½®ã™ã‚‹ã¨èª¬æ˜ã—ã‚„ã™ããªã‚Šã¾ã™ã€‚\nã¾ã¨ã‚ # å­¦ã‚“ã ã“ã¨ è©³ç´° æ“ä½œä¸»ä½“ã‚’æ˜ç¢ºã«ã™ã‚‹ ã€ŒIAMãŒS3ã‚’æ“ä½œã€ã§ã¯ãªãã€ŒGitHub ActionsãŒS3ã‚’æ“ä½œã€ å‡¡ä¾‹ã§è£œè¶³ã™ã‚‹ åˆ†ã‹ã‚Šã«ãã„ãƒ•ãƒ­ãƒ¼ï¼ˆCI/CDã€èªè¨¼ï¼‰ã¯èª¬æ˜æ–‡ã‚’è¿½åŠ  ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’ä¾é ¼ã™ã‚‹ è‡ªåˆ†ã§ã¯æ°—ã¥ã‹ãªã„æŒ‡æ‘˜ã‚’ã‚‚ã‚‰ãˆã‚‹ è‡ªåˆ†ã§æ›¸ã„ãŸå›³ã¯èª¬æ˜ã—ã‚„ã™ã„ ã€Œãªãœã“ã®é…ç½®ã«ã—ãŸã‹ã€ã‚’èª¬æ˜ã§ãã‚‹ å‚è€ƒ # draw.ioå…¬å¼ AWS Architecture Icons ","date":"2025å¹´ 12æœˆ 9æ—¥","externalUrl":null,"permalink":"/posts/251209231724_create-aws-architecture-diagram-with-drawio/","section":"Posts","summary":"","title":"draw.ioã§AWSã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£å›³ã‚’ä½œæˆã™ã‚‹","type":"posts"},{"content":" ä»Šæ—¥å­¦ã‚“ã ã“ã¨ # Terraform movedãƒ–ãƒ­ãƒƒã‚¯ã‚’ä½¿ã£ã¦ã€æ—¢å­˜ã®Terraformãƒªã‚½ãƒ¼ã‚¹ã‚’ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ ãªã—ã§moduleåŒ–ã—ã¾ã—ãŸã€‚movedãƒ–ãƒ­ãƒƒã‚¯ã¯Stateã®å‚ç…§å…ˆã ã‘ã‚’å¤‰æ›´ã—ã€å®Ÿãƒªã‚½ãƒ¼ã‚¹ã«ã¯è§¦ã‚Œãšã«ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã§ãã‚‹æ©Ÿèƒ½ã§ã™ã€‚\nå­¦ç¿’å†…å®¹ # èƒŒæ™¯ã¨èª²é¡Œ # å€‹äººãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§æ§‹ç¯‰ã—ãŸAWSã‚¤ãƒ³ãƒ•ãƒ©ï¼ˆS3ã€CloudFrontã€IAMç­‰ï¼‰ã‚’Terraform moduleåŒ–ã—ãŸã„ã¨è€ƒãˆã¾ã—ãŸã€‚æœ€åˆã¯environments/prod/ã«å…¨ãƒªã‚½ãƒ¼ã‚¹ã‚’ãƒ™ã‚¿æ›¸ãã—ã¦ã„ã¾ã—ãŸãŒã€å†åˆ©ç”¨æ€§ã¨å¯èª­æ€§ã®ãŸã‚ã«moduleæ§‹æˆã«ç§»è¡Œã™ã‚‹ã“ã¨ã«ã—ã¾ã—ãŸã€‚\nã—ã‹ã—ã€å˜ç´”ã«moduleã«ç§»å‹•ã™ã‚‹ã¨ã€Terraformã¯ã€Œæ—§ãƒªã‚½ãƒ¼ã‚¹ã‚’å‰Šé™¤ â†’ æ–°è¦ä½œæˆã€ã¨åˆ¤æ–­ã—ã¾ã™ã€‚æœ¬ç•ªç¨¼åƒä¸­ã®ã‚µã‚¤ãƒˆã§ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ ãŒç™ºç”Ÿã—ã¦ã—ã¾ã†å•é¡ŒãŒã‚ã‚Šã¾ã—ãŸã€‚\nmovedãƒ–ãƒ­ãƒƒã‚¯ã¨ã¯ # Terraform 1.1ã§å°å…¥ã•ã‚ŒãŸæ©Ÿèƒ½ã§ã™ã€‚Stateã®å‚ç…§å…ˆã ã‘ã‚’å¤‰æ›´ã—ã€å®Ÿãƒªã‚½ãƒ¼ã‚¹ã«ã¯è§¦ã‚‰ãšã«ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã§ãã¾ã™ã€‚\nmoved { from = aws_s3_bucket.content # æ—§ãƒ‘ã‚¹ to = module.s3_content.aws_s3_bucket.this # æ–°ãƒ‘ã‚¹ } å®Ÿè·µï¼šS3ãƒã‚±ãƒƒãƒˆã®moduleåŒ– # Step 1: moduleã¨å‘¼ã³å‡ºã—å…ƒã®æ§‹æˆ # â”œâ”€â”€ environments/prod/ â”‚ â””â”€â”€ main.tf â† movedãƒ–ãƒ­ãƒƒã‚¯ã‚’è¨˜è¿° â””â”€â”€ modules/s3-content/ â”œâ”€â”€ main.tf â”œâ”€â”€ outputs.tf â””â”€â”€ variables.tf Step 2: moduleå‘¼ã³å‡ºã—ã¨movedãƒ–ãƒ­ãƒƒã‚¯ã‚’è¨˜è¿° # # environments/prod/main.tf module \u0026#34;s3_content\u0026#34; { source = \u0026#34;../../modules/s3-content\u0026#34; bucket_name = \u0026#34;example-content\u0026#34; } # Stateç§»è¡Œ moved { from = aws_s3_bucket.content to = module.s3_content.aws_s3_bucket.this } moved { from = aws_s3_bucket_public_access_block.content to = module.s3_content.aws_s3_bucket_public_access_block.this } Step 3: terraform planã§ç¢ºèª # $ terraform plan # Terraform will perform the following actions: # # aws_s3_bucket.content has moved to module.s3_content.aws_s3_bucket.this # Plan: 0 to add, 0 to change, 0 to destroy. 0 to add, 0 to change, 0 to destroyã¨è¡¨ç¤ºã•ã‚Œã‚Œã°æˆåŠŸã§ã™ã€‚Stateã®å‚ç…§ãŒå¤‰ã‚ã‚‹ã ã‘ã§ã€S3ãƒã‚±ãƒƒãƒˆè‡ªä½“ã¯å¤‰æ›´ã•ã‚Œã¾ã›ã‚“ã€‚\nStep 4: terraform apply # $ terraform apply Apply complete! Resources: 0 added, 0 changed, 0 destroyed. ãƒãƒã£ãŸãƒã‚¤ãƒ³ãƒˆ # å‹•çš„ãªåå‰ç”Ÿæˆã«ã‚ˆã‚‹å†ä½œæˆ # moduleå†…ã§ãƒªã‚½ãƒ¼ã‚¹åã‚’å‹•çš„ç”Ÿæˆã™ã‚‹ã¨ã€æ—¢å­˜ãƒªã‚½ãƒ¼ã‚¹ã¨åå‰ãŒå¤‰ã‚ã£ã¦å†ä½œæˆãŒç™ºç”Ÿã™ã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚\n# âŒ ã“ã‚Œã ã¨å†ä½œæˆãŒç™ºç”Ÿã™ã‚‹å¯èƒ½æ€§ resource \u0026#34;aws_cloudfront_function\u0026#34; \u0026#34;this\u0026#34; { name = \u0026#34;${var.name_prefix}-url-rewrite\u0026#34; } è§£æ±ºç­–ã¨ã—ã¦ã€å¤‰æ•°ã§æ—¢å­˜ã®åå‰ã‚’æ˜ç¤ºçš„ã«æ¸¡ã—ã¾ã™ã€‚\n# âœ… æ—¢å­˜åã‚’å¤‰æ•°ã§æ¸¡ã™ variable \u0026#34;function_name\u0026#34; { type = string } resource \u0026#34;aws_cloudfront_function\u0026#34; \u0026#34;this\u0026#34; { name = var.function_name } movedãƒ–ãƒ­ãƒƒã‚¯ã¯applyå¾Œã«å‰Šé™¤å¯èƒ½ # movedãƒ–ãƒ­ãƒƒã‚¯ã¯applyå¾Œã€Stateã«åæ˜ æ¸ˆã¿ã§ã‚ã‚Œã°å‰Šé™¤ã—ã¦å•é¡Œã‚ã‚Šã¾ã›ã‚“ã€‚æ®‹ã—ã¦ãŠãã¨ã‚³ãƒ¼ãƒ‰ãŒç…©é›‘ã«ãªã‚‹ãŸã‚ã€é©å®œæ•´ç†ã—ã¾ã™ã€‚\ndata sourceã¯movedãƒ–ãƒ­ãƒƒã‚¯ä¸è¦ # æ—¢å­˜ãƒªã‚½ãƒ¼ã‚¹ã‚’å‚ç…§ã™ã‚‹ã ã‘ã®data sourceã¯Stateç§»è¡ŒãŒä¸è¦ã§ã™ã€‚ãã®ã¾ã¾moduleåŒ–ã§ãã¾ã™ã€‚\n# å‚ç…§ã®ã¿ãªã®ã§movedãƒ–ãƒ­ãƒƒã‚¯ä¸è¦ data \u0026#34;aws_acm_certificate\u0026#34; \u0026#34;this\u0026#34; { domain = var.domain_name statuses = [\u0026#34;ISSUED\u0026#34;] most_recent = true } ã¾ã¨ã‚ # ãƒã‚¤ãƒ³ãƒˆ å†…å®¹ movedãƒ–ãƒ­ãƒƒã‚¯ã®ç”¨é€” æ—¢å­˜ãƒªã‚½ãƒ¼ã‚¹ã‚’å£Šã•ãšã«moduleåŒ–ãƒ»ãƒªãƒãƒ¼ãƒ  æˆåŠŸã®ç¢ºèªæ–¹æ³• Plan: 0 to add, 0 to change, 0 to destroy applyå¾Œã®æ‰±ã„ movedãƒ–ãƒ­ãƒƒã‚¯ã¯å‰Šé™¤å¯èƒ½ data sourceã®æ‰±ã„ å‚ç…§ã®ã¿ãªã®ã§Stateç§»è¡Œä¸è¦ åå‰å¤‰æ›´ã«æ³¨æ„ å‹•çš„ç”Ÿæˆã§åå‰ãŒå¤‰ã‚ã‚‹ã¨å†ä½œæˆã•ã‚Œã‚‹ è£œè¶³ï¼šå€‹äººé–‹ç™ºã§moduleåŒ–ã¯å¿…è¦ã ã£ãŸã‹ï¼Ÿ # æ­£ç›´ã€ç¾æ®µéšã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã¯ä¸è¦ã ã£ãŸã¨æ€ã„ã¾ã™ã€‚\nä»Šå›ã¯ãƒ–ãƒ­ã‚°ç’°å¢ƒã‚’AWSã¸ç§»è¡Œã™ã‚‹ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§movedãƒ–ãƒ­ãƒƒã‚¯ã‚’ä½¿ç”¨ã—ã¾ã—ãŸã€‚\nãŸã ã€ä»¥ä¸‹ã®ç†ç”±ã§moduleåŒ–ã‚’é¸æŠã—ã¾ã—ãŸã€‚\nè¦³ç‚¹ ç†ç”± å°†æ¥ã®æ‹¡å¼µæ€§ ãƒ†ã‚¹ãƒˆå®Ÿè£…ã‚„ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¹ã‚­ãƒ£ãƒ³å°å…¥æ™‚ã€moduleå˜ä½ã§æ¤œè¨¼ã§ãã‚‹ å®Ÿå‹™çµŒé¨“ã®ä»£æ›¿ å®Ÿå‹™ã§ã¯moduleåŒ–ãŒä¸€èˆ¬çš„ã€‚è¨­è¨ˆãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’çµŒé¨“ã—ã¦ãŠããŸã‹ã£ãŸ å­¦ç¿’åŠ¹æœ movedãƒ–ãƒ­ãƒƒã‚¯ã€ãƒãƒ«ãƒãƒªãƒ¼ã‚¸ãƒ§ãƒ³providerã€ä¾å­˜é–¢ä¿‚è¨­è¨ˆã‚’ä¸€åº¦ã«å­¦ã¹ãŸ ã€Œä»Šå¿…è¦ã‹ã€ã ã‘ã§ãªãã€Œå°†æ¥æ‹¡å¼µã—ã‚„ã™ã„ã‹ã€ã€Œå­¦ç¿’ã¨ã—ã¦ä¾¡å€¤ãŒã‚ã‚‹ã‹ã€ã‚‚åˆ¤æ–­è»¸ã«å…¥ã‚Œã¾ã—ãŸã€‚\nå‚è€ƒ # Refactoring - Terraform Terraform ã®ã¤ã¾ãšããƒã‚¤ãƒ³ãƒˆã¨å›é¿ç­– ","date":"2025å¹´ 12æœˆ 8æ—¥","externalUrl":null,"permalink":"/posts/251208082023_terraform-moved-block-module-without-breaking-production-resources/","section":"Posts","summary":"","title":"Terraform movedãƒ–ãƒ­ãƒƒã‚¯ã§ãƒªã‚½ãƒ¼ã‚¹ã‚’å£Šã•ãšã«moduleåŒ–ã™ã‚‹","type":"posts"},{"content":"","date":"2025å¹´ 12æœˆ 8æ—¥","externalUrl":null,"permalink":"/tags/github/","section":"Tags","summary":"","title":"GitHub","type":"tags"},{"content":" ä»Šæ—¥å­¦ã‚“ã ã“ã¨ # GitHub Actions + OIDCèªè¨¼ã‚’ä½¿ã†ã“ã¨ã§ã€ã‚¢ã‚¯ã‚»ã‚¹ã‚­ãƒ¼ã‚’ä¸€åˆ‡ä¿å­˜ã›ãšã«AWSã¸å®‰å…¨ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ã“ã¨ã‚’å­¦ã³ã¾ã—ãŸã€‚ä¸€æ™‚çš„ãªèªè¨¼æƒ…å ±ï¼ˆ15åˆ†ã§æœŸé™åˆ‡ã‚Œï¼‰ã‚’ä½¿ç”¨ã™ã‚‹ãŸã‚ã€å¾“æ¥ã®ã‚¢ã‚¯ã‚»ã‚¹ã‚­ãƒ¼æ–¹å¼ã¨æ¯”ã¹ã¦ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒªã‚¹ã‚¯ã‚’å¤§å¹…ã«è»½æ¸›ã§ãã¾ã™ã€‚\nå­¦ç¿’å†…å®¹ # ãªãœOIDCèªè¨¼ã‚’é¸ã¶ã®ã‹ # æœ€åˆã¯ã€Œã‚¢ã‚¯ã‚»ã‚¹ã‚­ãƒ¼ã‚’GitHubã®ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆã«ä¿å­˜ã™ã‚Œã°ç°¡å˜ã€ã¨è€ƒãˆã¾ã—ãŸãŒã€èª¿ã¹ã¦ã„ãã†ã¡ã«OIDCèªè¨¼ã®æ–¹ãŒã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£é¢ã§å„ªã‚Œã¦ã„ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã—ãŸã€‚\nè¦³ç‚¹ ã‚¢ã‚¯ã‚»ã‚¹ã‚­ãƒ¼ OIDC èªè¨¼æƒ…å ±ã®ä¿å­˜ GitHubã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆã«ä¿å­˜ãŒå¿…è¦ ä¿å­˜ä¸è¦ æœ‰åŠ¹æœŸé™ ç„¡æœŸé™ï¼ˆæ‰‹å‹•ã§ãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ï¼‰ 15åˆ†ã§è‡ªå‹•æœŸé™åˆ‡ã‚Œ æ¼æ´©ãƒªã‚¹ã‚¯ ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆæ¼æ´©ã§æ°¸ç¶šçš„ãªã‚¢ã‚¯ã‚»ã‚¹ ãƒˆãƒ¼ã‚¯ãƒ³ã¯çŸ­å‘½ã§å†åˆ©ç”¨ä¸å¯ æ¨©é™ã®ç²’åº¦ IAMãƒ¦ãƒ¼ã‚¶ãƒ¼å˜ä½ ãƒªãƒã‚¸ãƒˆãƒªãƒ»ãƒ–ãƒ©ãƒ³ãƒå˜ä½ã§åˆ¶é™å¯èƒ½ ã‚¢ã‚¯ã‚»ã‚¹ã‚­ãƒ¼ã¯ã€Œæ¼æ´©ã—ãŸã‚‰çµ‚ã‚ã‚Šã€ã§ã™ãŒã€OIDCã¯æœ€åˆã‹ã‚‰æ¼æ´©ãƒªã‚¹ã‚¯ãŒã‚ã‚Šã¾ã›ã‚“ã€‚AWS/GitHubå…¬å¼ã‚‚OIDCã‚’æ¨å¥¨ã—ã¦ã„ã¾ã™ã€‚\nOIDCã®èªè¨¼ãƒ•ãƒ­ãƒ¼ # 1. GitHub Actions ãŒ GitHub OIDC Provider ã«ãƒˆãƒ¼ã‚¯ãƒ³ã‚’è¦æ±‚ â†“ 2. GitHub OIDC Provider ãŒãƒˆãƒ¼ã‚¯ãƒ³ã‚’ç™ºè¡Œï¼ˆãƒªãƒã‚¸ãƒˆãƒªåã€ãƒ–ãƒ©ãƒ³ãƒåã‚’å«ã‚€ï¼‰ â†“ 3. AWS STS ãŒãƒˆãƒ¼ã‚¯ãƒ³ã‚’æ¤œè¨¼ã—ã€ä¿¡é ¼ãƒãƒªã‚·ãƒ¼ã®æ¡ä»¶ã‚’ç¢ºèª â†“ 4. æ¡ä»¶ã‚’æº€ãŸã›ã°ã€ä¸€æ™‚èªè¨¼æƒ…å ±ã‚’ç™ºè¡Œï¼ˆ15åˆ†æœ‰åŠ¹ï¼‰ â†“ 5. GitHub Actions ãŒä¸€æ™‚èªè¨¼æƒ…å ±ã§AWSãƒªã‚½ãƒ¼ã‚¹ã«ã‚¢ã‚¯ã‚»ã‚¹ GitHubå´ã§OIDCãƒˆãƒ¼ã‚¯ãƒ³ãŒç™ºè¡Œã•ã‚Œã€ãƒˆãƒ¼ã‚¯ãƒ³ã«ã¯ã€Œã©ã®ãƒªãƒã‚¸ãƒˆãƒªã®ã€ã©ã®ãƒ–ãƒ©ãƒ³ãƒã‹ã‚‰ã€ã¨ã„ã†æƒ…å ±ãŒå«ã¾ã‚Œã¾ã™ã€‚AWSå´ã§ãã®æƒ…å ±ã‚’æ¤œè¨¼ã—ã€æ¡ä»¶ã‚’æº€ãŸã›ã°ä¸€æ™‚èªè¨¼æƒ…å ±ã‚’ç™ºè¡Œã—ã¾ã™ã€‚\nå®Ÿè£…æ‰‹é † # OIDCèªè¨¼ã®è¨­å®šã¯ã€Œå…±é€šéƒ¨åˆ†ã€ã¨ã€Œãƒ‡ãƒ—ãƒ­ã‚¤å…ˆã«å¿œã˜ãŸæ¨©é™è¨­å®šã€ã®2ã¤ã«åˆ†ã‹ã‚Œã¾ã™ã€‚\nStep 1: å…±é€šè¨­å®šï¼ˆOIDC Provider + IAMãƒ­ãƒ¼ãƒ«ï¼‰ # ã©ã®AWSã‚µãƒ¼ãƒ“ã‚¹ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹å ´åˆã§ã‚‚ã€ã“ã®è¨­å®šã¯å…±é€šã§ã™ã€‚\n# 1. OIDC Providerï¼ˆGitHubã¨AWSã‚’ç¹‹ãè¨­å®šï¼‰ resource \u0026#34;aws_iam_openid_connect_provider\u0026#34; \u0026#34;github\u0026#34; { url = \u0026#34;https://token.actions.githubusercontent.com\u0026#34; client_id_list = [\u0026#34;sts.amazonaws.com\u0026#34;] thumbprint_list = [\u0026#34;ffffffffffffffffffffffffffffffffffffffff\u0026#34;] } # 2. IAMãƒ­ãƒ¼ãƒ«ï¼ˆGitHub ActionsãŒå¼•ãå—ã‘ã‚‹ãƒ­ãƒ¼ãƒ«ï¼‰ resource \u0026#34;aws_iam_role\u0026#34; \u0026#34;github_actions\u0026#34; { name = \u0026#34;github-actions-deploy-role\u0026#34; assume_role_policy = jsonencode({ Version = \u0026#34;2012-10-17\u0026#34; Statement = [ { Effect = \u0026#34;Allow\u0026#34; Principal = { Federated = aws_iam_openid_connect_provider.github.arn } Action = \u0026#34;sts:AssumeRoleWithWebIdentity\u0026#34; Condition = { StringEquals = { \u0026#34;token.actions.githubusercontent.com:aud\u0026#34; = \u0026#34;sts.amazonaws.com\u0026#34; } StringLike = { # ãƒªãƒã‚¸ãƒˆãƒªãƒ»ãƒ–ãƒ©ãƒ³ãƒã‚’åˆ¶é™ \u0026#34;token.actions.githubusercontent.com:sub\u0026#34; = \u0026#34;repo:\u0026lt;OWNER\u0026gt;/\u0026lt;REPO\u0026gt;:ref:refs/heads/main\u0026#34; } } } ] }) } thumbprintã«ã¤ã„ã¦ï¼š2023å¹´7æœˆä»¥é™ã€AWSã¯GitHub OIDCã®è¨¼æ˜æ›¸ã‚’è‡ªå‹•æ¤œè¨¼ã™ã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚ãã®ãŸã‚ã€ä»»æ„ã®å€¤ã§ã‚‚å‹•ä½œã—ã¾ã™ã€‚\nStep 2: ãƒ‡ãƒ—ãƒ­ã‚¤å…ˆã«å¿œã˜ãŸæ¨©é™è¨­å®šï¼ˆIAMãƒãƒªã‚·ãƒ¼ï¼‰ # IAMãƒãƒªã‚·ãƒ¼ã¯ãƒ‡ãƒ—ãƒ­ã‚¤å…ˆã«ã‚ˆã£ã¦å¤‰ã‚ã‚Šã¾ã™ã€‚ä»Šå›ã¯S3 + CloudFrontã¸ã®é™çš„ã‚µã‚¤ãƒˆé…ä¿¡ã‚’ä¾‹ã«èª¬æ˜ã—ã¾ã™ã€‚\nresource \u0026#34;aws_iam_role_policy\u0026#34; \u0026#34;github_actions\u0026#34; { name = \u0026#34;github-actions-deploy-policy\u0026#34; role = aws_iam_role.github_actions.id policy = jsonencode({ Version = \u0026#34;2012-10-17\u0026#34; Statement = [ { Effect = \u0026#34;Allow\u0026#34; Action = [ \u0026#34;s3:PutObject\u0026#34;, \u0026#34;s3:GetObject\u0026#34;, \u0026#34;s3:DeleteObject\u0026#34;, \u0026#34;s3:ListBucket\u0026#34; ] Resource = [ \u0026#34;arn:aws:s3:::\u0026lt;BUCKET_NAME\u0026gt;\u0026#34;, \u0026#34;arn:aws:s3:::\u0026lt;BUCKET_NAME\u0026gt;/*\u0026#34; ] }, { Effect = \u0026#34;Allow\u0026#34; Action = [ \u0026#34;cloudfront:CreateInvalidation\u0026#34; ] Resource = \u0026#34;arn:aws:cloudfront::\u0026lt;ACCOUNT_ID\u0026gt;:distribution/\u0026lt;DISTRIBUTION_ID\u0026gt;\u0026#34; } ] }) } æ¨©é™ ç”¨é€” s3:PutObject ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ s3:GetObject syncæ™‚ã®å·®åˆ†æ¯”è¼ƒ s3:DeleteObject --deleteã‚ªãƒ—ã‚·ãƒ§ãƒ³ s3:ListBucket ãƒã‚±ãƒƒãƒˆå†…ä¸€è¦§å–å¾— cloudfront:CreateInvalidation ã‚­ãƒ£ãƒƒã‚·ãƒ¥ç„¡åŠ¹åŒ– Step 3: GitHub Actionså´ã®è¨­å®š # name: Deploy to AWS on: push: branches: - main permissions: id-token: write # OIDCãƒˆãƒ¼ã‚¯ãƒ³å–å¾—ã«å¿…é ˆ contents: read jobs: deploy: runs-on: ubuntu-latest steps: - name: Checkout uses: actions/checkout@v4 - name: Configure AWS Credentials uses: aws-actions/configure-aws-credentials@v4 with: role-to-assume: arn:aws:iam::\u0026lt;ACCOUNT_ID\u0026gt;:role/github-actions-deploy-role aws-region: ap-northeast-1 # ä»¥é™ã€AWS CLIã§ãƒ‡ãƒ—ãƒ­ã‚¤æ“ä½œã‚’å®Ÿè¡Œ - name: Deploy to S3 run: aws s3 sync public/ s3://\u0026lt;BUCKET_NAME\u0026gt;/ --delete permissions: id-token: write ã‚’ä»˜ã‘ãªã„ã¨ã€GitHub ActionsãŒãƒˆãƒ¼ã‚¯ãƒ³ã‚’å–å¾—ã§ããšã«ã‚¨ãƒ©ãƒ¼ã«ãªã‚Šã¾ã™ã€‚\nè¨­è¨ˆã®ãƒã‚¤ãƒ³ãƒˆ # mainãƒ–ãƒ©ãƒ³ãƒã®ã¿ã«åˆ¶é™ã™ã‚‹ç†ç”± # \u0026#34;token.actions.githubusercontent.com:sub\u0026#34; = \u0026#34;repo:\u0026lt;OWNER\u0026gt;/\u0026lt;REPO\u0026gt;:ref:refs/heads/main\u0026#34; ã‚‚ã— *ï¼ˆãƒ¯ã‚¤ãƒ«ãƒ‰ã‚«ãƒ¼ãƒ‰ï¼‰ã«ã™ã‚‹ã¨ã€ä»»æ„ã®ãƒ–ãƒ©ãƒ³ãƒã‚„PRã‹ã‚‰ãƒ‡ãƒ—ãƒ­ã‚¤å¯èƒ½ã«ãªã‚Šã¾ã™ã€‚æ‚ªæ„ã®ã‚ã‚‹PRãŒãƒãƒ¼ã‚¸ã•ã‚Œã‚‹å‰ã«ãƒ‡ãƒ—ãƒ­ã‚¤ã•ã‚Œã‚‹ãƒªã‚¹ã‚¯ã‚’é˜²ããŸã‚ã€mainãƒ–ãƒ©ãƒ³ãƒã®ã¿ã«åˆ¶é™ã—ã¾ã—ãŸã€‚\næœ€å°æ¨©é™ã®åŸå‰‡ # IAMãƒãƒªã‚·ãƒ¼ã§ã¯ã€å¿…è¦ãªAWSã‚µãƒ¼ãƒ“ã‚¹ãƒ»ãƒªã‚½ãƒ¼ã‚¹ã®ã¿ã«æ¨©é™ã‚’é™å®šã—ã¾ã™ã€‚ä»Šå›ã®ä¾‹ã§ã¯ç‰¹å®šã®S3ãƒã‚±ãƒƒãƒˆãƒ»CloudFront Distributionã®ã¿ã‚’æŒ‡å®šã—ã¦ã„ã¾ã™ã€‚\nä»–ã®ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ã¸ã®å¿œç”¨ # OIDC Provider + IAMãƒ­ãƒ¼ãƒ«ã®ä¿¡é ¼ãƒãƒªã‚·ãƒ¼ï¼ˆStep 1ï¼‰ã¯å…±é€šã§ã€IAMãƒãƒªã‚·ãƒ¼ï¼ˆStep 2ï¼‰ã‚’å¤‰ãˆã‚‹ã ã‘ã§ä»–ã®AWSã‚µãƒ¼ãƒ“ã‚¹ã«ã‚‚å¿œç”¨ã§ãã¾ã™ã€‚\nä¾‹ãˆã°ã€EC2ã¸ã®ãƒ‡ãƒ—ãƒ­ã‚¤ã§ã‚ã‚Œã°ä»¥ä¸‹ã®ã‚ˆã†ãªæ¨©é™ãŒå¿…è¦ã«ãªã‚Šã¾ã™ã€‚\nAction = [ \u0026#34;ec2:DescribeInstances\u0026#34;, \u0026#34;ssm:SendCommand\u0026#34;, \u0026#34;ssm:GetCommandInvocation\u0026#34; ] ã¾ã¨ã‚ # OIDCèªè¨¼ã¯ã‚¢ã‚¯ã‚»ã‚¹ã‚­ãƒ¼ä¸è¦ã§ã€15åˆ†ã§è‡ªå‹•æœŸé™åˆ‡ã‚Œã®ãŸã‚å®‰å…¨ è¨­å®šã¯ã€Œå…±é€šéƒ¨åˆ†ï¼ˆOIDC Provider + IAMãƒ­ãƒ¼ãƒ«ï¼‰ã€ã¨ã€Œãƒ‡ãƒ—ãƒ­ã‚¤å…ˆã«å¿œã˜ãŸæ¨©é™ï¼ˆIAMãƒãƒªã‚·ãƒ¼ï¼‰ã€ã«åˆ†ã‹ã‚Œã‚‹ GitHub Actionså´ã§ã¯ permissions: id-token: write ã®è¨­å®šãŒå¿…é ˆ mainãƒ–ãƒ©ãƒ³ãƒã®ã¿ã«åˆ¶é™ã—ã¦æœ¬ç•ªç’°å¢ƒã‚’ä¿è­·ã™ã‚‹ IAMãƒãƒªã‚·ãƒ¼ã‚’å¤‰ãˆã‚Œã°ã€S3ä»¥å¤–ã®AWSã‚µãƒ¼ãƒ“ã‚¹ï¼ˆEC2ç­‰ï¼‰ã«ã‚‚å¿œç”¨å¯èƒ½ å‚è€ƒ # AWS Security Blog: Use IAM roles to connect GitHub Actions to actions in AWS GitHub Docs: About security hardening with OpenID Connect GitHub Docs: Configuring OpenID Connect in Amazon Web Services aws-actions/configure-aws-credentials ","date":"2025å¹´ 12æœˆ 8æ—¥","externalUrl":null,"permalink":"/posts/251208075901_github-actions-oidc-aws-authentication/","section":"Posts","summary":"","title":"GitHub Actions + OIDCèªè¨¼ã§ã‚¢ã‚¯ã‚»ã‚¹ã‚­ãƒ¼ä¸è¦ã®AWSèªè¨¼ã‚’å®Ÿç¾ã™ã‚‹","type":"posts"},{"content":" ä»Šæ—¥å­¦ã‚“ã ã“ã¨ # GitHubãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«READMEã®ä½œæˆæ–¹æ³•ã‚’å­¦ã³ã¾ã—ãŸã€‚è‡ªåˆ†ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼åã¨åŒã˜åå‰ã®ãƒªãƒã‚¸ãƒˆãƒªã‚’ä½œæˆã—ã¦README.mdã‚’é…ç½®ã™ã‚‹ã¨ã€ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ãƒšãƒ¼ã‚¸ã®ãƒˆãƒƒãƒ—ã«è‡ªå·±ç´¹ä»‹ã‚’è¡¨ç¤ºã§ãã¾ã™ã€‚\nå­¦ç¿’å†…å®¹ # GitHubãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«READMEã¨ã¯ # GitHubã«ã¯ã€Œãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«READMEã€ã¨ã„ã†æ©Ÿèƒ½ãŒã‚ã‚Šã¾ã™ã€‚è‡ªåˆ†ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼åã¨åŒã˜åå‰ã®ãƒªãƒã‚¸ãƒˆãƒªï¼ˆä¾‹ï¼šusername/usernameï¼‰ã‚’ä½œæˆã—ã€README.mdã‚’é…ç½®ã™ã‚‹ã¨ã€GitHubãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ãƒšãƒ¼ã‚¸ã®ãƒˆãƒƒãƒ—ã«è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚\né€šå¸¸ã®ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ãƒšãƒ¼ã‚¸ã§ã¯ã€ã‚¢ã‚¤ã‚³ãƒ³ãƒ»åå‰ãƒ»Bioç¨‹åº¦ã—ã‹è¡¨ç¤ºã•ã‚Œã¾ã›ã‚“ãŒã€ã“ã®æ©Ÿèƒ½ã‚’ä½¿ã†ã¨è‡ªå·±ç´¹ä»‹ã‚„ã‚¹ã‚­ãƒ«ã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç´¹ä»‹ãªã©ã‚’è‡ªç”±ã«è¨˜è¼‰ã§ãã¾ã™ã€‚\nä½œæˆæ‰‹é † # Step 1: ãƒªãƒã‚¸ãƒˆãƒªã‚’ä½œæˆ # GitHubã«ãƒ­ã‚°ã‚¤ãƒ³ å³ä¸Šã®ã€Œ+ã€â†’ã€ŒNew repositoryã€ã‚’ã‚¯ãƒªãƒƒã‚¯ Repository nameã«è‡ªåˆ†ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼åã¨åŒã˜åå‰ã‚’å…¥åŠ› ã€ŒPublicã€ã‚’é¸æŠï¼ˆPrivateã ã¨ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ã«è¡¨ç¤ºã•ã‚Œãªã„ï¼‰ ã€ŒAdd a README fileã€ã«ãƒã‚§ãƒƒã‚¯ã‚’å…¥ã‚Œã‚‹ ã€ŒCreate repositoryã€ã‚’ã‚¯ãƒªãƒƒã‚¯ ãƒ¦ãƒ¼ã‚¶ãƒ¼åã¨åŒã˜åå‰ã‚’å…¥åŠ›ã™ã‚‹ã¨ã€ä»¥ä¸‹ã®ã‚ˆã†ãªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚\nusername/username is a special repository. Its README.md will appear on your public profile.\nã“ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã‚Œã°ã€è¨­å®šã¯æ­£ã—ã„ã§ã™ã€‚\nStep 2: README.mdã‚’ç·¨é›† # ä½œæˆã•ã‚ŒãŸãƒªãƒã‚¸ãƒˆãƒªã®README.mdã‚’ç·¨é›†ã—ã¾ã™ã€‚Markdownå½¢å¼ã§è‡ªç”±ã«æ›¸ã‘ã¾ã™ã€‚\næœ€åˆã¯ä»¥ä¸‹ã®ã‚ˆã†ãªãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãŒå…¥ã£ã¦ã„ã¾ã™ã€‚\n### Hi there ğŸ‘‹ \u0026lt;!-- **username/username** is a âœ¨ _special_ âœ¨ repository because its `README.md` (this file) appears on your GitHub profile. Here are some ideas to get you started: - ğŸ”­ I\u0026#39;m currently working on ... - ğŸŒ± I\u0026#39;m currently learning ... - ... --\u0026gt; ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆã‚’å¤–ã—ã¦ç·¨é›†ã™ã‚‹ã‹ã€è‡ªåˆ†ã§ä¸€ã‹ã‚‰æ›¸ãç›´ã—ã¾ã™ã€‚\nStep 3: ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ãƒšãƒ¼ã‚¸ã§ç¢ºèª # ç·¨é›†å¾Œã€è‡ªåˆ†ã®GitHubãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ãƒšãƒ¼ã‚¸ï¼ˆhttps://github.com/usernameï¼‰ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã¨ã€README.mdã®å†…å®¹ãŒè¡¨ç¤ºã•ã‚Œã¦ã„ã¾ã™ã€‚\nä½•ã‚’æ›¸ã‘ã°ã„ã„ã‹ # æœ€åˆã¯ä½•ã‚’æ›¸ã‘ã°ã„ã„ã‹è¿·ã„ã¾ã—ãŸã€‚å‚è€ƒã¾ã§ã«ã€è‡ªåˆ†ãŒæ›¸ã„ãŸé …ç›®ã‚’ç´¹ä»‹ã—ã¾ã™ã€‚\nã‚»ã‚¯ã‚·ãƒ§ãƒ³ å†…å®¹ è‡ªå·±ç´¹ä»‹ ä½•ã‚’ã—ã¦ã„ã‚‹äººã‹ã€ä½•ã«èˆˆå‘³ãŒã‚ã‚‹ã‹ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå®Ÿç¸¾ å–ã‚Šçµ„ã‚“ã ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®æ¦‚è¦ã¨ä½¿ç”¨æŠ€è¡“ æŠ€è¡“ã‚¢ã‚¦ãƒˆãƒ—ãƒƒãƒˆ ãƒ–ãƒ­ã‚°ã‚„Zennãªã©ã®ç™ºä¿¡æ´»å‹• ã‚¹ã‚­ãƒ«ã‚»ãƒƒãƒˆ ä½¿ãˆã‚‹æŠ€è¡“ã‚’ã‚«ãƒ†ã‚´ãƒªåˆ¥ã«æ•´ç† ä¿æœ‰è³‡æ ¼ å–å¾—ã—ãŸè³‡æ ¼ã‚’å¹´åº¦é †ã« é€£çµ¡å…ˆ SNSã‚„ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ å®Ÿéš›ã«æ›¸ã„ã¦ã¿ãŸä¾‹ # å‚è€ƒã¨ã—ã¦ã€è‡ªåˆ†ã®ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«READMEã‚’è¼‰ã›ã¦ãŠãã¾ã™ã€‚\nGitHub: https://github.com/mr110825\næ­£ç›´ã€æœ€åˆã¯ã‚‚ã£ã¨ã‚·ãƒ³ãƒ—ãƒ«ã§ã—ãŸã€‚ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãŒå®Œæˆã—ãŸã‚Šã€è³‡æ ¼ã‚’å–å¾—ã—ãŸã‚Šã™ã‚‹ãŸã³ã«å°‘ã—ãšã¤æ›´æ–°ã—ã¦ã„ã¾ã™ã€‚\næ›¸ã„ã¦ã¿ã¦æ°—ã¥ã„ãŸã“ã¨ # å®Ÿéš›ã«ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«READMEã‚’æ›¸ã„ã¦ã¿ã¦ã€ã„ãã¤ã‹æ°—ã¥ã„ãŸã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚\nå®Œæˆã—ãŸã‚‚ã®ã‚’ä¸Šã«ç½®ã\nä½œæˆä¸­ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚ˆã‚Šã€å®Œæˆã—ãŸãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’å…ˆã«æ›¸ã„ãŸæ–¹ãŒè¦‹æ „ãˆãŒè‰¯ã„ã¨æ„Ÿã˜ã¾ã—ãŸã€‚è¦‹ã‚‹äººã¯æœ€åˆã®æ•°ç§’ã§åˆ¤æ–­ã™ã‚‹ã®ã§ã€ã‚¢ãƒ”ãƒ¼ãƒ«ã§ãã‚‹ã‚‚ã®ã‚’ä¸Šã«æŒã£ã¦ãã‚‹ã®ãŒè‰¯ã•ãã†ã§ã™ã€‚\nã€Œå­¦ç¿’ä¸­ã€ã‚ˆã‚Šå…·ä½“çš„ãªå†…å®¹ã‚’æ›¸ã\nã€ŒTerraformå­¦ç¿’ä¸­ã€ã‚ˆã‚Šã€ŒTerraformã§â—‹â—‹ã‚’æ§‹ç¯‰ã€ã®ã‚ˆã†ã«ã€ä½•ã‚’ã—ãŸã‹å…·ä½“çš„ã«æ›¸ã„ãŸæ–¹ãŒä¼ã‚ã‚Šã‚„ã™ã„ã¨æ€ã„ã¾ã—ãŸã€‚\nãƒ†ãƒ¼ãƒ–ãƒ«å½¢å¼ã¯è¦‹ã‚„ã™ã„\nè³‡æ ¼ã‚„ã‚¹ã‚­ãƒ«ã‚»ãƒƒãƒˆãªã©ã€é …ç›®ãŒå¤šã„ã‚‚ã®ã¯ãƒ†ãƒ¼ãƒ–ãƒ«å½¢å¼ã«ã™ã‚‹ã¨ä¸€è¦§æ€§ãŒé«˜ããªã‚Šã¾ã—ãŸã€‚\nã¾ã¨ã‚ # ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«READMEã¯username/usernameãƒªãƒã‚¸ãƒˆãƒªã®README.mdã«æ›¸ã ãƒªãƒã‚¸ãƒˆãƒªã¯Publicã«ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ Markdownå½¢å¼ã§è‡ªç”±ã«è‡ªå·±ç´¹ä»‹ã‚’æ›¸ã‘ã‚‹ å®Œæˆã—ãŸãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚„å…·ä½“çš„ãªå®Ÿç¸¾ã‚’ä¸Šä½ã«ç½®ãã¨åŠ¹æœçš„ å‚è€ƒ # Managing your profile README - GitHub Docs è‡ªåˆ†ã®ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ« ","date":"2025å¹´ 12æœˆ 7æ—¥","externalUrl":null,"permalink":"/posts/251207233715_github-profile-readme-creation/","section":"Posts","summary":"","title":"GitHubãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«READMEã‚’ä½œæˆã—ã¦ã¿ãŸ","type":"posts"},{"content":"","date":"2025å¹´ 12æœˆ 7æ—¥","externalUrl":null,"permalink":"/tags/%E3%83%A1%E3%83%A2/","section":"Tags","summary":"","title":"ãƒ¡ãƒ¢","type":"tags"},{"content":"","date":"2025å¹´ 12æœˆ 7æ—¥","externalUrl":null,"permalink":"/tags/google/","section":"Tags","summary":"","title":"Google","type":"tags"},{"content":" ä»Šæ—¥å­¦ã‚“ã ã“ã¨ # Google Search Consoleã®ãƒ‰ãƒ¡ã‚¤ãƒ³æ‰€æœ‰æ¨©æ¤œè¨¼ã‚’Terraformã§ç®¡ç†ã™ã‚‹æ–¹æ³•ã‚’å­¦ã³ã¾ã—ãŸã€‚DNSæ¤œè¨¼ï¼ˆTXTãƒ¬ã‚³ãƒ¼ãƒ‰ï¼‰ã‚’é¸æŠã™ã‚‹ã“ã¨ã§ã€IaCã®ä¸€è²«æ€§ã‚’ä¿ã¡ãªãŒã‚‰Search Consoleã®è¨­å®šã‚’è¡Œãˆã¾ã™ã€‚\nå‰ææ¡ä»¶ # AWSã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’æŒã£ã¦ã„ã‚‹ Route53ã§ãƒ›ã‚¹ãƒˆã‚¾ãƒ¼ãƒ³ãŒä½œæˆæ¸ˆã¿ Terraformã®åŸºæœ¬æ“ä½œï¼ˆinit, plan, applyï¼‰ã‚’ç†è§£ã—ã¦ã„ã‚‹ å­¦ç¿’å†…å®¹ # æ¤œè¨¼æ–¹å¼ã®é¸æŠ # Google Search Consoleã«ã¯è¤‡æ•°ã®æ‰€æœ‰æ¨©æ¤œè¨¼æ–¹å¼ãŒã‚ã‚Šã¾ã™ã€‚\næ¤œè¨¼æ–¹å¼ æ¦‚è¦ Terraformç®¡ç† DNSæ¤œè¨¼ï¼ˆTXTãƒ¬ã‚³ãƒ¼ãƒ‰ï¼‰ ãƒ‰ãƒ¡ã‚¤ãƒ³ã®DNSã«TXTãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’è¿½åŠ  âœ… å¯èƒ½ HTMLãƒ•ã‚¡ã‚¤ãƒ« æŒ‡å®šã•ã‚ŒãŸHTMLãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚µã‚¤ãƒˆã«é…ç½® â–³ ãƒ“ãƒ«ãƒ‰ã«å«ã‚ã‚‹å¿…è¦ã‚ã‚Š metaã‚¿ã‚° HTMLã®headã«metaã‚¿ã‚°ã‚’è¿½åŠ  â–³ ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆä¿®æ­£ãŒå¿…è¦ Google Analytics æ—¢å­˜ã®GAè¨­å®šã‚’åˆ©ç”¨ âŒ ä¸å¯ IaCã®ä¸€è²«æ€§ã‚’ä¿ã¤ãŸã‚ã€DNSæ¤œè¨¼ã‚’æ¡ç”¨ã—ã¾ã—ãŸã€‚\nå®Ÿè£…æ‰‹é † # Step 1: Google Search Consoleã§TXTãƒ¬ã‚³ãƒ¼ãƒ‰å€¤ã‚’å–å¾— # Google Search Consoleã«ã‚¢ã‚¯ã‚»ã‚¹ ã€Œãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’è¿½åŠ ã€â†’ã€Œãƒ‰ãƒ¡ã‚¤ãƒ³ã€ã‚’é¸æŠ ãƒ‰ãƒ¡ã‚¤ãƒ³åã‚’å…¥åŠ› è¡¨ç¤ºã•ã‚ŒãŸTXTãƒ¬ã‚³ãƒ¼ãƒ‰å€¤ã‚’ã‚³ãƒ”ãƒ¼ å–å¾—ã§ãã‚‹å€¤ã®å½¢å¼ï¼š\ngoogle-site-verification=XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX Step 2: Terraformã‚³ãƒ¼ãƒ‰ã®ä½œæˆ # ä»¥ä¸‹ã¯ã€Route53ã«Google Search Consoleæ¤œè¨¼ç”¨ã®TXTãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆã™ã‚‹ã‚³ãƒ¼ãƒ‰ä¾‹ã§ã™ã€‚\næ³¨æ„: ã“ã®ã‚³ãƒ¼ãƒ‰ã¯å€‹äººãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ä½¿ç”¨ã—ãŸã‚‚ã®ã§ã™ã€‚å®Ÿéš›ã«åˆ©ç”¨ã™ã‚‹éš›ã¯ã€ã”è‡ªèº«ã®ç’°å¢ƒã«åˆã‚ã›ã¦èª¿æ•´ã—ã¦ãã ã•ã„ã€‚\nvariables.tf\nvariable \u0026#34;domain_name\u0026#34; { description = \u0026#34;ãƒ‰ãƒ¡ã‚¤ãƒ³å\u0026#34; type = string } variable \u0026#34;google_site_verification\u0026#34; { description = \u0026#34;Google Search Consoleæ¤œè¨¼ç”¨ã®TXTãƒ¬ã‚³ãƒ¼ãƒ‰å€¤\u0026#34; type = string } main.tf\ndata \u0026#34;aws_route53_zone\u0026#34; \u0026#34;this\u0026#34; { name = var.domain_name } resource \u0026#34;aws_route53_record\u0026#34; \u0026#34;google_site_verification\u0026#34; { zone_id = data.aws_route53_zone.this.zone_id name = var.domain_name type = \u0026#34;TXT\u0026#34; ttl = 300 records = [var.google_site_verification] } terraform.tfvars\ndomain_name = \u0026#34;example.com\u0026#34; google_site_verification = \u0026#34;google-site-verification=XXXXXXXXXXXX\u0026#34; Step 3: Terraformé©ç”¨ # terraform plan terraform apply Step 4: Search Consoleã§æ¤œè¨¼å®Œäº† # Google Search Consoleã«æˆ»ã‚Šã€ã€Œç¢ºèªã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¾ã™ã€‚DNSã®åæ˜ ã«ã¯æ•°åˆ†ã‹ã‹ã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚\nã¾ã¨ã‚ # Google Search Consoleã®DNSæ¤œè¨¼ã¯Terraformã§ç®¡ç†å¯èƒ½ TXTãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’Route53ã«è¿½åŠ ã™ã‚‹ã“ã¨ã§æ‰€æœ‰æ¨©ã‚’è¨¼æ˜ DNSæ¤œè¨¼ã¯ä¸€åº¦è¨­å®šã™ã‚Œã°æ°¸ç¶šçš„ã«æœ‰åŠ¹ å‚è€ƒ # Search Console ãƒ˜ãƒ«ãƒ— - ãƒ‰ãƒ¡ã‚¤ãƒ³ ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’è¿½åŠ ã™ã‚‹ Terraform AWS Provider - aws_route53_record fumi-til-infrastructure - GitHub ","date":"2025å¹´ 12æœˆ 7æ—¥","externalUrl":null,"permalink":"/posts/251207230407_terraform-google-search-console-dns-verification/","section":"Posts","summary":"","title":"Terraformã§Google Search Consoleã®DNSæ¤œè¨¼ã‚’ç®¡ç†ã™ã‚‹","type":"posts"},{"content":" ä»Šæ—¥å­¦ã‚“ã ã“ã¨ # GitHub Pagesã‹ã‚‰AWSï¼ˆS3 + CloudFrontï¼‰ã¸ãƒ–ãƒ­ã‚°ã‚’ç§»è¡Œã—ãŸéš›ã€ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸ã¯è¡¨ç¤ºã•ã‚Œã‚‹ãŒå€‹åˆ¥è¨˜äº‹ãƒšãƒ¼ã‚¸ã§404ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚åŸå› ã¯OACï¼ˆOrigin Access Controlï¼‰ä½¿ç”¨æ™‚ã«S3ã®é™çš„ã‚¦ã‚§ãƒ–ã‚µã‚¤ãƒˆãƒ›ã‚¹ãƒ†ã‚£ãƒ³ã‚°æ©Ÿèƒ½ãŒä½¿ãˆãšã€/posts/article/ â†’ /posts/article/index.html ã®è‡ªå‹•è£œå®ŒãŒåŠ¹ã‹ãªã„ã“ã¨ã§ã—ãŸã€‚CloudFront Functionã§viewer-requestæ™‚ã«URLãƒªãƒ©ã‚¤ãƒˆã‚’å®Ÿè£…ã—ã¦è§£æ±ºã—ã¾ã—ãŸã€‚\nå­¦ç¿’å†…å®¹ # å•é¡Œã®ç™ºç”ŸçŠ¶æ³ # GitHub Pagesã§æ­£å¸¸ã«å‹•ä½œã—ã¦ã„ãŸHugoãƒ–ãƒ­ã‚°ã‚’AWSã«ç§»è¡Œã—ãŸã¨ã“ã‚ã€ä»¥ä¸‹ã®ç—‡çŠ¶ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚\nãƒšãƒ¼ã‚¸ URL çµæœ ãƒˆãƒƒãƒ— https://example.com/ âœ… æ­£å¸¸è¡¨ç¤º è¨˜äº‹ä¸€è¦§ https://example.com/posts/ âŒ 404ã‚¨ãƒ©ãƒ¼ å€‹åˆ¥è¨˜äº‹ https://example.com/posts/article-name/ âŒ 404ã‚¨ãƒ©ãƒ¼ åŸå› ã®ç‰¹å®š # S3ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹æ–¹å¼ã®é•ã„ãŒåŸå› ã§ã—ãŸã€‚\næ–¹å¼ index.htmlè‡ªå‹•è£œå®Œ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ é™çš„ã‚¦ã‚§ãƒ–ã‚µã‚¤ãƒˆãƒ›ã‚¹ãƒ†ã‚£ãƒ³ã‚° âœ… ã‚ã‚Š âŒ ãƒ‘ãƒ–ãƒªãƒƒã‚¯å…¬é–‹ãŒå¿…è¦ OACçµŒç”±ï¼ˆä»Šå›ã®æ§‹æˆï¼‰ âŒ ãªã— âœ… S3ã¯éå…¬é–‹ã®ã¾ã¾ OACã‚’ä½¿ç”¨ã™ã‚‹å ´åˆã€S3ã¯REST APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã¨ã—ã¦ã‚¢ã‚¯ã‚»ã‚¹ã•ã‚Œã¾ã™ã€‚ã“ã®å ´åˆã€/posts/ ã¨ã„ã†ãƒªã‚¯ã‚¨ã‚¹ãƒˆã¯ã€Œposts/ã¨ã„ã†ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã€ã‚’æ¢ã—ã«è¡ŒããŸã‚ã€posts/index.html ã¯è¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚\nè§£æ±ºç­–ã®æ¯”è¼ƒ # è§£æ±ºç­– å®Ÿè¡Œå ´æ‰€ ãƒ¬ã‚¤ãƒ†ãƒ³ã‚· ã‚³ã‚¹ãƒˆ æ¡ç”¨ CloudFront Function ã‚¨ãƒƒã‚¸ æ¥µå° ç„¡æ–™æ å¤§ âœ… Lambda@Edge ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ å° å¾“é‡èª²é‡‘ - S3é™çš„ãƒ›ã‚¹ãƒ†ã‚£ãƒ³ã‚° - - - âŒ OACä¸å¯ CloudFront Functionã‚’æ¡ç”¨ã—ãŸç†ç”±ã¯ã€å˜ç´”ãªURLãƒªãƒ©ã‚¤ãƒˆã«ã¯ååˆ†ãªæ©Ÿèƒ½ãŒã‚ã‚Šã€ç„¡æ–™æ ãŒå¤§ããï¼ˆæœˆ200ä¸‡ãƒªã‚¯ã‚¨ã‚¹ãƒˆï¼‰ã€ã‚¨ãƒƒã‚¸ã§å®Ÿè¡Œã•ã‚Œã‚‹ãŸã‚ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·ã¸ã®å½±éŸ¿ãŒæœ€å°é™ã ã‹ã‚‰ã§ã™ã€‚\nè§£æ±ºç­–ï¼šCloudFront Functionã«ã‚ˆã‚‹URLãƒªãƒ©ã‚¤ãƒˆ # viewer-requestã‚¤ãƒ™ãƒ³ãƒˆã§URLã‚’æ›¸ãæ›ãˆã€æœ«å°¾ã« index.html ã‚’ä»˜ä¸ã—ã¾ã™ã€‚\nfunction handler(event) { var request = event.request; var uri = request.uri; // æœ«å°¾ãŒ `/` ã®å ´åˆ â†’ `/index.html` ã‚’ä»˜ä¸ if (uri.endsWith(\u0026#39;/\u0026#39;)) { request.uri += \u0026#39;index.html\u0026#39;; } // æ‹¡å¼µå­ãŒãªã„å ´åˆ â†’ `/index.html` ã‚’ä»˜ä¸ else if (!uri.includes(\u0026#39;.\u0026#39;)) { request.uri += \u0026#39;/index.html\u0026#39;; } return request; } å‡¦ç†ãƒ•ãƒ­ãƒ¼ã®å›³è§£ # ãƒªã‚¯ã‚¨ã‚¹ãƒˆ: /posts/article/ â†“ CloudFront Functionï¼ˆviewer-requestï¼‰ â†“ URIæ›¸ãæ›ãˆ: /posts/article/index.html â†“ S3ã‹ã‚‰ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå–å¾— â†“ ãƒ¬ã‚¹ãƒãƒ³ã‚¹: 200 OK Terraformã§ã®å®Ÿè£… # resource \u0026#34;aws_cloudfront_function\u0026#34; \u0026#34;rewrite\u0026#34; { name = \u0026#34;url-rewrite\u0026#34; runtime = \u0026#34;cloudfront-js-2.0\u0026#34; publish = true code = \u0026lt;\u0026lt;-EOF function handler(event) { var request = event.request; var uri = request.uri; if (uri.endsWith(\u0026#39;/\u0026#39;)) { request.uri += \u0026#39;index.html\u0026#39;; } else if (!uri.includes(\u0026#39;.\u0026#39;)) { request.uri += \u0026#39;/index.html\u0026#39;; } return request; } EOF } CloudFront Distributionã® default_cache_behavior å†…ã§ã€ã“ã®Functionã‚’ viewer-request ã‚¤ãƒ™ãƒ³ãƒˆã«é–¢é€£ä»˜ã‘ã¾ã™ã€‚\nresource \u0026#34;aws_cloudfront_distribution\u0026#34; \u0026#34;blog\u0026#34; { # ... ä»–ã®è¨­å®š ... default_cache_behavior { # ... ä»–ã®è¨­å®š ... function_association { event_type = \u0026#34;viewer-request\u0026#34; function_arn = aws_cloudfront_function.rewrite.arn } } } ãƒ‡ãƒ—ãƒ­ã‚¤ã¨å‹•ä½œç¢ºèª # 1. Terraformã§ãƒ‡ãƒ—ãƒ­ã‚¤ # terraform plan # å¤‰æ›´å†…å®¹ã‚’ç¢ºèª terraform apply # é©ç”¨ 2. CloudFrontã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®ç„¡åŠ¹åŒ– # è¨­å®šå¤‰æ›´å¾Œã€ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãŒæ®‹ã£ã¦ã„ã‚‹ã¨å¤ã„æŒ™å‹•ãŒç¶šãå ´åˆãŒã‚ã‚Šã¾ã™ã€‚\naws cloudfront create-invalidation \\ --distribution-id \u0026lt;DISTRIBUTION_ID\u0026gt; \\ --paths \u0026#34;/*\u0026#34; 3. å‹•ä½œç¢ºèª # # æœ«å°¾ã‚¹ãƒ©ãƒƒã‚·ãƒ¥ã‚ã‚Šã®URL curl -I https://example.com/posts/ # æœ«å°¾ã‚¹ãƒ©ãƒƒã‚·ãƒ¥ãªã—ã®URL curl -I https://example.com/posts/article-name ã„ãšã‚Œã‚‚ HTTP/2 200 ãŒè¿”ã‚Œã°æˆåŠŸã§ã™ã€‚\nCloudFront Function vs Lambda@Edge # é …ç›® CloudFront Function Lambda@Edge å®Ÿè¡Œå ´æ‰€ å…¨ã‚¨ãƒƒã‚¸ãƒ­ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ã‚¨ãƒƒã‚¸ã‚­ãƒ£ãƒƒã‚·ãƒ¥ æœ€å¤§å®Ÿè¡Œæ™‚é–“ 1ms 5ç§’ï¼ˆviewerï¼‰/ 30ç§’ï¼ˆoriginï¼‰ ãƒ¡ãƒ¢ãƒª 2MB 128MBã€œ10GB ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¢ã‚¯ã‚»ã‚¹ âŒ ä¸å¯ âœ… å¯èƒ½ å¯¾å¿œã‚¤ãƒ™ãƒ³ãƒˆ viewer-request/response 4ç¨®é¡ã™ã¹ã¦ æ–™é‡‘ æœˆ200ä¸‡ãƒªã‚¯ã‚¨ã‚¹ãƒˆç„¡æ–™ ãƒªã‚¯ã‚¨ã‚¹ãƒˆ+å®Ÿè¡Œæ™‚é–“èª²é‡‘ å˜ç´”ãªURLãƒªãƒ©ã‚¤ãƒˆã§ã‚ã‚Œã°CloudFront Functionã§ååˆ†ã§ã™ã€‚å¤–éƒ¨APIã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ã‚„è¤‡é›‘ãªå‡¦ç†ãŒå¿…è¦ãªå ´åˆã¯Lambda@Edgeã‚’æ¤œè¨ã—ã¦ãã ã•ã„ã€‚\nã¾ã¨ã‚ # OACä½¿ç”¨æ™‚ã¯S3ã®ã€Œindex.htmlè‡ªå‹•è£œå®Œã€ãŒåŠ¹ã‹ãªã„ CloudFront Functionã§viewer-requestæ™‚ã«URLãƒªãƒ©ã‚¤ãƒˆã‚’å®Ÿè£…ã—ã¦è§£æ±º å˜ç´”ãªURLæ›¸ãæ›ãˆã«ã¯CloudFront FunctionãŒæœ€é©ï¼ˆä½ã‚³ã‚¹ãƒˆãƒ»ä½ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·ï¼‰ è¨­å®šå¤‰æ›´å¾Œã¯ã‚­ãƒ£ãƒƒã‚·ãƒ¥ç„¡åŠ¹åŒ–ã‚’å¿˜ã‚Œãšã«å®Ÿè¡Œ å‚è€ƒ # CloudFront Functions ã‚’ä½¿ç”¨ã—ã¦ URL ã®æœ«å°¾ã‹ã‚‰ index.html ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è¡¨ç¤ºã™ã‚‹ï½œAWS re:Post CloudFront Functions ã®ä½œæˆ - Amazon CloudFront ","date":"2025å¹´ 12æœˆ 7æ—¥","externalUrl":null,"permalink":"/posts/251207182151_cloudfront-oac-404-page-issue-resolution/","section":"Posts","summary":"","title":"CloudFront + OACã§å€‹åˆ¥ãƒšãƒ¼ã‚¸ãŒ404ã«ãªã‚‹å•é¡Œã®è§£æ±º","type":"posts"},{"content":"","date":"2025å¹´ 12æœˆ 7æ—¥","externalUrl":null,"permalink":"/tags/%E3%83%88%E3%83%A9%E3%83%96%E3%83%AB%E3%82%B7%E3%83%A5%E3%83%BC%E3%83%86%E3%82%A3%E3%83%B3%E3%82%B0/","section":"Tags","summary":"","title":"ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°","type":"tags"},{"content":" ä»Šæ—¥å­¦ã‚“ã ã“ã¨ # AWS Budgetsã§ã‚¢ãƒ©ãƒ¼ãƒˆã‚’å—ä¿¡ã—ãŸéš›ã®å¯¾å¿œãƒ•ãƒ­ãƒ¼ã‚’æ•´ç†ã—ã¾ã—ãŸã€‚å®Ÿéš›ã«FORECASTEDã‚¢ãƒ©ãƒ¼ãƒˆã‚’å—ä¿¡ã—ã¦å¯¾å¿œã—ãŸçµŒé¨“ã‹ã‚‰ã€ä»Šå¾Œã‚‚ä½¿ãˆã‚‹ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ã¨ã—ã¦ã¾ã¨ã‚ã¾ã—ãŸã€‚\nå­¦ç¿’å†…å®¹ # ã“ã®è¨˜äº‹ã‚’æ›¸ã„ãŸçµŒç·¯ # AWS Budgetsã‹ã‚‰äºˆç®—è¶…éã®ã‚¢ãƒ©ãƒ¼ãƒˆãƒ¡ãƒ¼ãƒ«ã‚’å—ä¿¡ã—ã¾ã—ãŸã€‚èª¿æŸ»ã®çµæœã€éå»ã®ãƒãƒ³ã‚ºã‚ªãƒ³ç’°å¢ƒã®ã‚³ã‚¹ãƒˆã¨ä¸€æ‹¬è²»ç”¨ï¼ˆãƒ‰ãƒ¡ã‚¤ãƒ³è³¼å…¥ï¼‰ãŒåŸå› ã¨åˆ¤æ˜ã—ã€å¯¾å¿œä¸è¦ã¨åˆ¤æ–­ã§ãã¾ã—ãŸã€‚ã“ã®å¯¾å¿œãƒ•ãƒ­ãƒ¼ã¯ä»Šå¾Œã‚‚å½¹ç«‹ã¤ã¨è€ƒãˆã€ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ã¨ã—ã¦æ•´ç†ã—ã¾ã—ãŸã€‚\nAWS Budgetsã¨ã¯ # AWS Budgetsã¯ã€AWSã®åˆ©ç”¨ã‚³ã‚¹ãƒˆã‚’ç›£è¦–ã—ã€è¨­å®šã—ãŸäºˆç®—ã‚’è¶…ãˆãã†ãªå ´åˆã«ã‚¢ãƒ©ãƒ¼ãƒˆã‚’é€šçŸ¥ã™ã‚‹ã‚µãƒ¼ãƒ“ã‚¹ã§ã™ã€‚æœˆé¡ã®äºˆç®—ã‚’è¨­å®šã—ã¦ãŠãã¨ã€å®Ÿç¸¾ã‚„äºˆæ¸¬ãŒã—ãã„å€¤ã‚’è¶…ãˆãŸéš›ã«ãƒ¡ãƒ¼ãƒ«ã§é€šçŸ¥ã‚’å—ã‘å–ã‚Œã¾ã™ã€‚\nAWS Budgetsã®ã‚¢ãƒ©ãƒ¼ãƒˆç¨®åˆ¥ # AWS Budgetsã«ã¯2ç¨®é¡ã®ã‚¢ãƒ©ãƒ¼ãƒˆãŒã‚ã‚Šã¾ã™ã€‚\nç¨®åˆ¥ æ„å‘³ ACTUAL å®Ÿéš›ã«ãã®é‡‘é¡ã‚’ä½¿ã£ãŸ FORECASTED æœˆæœ«ã«ãã®é‡‘é¡ã«ãªã‚Šãã†ï¼ˆäºˆæ¸¬ï¼‰ å‡ºå…¸: AWSå…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ - Best practices for AWS Budgets\nFORECASTEDäºˆæ¸¬ã®é™ç•Œ # FORECASTEDã¯ã€Œç¾åœ¨ã®ãƒšãƒ¼ã‚¹ãŒæœˆæœ«ã¾ã§ç¶šãã€ã¨ä»®å®šã—ãŸç·šå½¢äºˆæ¸¬ã§ã™ã€‚ã“ã®äºˆæ¸¬æ–¹æ³•ã«ã¯é™ç•ŒãŒã‚ã‚Šã¾ã™ã€‚\nçŠ¶æ³ äºˆæ¸¬ã®å•é¡Œç‚¹ ãƒªã‚½ãƒ¼ã‚¹ã‚’æœˆã®é€”ä¸­ã§å‰Šé™¤ã—ãŸ å‰Šé™¤å¾Œã‚‚ã‚³ã‚¹ãƒˆãŒç¶™ç¶šã™ã‚‹å‰æã§è¨ˆç®—ã•ã‚Œã‚‹ ãƒ‰ãƒ¡ã‚¤ãƒ³è³¼å…¥ãªã©ä¸€æ‹¬è²»ç”¨ãŒç™ºç”Ÿã—ãŸ æ¯æ—¥åŒé¡ãŒç™ºç”Ÿã™ã‚‹å‰æã§è¨ˆç®—ã•ã‚Œã‚‹ ãƒãƒ³ã‚ºã‚ªãƒ³ç’°å¢ƒã‚’çŸ­æœŸé–“ã ã‘ä½¿ç”¨ã—ãŸ æœˆæœ«ã¾ã§ä½¿ã„ç¶šã‘ã‚‹å‰æã§è¨ˆç®—ã•ã‚Œã‚‹ ã“ã®ãŸã‚ã€FORECASTEDã‚¢ãƒ©ãƒ¼ãƒˆã¯ã€Œå‚è€ƒç¨‹åº¦ã€ã«æ‰ãˆã€ACTUALã‚¢ãƒ©ãƒ¼ãƒˆã‚’é‡è¦–ã™ã‚‹ã“ã¨ã‚’ãŠã™ã™ã‚ã—ã¾ã™ã€‚\nã‚¢ãƒ©ãƒ¼ãƒˆå¯¾å¿œãƒ•ãƒ­ãƒ¼ # Step 1: ã‚¢ãƒ©ãƒ¼ãƒˆç¨®åˆ¥ã®ç¢ºèª # å—ä¿¡ã—ãŸãƒ¡ãƒ¼ãƒ«ã§ACTUAL/FORECASTEDã‚’ç¢ºèªã€‚\nStep 2: Cost Explorerã§åŸå› ç‰¹å®š # Cost Explorerã«ã‚¢ã‚¯ã‚»ã‚¹ æœŸé–“ã‚’ã€Œä»Šæœˆï¼ˆMonth-to-dateï¼‰ã€ã«è¨­å®š Group byã§ã€ŒServiceã€ã‚’é¸æŠ ç•°å¸¸ã«é«˜ã„ã‚µãƒ¼ãƒ“ã‚¹ã‚’ç‰¹å®š Step 3: åŸå› ã®åˆ†é¡ã¨å¯¾å¿œ # åŸå›  å¯¾å¿œ ä¸€æ™‚çš„ãªè²»ç”¨ï¼ˆãƒ‰ãƒ¡ã‚¤ãƒ³è³¼å…¥ç­‰ï¼‰ å¯¾å¿œä¸è¦ã€äºˆæ¸¬ã¯ç„¡è¦– å‰Šé™¤æ¸ˆã¿ãƒªã‚½ãƒ¼ã‚¹ã®æ®‹å­˜ã‚³ã‚¹ãƒˆ å¯¾å¿œä¸è¦ã€æ¥æœˆã‹ã‚‰æ¸›ã‚‹ èµ·å‹•ä¸­ã®ãƒªã‚½ãƒ¼ã‚¹ ä¸è¦ãªã‚‰å³å‰Šé™¤ æƒ³å®šå†…ã®å¢—åŠ  äºˆç®—è¨­å®šã‚’è¦‹ç›´ã— Step 4: ãƒªã‚½ãƒ¼ã‚¹ç¢ºèªï¼ˆå¿…è¦ãªå ´åˆã®ã¿ï¼‰ # åŸå› ãŒã€Œèµ·å‹•ä¸­ã®ãƒªã‚½ãƒ¼ã‚¹ã€ã®å ´åˆã€ä»¥ä¸‹ã®ã‚µãƒ¼ãƒ“ã‚¹ã‚’å„ªå…ˆçš„ã«ç¢ºèªã—ã¾ã™ã€‚\nå„ªå…ˆåº¦ ã‚µãƒ¼ãƒ“ã‚¹ ç¢ºèªå ´æ‰€ é«˜ NAT Gateway VPCã‚³ãƒ³ã‚½ãƒ¼ãƒ« é«˜ EC2ï¼ˆå…¨ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ï¼‰ AWS Global View é«˜ RDS RDSã‚³ãƒ³ã‚½ãƒ¼ãƒ« é«˜ ALB/ELB EC2 â†’ ãƒ­ãƒ¼ãƒ‰ãƒãƒ©ãƒ³ã‚µãƒ¼ ä¸­ Elastic IPï¼ˆæœªä½¿ç”¨ï¼‰ EC2 â†’ Elastic IP ã“ã‚Œã‚‰ã®ã‚µãƒ¼ãƒ“ã‚¹ã¯èµ·å‹•ã—ã¦ã„ã‚‹ã ã‘ã§èª²é‡‘ãŒç™ºç”Ÿã™ã‚‹ãŸã‚ã€ä¸è¦ã§ã‚ã‚Œã°å‰Šé™¤ã—ã¾ã™ã€‚\nAWS Global Viewã‚’ä½¿ã£ãŸå…¨ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ç¢ºèª # EC2ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã¯é€šå¸¸ã€ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ã”ã¨ã«ã—ã‹ç¢ºèªã§ãã¾ã›ã‚“ã€‚ã—ã‹ã—ã€AWS Global Viewã‚’ä½¿ãˆã°ã€å…¨ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ã®ãƒªã‚½ãƒ¼ã‚¹ã‚’ä¸€ç”»é¢ã§ç¢ºèªã§ãã¾ã™ã€‚ä»Šå›ã®å¯¾å¿œã§å®Ÿéš›ã«ä½¿ç”¨ã—ã€éå¸¸ã«ä¾¿åˆ©ã ã¨æ„Ÿã˜ã¾ã—ãŸã€‚\nAWS Global Viewã¨ã¯ # AWS Global Viewã¯ã€è¤‡æ•°ã®AWSãƒªãƒ¼ã‚¸ãƒ§ãƒ³ã«ã¾ãŸãŒã‚‹EC2ãŠã‚ˆã³VPCé–¢é€£ãƒªã‚½ãƒ¼ã‚¹ã‚’å˜ä¸€ã®ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã§è¡¨ç¤ºã§ãã‚‹æ©Ÿèƒ½ã§ã™ã€‚\nç¢ºèªã§ãã‚‹ãƒªã‚½ãƒ¼ã‚¹ # EC2ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ VPC ã‚µãƒ–ãƒãƒƒãƒˆ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚°ãƒ«ãƒ¼ãƒ— EBSãƒœãƒªãƒ¥ãƒ¼ãƒ  NAT Gateway Elastic IP ã‚¢ã‚¯ã‚»ã‚¹æ–¹æ³• # AWSã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã§ã€ŒAWS Global Viewã€ã‚’æ¤œç´¢ ã¾ãŸã¯ç›´æ¥ã‚¢ã‚¯ã‚»ã‚¹: https://console.aws.amazon.com/ec2globalview/home ä½¿ã„æ–¹ # ã€Œãƒªãƒ¼ã‚¸ãƒ§ãƒ³ã‚¨ã‚¯ã‚¹ãƒ—ãƒ­ãƒ¼ãƒ©ãƒ¼ã€ã‚¿ãƒ–ã‚’é–‹ã ã€Œãƒªã‚½ãƒ¼ã‚¹ã®æ¦‚è¦ã€ã§å…¨ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹æ•°ã‚’ç¢ºèª ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹æ•°ã®ãƒªãƒ³ã‚¯ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨ã€å…¨ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ä¸€è¦§ãŒè¡¨ç¤ºã•ã‚Œã‚‹ ä¸è¦ãªã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãŒã‚ã‚Œã°ã€ãƒªã‚½ãƒ¼ã‚¹IDã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦è©²å½“ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ã®ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«ç§»å‹•ã—ã€å‰Šé™¤ ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ã‚’åˆ‡ã‚Šæ›¿ãˆãªãŒã‚‰ç¢ºèªã™ã‚‹æ‰‹é–“ãŒçœã‘ã‚‹ãŸã‚ã€ã‚³ã‚¹ãƒˆèª¿æŸ»ã®éš›ã«éå¸¸ã«ä¾¿åˆ©ã§ã™ã€‚\né‹ç”¨ä¸Šã®ãƒã‚¤ãƒ³ãƒˆ # ãƒã‚¤ãƒ³ãƒˆ å†…å®¹ ãƒãƒ³ã‚ºã‚ªãƒ³å¾Œã®ç¢ºèª ãƒªã‚½ãƒ¼ã‚¹å‰Šé™¤ã‚’å¿˜ã‚Œãªã„ã“ã¨ å¤ã„è¨­å®šã®æ•´ç† ä¸è¦ãªBudgetã¯å‰Šé™¤ã™ã‚‹ ã‚¢ãƒ©ãƒ¼ãƒˆã®ä½¿ã„åˆ†ã‘ ACTUALã‚’é‡è¦–ã€FORECASTEDã¯å‚è€ƒç¨‹åº¦ ã¾ã¨ã‚ # AWS Budgetsã®ã‚¢ãƒ©ãƒ¼ãƒˆã¯ ACTUALï¼ˆå®Ÿç¸¾ï¼‰ã¨ FORECASTEDï¼ˆäºˆæ¸¬ï¼‰ã®2ç¨®é¡ãŒã‚ã‚‹ FORECASTED ã¯ç·šå½¢äºˆæ¸¬ã®ãŸã‚ã€ãƒªã‚½ãƒ¼ã‚¹å‰Šé™¤ã‚„ä¸€æ‹¬è²»ç”¨ã‚’è€ƒæ…®ã—ãªã„ ã‚¢ãƒ©ãƒ¼ãƒˆå—ä¿¡æ™‚ã¯ Cost Explorer ã§ã‚µãƒ¼ãƒ“ã‚¹åˆ¥ã«åŸå› ã‚’ç‰¹å®šã™ã‚‹ AWS Global View ã‚’ä½¿ãˆã°å…¨ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ã®ãƒªã‚½ãƒ¼ã‚¹ã‚’ä¸€ç”»é¢ã§ç¢ºèªã§ãã‚‹ ãƒãƒ³ã‚ºã‚ªãƒ³ç’°å¢ƒã¯ä½¿ç”¨å¾Œã«å¿…ãšãƒªã‚½ãƒ¼ã‚¹ã‚’å‰Šé™¤ã™ã‚‹ å‚è€ƒ # AWS Budgets Best practices for AWS Budgets Budgets API Reference - Notification AWS Cost Explorer AWS Global View ","date":"2025å¹´ 12æœˆ 7æ—¥","externalUrl":null,"permalink":"/posts/251207175353_aws-budgets-alert-response-flow/","section":"Posts","summary":"","title":"AWS Budgetsã‚¢ãƒ©ãƒ¼ãƒˆã‚’å—ä¿¡ã—ãŸã¨ãã®å¯¾å¿œãƒ•ãƒ­ãƒ¼","type":"posts"},{"content":"","date":"2025å¹´ 12æœˆ 4æ—¥","externalUrl":null,"permalink":"/tags/it%E5%9F%BA%E7%A4%8E/","section":"Tags","summary":"","title":"ITåŸºç¤","type":"tags"},{"content":" ä»Šæ—¥å­¦ã‚“ã ã“ã¨ # CPUãŒå‘½ä»¤ã‚’å®Ÿè¡Œã™ã‚‹éš›ã€å‡¦ç†å¯¾è±¡ãƒ‡ãƒ¼ã‚¿ã®ä½ç½®ã‚’æŒ‡å®šã™ã‚‹ã€Œã‚¢ãƒ‰ãƒ¬ã‚¹æŒ‡å®šæ–¹æ³•ã€ã«ã¤ã„ã¦å­¦ã³ã¾ã—ãŸã€‚å³å€¤ãƒ»ç›´æ¥ãƒ»é–“æ¥ãƒ»æŒ‡æ¨™ãƒ»åŸºåº•ãƒ»ç›¸å¯¾ãƒ»ãƒ¬ã‚¸ã‚¹ã‚¿ãƒ»ãƒ¬ã‚¸ã‚¹ã‚¿é–“æ¥ã®8ç¨®é¡ãŒã‚ã‚Šã€ãã‚Œãã‚Œé€Ÿåº¦ãƒ»æŸ”è»Ÿæ€§ãƒ»ç”¨é€”ãŒç•°ãªã‚Šã¾ã™ã€‚\nå­¦ç¿’å†…å®¹ # ã‚¢ãƒ‰ãƒ¬ã‚¹æŒ‡å®šæ–¹æ³•ã¨ã¯ # ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ã®å‘½ä»¤ã¯ã€Œå‘½ä»¤éƒ¨ã€ã¨ã€Œã‚¢ãƒ‰ãƒ¬ã‚¹éƒ¨ï¼ˆã‚ªãƒšãƒ©ãƒ³ãƒ‰ï¼‰ã€ã‹ã‚‰æ§‹æˆã•ã‚Œã¦ã„ã¾ã™ã€‚ã‚¢ãƒ‰ãƒ¬ã‚¹æŒ‡å®šæ–¹æ³•ã¨ã¯ã€ã‚ªãƒšãƒ©ãƒ³ãƒ‰ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã®å®Ÿéš›ã®æ ¼ç´å ´æ‰€ï¼ˆæœ‰åŠ¹ã‚¢ãƒ‰ãƒ¬ã‚¹ï¼‰ã‚’æ±‚ã‚ã‚‹æ–¹å¼ã®ã“ã¨ã§ã™ã€‚\n8ç¨®é¡ã®ã‚¢ãƒ‰ãƒ¬ã‚¹æŒ‡å®šæ–¹æ³• # 1. å³å€¤ã‚¢ãƒ‰ãƒ¬ã‚¹æŒ‡å®š # ã‚¢ãƒ‰ãƒ¬ã‚¹éƒ¨ã®å€¤ãŒãƒ¡ãƒ¢ãƒªã‚¢ãƒ‰ãƒ¬ã‚¹ã§ã¯ãªãã€æ¼”ç®—å¯¾è±¡ã®ãƒ‡ãƒ¼ã‚¿ãã®ã‚‚ã®ã§ã‚ã‚‹æ–¹å¼ã§ã™ã€‚\nå‘½ä»¤ +------+------+ | å‘½ä»¤ | ãƒ‡ãƒ¼ã‚¿ | â† ã“ã®ãƒ‡ãƒ¼ã‚¿ï¼ˆã‚ªãƒšãƒ©ãƒ³ãƒ‰ï¼‰ã‚’ç›´æ¥ä½¿ã† +------+------+ ãƒ¡ãƒ¢ãƒªã‚¢ã‚¯ã‚»ã‚¹ãŒä¸è¦ãªãŸã‚é«˜é€Ÿã§ã™ãŒã€å‘½ä»¤å†…ã«ãƒ‡ãƒ¼ã‚¿ã‚’åŸ‹ã‚è¾¼ã‚€ãŸã‚è¡¨ç¾ã§ãã‚‹å€¤ã®ç¯„å›²ãŒåˆ¶é™ã•ã‚Œã¾ã™ã€‚\n2. ç›´æ¥ã‚¢ãƒ‰ãƒ¬ã‚¹æŒ‡å®š # å‘½ä»¤ã®ã‚¢ãƒ‰ãƒ¬ã‚¹éƒ¨ã«ã€æœ‰åŠ¹ã‚¢ãƒ‰ãƒ¬ã‚¹ãŒç›´æ¥æ›¸ãè¾¼ã¾ã‚Œã¦ã„ã‚‹æ–¹å¼ã§ã™ã€‚\nå‘½ä»¤ ä¸»è¨˜æ†¶ +------+---------+ +-------------+ | å‘½ä»¤ | ã‚¢ãƒ‰ãƒ¬ã‚¹A | ------------\u0026gt; | ãƒ‡ãƒ¼ã‚¿ | â† ç›®çš„ã®ãƒ‡ãƒ¼ã‚¿ +------+---------+ +-------------+ ã‚¢ãƒ‰ãƒ¬ã‚¹A æ§‹é€ ãŒã‚·ãƒ³ãƒ—ãƒ«ã§ã™ãŒã€æŒ‡å®šã§ãã‚‹ãƒ¡ãƒ¢ãƒªã‚¢ãƒ‰ãƒ¬ã‚¹ã®ç¯„å›²ãŒã‚¢ãƒ‰ãƒ¬ã‚¹éƒ¨ã®ãƒ“ãƒƒãƒˆæ•°ã«ä¾å­˜ã—ã¾ã™ã€‚\n3. é–“æ¥ã‚¢ãƒ‰ãƒ¬ã‚¹æŒ‡å®š # å‘½ä»¤ã®ã‚¢ãƒ‰ãƒ¬ã‚¹éƒ¨ãŒæŒ‡ã™ãƒ¡ãƒ¢ãƒªç•ªåœ°ã«ã€æœ‰åŠ¹ã‚¢ãƒ‰ãƒ¬ã‚¹ãŒæ ¼ç´ã•ã‚Œã¦ã„ã‚‹æ–¹å¼ã§ã™ã€‚\nå‘½ä»¤ ä¸»è¨˜æ†¶ +------+---------+ +-------------+ +-------------+ | å‘½ä»¤ | ã‚¢ãƒ‰ãƒ¬ã‚¹A | ------------\u0026gt; | ã‚¢ãƒ‰ãƒ¬ã‚¹B | ------------\u0026gt; | ãƒ‡ãƒ¼ã‚¿ | +------+---------+ +-------------+ +-------------+ ã‚¢ãƒ‰ãƒ¬ã‚¹A ã‚¢ãƒ‰ãƒ¬ã‚¹B åºƒã„ãƒ¡ãƒ¢ãƒªç©ºé–“ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã¾ã™ãŒã€ãƒ¡ãƒ¢ãƒªã‚¢ã‚¯ã‚»ã‚¹ãŒ2å›ç™ºç”Ÿã™ã‚‹ãŸã‚å‡¦ç†é€Ÿåº¦ãŒé…ããªã‚Šã¾ã™ã€‚\n4. æŒ‡æ¨™ã‚¢ãƒ‰ãƒ¬ã‚¹æŒ‡å®šï¼ˆã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚¢ãƒ‰ãƒ¬ã‚¹æŒ‡å®šï¼‰ # å‘½ä»¤ã®ã‚¢ãƒ‰ãƒ¬ã‚¹éƒ¨ã®å€¤ã¨ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ãƒ¬ã‚¸ã‚¹ã‚¿ã®å€¤ã‚’åŠ ç®—ã—ã¦æœ‰åŠ¹ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’æ±‚ã‚ã¾ã™ã€‚\nå‘½ä»¤ ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ãƒ¬ã‚¸ã‚¹ã‚¿ +------+---------+ +-------------+ | å‘½ä»¤ | ã‚¢ãƒ‰ãƒ¬ã‚¹A | | å€¤X | +------+---------+ +-------------+ | | +--------\u0026gt; åŠ ç®— \u0026lt;---------+ | â†“ æœ‰åŠ¹ã‚¢ãƒ‰ãƒ¬ã‚¹ (A+X) é…åˆ—ãªã©é€£ç¶šã—ãŸãƒ‡ãƒ¼ã‚¿é ˜åŸŸã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ã«ä¾¿åˆ©ã§ã™ã€‚ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ãƒ¬ã‚¸ã‚¹ã‚¿ã®å€¤ã‚’å¤‰æ›´ã™ã‚‹ã ã‘ã§ã‚¢ã‚¯ã‚»ã‚¹å…ˆã‚’ãšã‚‰ã›ã¾ã™ã€‚\n5. åŸºåº•ã‚¢ãƒ‰ãƒ¬ã‚¹æŒ‡å®šï¼ˆãƒ™ãƒ¼ã‚¹ã‚¢ãƒ‰ãƒ¬ã‚¹æŒ‡å®šï¼‰ # å‘½ä»¤ã®ã‚¢ãƒ‰ãƒ¬ã‚¹éƒ¨ã®å€¤ã¨ãƒ™ãƒ¼ã‚¹ãƒ¬ã‚¸ã‚¹ã‚¿ã®å€¤ã‚’åŠ ç®—ã—ã¦æœ‰åŠ¹ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’æ±‚ã‚ã¾ã™ã€‚\nå‘½ä»¤ ãƒ™ãƒ¼ã‚¹ãƒ¬ã‚¸ã‚¹ã‚¿ +------+---------+ +-------------+ | å‘½ä»¤ | å¤‰ä½A | | åŸºæº–å€¤B | +------+---------+ +-------------+ | | +--------\u0026gt; åŠ ç®— \u0026lt;-----------+ | â†“ æœ‰åŠ¹ã‚¢ãƒ‰ãƒ¬ã‚¹ (B+A) ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®å†é…ç½®ã‚’å®¹æ˜“ã«ã—ã¾ã™ã€‚ãƒ™ãƒ¼ã‚¹ãƒ¬ã‚¸ã‚¹ã‚¿ã«ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®å…ˆé ­ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å…¥ã‚Œã¦ãŠãã“ã¨ã§ã€ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’ãƒ¡ãƒ¢ãƒªä¸Šã®ã©ã“ã«ç§»å‹•ã—ã¦ã‚‚å‘½ä»¤ã‚’æ›¸ãæ›ãˆã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã›ã‚“ã€‚\n6. ç›¸å¯¾ã‚¢ãƒ‰ãƒ¬ã‚¹æŒ‡å®š # å‘½ä»¤ã®ã‚¢ãƒ‰ãƒ¬ã‚¹éƒ¨ã®å€¤ã¨ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚«ã‚¦ãƒ³ã‚¿ã®å€¤ã‚’åŠ ç®—ã—ã¦æœ‰åŠ¹ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’æ±‚ã‚ã¾ã™ã€‚\nå‘½ä»¤ ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚«ã‚¦ãƒ³ã‚¿ +------+---------+ +-------------+ | å‘½ä»¤ | å¤‰ä½A | | ç¾åœ¨ä½ç½®P | +------+---------+ +-------------+ | | +--------\u0026gt; åŠ ç®— \u0026lt;---------+ | â†“ æœ‰åŠ¹ã‚¢ãƒ‰ãƒ¬ã‚¹ (P+A) ä¸»ã«åˆ†å²å‘½ä»¤ã§ä½¿ã‚ã‚Œã€ç¾åœ¨ã®å‘½ä»¤ä½ç½®ã‹ã‚‰ã®ç›¸å¯¾çš„ãªã‚¸ãƒ£ãƒ³ãƒ—å…ˆã‚’æŒ‡å®šã—ã¾ã™ã€‚\n7. ãƒ¬ã‚¸ã‚¹ã‚¿ã‚¢ãƒ‰ãƒ¬ã‚¹æŒ‡å®š # ã‚ªãƒšãƒ©ãƒ³ãƒ‰éƒ¨ã§æŒ‡å®šã—ãŸãƒ¬ã‚¸ã‚¹ã‚¿ã®å€¤ã‚’ç›´æ¥ãƒ‡ãƒ¼ã‚¿ã¨ã—ã¦ä½¿ã†æ–¹å¼ã§ã™ã€‚\nå‘½ä»¤ CPUå†…éƒ¨ãƒ¬ã‚¸ã‚¹ã‚¿ç¾¤ +------+----------+ | å‘½ä»¤ | ãƒ¬ã‚¸ã‚¹ã‚¿A | ------------\u0026gt; +-------------+ +------+----------+ | ãƒ‡ãƒ¼ã‚¿ | â† ç›®çš„ã®ãƒ‡ãƒ¼ã‚¿ +-------------+ CPUå†…éƒ¨ã§å®Œçµã™ã‚‹ãŸã‚æ¥µã‚ã¦é«˜é€Ÿã§ã™ãŒã€ãƒ¬ã‚¸ã‚¹ã‚¿ã®æ•°ã¯é™ã‚‰ã‚Œã¦ã„ã¾ã™ã€‚\n8. ãƒ¬ã‚¸ã‚¹ã‚¿é–“æ¥ã‚¢ãƒ‰ãƒ¬ã‚¹æŒ‡å®š # ã‚ªãƒšãƒ©ãƒ³ãƒ‰éƒ¨ã§æŒ‡å®šã—ãŸãƒ¬ã‚¸ã‚¹ã‚¿ã«ã€æœ‰åŠ¹ã‚¢ãƒ‰ãƒ¬ã‚¹ãŒæ ¼ç´ã•ã‚Œã¦ã„ã‚‹æ–¹å¼ã§ã™ã€‚\nå‘½ä»¤ CPUå†…éƒ¨ãƒ¬ã‚¸ã‚¹ã‚¿ç¾¤ ä¸»è¨˜æ†¶ +------+----------+ | å‘½ä»¤ | ãƒ¬ã‚¸ã‚¹ã‚¿A | ------------\u0026gt; +-------------+ +-------------+ +------+----------+ | ã‚¢ãƒ‰ãƒ¬ã‚¹B | ------------\u0026gt; | ãƒ‡ãƒ¼ã‚¿ | +-------------+ +-------------+ ã‚¢ãƒ‰ãƒ¬ã‚¹B é–“æ¥ã‚¢ãƒ‰ãƒ¬ã‚¹æŒ‡å®šã§ã¯ãƒ¡ãƒ¢ãƒªã‚¢ã‚¯ã‚»ã‚¹ãŒ2å›å¿…è¦ã§ã—ãŸãŒã€ãƒ¬ã‚¸ã‚¹ã‚¿é–“æ¥ã§ã¯ãƒ¡ãƒ¢ãƒªã‚¢ã‚¯ã‚»ã‚¹ã¯1å›ã§æ¸ˆã¿ã¾ã™ã€‚ãƒã‚¤ãƒ³ã‚¿ã‚’åˆ©ç”¨ã—ãŸå‡¦ç†ã§é«˜ã„æŸ”è»Ÿæ€§ã‚’ç™ºæ®ã—ã¾ã™ã€‚\nã¾ã¨ã‚ # ã‚¢ãƒ‰ãƒ¬ã‚¹æŒ‡å®šæ–¹æ³• æœ‰åŠ¹ã‚¢ãƒ‰ãƒ¬ã‚¹ã®æ±‚ã‚æ–¹ ãƒ¡ãƒ¢ãƒªã‚¢ã‚¯ã‚»ã‚¹ ç‰¹å¾´ãƒ»ç”¨é€” å³å€¤ ãƒ‡ãƒ¼ã‚¿ãã®ã‚‚ã® 0å› é«˜é€Ÿã€å®šæ•°ã®æŒ‡å®š ç›´æ¥ ã‚¢ãƒ‰ãƒ¬ã‚¹éƒ¨ã®å€¤ 1å› ã‚·ãƒ³ãƒ—ãƒ« é–“æ¥ ã‚¢ãƒ‰ãƒ¬ã‚¹éƒ¨ãŒæŒ‡ã™ç•ªåœ°ã®å€¤ 2å› åºƒã„ã‚¢ãƒ‰ãƒ¬ã‚¹ç©ºé–“ æŒ‡æ¨™ ã‚¢ãƒ‰ãƒ¬ã‚¹éƒ¨ + ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ãƒ¬ã‚¸ã‚¹ã‚¿ 1å› é…åˆ—ã‚¢ã‚¯ã‚»ã‚¹ åŸºåº• ã‚¢ãƒ‰ãƒ¬ã‚¹éƒ¨ + ãƒ™ãƒ¼ã‚¹ãƒ¬ã‚¸ã‚¹ã‚¿ 1å› ãƒ—ãƒ­ã‚°ãƒ©ãƒ å†é…ç½® ç›¸å¯¾ ã‚¢ãƒ‰ãƒ¬ã‚¹éƒ¨ + ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚«ã‚¦ãƒ³ã‚¿ 1å› åˆ†å²å‘½ä»¤ ãƒ¬ã‚¸ã‚¹ã‚¿ ãƒ¬ã‚¸ã‚¹ã‚¿ã®å€¤ãŒãƒ‡ãƒ¼ã‚¿ 0å› æœ€é«˜é€Ÿ ãƒ¬ã‚¸ã‚¹ã‚¿é–“æ¥ ãƒ¬ã‚¸ã‚¹ã‚¿ã®å€¤ãŒã‚¢ãƒ‰ãƒ¬ã‚¹ 1å› ãƒã‚¤ãƒ³ã‚¿æ“ä½œ é€Ÿåº¦é‡è¦–ãªã‚‰å³å€¤ãƒ»ãƒ¬ã‚¸ã‚¹ã‚¿ã‚¢ãƒ‰ãƒ¬ã‚¹æŒ‡å®šï¼ˆãƒ¡ãƒ¢ãƒªã‚¢ã‚¯ã‚»ã‚¹0å›ï¼‰ æŸ”è»Ÿæ€§é‡è¦–ãªã‚‰é–“æ¥ãƒ»ãƒ¬ã‚¸ã‚¹ã‚¿é–“æ¥ã‚¢ãƒ‰ãƒ¬ã‚¹æŒ‡å®š æŒ‡æ¨™ã¨åŸºåº•ã¯åŠ ç®—ã™ã‚‹å¯¾è±¡ãŒç•°ãªã‚‹ï¼ˆé…åˆ—æ“ä½œ vs ãƒ—ãƒ­ã‚°ãƒ©ãƒ å†é…ç½®ï¼‰ ","date":"2025å¹´ 12æœˆ 4æ—¥","externalUrl":null,"permalink":"/posts/251204202004_why-address-specification-is-necessary/","section":"Posts","summary":"","title":"ã‚¢ãƒ‰ãƒ¬ã‚¹æŒ‡å®šæ–¹æ³•ã¯ãªãœå¿…è¦ï¼Ÿ","type":"posts"},{"content":"","date":"2025å¹´ 12æœˆ 3æ—¥","externalUrl":null,"permalink":"/tags/cloudfront/","section":"Tags","summary":"","title":"CloudFront","type":"tags"},{"content":" ä»Šæ—¥å­¦ã‚“ã ã“ã¨ # CloudFrontã§ACMè¨¼æ˜æ›¸ã‚’ä½¿ã†å ´åˆã€è¨¼æ˜æ›¸ã¯å¿…ãšus-east-1ï¼ˆãƒãƒ¼ã‚¸ãƒ‹ã‚¢åŒ—éƒ¨ï¼‰ã§ä½œæˆã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã“ã¨ã‚’å­¦ã³ã¾ã—ãŸã€‚æ±äº¬ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ã§ä½œæˆã™ã‚‹ã¨ã€CloudFrontã®è¨­å®šç”»é¢ã§é¸æŠè‚¢ã«è¡¨ç¤ºã•ã‚Œã¾ã›ã‚“ã€‚\nå­¦ç¿’å†…å®¹ # ãªãœus-east-1ãªã®ã‹ # CloudFrontã¯ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚µãƒ¼ãƒ“ã‚¹ã§ã™ã€‚ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚µãƒ¼ãƒ“ã‚¹ã¯us-east-1ã®ACMè¨¼æ˜æ›¸ã—ã‹å‚ç…§ã§ããªã„ä»•æ§˜ã«ãªã£ã¦ã„ã¾ã™ã€‚ å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã«ã‚‚æ˜è¨˜ã•ã‚Œã¦ã„ã¾ã™\nã€ŒAmazon CloudFrontã§ACMè¨¼æ˜æ›¸ã‚’ä½¿ç”¨ã™ã‚‹ã«ã¯ã€ç±³å›½æ±éƒ¨ï¼ˆãƒãƒ¼ã‚¸ãƒ‹ã‚¢åŒ—éƒ¨ï¼‰ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ã§è¨¼æ˜æ›¸ã‚’ãƒªã‚¯ã‚¨ã‚¹ãƒˆã¾ãŸã¯ã‚¤ãƒ³ãƒãƒ¼ãƒˆã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ã€ â€” Supported Regions - AWS Certificate Manager\nã€Œãªãœus-east-1ãªã®ã‹ã€ã®èƒŒæ™¯ # 1. CloudFrontã®ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ãƒ—ãƒ¬ãƒ¼ãƒ³ãŒus-east-1ã«ã‚ã‚‹ # CloudFrontã¯ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚µãƒ¼ãƒ“ã‚¹ã§ã™ãŒã€APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã¯us-east-1ã«å­˜åœ¨ã—ã¾ã™ã€‚\nã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ cloudfront.amazonaws.com ç±³å›½æ±éƒ¨ï¼ˆãƒãƒ¼ã‚¸ãƒ‹ã‚¢åŒ—éƒ¨ï¼‰ cloudfront-fips.amazonaws.com ç±³å›½æ±éƒ¨ï¼ˆãƒãƒ¼ã‚¸ãƒ‹ã‚¢åŒ—éƒ¨ï¼‰ cloudfront.global.api.aws ç±³å›½æ±éƒ¨ï¼ˆãƒãƒ¼ã‚¸ãƒ‹ã‚¢åŒ—éƒ¨ï¼‰ â€” Amazon CloudFront endpoints and quotas\n2. ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚µãƒ¼ãƒ“ã‚¹ã®APIãƒªã‚¯ã‚¨ã‚¹ãƒˆã¯us-east-1ã«ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã•ã‚Œã‚‹ # AWSã®å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã§ã¯ã€ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã«ã¤ã„ã¦ä»¥ä¸‹ã®ã‚ˆã†ã«èª¬æ˜ã•ã‚Œã¦ã„ã¾ã™ï¼š\nã€Œæ±ç”¨ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€AWSã¯APIãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’ç±³å›½æ±éƒ¨ï¼ˆãƒãƒ¼ã‚¸ãƒ‹ã‚¢åŒ—éƒ¨ï¼‰ï¼ˆus-east-1ï¼‰ã«ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã—ã¾ã™ã€‚ã“ã‚Œã¯APIå‘¼ã³å‡ºã—ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒªãƒ¼ã‚¸ãƒ§ãƒ³ã§ã™ã€‚ã€ â€” AWS service endpoints\nCloudFrontã€IAMã€Route 53ãªã©ã®ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚µãƒ¼ãƒ“ã‚¹ã¯us-east-1ã‚’ç®¡ç†åŸºç›¤ã¨ã—ã¦ã„ã¾ã™ã€‚\n3. ACMè¨¼æ˜æ›¸ã¯ãƒªãƒ¼ã‚¸ãƒ§ãƒŠãƒ«ãƒªã‚½ãƒ¼ã‚¹ # ACMè¨¼æ˜æ›¸ã¯ä½œæˆã—ãŸãƒªãƒ¼ã‚¸ãƒ§ãƒ³å†…ã§ã®ã¿å‚ç…§å¯èƒ½ã§ã™ï¼š\nus-east-1ã§ä½œæˆã—ãŸè¨¼æ˜æ›¸ â†’ us-east-1ã®ãƒªã‚½ãƒ¼ã‚¹ã‹ã‚‰ã®ã¿å‚ç…§å¯èƒ½ ap-northeast-1ã§ä½œæˆã—ãŸè¨¼æ˜æ›¸ â†’ ap-northeast-1ã®ãƒªã‚½ãƒ¼ã‚¹ã‹ã‚‰ã®ã¿å‚ç…§å¯èƒ½ CloudFrontã®ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ãƒ—ãƒ¬ãƒ¼ãƒ³ï¼ˆAPIï¼‰ãŒus-east-1ã«ã‚ã‚‹ãŸã‚ã€åŒã˜us-east-1ã«ã‚ã‚‹ACMè¨¼æ˜æ›¸ã—ã‹ã€Œè¦‹ãˆãªã„ã€ ã®ã§ã™ã€‚\n4. è¨¼æ˜æ›¸é…å¸ƒã®ä»•çµ„ã¿ # 1. us-east-1ã§ACMè¨¼æ˜æ›¸ã‚’ä½œæˆ 2. CloudFrontãƒ‡ã‚£ã‚¹ãƒˆãƒªãƒ“ãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã«è¨¼æ˜æ›¸ã‚’é–¢é€£ä»˜ã‘ 3. CloudFrontãŒè¨¼æ˜æ›¸ã‚’å…¨ã‚¨ãƒƒã‚¸ãƒ­ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«å†…éƒ¨é…å¸ƒ 4. ä¸–ç•Œä¸­ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒHTTPSã§ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½ã« CloudFrontã¯ä¸–ç•Œä¸­ã« 400ä»¥ä¸Šã®ã‚¨ãƒƒã‚¸ãƒ­ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆPoPï¼‰ ã‚’æŒã¡ã€us-east-1ã§è¨­å®šã•ã‚ŒãŸè¨¼æ˜æ›¸ã‚’å„ã‚¨ãƒƒã‚¸ã«é…å¸ƒã—ã¾ã™ã€‚\nâ€” Amazon CloudFront features\nã‚µãƒ¼ãƒ“ã‚¹åˆ¥ã®ACMè¨¼æ˜æ›¸ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ # ã‚µãƒ¼ãƒ“ã‚¹ ACMè¨¼æ˜æ›¸ã®ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ ç†ç”± CloudFront us-east-1ã®ã¿ ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚µãƒ¼ãƒ“ã‚¹ã®ãŸã‚ ALB ALBã¨åŒã˜ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ ãƒªãƒ¼ã‚¸ãƒ§ãƒŠãƒ«ã‚µãƒ¼ãƒ“ã‚¹ã®ãŸã‚ API Gatewayï¼ˆEdgeæœ€é©åŒ–ï¼‰ us-east-1ã®ã¿ CloudFrontçµŒç”±ã®ãŸã‚ API Gatewayï¼ˆãƒªãƒ¼ã‚¸ãƒ§ãƒŠãƒ«ï¼‰ API Gatewayã¨åŒã˜ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ ãƒªãƒ¼ã‚¸ãƒ§ãƒŠãƒ«ã‚µãƒ¼ãƒ“ã‚¹ã®ãŸã‚ ã¾ã¨ã‚ # CloudFrontã§ACMè¨¼æ˜æ›¸ã‚’ä½¿ã†å ´åˆã¯us-east-1ã§ä½œæˆå¿…é ˆ ALBã¯åŒã˜ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ã®ACMè¨¼æ˜æ›¸ã‚’ä½¿ç”¨ API Gatewayï¼ˆEdgeæœ€é©åŒ–ï¼‰ã‚‚us-east-1ãŒå¿…è¦ å‚è€ƒ # Supported Regions - AWS Certificate Manager AWS Certificate Manager Overview Amazon CloudFront endpoints and quotas AWS service endpoints Amazon CloudFront features ","date":"2025å¹´ 12æœˆ 3æ—¥","externalUrl":null,"permalink":"/posts/251203194906_cloudfront-acm-certificate-us-east-1-constraint/","section":"Posts","summary":"","title":"CloudFront + ACMè¨¼æ˜æ›¸ã§ãƒãƒã‚‹us-east-1åˆ¶ç´„","type":"posts"},{"content":"","date":"2025å¹´ 12æœˆ 3æ—¥","externalUrl":null,"permalink":"/tags/route53/","section":"Tags","summary":"","title":"Route53","type":"tags"},{"content":" ä»Šæ—¥å­¦ã‚“ã ã“ã¨ # Route53ã§ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚’è³¼å…¥ã™ã‚‹æ‰‹é †ã¨ã€è³¼å…¥æ™‚ã«æ³¨æ„ã™ã¹ããƒã‚¤ãƒ³ãƒˆã‚’å­¦ã³ã¾ã—ãŸã€‚\nå­¦ç¿’å†…å®¹ # Step 1: ãƒ‰ãƒ¡ã‚¤ãƒ³åã®æ¤œè¨ # Route53ã§è³¼å…¥å¯èƒ½ãªTLDã¨ä¾¡æ ¼ã‚’ç¢ºèªã—ã¾ã™ã€‚ ï¼ˆRoute53ã®ã€Œãƒ‰ãƒ¡ã‚¤ãƒ³ã‚’ç™»éŒ²ã€ç”»é¢ã«ã¦æ–™é‡‘è¡¨ã‚’ç¢ºèªã§ãã¾ã™ã€‚ï¼š2025å¹´12æœˆæ™‚ç‚¹ï¼‰\nTLD Route53ä¾¡æ ¼ æ¤œè¨çµæœ .com $15/å¹´ âœ… èªçŸ¥åº¦æœ€é«˜ã€ç›´æ¥è³¼å…¥å¯èƒ½ .tech $40/å¹´ âŒ é«˜ã‚ .io $71/å¹´ âŒ é«˜ã‚ æ³¨æ„ï¼š.devã¯Route53ã§å–ã‚Šæ‰±ã„ãŒã‚ã‚Šã¾ã›ã‚“ã€‚ Cloudflareç­‰ã§è³¼å…¥ã—ã¦Route53ã«DNSç§»ç®¡ãŒå¿…è¦ã«ãªã‚Šã€æ‰‹é–“ãŒå¢—ãˆã¾ã™ã€‚\nStep 2: ãƒ‰ãƒ¡ã‚¤ãƒ³è³¼å…¥ # AWSã‚³ãƒ³ã‚½ãƒ¼ãƒ« â†’ Route53 â†’ ç™»éŒ²æ¸ˆã¿ãƒ‰ãƒ¡ã‚¤ãƒ³ â†’ ãƒ‰ãƒ¡ã‚¤ãƒ³ã®ç™»éŒ² å¸Œæœ›ã®ãƒ‰ãƒ¡ã‚¤ãƒ³åã‚’æ¤œç´¢ ã‚«ãƒ¼ãƒˆã«è¿½åŠ  â†’ ãƒã‚§ãƒƒã‚¯ã‚¢ã‚¦ãƒˆ ä»¥ä¸‹ã®é …ç›®ã‚’è¨­å®šï¼š é …ç›® æ¨å¥¨è¨­å®š ç†ç”± ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ä¿è­· æœ‰åŠ¹ WHOISæƒ…å ±ã‚’éå…¬é–‹ã«ã™ã‚‹ è‡ªå‹•æ›´æ–° æœ‰åŠ¹ æ›´æ–°å¿˜ã‚Œã«ã‚ˆã‚‹ãƒ‰ãƒ¡ã‚¤ãƒ³å¤±åŠ¹ã‚’é˜²æ­¢ æœŸé–“ 1å¹´ - è³¼å…¥æ‰‹ç¶šãã‚’å®Ÿè¡Œ Step 3: ãƒ¡ãƒ¼ãƒ«æ‰¿èª # è³¼å…¥å¾Œã€ä»¥ä¸‹ã®ãƒ¡ãƒ¼ãƒ«ãŒå±Šãã¾ã™ã€‚å†…å®¹ã‚’ç¢ºèªã—ã¦æ‰¿èªã—ã¦ãã ã•ã„ã€‚\n[Action Required] Verify your email address for xxx.com\næ³¨æ„ï¼šæ‰¿èªãƒ¡ãƒ¼ãƒ«ãŒè¿·æƒ‘ãƒ¡ãƒ¼ãƒ«ãƒ•ã‚©ãƒ«ãƒ€ã«å…¥ã£ã¦ã„ã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚ï¼ˆè‡ªåˆ†ã‚‚ãã†ã§ã—ãŸã€‚ï¼‰\nStep 4: ç¢ºèª # Route53 â†’ ãƒ›ã‚¹ãƒˆã‚¾ãƒ¼ãƒ³ ã§ã€è³¼å…¥ã—ãŸãƒ‰ãƒ¡ã‚¤ãƒ³ã®ãƒ›ã‚¹ãƒˆã‚¾ãƒ¼ãƒ³ãŒä½œæˆã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¾ã™ã€‚\nåˆæœŸçŠ¶æ…‹ã§ã¯NSãƒ¬ã‚³ãƒ¼ãƒ‰ã¨SOAãƒ¬ã‚³ãƒ¼ãƒ‰ã®2ä»¶ãŒç™»éŒ²ã•ã‚Œã¦ã„ã¾ã™ã€‚ã“ã‚Œã¯æ­£å¸¸ã§ã™ã€‚\nTerraformç®¡ç†ç¯„å›²ã«ã¤ã„ã¦ # ãƒ‰ãƒ¡ã‚¤ãƒ³è³¼å…¥ã¯Terraformã§ç®¡ç†ã§ãã¾ã›ã‚“ã€‚\nå¯¾è±¡ Terraformç®¡ç† ç†ç”± ãƒ‰ãƒ¡ã‚¤ãƒ³è³¼å…¥ âŒ ä¸å¯ ä¸€åº¦ãã‚Šã®æ“ä½œã€é€£çµ¡å…ˆå…¥åŠ›ãŒå¿…è¦ ãƒ›ã‚¹ãƒˆã‚¾ãƒ¼ãƒ³ â–³ å‚ç…§ã®ã¿ è³¼å…¥æ™‚ã«è‡ªå‹•ä½œæˆã•ã‚Œã‚‹ DNSãƒ¬ã‚³ãƒ¼ãƒ‰ âœ… ç®¡ç†å¯èƒ½ A, CNAME, ACMæ¤œè¨¼ãƒ¬ã‚³ãƒ¼ãƒ‰ ã¾ã¨ã‚ # Route53ã§ãƒ‰ãƒ¡ã‚¤ãƒ³è³¼å…¥ã¯æ•°ã‚¯ãƒªãƒƒã‚¯ã§å®Œäº† .devãªã©ä¸€éƒ¨ã®TLDã¯Route53ã§è³¼å…¥ä¸å¯ ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ä¿è­·ã¨è‡ªå‹•æ›´æ–°ã¯æœ‰åŠ¹ã«ã—ã¦ãŠã æ‰¿èªãƒ¡ãƒ¼ãƒ«ãŒè¿·æƒ‘ãƒ¡ãƒ¼ãƒ«ã«å…¥ã‚‹ã“ã¨ãŒã‚ã‚‹ã®ã§æ³¨æ„ ãƒ‰ãƒ¡ã‚¤ãƒ³è³¼å…¥ã¯Terraformç®¡ç†å¤–ã€DNSãƒ¬ã‚³ãƒ¼ãƒ‰ã¯Terraformã§ç®¡ç†å¯èƒ½ å‚è€ƒ # Route 53ã§ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚’è³¼å…¥ã—ã¦ã¿ãŸ | DevelopersIO Route53 ãƒ‰ãƒ¡ã‚¤ãƒ³ä¾¡æ ¼è¡¨ï¼ˆ2025å¹´9æœˆæ›´æ–°ï¼‰ ","date":"2025å¹´ 12æœˆ 3æ—¥","externalUrl":null,"permalink":"/posts/251203194756_route53-domain-purchase-procedure-and-notes/","section":"Posts","summary":"","title":"Route53ã§ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚’è³¼å…¥ã™ã‚‹æ‰‹é †ã¨æ³¨æ„ç‚¹","type":"posts"},{"content":" ä»Šæ—¥å­¦ã‚“ã ã“ã¨ # Terraformã§ãƒªãƒ¢ãƒ¼ãƒˆãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ï¼ˆS3 + DynamoDBï¼‰ã‚’ä½¿ã†å ´åˆã€ ã€Œtfstateç”¨ã®S3/DynamoDBã ã‘ã¯å…ˆã«åˆ¥ã§ä½œã‚‹ã€å¿…è¦ãŒã‚ã‚‹ã“ã¨ã‚’å­¦ã³ã¾ã—ãŸã€‚ ã“ã‚Œã¯ã€Œé¶ã¨åµå•é¡Œã€ã¨å‘¼ã°ã‚Œã¾ã™ã€‚\nå­¦ç¿’å†…å®¹ # é¶ã¨åµå•é¡Œã¨ã¯ # Terraformã§ S3, CloudFront, Route53... ã‚’ä½œã‚ŠãŸã„ â†“ tfstateã‚’S3ã«ä¿å­˜ã—ãŸã„ â†“ ã§ã‚‚ã€ãã®S3è‡ªä½“ã‚’Terraformã§ä½œã‚‹ã¨... â†“ ã€Œtfstateç”¨S3ã®tfstateã€ã¯ã©ã“ã«ä¿å­˜ã™ã‚‹ï¼Ÿ â† ç„¡é™ãƒ«ãƒ¼ãƒ— ã“ã®å¾ªç’°å‚ç…§ã‚’æ–­ã¡åˆ‡ã‚‹ãŸã‚ã€tfstateç”¨ã®S3/DynamoDBã ã‘ã¯æœ€åˆã«åˆ¥ã§ä½œæˆã—ã¾ã™ã€‚\nå„ãƒªã‚½ãƒ¼ã‚¹ã®å½¹å‰² # ã‚µãƒ¼ãƒ“ã‚¹ å½¹å‰² S3 tfstateãƒ•ã‚¡ã‚¤ãƒ«ã®ä¿å­˜å ´æ‰€ DynamoDB ãƒ­ãƒƒã‚¯æ©Ÿæ§‹ï¼ˆåŒæ™‚ç·¨é›†é˜²æ­¢ï¼‰ è§£æ±ºç­–ï¼šbackend-setupãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª # fumi-til-infrastructure/ â”œâ”€â”€ backend-setup/ â† æœ€åˆã«ã“ã‚Œã ã‘å®Ÿè¡Œ â”‚ â”œâ”€â”€ main.tf â”‚ â””â”€â”€ terraform.tfstate â† ãƒ­ãƒ¼ã‚«ãƒ«ã«æ®‹ã‚‹ â””â”€â”€ environments/ â””â”€â”€ prod/ â† backend-setupå®Œäº†å¾Œã«å®Ÿè¡Œ â””â”€â”€ main.tf æ³¨æ„ç‚¹ # backend-setupè‡ªä½“ã®tfstateã¯ãƒ­ãƒ¼ã‚«ãƒ«ã«æ®‹ã‚‹ .gitignoreã§é™¤å¤–ã—ã¤ã¤ã€ãƒ­ãƒ¼ã‚«ãƒ«ã§å¤§åˆ‡ã«ä¿ç®¡ è£œè¶³ï¼šã“ã®æ–¹æ³•ã¯å”¯ä¸€ã®æ­£è§£ã§ã¯ãªã„ # æœ¬è¨˜äº‹ã§ç´¹ä»‹ã—ãŸã€Œbackend-setupãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã§tfstateç”¨ã‚¤ãƒ³ãƒ•ãƒ©ã‚’ä½œæˆã™ã‚‹ã€æ–¹æ³•ã¯ã€ã‚ˆãä½¿ã‚ã‚Œã‚‹æ–¹æ³•ã®ä¸€ã¤ã§ã™ãŒã€å”¯ä¸€ã®æ­£è§£ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚\nTerragruntã®é–‹ç™ºå…ƒã§ã‚ã‚‹Gruntworkã®å…¬å¼ãƒ‡ã‚£ã‚¹ã‚«ãƒƒã‚·ãƒ§ãƒ³ã§ã¯ã€ä»¥ä¸‹ã®æ–¹æ³•ãŒä¸¦åˆ—ã§ç´¹ä»‹ã•ã‚Œã¦ã„ã¾ã™ã€‚\næ–¹æ³• æ¦‚è¦ ãƒ¡ãƒªãƒƒãƒˆ ãƒ‡ãƒ¡ãƒªãƒƒãƒˆ æ‰‹å‹•ä½œæˆï¼ˆã‚³ãƒ³ã‚½ãƒ¼ãƒ«/CLIï¼‰ AWSã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã‚„CLIã§ç›´æ¥ä½œæˆ ã‚·ãƒ³ãƒ—ãƒ«ã€é¶ã¨åµå•é¡Œãªã— IaCåŸå‰‡ã«åã™ã‚‹ã€æ‰‹é †ãŒæ®‹ã‚‰ãªã„ Terraformã§ä½œæˆï¼ˆæœ¬è¨˜äº‹ã®æ–¹å¼ï¼‰ åˆ¥ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã§Terraformç®¡ç† IaCã§ç®¡ç†å¯èƒ½ ãƒ­ãƒ¼ã‚«ãƒ«tfstateã®ç®¡ç†ãŒèª²é¡Œ CloudFormation/CDK AWSãƒã‚¤ãƒ†ã‚£ãƒ–ãƒ„ãƒ¼ãƒ«ã§ä½œæˆ AWSå†…ã§å®Œçµ ãƒ„ãƒ¼ãƒ«æ··åœ¨ Terragrunt è‡ªå‹•ã§ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ä½œæˆ DRYã€ç’°å¢ƒç®¡ç†ãŒæ¥½ å­¦ç¿’ã‚³ã‚¹ãƒˆ Terraform Cloud/Enterprise ãƒãƒãƒ¼ã‚¸ãƒ‰ã‚µãƒ¼ãƒ“ã‚¹ é‹ç”¨ãŒæ¥½ æœ‰æ–™ Gruntworkã®è¦‹è§£ # Gruntworkã®ãƒ‡ã‚£ã‚¹ã‚«ãƒƒã‚·ãƒ§ãƒ³ã§ã¯ã€æ‰‹å‹•ä½œæˆã«ã¤ã„ã¦ä»¥ä¸‹ã®ã‚ˆã†ã«è¿°ã¹ã‚‰ã‚Œã¦ã„ã¾ã™ã€‚\nã€Œã“ã‚Œã¯å§‹ã‚ã‚‹ãŸã‚ã®ç°¡å˜ãªæ–¹æ³•ã§ã™ã€‚ç®¡ç†ã™ã‚‹ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ãŒå°‘æ•°ï¼ˆä¾‹ï¼šä¼šç¤¾å…¨ä½“ã§1ã€œ3å€‹ã®S3ãƒã‚±ãƒƒãƒˆã®ã¿ï¼‰ã§ã‚ã‚Œã°ã€ã“ã®ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã§ååˆ†ã†ã¾ãã„ãã¾ã™ã€‚ã€\nä¸€æ–¹ã§ã€æ‰‹å‹•ä½œæˆã®ãƒ‡ãƒ¡ãƒªãƒƒãƒˆã¨ã—ã¦ã€Œæ‰‹å‹•ãƒ—ãƒ­ã‚»ã‚¹ã§ã‚ã‚‹ã€ã€Œã™ã¹ã¦ã®ã‚¤ãƒ³ãƒ•ãƒ©ã‚’ã‚³ãƒ¼ãƒ‰ã§ç®¡ç†ã§ãã¦ã„ãªã„ã€ã€Œãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ–¹æ³•ãŒãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆåŒ–ã•ã‚Œãªã„ã€ã‚‚æŒ‡æ‘˜ã•ã‚Œã¦ã„ã¾ã™ã€‚\nãƒ‡ã‚£ã‚¹ã‚«ãƒƒã‚·ãƒ§ãƒ³ã®å†…å®¹ã‚’è‡ªåˆ†ãªã‚Šè§£é‡ˆã™ã‚‹ã¨ã€Œè¦æ¨¡ãŒå°ã•ã„å ´åˆã¯S3/DynamoDBãªã©ã‚’ä½¿ç”¨ã™ã‚‹ã€‚é–‹ç™ºè¦æ¨¡ãŒå¤§ãããªã‚Šã€è‡ªå‹•åŒ–ãªã©ãŒå¿…è¦ã®å ´åˆã¯Terragruntã«ã‚ˆã‚‹è‡ªå‹•ä½œæˆãŒãŠã™ã™ã‚ã€ã¨ã„ã†å°è±¡ã§ã—ãŸã€‚\nçŠ¶æ³åˆ¥ã®æ¨å¥¨ # çŠ¶æ³ æ¨å¥¨æ–¹æ³• å€‹äººé–‹ç™ºãƒ»å­¦ç¿’ æ‰‹å‹•ä½œæˆ or Terraformï¼ˆæœ¬è¨˜äº‹ã®æ–¹å¼ï¼‰ å°è¦æ¨¡ãƒãƒ¼ãƒ  Terraform + tfstateã‚’S3ã«æ‰‹å‹•ã‚³ãƒ”ãƒ¼ ä¸­è¦æ¨¡ä»¥ä¸Š Terragrunt or Terraform Cloud ã‚¨ãƒ³ã‚¿ãƒ¼ãƒ—ãƒ©ã‚¤ã‚º Terraform Cloud/Enterprise é‡è¦ãªã®ã¯ã€ãƒãƒ¼ãƒ ã®è¦æ¨¡ã‚„ã‚¹ã‚­ãƒ«ã‚»ãƒƒãƒˆã«åˆã£ãŸæ–¹æ³•ã‚’é¸ã¶ã“ã¨ã§ã™ã€‚\nã¾ã¨ã‚ # tfstateç”¨ã®S3/DynamoDBã¯ã€Œå…ˆã«åˆ¥ã§ä½œã‚‹ã€å¿…è¦ãŒã‚ã‚‹ï¼ˆé¶ã¨åµå•é¡Œï¼‰ backend-setupè‡ªä½“ã®tfstateã¯ãƒ­ãƒ¼ã‚«ãƒ«ç®¡ç†ã¨ãªã‚‹ S3ã¯ä¿å­˜ã€DynamoDBã¯ãƒ­ãƒƒã‚¯ã®å½¹å‰² æœ¬è¨˜äº‹ã®æ–¹æ³•ã¯ã€Œã‚ˆãä½¿ã‚ã‚Œã‚‹æ–¹æ³•ã®ä¸€ã¤ã€ã§ã‚ã‚Šã€çŠ¶æ³ã«å¿œã˜ã¦ä»–ã®æ–¹æ³•ã‚‚æ¤œè¨ã™ã¹ã å‚è€ƒ # Terraformã‚¹ãƒ†ãƒ¼ãƒˆç®¡ç† Part1 - S3ãƒªãƒ¢ãƒ¼ãƒˆãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã¨ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ Backend Configuration - Terraform How should I create the backend for storing Terraform state? - Gruntwork Discussion Initial setup of terraform backend using terraform - Stack Overflow ","date":"2025å¹´ 12æœˆ 3æ—¥","externalUrl":null,"permalink":"/posts/251203194515_terraform-tfstate-management-chicken-egg-problem/","section":"Posts","summary":"","title":"Terraform tfstateç®¡ç†ã®é¶ã¨åµå•é¡Œ","type":"posts"},{"content":"","date":"2025å¹´ 12æœˆ 3æ—¥","externalUrl":null,"permalink":"/tags/acm/","section":"Tags","summary":"","title":"ACM","type":"tags"},{"content":" ä»Šæ—¥å­¦ã‚“ã ã“ã¨ # ACMï¼ˆAWS Certificate Managerï¼‰ã¯SSL/TLSè¨¼æ˜æ›¸ã‚’ç„¡æ–™ã§ç™ºè¡Œãƒ»è‡ªå‹•æ›´æ–°ã§ãã‚‹AWSã‚µãƒ¼ãƒ“ã‚¹ã€‚ CloudFrontã¨çµ„ã¿åˆã‚ã›ã‚‹ã“ã¨ã§ã€ã‚«ã‚¹ã‚¿ãƒ ãƒ‰ãƒ¡ã‚¤ãƒ³ã§ã®HTTPSé€šä¿¡ã‚’å®Ÿç¾ã§ãã¾ã™ã€‚\nå­¦ç¿’å†…å®¹ # ACMã¨ã¯ # ACM = AWS Certificate Manager\nSSL/TLSè¨¼æ˜æ›¸ã‚’ç®¡ç†ã™ã‚‹AWSã‚µãƒ¼ãƒ“ã‚¹ã§ã™ã€‚\nSSL/TLSè¨¼æ˜æ›¸ã®å½¹å‰² # SSL/TLSè¨¼æ˜æ›¸ã«ã¯2ã¤ã®å½¹å‰²ãŒã‚ã‚Šã¾ã™\nå½¹å‰² èª¬æ˜ é€šä¿¡ã®æš—å·åŒ– HTTPSé€šä¿¡ã‚’å®Ÿç¾ï¼ˆHTTP = æš—å·åŒ–ãªã—ã€HTTPS = æš—å·åŒ–ã‚ã‚Šï¼‰ ã‚µã‚¤ãƒˆã®è¨¼æ˜ ã€Œã“ã®ã‚µã‚¤ãƒˆã¯æœ¬ç‰©ã§ã™ã€ã‚’ä¿è¨¼ ACMã®ãƒ¡ãƒªãƒƒãƒˆ # å¾“æ¥ã®æ–¹æ³•ã¨æ¯”è¼ƒã™ã‚‹ã¨ã€ACMã®ãƒ¡ãƒªãƒƒãƒˆãŒæ˜ç¢ºã§ã™\nç„¡æ–™ AWSå´ã§è‡ªå‹•è¨­å®š æœ‰åŠ¹æœŸé™åˆ‡ã‚Œã«å¯¾ã—ã¦è‡ªå‹•æ›´æ–° CloudFrontã§ã®æ§‹æˆ # ãƒ¦ãƒ¼ã‚¶ãƒ¼ â†“ HTTPSï¼ˆæš—å·åŒ–é€šä¿¡ï¼‰ CloudFront â† ACMè¨¼æ˜æ›¸ã§ã€Œexample.comã€ã‚’è¨¼æ˜ â†“ S3ï¼ˆã‚³ãƒ³ãƒ†ãƒ³ãƒ„ï¼‰ ACMè¨¼æ˜æ›¸ãŒãªã„ã¨ https://example.com ã§ã‚¢ã‚¯ã‚»ã‚¹ã§ããšã€ãƒ–ãƒ©ã‚¦ã‚¶ã«è­¦å‘ŠãŒå‡ºã¾ã™ã€‚\né‡è¦ãªåˆ¶ç´„ # CloudFrontã§ACMè¨¼æ˜æ›¸ã‚’ä½¿ç”¨ã™ã‚‹å ´åˆã€è¨¼æ˜æ›¸ã¯å¿…ãšus-east-1ï¼ˆãƒãƒ¼ã‚¸ãƒ‹ã‚¢åŒ—éƒ¨ï¼‰ã§ä½œæˆã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚\nCloudFrontã§ã®åˆ©ç”¨ï¼šAmazon CloudFrontã§ACMè¨¼æ˜æ›¸ã‚’ä½¿ç”¨ã™ã‚‹å ´åˆã€è¨¼æ˜æ›¸ã¯å¿…ãšUS East (N. Virginia) ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ã§ãƒªã‚¯ã‚¨ã‚¹ãƒˆã¾ãŸã¯ã‚¤ãƒ³ãƒãƒ¼ãƒˆã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ â€” AWS Certificate Manager Overview\nã¾ã¨ã‚ # ACMã¯SSL/TLSè¨¼æ˜æ›¸ã‚’ç„¡æ–™ã§ç™ºè¡Œãƒ»è‡ªå‹•æ›´æ–°ã§ãã‚‹ã‚µãƒ¼ãƒ“ã‚¹ å¾“æ¥ã®è¨¼æ˜æ›¸ç®¡ç†ã¨æ¯”ã¹ã¦ã€ã‚³ã‚¹ãƒˆãƒ»æ‰‹é–“ãŒå¤§å¹…ã«å‰Šæ¸›ã•ã‚Œã‚‹ CloudFrontã¨çµ„ã¿åˆã‚ã›ã¦HTTPSé€šä¿¡ã‚’å®Ÿç¾ CloudFrontã§ä½¿ç”¨ã™ã‚‹å ´åˆã¯us-east-1ã§ç™ºè¡ŒãŒå¿…è¦ å‚è€ƒ # AWS Certificate Manager Overview Supported Regions - AWS Certificate Manager ","date":"2025å¹´ 12æœˆ 3æ—¥","externalUrl":null,"permalink":"/posts/251203194354_acm-certificate-ssl-tls-basics-cloudfront-integration/","section":"Posts","summary":"","title":"ACMè¨¼æ˜æ›¸ã¨ã¯ï¼ŸSSL/TLSè¨¼æ˜æ›¸ã®åŸºç¤ã‹ã‚‰CloudFronté€£æºã¾ã§","type":"posts"},{"content":" ä»Šæ—¥å­¦ã‚“ã ã“ã¨ # Terraform ã‚’ä½¿ã†ä¸Šã§ã®ã¤ã¾ãšããƒã‚¤ãƒ³ãƒˆã¨å›é¿ç­–ã«ã¤ã„ã¦å­¦ã³ã¾ã—ãŸã€‚count/for_each ã®åˆ¶é™äº‹é …ã€plan ãŒæˆåŠŸã—ã¦ã‚‚ apply ãŒå¤±æ•—ã™ã‚‹ã‚±ãƒ¼ã‚¹ã€ãã—ã¦ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°æ™‚ã®æ³¨æ„ç‚¹ã‚’ç†è§£ã—ã¾ã—ãŸã€‚\nå­¦ç¿’å†…å®¹ # count ã¨ for_each ã®åˆ¶é™äº‹é … # ãƒªã‚½ãƒ¼ã‚¹å‡ºåŠ›ã‚’å‚ç…§ã§ããªã„ # Terraform ã¯ plan ãƒ•ã‚§ãƒ¼ã‚ºä¸­ã« count ã¨ for_each ã‚’è¨ˆç®—ã§ãã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ãƒªã‚½ãƒ¼ã‚¹ãŒä½œæˆãƒ»å¤‰æ›´ã•ã‚Œã‚‹å‰ã«å€¤ãŒæ±ºã¾ã£ã¦ã„ãªã‘ã‚Œã°ãªã‚Šã¾ã›ã‚“ã€‚\nå€¤ã®ç¨®é¡ ä¾‹ count/for_each ã§ä½¿ç”¨ ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‰ 3, [\u0026quot;a\u0026quot;, \u0026quot;b\u0026quot;] âœ… å¯èƒ½ å¤‰æ•° var.user_names âœ… å¯èƒ½ ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ï¼ˆé™çš„ï¼‰ data.aws_ami.example.id âœ… å¯èƒ½ï¼ˆå ´åˆã«ã‚ˆã‚‹ï¼‰ ãƒªã‚½ãƒ¼ã‚¹å‡ºåŠ› aws_instance.example.id âŒ ä¸å¯ ãƒªã‚½ãƒ¼ã‚¹å‡ºåŠ›ãŒä½¿ãˆãªã„ç†ç”±ã¯ã€ä»¥ä¸‹ã®å‡¦ç†é †åºã«ã‚ã‚Šã¾ã™ã€‚\nplan ãƒ•ã‚§ãƒ¼ã‚º â†“ count/for_each ã‚’è¨ˆç®—ï¼ˆã“ã®æ™‚ç‚¹ã§å€¤ãŒå¿…è¦ï¼‰ â†“ apply ãƒ•ã‚§ãƒ¼ã‚º â†“ ãƒªã‚½ãƒ¼ã‚¹ãŒä½œæˆã•ã‚Œã‚‹ï¼ˆå‡ºåŠ›å€¤ãŒæ±ºã¾ã‚‹ï¼‰â† é…ã™ãã‚‹ï¼ æœ‰åŠ¹ãªãƒ—ãƒ©ãƒ³ã‚‚å¤±æ•—ã™ã‚‹ã“ã¨ãŒã‚ã‚‹ # terraform validate ã‚„ terraform plan ã§å•é¡Œãªã—ã¨åˆ¤å®šã•ã‚Œã¦ã‚‚ã€terraform apply ã§ã‚¨ãƒ©ãƒ¼ã«ãªã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚\nå…·ä½“ä¾‹ï¼šIAM ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®é‡è¤‡ # resource \u0026#34;aws_iam_user\u0026#34; \u0026#34;example\u0026#34; { name = \u0026#34;user1\u0026#34; } ã‚³ãƒãƒ³ãƒ‰ çµæœ terraform validate âœ… Success terraform plan âœ… 1 to add terraform apply âŒ ã‚¨ãƒ©ãƒ¼ å®Ÿéš›ã®ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ï¼š\nâ”‚ Error: creating IAM User (user1): EntityAlreadyExists: User with name user1 already exists. ãªãœèµ·ã“ã‚‹ã®ã‹ # Terraform ã¯è‡ªèº«ãŒç®¡ç†ã—ã¦ã„ã‚‹ãƒªã‚½ãƒ¼ã‚¹ï¼ˆã‚¹ãƒ†ãƒ¼ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ï¼‰ã—ã‹æŠŠæ¡ã—ã¦ã„ãªã„ AWS ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã‚„åˆ¥ã® Terraform ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ä½œæˆã•ã‚ŒãŸãƒªã‚½ãƒ¼ã‚¹ã¯æ¤œçŸ¥ã§ããªã„ plan æ™‚ç‚¹ã§ã¯ AWS ã«å•ã„åˆã‚ã›ãªã„ãŸã‚ã€é‡è¤‡ã‚’æ¤œå‡ºã§ããªã„ å¯¾ç­– # å¯¾ç­– èª¬æ˜ Terraform ã ã‘ã‚’ä½¿ã† ã‚¤ãƒ³ãƒ•ãƒ©ã®ç®¡ç†æ–¹æ³•ã‚’ Terraform ã«çµ±ä¸€ã—ã€æ‰‹å‹•ä½œæˆã‚’ç¦æ­¢ import ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ æ—¢å­˜ã®ã‚¤ãƒ³ãƒ•ãƒ©ã‚’ Terraform ã®ã‚¹ãƒ†ãƒ¼ãƒˆã«å–ã‚Šè¾¼ã‚€ terraform import aws_iam_user.example user1 ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã¯é›£ã—ã„ # ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã¨ã¯ã€å¤–éƒ¨çš„ãªãµã‚‹ã¾ã„ã¯å¤‰æ›´ã›ãšã€æ—¢å­˜ã‚³ãƒ¼ãƒ‰ã®å†…éƒ¨æ§‹é€ ã‚’æ•´ç†ã™ã‚‹ã“ã¨ã§ã™ã€‚\nTerraform ã§ã®å•é¡Œ # Terraform ã¯ãƒªã‚½ãƒ¼ã‚¹ã‚’è­˜åˆ¥å­ï¼ˆãƒªã‚½ãƒ¼ã‚¹ã‚¿ã‚¤ãƒ— + ãƒªã‚½ãƒ¼ã‚¹åï¼‰ã§ç®¡ç†ã—ã¦ã„ã¾ã™ã€‚\n# å¤‰æ›´å‰ resource \u0026#34;aws_instance\u0026#34; \u0026#34;example\u0026#34; { } # å¤‰æ›´å¾Œï¼ˆãƒªã‚½ãƒ¼ã‚¹åã‚’å¤‰æ›´ï¼‰ resource \u0026#34;aws_instance\u0026#34; \u0026#34;web_server\u0026#34; { } å¤‰æ›´ äººé–“ã®æ„å›³ Terraform ã®è§£é‡ˆ example â†’ web_server åå‰ã‚’æ•´ç†ã—ãŸã ã‘ example ã‚’å‰Šé™¤ã—ã¦ web_server ã‚’æ–°è¦ä½œæˆ æœ¬ç•ªç’°å¢ƒã§å®Ÿè¡Œã™ã‚‹ã¨ã€EC2 ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãŒå‰Šé™¤ã•ã‚Œã¦ã—ã¾ã„ã¾ã™ã€‚\nãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã®4ã¤ã®æ•™è¨“ # æ•™è¨“1ï¼šã„ã¤ã‚‚ plan ã‚³ãƒãƒ³ãƒ‰ã‚’åˆ©ç”¨ã™ã‚‹ # å¤‰æ›´ã‚„ä½œæˆã•ã‚Œã‚‹å†…å®¹ã‚’äº‹å‰ã«ç¢ºèªã—ã¾ã™ã€‚äºˆæœŸã—ãªã„å‰Šé™¤ãƒ»ä½œæˆãŒãªã„ã‹ãƒã‚§ãƒƒã‚¯ã—ã¾ã—ã‚‡ã†ã€‚\næ•™è¨“2ï¼šå‰Šé™¤ã™ã‚‹å‰ã«ä½œæˆ # ãƒªã‚½ãƒ¼ã‚¹ã®ç½®ãæ›ãˆæ™‚ã¯ã€å…ˆã«ç½®ãæ›ãˆå…ˆã‚’ä½œæˆã—ã¦ã‹ã‚‰ã€å¤ã„ãƒªã‚½ãƒ¼ã‚¹ã‚’å‰Šé™¤ã—ã¾ã™ã€‚\nlifecycle { create_before_destroy = true } æ•™è¨“3ï¼šãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã«ã¯ã‚¹ãƒ†ãƒ¼ãƒˆã®å¤‰æ›´ãŒå¿…è¦ãªå ´åˆãŒã‚ã‚‹ # ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ ã‚’èµ·ã“ã•ãšã«ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã—ãŸã„ãªã‚‰ã€Terraform ã‚¹ãƒ†ãƒ¼ãƒˆã‚‚æ›´æ–°ã—ã¾ã™ã€‚\næ–¹æ³• èª¬æ˜ terraform state mv ã‚³ãƒãƒ³ãƒ‰ã§ã‚¹ãƒ†ãƒ¼ãƒˆã‚’ç§»å‹• moved ãƒ–ãƒ­ãƒƒã‚¯ ã‚³ãƒ¼ãƒ‰å†…ã§ã‚¹ãƒ†ãƒ¼ãƒˆã®ç§»è¡Œã‚’è‡ªå‹•å®Ÿè¡Œ terraform state mv ã®ä¾‹ï¼š\nterraform state mv aws_instance.example aws_instance.web_server moved ãƒ–ãƒ­ãƒƒã‚¯ã®ä¾‹ï¼š\nmoved { from = aws_instance.example to = aws_instance.web_server } moved ãƒ–ãƒ­ãƒƒã‚¯ã®å¿œç”¨ä¾‹ï¼š\n# ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«åã®å¤‰æ›´ moved { from = module.webserver_cluster to = module.web } # ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«å†…ã®ãƒªã‚½ãƒ¼ã‚¹ã‚’ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«å¤–ã«ç§»å‹• moved { from = module.webserver_cluster.aws_security_group.instance to = aws_security_group.instance } moved ãƒ–ãƒ­ãƒƒã‚¯ã®ãƒ¡ãƒªãƒƒãƒˆã¯ã€ã‚³ãƒ¼ãƒ‰ã¨ã—ã¦æ®‹ã‚‹ãŸã‚ãƒãƒ¼ãƒ ãƒ¡ãƒ³ãƒãƒ¼ãŒå¤‰æ›´å±¥æ­´ã‚’è¿½è·¡ã§ãã‚‹ã“ã¨ã€ãã—ã¦ terraform plan ã§ç§»å‹•ãŒæ­£ã—ãæ¤œå‡ºã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèªã§ãã‚‹ç‚¹ã§ã™ã€‚\næ•™è¨“4ï¼šã‚¤ãƒŸãƒ¥ãƒ¼ã‚¿ãƒ–ãƒ«ãªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚‚ã‚ã‚‹ # ä¸€éƒ¨ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¯å¤‰æ›´ã™ã‚‹ã¨ãƒªã‚½ãƒ¼ã‚¹ã®å†ä½œæˆãŒå¿…è¦ã«ãªã‚Šã¾ã™ï¼ˆã‚¤ãƒ³ãƒ—ãƒ¬ãƒ¼ã‚¹æ›´æ–°ãŒã§ããªã„ï¼‰ã€‚ä¾‹ãˆã° EC2 ã® ami ã‚„ RDS ã® engine ãªã©ãŒã“ã‚Œã«è©²å½“ã—ã¾ã™ã€‚\nã¾ã¨ã‚ # ã¤ã¾ãšããƒã‚¤ãƒ³ãƒˆ å›é¿ç­– count/for_each ã§ãƒªã‚½ãƒ¼ã‚¹å‡ºåŠ›ã‚’å‚ç…§ ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‰ã‚„å¤‰æ•°ã‚’ä½¿ã† plan æˆåŠŸã§ã‚‚ apply å¤±æ•— Terraform ã«çµ±ä¸€ã€ã¾ãŸã¯ import ã‚’ä½¿ç”¨ ãƒªã‚½ãƒ¼ã‚¹åå¤‰æ›´ã§å‰Šé™¤ã•ã‚Œã‚‹ moved ãƒ–ãƒ­ãƒƒã‚¯ã‚„ terraform state mv ã‚’ä½¿ã† ã‚¤ãƒŸãƒ¥ãƒ¼ã‚¿ãƒ–ãƒ«ãªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®å¤‰æ›´ create_before_destroy ã§å¯¾å¿œ count/for_each ã¯ plan ãƒ•ã‚§ãƒ¼ã‚ºã§è¨ˆç®—ã•ã‚Œã‚‹ãŸã‚ã€ãƒªã‚½ãƒ¼ã‚¹å‡ºåŠ›ã‚’å‚ç…§ã§ããªã„ Terraform ã¯è‡ªèº«ãŒç®¡ç†ã—ã¦ã„ã‚‹ãƒªã‚½ãƒ¼ã‚¹ã—ã‹æŠŠæ¡ã—ã¦ã„ãªã„ ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°æ™‚ã¯ moved ãƒ–ãƒ­ãƒƒã‚¯ã‚’æ´»ç”¨ã—ã¦ã‚¹ãƒ†ãƒ¼ãƒˆã‚’æ›´æ–°ã™ã‚‹ ã„ã¤ã‚‚ plan ã‚³ãƒãƒ³ãƒ‰ã§å¤‰æ›´å†…å®¹ã‚’äº‹å‰ç¢ºèªã™ã‚‹ å‚è€ƒ # è©³è§£ Terraform ç¬¬3ç‰ˆ - Yevgeniy Brikmanè‘—ã€æ¾æµ¦éš¼äººè¨³ã€ã‚ªãƒ©ã‚¤ãƒªãƒ¼ã‚¸ãƒ£ãƒ‘ãƒ³ã€2023å¹´ Refactoring (moved blocks) State: terraform state mv Import The lifecycle Meta-Argument ","date":"2025å¹´ 12æœˆ 2æ—¥","externalUrl":null,"permalink":"/posts/251202083121_terraform-stumbling-points-and-solutions/","section":"Posts","summary":"","title":"Terraform ã®ã¤ã¾ãšããƒã‚¤ãƒ³ãƒˆã¨å›é¿ç­–","type":"posts"},{"content":"","date":"2025å¹´ 12æœˆ 2æ—¥","externalUrl":null,"permalink":"/tags/devops/","section":"Tags","summary":"","title":"DevOps","type":"tags"},{"content":" ä»Šæ—¥å­¦ã‚“ã ã“ã¨ # Terraform ã§ ASGï¼ˆAuto Scaling Groupï¼‰ã‚’ä½¿ã£ãŸã‚¼ãƒ­ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ ãƒ‡ãƒ—ãƒ­ã‚¤ã‚’å®Ÿç¾ã™ã‚‹æ–¹æ³•ã‚’å­¦ã³ã¾ã—ãŸã€‚create_before_destroy ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ã¨ min_elb_capacity ã‚’çµ„ã¿åˆã‚ã›ã‚‹ã“ã¨ã§ã€ã‚µãƒ¼ãƒ“ã‚¹ã‚’åœæ­¢ã›ãšã«ã‚¤ãƒ³ãƒ•ãƒ©ã‚’æ›´æ–°ã§ãã¾ã™ã€‚\nå­¦ç¿’å†…å®¹ # èƒŒæ™¯ã¨å•é¡Œ # webserver-cluster ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã§ user-data.sh ã®å†…å®¹ï¼ˆserver_text ãªã©ï¼‰ã‚’å¤‰æ›´ã—ãŸå ´åˆã€ä»¥ä¸‹ã®ã‚ˆã†ãªå‹•ä½œã«ãªã‚Šã¾ã™ã€‚\næ–°ã—ã„ Launch Configuration ãŒä½œæˆã•ã‚Œã‚‹ ASG ãŒæ–°ã—ã„ Launch Configuration ã‚’å‚ç…§ã™ã‚‹ã‚ˆã†ã«ãªã‚‹ ã—ã‹ã—ã€æ—¢å­˜ã® EC2 ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã¯ãã®ã¾ã¾ï¼ Launch Configuration ã¯æ–°ã—ã„ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’èµ·å‹•ã™ã‚‹éš›ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã§ã‚ã‚Šã€æ—¢å­˜ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã«ã¯å½±éŸ¿ã—ã¾ã›ã‚“ã€‚\nè§£æ±ºç­–ã®æ¯”è¼ƒ # æ–¹æ³• æ‰‹é † å•é¡Œç‚¹ ASG ã‚’å‰Šé™¤ã—ã¦å†ä½œæˆ å¤ã„ ASG å‰Šé™¤ â†’ æ–°ã—ã„ ASG ä½œæˆ ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ ãŒç™ºç”Ÿ create_before_destroy æ–°ã—ã„ ASG ä½œæˆ â†’ å¤ã„ ASG å‰Šé™¤ ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ ãªã— âœ… ã‚¼ãƒ­ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ ãƒ‡ãƒ—ãƒ­ã‚¤ã«å¿…è¦ãª3ã¤ã®è¨­å®š # # è¨­å®š ç›®çš„ 1 name ã‚’èµ·å‹•è¨­å®šã®åå‰ã«ä¾å­˜ã•ã›ã‚‹ èµ·å‹•è¨­å®šãŒå¤‰ã‚ã‚‹ã¨ ASG åã‚‚å¤‰ã‚ã‚Šã€ç½®ãæ›ãˆãŒç™ºç”Ÿ 2 create_before_destroy = true æ–°ã—ã„ ASG ã‚’å…ˆã«ä½œæˆã—ã¦ã‹ã‚‰å¤ã„ã‚‚ã®ã‚’å‰Šé™¤ 3 min_elb_capacity = min_size æ–°ã—ã„ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãŒ ELB ã®ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ã«åˆæ ¼ã™ã‚‹ã¾ã§å¾…æ©Ÿ ã‚³ãƒ¼ãƒ‰ä¾‹ï¼šã‚¼ãƒ­ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ ãƒ‡ãƒ—ãƒ­ã‚¤å¯¾å¿œã® ASG # resource \u0026#34;aws_autoscaling_group\u0026#34; \u0026#34;example\u0026#34; { # 1. ASGåãŒèµ·å‹•è¨­å®šã®åå‰ã‚’å‚ç…§ï¼ˆèµ·å‹•è¨­å®šãŒå¤‰ã‚ã‚‹ã¨ASGã‚‚ç½®ãæ›ãˆï¼‰ name = \u0026#34;${var.cluster_name}-${aws_launch_configuration.example.name}\u0026#34; launch_configuration = aws_launch_configuration.example.name vpc_zone_identifier = data.aws_subnets.default.ids target_group_arns = [aws_lb_target_group.asg.arn] health_check_type = \u0026#34;ELB\u0026#34; min_size = var.min_size max_size = var.max_size # 3. ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ã«åˆæ ¼ã™ã‚‹ã¾ã§å¾…æ©Ÿ min_elb_capacity = var.min_size # 2. æ–°ã—ã„ASGã‚’å…ˆã«ä½œæˆã—ã¦ã‹ã‚‰å¤ã„ASGã‚’å‰Šé™¤ lifecycle { create_before_destroy = true } tag { key = \u0026#34;Name\u0026#34; value = var.cluster_name propagate_at_launch = true } dynamic \u0026#34;tag\u0026#34; { for_each = { for key, value in var.custom_tags: key =\u0026gt; upper(value) if key != \u0026#34;Name\u0026#34; } content { key = tag.key value = tag.value propagate_at_launch = true } } } ãƒ‡ãƒ—ãƒ­ã‚¤ã®æµã‚Œ # server_text å¤‰æ›´ â†“ user-data.sh ã®å†…å®¹ãŒå¤‰æ›´ â†“ æ–°ã—ã„ Launch Configuration ä½œæˆï¼ˆåå‰ãŒå¤‰ã‚ã‚‹ï¼‰ â†“ ASG ã® name ãŒå¤‰ã‚ã‚‹ â†’ ASG ã®ç½®ãæ›ãˆãŒå¿…è¦ã¨åˆ¤æ–­ â†“ æ–°ã—ã„ ASG ã‚’ä½œæˆï¼ˆcreate_before_destroyï¼‰ â†“ min_elb_capacity å°ãŒãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯åˆæ ¼ã‚’å¾…ã¤ â†“ å¤ã„ ASG ã‚’å‰Šé™¤ â†“ ã‚¼ãƒ­ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ ã§å®Œäº†ï¼ å‹•ä½œç¢ºèªæ–¹æ³• # while true; do curl http://\u0026lt;load_balancer_url\u0026gt;; sleep 1; done 1ç§’ã”ã¨ã«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ã‚Šã€ãƒ‡ãƒ—ãƒ­ã‚¤ä¸­ã‚‚ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãŒé€”åˆ‡ã‚Œãªã„ã“ã¨ã‚’ç¢ºèªã—ã¾ã™ã€‚\nçŠ¶æ…‹ ãƒ¬ã‚¹ãƒãƒ³ã‚¹ ãƒ‡ãƒ—ãƒ­ã‚¤å‰ å¤ã„ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®ã¿ ãƒ‡ãƒ—ãƒ­ã‚¤ä¸­ å¤ã„/æ–°ã—ã„ãŒæ··åœ¨ï¼ˆä¸¡æ–¹ã® ASG ãŒç¨¼åƒï¼‰ ãƒ‡ãƒ—ãƒ­ã‚¤å¾Œ æ–°ã—ã„ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®ã¿ ãƒ‡ãƒ—ãƒ­ã‚¤ä¸­ã‚‚ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãŒé€”åˆ‡ã‚Œãªã‘ã‚Œã°ã€ã‚¼ãƒ­ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ é”æˆã§ã™ã€‚\nã‚¼ãƒ­ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ ãƒ‡ãƒ—ãƒ­ã‚¤ã®åˆ¶é™äº‹é … # åˆ¶é™1ï¼šAuto Scaling ãƒãƒªã‚·ãƒ¼ã¨ã¯çµ„ã¿åˆã‚ã›ã¦ä½¿ãˆãªã„ # ãƒ‡ãƒ—ãƒ­ã‚¤ã®ãŸã³ã« ASG ã®ã‚µã‚¤ã‚ºãŒ min_size ã«ãƒªã‚»ãƒƒãƒˆã•ã‚Œã¦ã—ã¾ã„ã¾ã™ã€‚\né€šå¸¸é‹ç”¨ä¸­ï¼šAuto Scaling ã«ã‚ˆã‚Š 10 å°ã§ç¨¼åƒ â†“ ãƒ‡ãƒ—ãƒ­ã‚¤å®Ÿè¡Œï¼ˆcreate_before_destroyï¼‰ â†“ æ–°ã—ã„ ASG ä½œæˆæ™‚ã« min_sizeï¼ˆä¾‹ï¼š2å°ï¼‰ã§ã‚¹ã‚¿ãƒ¼ãƒˆ â†“ ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ã«å¯¾ã—ã¦ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹æ•°ãŒä¸è¶³ï¼ å›é¿ç­–ã¨ã—ã¦ã¯ã€recurrence ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®èª¿æ•´ã‚„ desired_capacity ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®æ˜ç¤ºçš„ãªè¨­å®šãŒã‚ã‚Šã¾ã™ã€‚\nåˆ¶é™2ï¼šãƒã‚¤ãƒ†ã‚£ãƒ–ãªãƒ‡ãƒ—ãƒ­ã‚¤æ–¹æ³•ãŒãªã„ï¼ˆãªã‹ã£ãŸï¼‰ # ä»¥å‰ã® Terraform ã«ã¯ã‚¼ãƒ­ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ ãƒ‡ãƒ—ãƒ­ã‚¤ã®ã‚ˆã†ãªãƒã‚¤ãƒ†ã‚£ãƒ–ãªãƒ‡ãƒ—ãƒ­ã‚¤æ–¹æ³•ãŒã‚ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚æœ€è¿‘ã® Terraform ã§ã¯ãƒã‚¤ãƒ†ã‚£ãƒ–ãªãƒ‡ãƒ—ãƒ­ã‚¤æ–¹æ³•ãŒã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ãã¦ã„ã‚‹ãŸã‚ã€é©å®œå…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®ç¢ºèªãŒå¿…è¦ã§ã™ã€‚\nã¾ã¨ã‚ # ã‚¼ãƒ­ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ ãƒ‡ãƒ—ãƒ­ã‚¤ã«ã¯3ã¤ã®è¨­å®šãŒå¿…è¦ï¼šASGåã®ä¾å­˜ã€create_before_destroyã€min_elb_capacity create_before_destroy ã§æ–°ã—ã„ ASG ã‚’å…ˆã«ä½œæˆã—ã¦ã‹ã‚‰å¤ã„ ASG ã‚’å‰Šé™¤ã™ã‚‹ min_elb_capacity ã§ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯åˆæ ¼ã¾ã§å¾…æ©Ÿã™ã‚‹ã“ã¨ã§ã€ã‚µãƒ¼ãƒ“ã‚¹æ–­ã‚’é˜²ã Auto Scaling ãƒãƒªã‚·ãƒ¼ã¨ã®ä½µç”¨ã«ã¯æ³¨æ„ãŒå¿…è¦ å‚è€ƒ # è©³è§£ Terraform ç¬¬3ç‰ˆ - Yevgeniy Brikmanè‘—ã€æ¾æµ¦éš¼äººè¨³ã€ã‚ªãƒ©ã‚¤ãƒªãƒ¼ã‚¸ãƒ£ãƒ‘ãƒ³ã€2023å¹´ The lifecycle Meta-Argument AWS Provider: aws_autoscaling_group ","date":"2025å¹´ 12æœˆ 2æ—¥","externalUrl":null,"permalink":"/posts/251202082958_terraform-zero-downtime-deployment-methods/","section":"Posts","summary":"","title":"Terraformã‚¼ãƒ­ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ ãƒ‡ãƒ—ãƒ­ã‚¤ã®å®Ÿç¾æ–¹æ³•","type":"posts"},{"content":" ä»Šæ—¥å­¦ã‚“ã ã“ã¨ # Terraform ã§æ¡ä»¶åˆ†å²ã‚’å®Ÿç¾ã™ã‚‹3ã¤ã®æ‰‹æ³•ï¼ˆcount + ä¸‰é …æ¼”ç®—å­ã€for_each + for ã® ifã€if æ–‡å­—åˆ—ãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–ï¼‰ã«ã¤ã„ã¦å­¦ã³ã¾ã—ãŸã€‚ç‰¹ã« count ã‚’ä½¿ã£ãŸã€Œä½œã‚‹/ä½œã‚‰ãªã„ã€ã®åˆ¶å¾¡ãƒ‘ã‚¿ãƒ¼ãƒ³ã¯å®Ÿè·µã§é »ç¹ã«ä½¿ã‚ã‚Œã¾ã™ã€‚\nå­¦ç¿’å†…å®¹ # æ¡ä»¶åˆ†å²ã«ä½¿ã†æ‰‹æ³• # æ‰‹æ³• ç”¨é€” count ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ æ¡ä»¶ä»˜ããƒªã‚½ãƒ¼ã‚¹ã®ä½œæˆï¼ˆä½œã‚‹/ä½œã‚‰ãªã„ï¼‰ for_each å¼ / for å¼ æ¡ä»¶ä»˜ããƒªã‚½ãƒ¼ã‚¹ã€ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ãƒ–ãƒ­ãƒƒã‚¯ã®æ¡ä»¶ç”Ÿæˆ if æ–‡å­—åˆ—ãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ– æ–‡å­—åˆ—å†…ã§ã®æ¡ä»¶åˆ†å² count ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ä½¿ã£ãŸæ¡ä»¶åˆ†å² # count ã‚’ä½¿ã£ãŸ if æ–‡ # ä¸‰é …æ¼”ç®—å­ã¨çµ„ã¿åˆã‚ã›ã¦ã€ãƒªã‚½ãƒ¼ã‚¹ã‚’ã€Œä½œæˆã™ã‚‹/ã—ãªã„ã€ã‚’åˆ¶å¾¡ã—ã¾ã™ã€‚\ncount = var.enable_autoscaling ? 1 : 0 var.enable_autoscaling count çµæœ true 1 ãƒªã‚½ãƒ¼ã‚¹ã‚’ä½œæˆã™ã‚‹ false 0 ãƒªã‚½ãƒ¼ã‚¹ã‚’ä½œæˆã—ãªã„ ã‚³ãƒ¼ãƒ‰ä¾‹ï¼šã‚ªãƒ¼ãƒˆã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ« # resource \u0026#34;aws_autoscaling_schedule\u0026#34; \u0026#34;scale_out_during_business_hours\u0026#34; { count = var.enable_autoscaling ? 1 : 0 scheduled_action_name = \u0026#34;${var.cluster_name}-scale-out-during-business-hours\u0026#34; min_size = 2 max_size = 10 desired_capacity = 10 recurrence = \u0026#34;0 9 * * *\u0026#34; autoscaling_group_name = aws_autoscaling_group.example.name } æœ¬ç•ªç’°å¢ƒã§ã¯ enable_autoscaling = trueã€ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ç’°å¢ƒã§ã¯ enable_autoscaling = false ã®ã‚ˆã†ã«ç’°å¢ƒã”ã¨ã«è¨­å®šã‚’åˆ‡ã‚Šæ›¿ãˆã‚‰ã‚Œã¾ã™ã€‚\ncount ã‚’ä½¿ã£ãŸ if-else æ–‡ # count ã®å€¤ã‚’åè»¢ã•ã›ã‚‹ã“ã¨ã§ if-else ã‚’å®Ÿç¾ã—ã¾ã™ã€‚\n# if æ–‡ï¼ˆtrue ã®ã¨ãä½œæˆï¼‰ resource \u0026#34;aws_iam_user_policy_attachment\u0026#34; \u0026#34;user1_cloudwatch_full_access\u0026#34; { count = var.give_user1_cloudwatch_full_access ? 1 : 0 # ... } # else æ–‡ï¼ˆfalse ã®ã¨ãä½œæˆï¼‰â†’ ä¸‰é …æ¼”ç®—å­ã®å€¤ã‚’åè»¢ resource \u0026#34;aws_iam_user_policy_attachment\u0026#34; \u0026#34;user1_cloudwatch_read_only\u0026#34; { count = var.give_user1_cloudwatch_full_access ? 0 : 1 # ... } var.give_user1_cloudwatch_full_access full_access ã® count read_only ã® count true 1 0 false 0 1 æ¡ä»¶ä»˜ããƒªã‚½ãƒ¼ã‚¹ã®å‡ºåŠ›å€¤ã‚’å–å¾— # count ã§ä½œæˆã—ãŸãƒªã‚½ãƒ¼ã‚¹ã¯ã€æ¡ä»¶ã«ã‚ˆã£ã¦å­˜åœ¨ã—ãŸã‚Šã—ãªã‹ã£ãŸã‚Šã—ã¾ã™ã€‚concat ã¨ one é–¢æ•°ã‚’çµ„ã¿åˆã‚ã›ã¦å‡ºåŠ›å€¤ã‚’å–å¾—ã—ã¾ã™ã€‚\noutput \u0026#34;user1_cloudwatch_policy_arn\u0026#34; { value = one(concat( aws_iam_user_policy_attachment.user1_cloudwatch_full_access[*].policy_arn, aws_iam_user_policy_attachment.user1_cloudwatch_read_only[*].policy_arn )) } one() é–¢æ•°ã¯å˜ä¸€è¦ç´ ã®ãƒªã‚¹ãƒˆã‹ã‚‰å€¤ã‚’å–ã‚Šå‡ºã—ã¾ã™ã€‚ç©ºã®ãƒªã‚¹ãƒˆã®å ´åˆã¯ null ã‚’è¿”ã—ã¾ã™ã€‚\nfor_each ã¨ for ã‚’ä½¿ã£ãŸæ¡ä»¶åˆ†å² # åŸºæœ¬çš„ãªè€ƒãˆæ–¹ # for_each ã«æ¸¡ã™é›†åˆ çµæœ ç©ºã®é›†åˆ {} / [] ãƒªã‚½ãƒ¼ã‚¹ã¯ä½œæˆã•ã‚Œãªã„ ç©ºã§ã¯ãªã„é›†åˆ ãƒªã‚½ãƒ¼ã‚¹ãŒä½œæˆã•ã‚Œã‚‹ for å¼ã® if ã§ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã™ã‚‹ã“ã¨ã§ã€æ¡ä»¶ã«åˆã†è¦ç´ ã®ã¿ã‚’å‡¦ç†ã§ãã¾ã™ã€‚\ndynamic \u0026#34;tag\u0026#34; { for_each = { for key, value in var.custom_tags: key =\u0026gt; upper(value) if key != \u0026#34;Name\u0026#34; # â† æ¡ä»¶åˆ†å²ï¼ˆãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ï¼‰ } content { key = tag.key value = tag.value propagate_at_launch = true } } ã“ã®ä¾‹ã§ã¯ key != \u0026quot;Name\u0026quot; ã®æ¡ä»¶ã«ã‚ˆã‚Šã€\u0026ldquo;Name\u0026rdquo; ã‚­ãƒ¼ã‚’é™¤å¤–ã—ã¦ã„ã¾ã™ã€‚\ncount vs for_each ã®ä½¿ã„åˆ†ã‘ï¼ˆæ¡ä»¶åˆ†å²ï¼‰ # ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ æ¨å¥¨ ç†ç”± æ¡ä»¶ä»˜ãã§ãƒªã‚½ãƒ¼ã‚¹/ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ä½œæˆï¼ˆä½œã‚‹ or ä½œã‚‰ãªã„ï¼‰ count ? 1 : 0 ãŒã‚·ãƒ³ãƒ—ãƒ« ãƒªã‚½ãƒ¼ã‚¹/ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’è¤‡æ•°ä½œæˆ for_each é€”ä¸­è¦ç´ å‰Šé™¤ã®å•é¡ŒãŒãªã„ ãã‚Œä»¥å¤–ã®ãƒ«ãƒ¼ãƒ—ã‚„æ¡ä»¶åˆ†å² for_each æŸ”è»Ÿæ€§ãŒé«˜ã„ if æ–‡å­—åˆ—ãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–ã‚’ä½¿ã£ãŸæ¡ä»¶åˆ†å² # æ–‡å­—åˆ—å†…ã§æ¡ä»¶åˆ†å²ã‚’è¡Œã†ãŸã‚ã®æ§‹æ–‡ã§ã™ã€‚\nåŸºæœ¬æ§‹æ–‡ # %{ if \u0026lt;CONDITION\u0026gt; }\u0026lt;TRUE_VAL\u0026gt;%{ endif } ã‚³ãƒ¼ãƒ‰ä¾‹ï¼šæœ€å¾Œã®è¦ç´ ã ã‘ã‚«ãƒ³ãƒã‚’ä»˜ã‘ãªã„ # output \u0026#34;for_directive_index_if\u0026#34; { value = \u0026lt;\u0026lt;EOF %{~ for i, name in var.names ~} ${name}%{ if i \u0026lt; length(var.names) - 1 }, %{ endif } %{~ endfor ~} EOF } ãƒ«ãƒ¼ãƒ— i name i \u0026lt; length - 1 å‡ºåŠ› 1å›ç›® 0 user1 true user1, 2å›ç›® 1 user2 true user2, 3å›ç›® 2 user3 false user3 if-else æ§‹æ–‡ # %{ if \u0026lt;CONDITION\u0026gt; }\u0026lt;TRUE_VAL\u0026gt;%{ else }\u0026lt;FALSE_VAL\u0026gt;%{ endif } output \u0026#34;for_directive_index_if_else_strip\u0026#34; { value = \u0026lt;\u0026lt;EOF %{~ for i, name in var.names ~} ${name}%{ if i \u0026lt; length(var.names) - 1 }, %{ else }.%{ endif } %{~ endfor ~} EOF } å‡ºåŠ›çµæœã¯ user1, user2, user3. ã¨ãªã‚Šã€æœ€å¾Œã®è¦ç´ ã«ãƒ”ãƒªã‚ªãƒ‰ãŒä»˜ãã¾ã™ã€‚\nã¾ã¨ã‚ # æ‰‹æ³• ç”¨é€” æ§‹æ–‡ä¾‹ count + ä¸‰é …æ¼”ç®—å­ ãƒªã‚½ãƒ¼ã‚¹ã‚’ä½œã‚‹/ä½œã‚‰ãªã„ count = var.enable ? 1 : 0 countï¼ˆif-elseï¼‰ æ’ä»–çš„ãªãƒªã‚½ãƒ¼ã‚¹ä½œæˆ ? 1 : 0 ã¨ ? 0 : 1 ã‚’åè»¢ for_each + for ã® if æ¡ä»¶ä»˜ããƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚° for k, v in map : k =\u0026gt; v if condition if æ–‡å­—åˆ—ãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ– æ–‡å­—åˆ—å†…ã®æ¡ä»¶åˆ†å² %{ if condition }...%{ endif } ã€Œä½œã‚‹ or ä½œã‚‰ãªã„ã€ã®2æŠãªã‚‰ count ãŒã‚·ãƒ³ãƒ—ãƒ« è¤‡æ•°ä½œæˆã‚„è¤‡é›‘ãªæ¡ä»¶ãªã‚‰ for_each ã‚’ä½¿ã† one() ã¨ concat() ã§æ¡ä»¶ä»˜ããƒªã‚½ãƒ¼ã‚¹ã®å‡ºåŠ›å€¤ã‚’å®‰å…¨ã«å–å¾—ã§ãã‚‹ å‚è€ƒ # è©³è§£ Terraform ç¬¬3ç‰ˆ - Yevgeniy Brikmanè‘—ã€æ¾æµ¦éš¼äººè¨³ã€ã‚ªãƒ©ã‚¤ãƒªãƒ¼ã‚¸ãƒ£ãƒ‘ãƒ³ã€2023å¹´ The count Meta-Argument The for_each Meta-Argument String Templates Built-in Functions - one ","date":"2025å¹´ 12æœˆ 2æ—¥","externalUrl":null,"permalink":"/posts/251202082829_terraform-conditional-branching-patterns/","section":"Posts","summary":"","title":"Terraformæ¡ä»¶åˆ†å²ãƒ‘ã‚¿ãƒ¼ãƒ³é›†","type":"posts"},{"content":" ä»Šæ—¥å­¦ã‚“ã ã“ã¨ # Terraform ã® for å¼ã¨ for æ–‡å­—åˆ—ãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–ã«ã¤ã„ã¦å­¦ã³ã¾ã—ãŸã€‚ã“ã‚Œã‚‰ã¯ count ã‚„ for_each ã¨ã¯ç•°ãªã‚Šã€ãƒªã‚½ãƒ¼ã‚¹ã‚’ä½œæˆã™ã‚‹ã®ã§ã¯ãªãã€ãƒªã‚¹ãƒˆã‚„ãƒãƒƒãƒ—ã‚’å¤‰æ›ãƒ»åŠ å·¥ã™ã‚‹ãŸã‚ã®æ©Ÿèƒ½ã§ã™ã€‚\nå­¦ç¿’å†…å®¹ # for å¼ã®åŸºæœ¬ # for å¼ã¯ count ã‚„ for_each ã¨ã¯ç•°ãªã‚Šã€ãƒªã‚¹ãƒˆã‚„ãƒãƒƒãƒ—ã‚’å¤‰æ›ãƒ»åŠ å·¥ã™ã‚‹ãŸã‚ã®å¼ã§ã™ã€‚\nãƒªã‚¹ãƒˆã‚’å‡ºåŠ›ã™ã‚‹æ§‹æ–‡ # [for \u0026lt;ITEM\u0026gt; in \u0026lt;LIST\u0026gt; : \u0026lt;OUTPUT\u0026gt;] ä¾‹ã¨ã—ã¦ã€åå‰ã®ãƒªã‚¹ãƒˆã‚’å¤§æ–‡å­—ã«å¤‰æ›ã—ã¦ã¿ã¾ã™ã€‚\nvariable \u0026#34;names\u0026#34; { type = list(string) default = [\u0026#34;user1\u0026#34;, \u0026#34;user2\u0026#34;, \u0026#34;user3\u0026#34;] } output \u0026#34;upper_names\u0026#34; { value = [for name in var.names : upper(name)] } å‡ºåŠ›çµæœã¯ [\u0026quot;USER1\u0026quot;, \u0026quot;USER2\u0026quot;, \u0026quot;USER3\u0026quot;] ã¨ãªã‚Šã¾ã™ã€‚\nãƒãƒƒãƒ—ã«å¯¾ã™ã‚‹ãƒ«ãƒ¼ãƒ— # ãƒãƒƒãƒ—ã‚’ãƒ«ãƒ¼ãƒ—ã™ã‚‹å ´åˆã¯ã€ã‚­ãƒ¼ã¨å€¤ã®ä¸¡æ–¹ã‚’å–å¾—ã§ãã¾ã™ã€‚\n[for \u0026lt;KEY\u0026gt;, \u0026lt;VALUE\u0026gt; in \u0026lt;MAP\u0026gt; : \u0026lt;OUTPUT\u0026gt;] variable \u0026#34;user_roles\u0026#34; { type = map(string) default = { user1 = \u0026#34;admin\u0026#34; user2 = \u0026#34;developer\u0026#34; user3 = \u0026#34;viewer\u0026#34; } } output \u0026#34;user_descriptions\u0026#34; { value = [for name, role in var.user_roles : \u0026#34;${name} is the ${role}\u0026#34;] } å‡ºåŠ›çµæœã¯ [\u0026quot;user1 is the admin\u0026quot;, \u0026quot;user2 is the developer\u0026quot;, \u0026quot;user3 is the viewer\u0026quot;] ã®ã‚ˆã†ãªãƒªã‚¹ãƒˆã«ãªã‚Šã¾ã™ã€‚\næ³¨æ„: ãƒãƒƒãƒ—ã®è¦ç´ é †åºã¯ä¿è¨¼ã•ã‚Œãªã„ãŸã‚ã€å‡ºåŠ›é †åºã¯ç•°ãªã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚\nãƒãƒƒãƒ—ã‚’å‡ºåŠ›ã™ã‚‹æ§‹æ–‡ # [] ã¨ {} ã§å‡ºåŠ›å½¢å¼ãŒå¤‰ã‚ã‚Šã¾ã™ã€‚\næ‹¬å¼§ å‡ºåŠ›å½¢å¼ æ§‹æ–‡ [] ãƒªã‚¹ãƒˆ [for ... : \u0026lt;OUTPUT\u0026gt;] {} ãƒãƒƒãƒ— {for ... : \u0026lt;KEY\u0026gt; =\u0026gt; \u0026lt;VALUE\u0026gt;} output \u0026#34;upper_roles\u0026#34; { value = {for name, role in var.user_roles : upper(name) =\u0026gt; upper(role)} } å‡ºåŠ›çµæœã¯ä»¥ä¸‹ã®ã‚ˆã†ãªãƒãƒƒãƒ—ã«ãªã‚Šã¾ã™ã€‚\n{ \u0026#34;USER1\u0026#34; = \u0026#34;ADMIN\u0026#34; \u0026#34;USER2\u0026#34; = \u0026#34;DEVELOPER\u0026#34; \u0026#34;USER3\u0026#34; = \u0026#34;VIEWER\u0026#34; } for å¼ã®å‡ºåŠ›ãƒ‘ã‚¿ãƒ¼ãƒ³ã¾ã¨ã‚ # å…¥åŠ› å‡ºåŠ› æ§‹æ–‡ä¾‹ ãƒªã‚¹ãƒˆ â†’ ãƒªã‚¹ãƒˆ [] [for x in list : upper(x)] ãƒãƒƒãƒ— â†’ ãƒªã‚¹ãƒˆ [] [for k, v in map : \u0026quot;${k}=${v}\u0026quot;] ãƒªã‚¹ãƒˆ â†’ ãƒãƒƒãƒ— {} {for x in list : x =\u0026gt; upper(x)} ãƒãƒƒãƒ— â†’ ãƒãƒƒãƒ— {} {for k, v in map : upper(k) =\u0026gt; upper(v)} for æ–‡å­—åˆ—ãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–ã«ã‚ˆã‚‹ãƒ«ãƒ¼ãƒ— # æ–‡å­—åˆ—ãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–ã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€æ–‡å­—åˆ—å†…ã§ãƒ«ãƒ¼ãƒ—ã‚’å±•é–‹ã§ãã¾ã™ã€‚%{...} ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚\nåŸºæœ¬æ§‹æ–‡ # %{for \u0026lt;ITEM\u0026gt; in \u0026lt;COLLECTION\u0026gt;} \u0026lt;BODY\u0026gt; %{endfor} ä¾‹ï¼šåå‰ã®ãƒªã‚¹ãƒˆã‚’ã‚«ãƒ³ãƒåŒºåˆ‡ã‚Šã§å‡ºåŠ› # output \u0026#34;for_directive\u0026#34; { value = \u0026#34;%{ for name in var.names }${name}, %{ endfor }\u0026#34; } å‡ºåŠ›çµæœã¯ \u0026quot;user1, user2, user3, \u0026quot; ã¨ãªã‚Šã¾ã™ã€‚\nã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ä»˜ãã®æ§‹æ–‡ # %{for \u0026lt;INDEX\u0026gt;, \u0026lt;ITEM\u0026gt; in \u0026lt;COLLECTION\u0026gt;} \u0026lt;BODY\u0026gt; %{endfor} output \u0026#34;for_directive_with_index\u0026#34; { value = \u0026#34;%{ for index, name in var.names }${index}: ${name}, %{ endfor }\u0026#34; } å‡ºåŠ›çµæœã¯ \u0026quot;0: user1, 1: user2, 2: user3, \u0026quot; ã¨ãªã‚Šã¾ã™ã€‚\nãƒ’ã‚¢ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ§‹æ–‡ # æ–‡å­—åˆ—ãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–ã§ã¯ã€è¤‡æ•°è¡Œã®æ–‡å­—åˆ—ã‚’æ‰±ã†ãŸã‚ã«ãƒ’ã‚¢ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ§‹æ–‡ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ãŒå¤šã„ã§ã™ã€‚\n\u0026lt;\u0026lt;EOF è¤‡æ•°è¡Œã® æ–‡å­—åˆ—ã‚’ ã“ã“ã«è¨˜è¿° EOF \u0026lt;\u0026lt;-EOF ã‚’ä½¿ã†ã¨ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆã‚’è‡ªå‹•é™¤å»ã§ãã¾ã™ã€‚\nstrip markerï¼ˆ~ï¼‰ã«ã‚ˆã‚‹ç©ºç™½é™¤å» # æ–‡å­—åˆ—ãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–ã‚’ä½¿ã†ã¨ä¸è¦ãªã‚¹ãƒšãƒ¼ã‚¹ã‚„æ”¹è¡ŒãŒè¿½åŠ ã•ã‚Œã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚strip markerï¼ˆ~ï¼‰ã§è§£æ±ºã§ãã¾ã™ã€‚\noutput \u0026#34;for_directive_strip\u0026#34; { value = \u0026lt;\u0026lt;EOF %{~ for i, name in var.names ~} ${name}%{ if i \u0026lt; length(var.names) - 1 }, %{ endif } %{~ endfor ~} EOF } å‡ºåŠ›çµæœã¯ user1, user2, user3 ã¨ãã‚Œã„ã«æ•´å½¢ã•ã‚Œã¾ã™ã€‚\nè¨˜æ³• åŠ¹æœ %{~ ... } å·¦å´ã®ç©ºç™½ãƒ»æ”¹è¡Œã‚’é™¤å» %{ ... ~} å³å´ã®ç©ºç™½ãƒ»æ”¹è¡Œã‚’é™¤å» %{~ ... ~} ä¸¡å´ã®ç©ºç™½ãƒ»æ”¹è¡Œã‚’é™¤å» for å¼ã¨æ–‡å­—åˆ—ãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–ã®æ¯”è¼ƒ # æ‰‹æ³• æ§‹æ–‡ çµæœ for å¼ [for i, name in var.names : \u0026quot;${i}: ${name}\u0026quot;] ãƒªã‚¹ãƒˆ æ–‡å­—åˆ—ãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ– \u0026quot;%{for i, name in var.names}${i}: ${name}%{endfor}\u0026quot; æ–‡å­—åˆ— ã¾ã¨ã‚ # æ‰‹æ³• ç”¨é€” çµæœ for å¼ ãƒªã‚¹ãƒˆ/ãƒãƒƒãƒ—ã®å¤‰æ›ãƒ»åŠ å·¥ æ–°ã—ã„ãƒªã‚¹ãƒˆ or ãƒãƒƒãƒ— for æ–‡å­—åˆ—ãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ– æ–‡å­—åˆ—å†…ã§ã®ãƒ«ãƒ¼ãƒ—å±•é–‹ æ–‡å­—åˆ— for å¼ã¯ [] ã§ãƒªã‚¹ãƒˆã€{} ã§ãƒãƒƒãƒ—ã‚’å‡ºåŠ›ã™ã‚‹ æ–‡å­—åˆ—ãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–ã¯ %{for ...}...%{endfor} ã§æ–‡å­—åˆ—å†…ã«ãƒ«ãƒ¼ãƒ—ã‚’å±•é–‹ã™ã‚‹ strip markerï¼ˆ~ï¼‰ã‚’ä½¿ã†ã¨ä¸è¦ãªç©ºç™½ãƒ»æ”¹è¡Œã‚’é™¤å»ã§ãã‚‹ å‚è€ƒ # è©³è§£ Terraform ç¬¬3ç‰ˆ - Yevgeniy Brikmanè‘—ã€æ¾æµ¦éš¼äººè¨³ã€ã‚ªãƒ©ã‚¤ãƒªãƒ¼ã‚¸ãƒ£ãƒ‘ãƒ³ã€2023å¹´ for Expressions String Templates Built-in Functions ","date":"2025å¹´ 12æœˆ 2æ—¥","externalUrl":null,"permalink":"/posts/251202082701_terraform-for-expression-list-and-map-conversion-techniques/","section":"Posts","summary":"","title":"Terraform forå¼å…¥é–€ï¼šãƒªã‚¹ãƒˆã¨ãƒãƒƒãƒ—ã®å¤‰æ›ãƒ†ã‚¯ãƒ‹ãƒƒã‚¯","type":"posts"},{"content":"","date":"2025å¹´ 12æœˆ 2æ—¥","externalUrl":null,"permalink":"/tags/%E3%81%BE%E3%81%A8%E3%82%81/","section":"Tags","summary":"","title":"ã¾ã¨ã‚","type":"tags"},{"content":" ä»Šæ—¥å­¦ã‚“ã ã“ã¨ # Terraform ã§åŒã˜ã‚ˆã†ãªãƒªã‚½ãƒ¼ã‚¹ã‚’è¤‡æ•°ä½œæˆã™ã‚‹éš›ã«ä½¿ã† count ã¨ for_each ã«ã¤ã„ã¦å­¦ã³ã¾ã—ãŸã€‚ä¸¡è€…ã®é•ã„ã¨ã€é€”ä¸­ã®è¦ç´ ã‚’å‰Šé™¤ã™ã‚‹éš›ã«ç™ºç”Ÿã™ã‚‹å•é¡Œã€ãã—ã¦ for_each ãŒãã®å•é¡Œã‚’ã©ã†è§£æ±ºã™ã‚‹ã‹ã‚’ç†è§£ã—ã¾ã—ãŸã€‚\nå­¦ç¿’å†…å®¹ # count ã¨ for_each ã®é•ã„ # é …ç›® count for_each è­˜åˆ¥æ–¹æ³• ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ï¼ˆç•ªå·ï¼‰ ã‚­ãƒ¼ï¼ˆåå‰ï¼‰ å¯¾å¿œãƒ‡ãƒ¼ã‚¿å‹ æ•°å€¤ã®ã¿ é›†åˆï¼ˆsetï¼‰ãƒ»ãƒãƒƒãƒ—ï¼ˆmapï¼‰ é€”ä¸­è¦ç´ ã®å‰Šé™¤ ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ãšã‚Œå•é¡Œã‚ã‚Š ä»–ã®è¦ç´ ã«å½±éŸ¿ãªã— ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ãƒ–ãƒ­ãƒƒã‚¯ ä½¿ç”¨ä¸å¯ ä½¿ç”¨å¯èƒ½ï¼ˆdynamic ãƒ–ãƒ­ãƒƒã‚¯ï¼‰ count ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã«ã‚ˆã‚‹ãƒ«ãƒ¼ãƒ— # count ã¯ Terraform ã®åˆæœŸã‹ã‚‰å­˜åœ¨ã™ã‚‹åŸºæœ¬çš„ãªæ©Ÿèƒ½ã§ã™ã€‚count.index ã‚’ä½¿ã£ã¦ãƒªã‚½ãƒ¼ã‚¹ã«ä¸€æ„ã®åå‰ã‚’ä»˜ã‘ã¾ã™ã€‚\nresource \u0026#34;aws_iam_user\u0026#34; \u0026#34;example\u0026#34; { count = 3 name = \u0026#34;user.${count.index}\u0026#34; } ä½œæˆã•ã‚Œã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼åã¯ user.0, user.1, user.2 ã¨ãªã‚Šã¾ã™ã€‚count.index ã¯ 0 ã‹ã‚‰å§‹ã¾ã‚‹ç‚¹ã«æ³¨æ„ãŒå¿…è¦ã§ã™ã€‚\nã‚ˆã‚Šå®Ÿè·µçš„ãªãƒ‘ã‚¿ãƒ¼ãƒ³ã¨ã—ã¦ã€ãƒªã‚¹ãƒˆã¨ length() é–¢æ•°ã‚’çµ„ã¿åˆã‚ã›ã‚‹æ–¹æ³•ãŒã‚ã‚Šã¾ã™ã€‚\nvariable \u0026#34;user_names\u0026#34; { type = list(string) default = [\u0026#34;user1\u0026#34;, \u0026#34;user2\u0026#34;, \u0026#34;user3\u0026#34;] } resource \u0026#34;aws_iam_user\u0026#34; \u0026#34;example\u0026#34; { count = length(var.user_names) name = var.user_names[count.index] } ã“ã®æ–¹æ³•ã®ãƒ¡ãƒªãƒƒãƒˆã¯ã€å¤‰æ•°ã‚’å¤‰æ›´ã™ã‚‹ã ã‘ã§ãƒ¦ãƒ¼ã‚¶ãƒ¼æ•°ã‚’å¢—æ¸›ã§ãã€main.tf ã‚’ç·¨é›†ã™ã‚‹å¿…è¦ãŒãªã„ç‚¹ã§ã™ã€‚\ncount ä½¿ç”¨æ™‚ã®ãƒªã‚½ãƒ¼ã‚¹å‚ç…§ # count ã‚’ä½¿ã†ã¨ãƒªã‚½ãƒ¼ã‚¹ã¯é…åˆ—ã¨ã—ã¦æ‰±ã‚ã‚Œã‚‹ãŸã‚ã€ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’æŒ‡å®šã—ã¦å‚ç…§ã—ã¾ã™ã€‚\n# ç‰¹å®šã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’å‚ç…§ aws_iam_user.example[0].arn # â†’ user1 ã® ARN # å…¨ãƒ¦ãƒ¼ã‚¶ãƒ¼ã® ARN ã‚’å‡ºåŠ›ï¼ˆã‚¹ãƒ—ãƒ©ãƒƒãƒˆå¼ï¼‰ output \u0026#34;user_arns\u0026#34; { value = aws_iam_user.example[*].arn } count ã®åˆ¶é™äº‹é … # count ã«ã¯å¤§ããªåˆ¶é™äº‹é …ãŒ2ã¤ã‚ã‚Šã¾ã™ã€‚\nåˆ¶é™1ï¼šã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ãƒ–ãƒ­ãƒƒã‚¯ã«ã¯åˆ©ç”¨ä¸å¯\ningress ã‚„ egress ãªã©ã®ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ãƒ–ãƒ­ãƒƒã‚¯å†…ã§ count ã¯ä½¿ãˆã¾ã›ã‚“ã€‚ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ãƒ–ãƒ­ãƒƒã‚¯ã‚’å‹•çš„ã«ç”Ÿæˆã—ãŸã„å ´åˆã¯ dynamic ãƒ–ãƒ­ãƒƒã‚¯ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚\nåˆ¶é™2ï¼šé€”ä¸­ã®è¦ç´ å‰Šé™¤ã§å•é¡ŒãŒç™ºç”Ÿ\nã“ã‚ŒãŒ count ã®æœ€å¤§ã®å•é¡Œç‚¹ã§ã™ã€‚[\u0026quot;user1\u0026quot;, \u0026quot;user2\u0026quot;, \u0026quot;user3\u0026quot;] ã‹ã‚‰ user2 ã‚’å‰Šé™¤ã—ã‚ˆã†ã¨ã™ã‚‹ã¨ã€ä»¥ä¸‹ã®ã‚ˆã†ãªæ„å›³ã—ãªã„å‹•ä½œãŒç™ºç”Ÿã—ã¾ã™ã€‚\nã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ æœŸå¾… å®Ÿéš›ã®å‹•ä½œ [0] user1ï¼ˆç¶­æŒï¼‰ user1ï¼ˆç¶­æŒï¼‰ [1] user3ï¼ˆç¶­æŒï¼‰ user2 â†’ user3 ã«å¤‰æ›´ [2] - user3 ã‚’å‰Šé™¤ count ã¯ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã§ãƒªã‚½ãƒ¼ã‚¹ã‚’è­˜åˆ¥ã™ã‚‹ãŸã‚ã€é€”ä¸­ã®è¦ç´ ã‚’æŠœãã¨ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ãŒãšã‚Œã¦ã—ã¾ã„ã¾ã™ã€‚çµæœã¨ã—ã¦ã€user2 ã§ã¯ãªã user3 ãŒå‰Šé™¤ã•ã‚Œã¦ã—ã¾ã„ã¾ã™ã€‚\nfor_each å¼ã«ã‚ˆã‚‹ãƒ«ãƒ¼ãƒ— # for_each ã¯ã‚­ãƒ¼ï¼ˆåå‰ï¼‰ã§ãƒªã‚½ãƒ¼ã‚¹ã‚’è­˜åˆ¥ã™ã‚‹ãŸã‚ã€é€”ä¸­ã®è¦ç´ ã‚’å‰Šé™¤ã—ã¦ã‚‚ä»–ã®ãƒªã‚½ãƒ¼ã‚¹ã«å½±éŸ¿ã—ã¾ã›ã‚“ã€‚\nresource \u0026#34;aws_iam_user\u0026#34; \u0026#34;example\u0026#34; { for_each = toset(var.user_names) name = each.value } ãƒªã‚¹ãƒˆã‚’ä½¿ã†å ´åˆã¯ toset() ã§é›†åˆã«å¤‰æ›ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚\næ³¨æ„: toset() ã¯é‡è¤‡ã™ã‚‹å€¤ã‚’è‡ªå‹•çš„ã«é™¤å»ã—ã¾ã™ã€‚ãƒªã‚¹ãƒˆã«é‡è¤‡å€¤ãŒã‚ã‚‹å ´åˆã€æ„å›³ã—ãªã„çµæœã«ãªã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ãŸã‚ã€å…¥åŠ›ãƒ‡ãƒ¼ã‚¿ã®ä¸€æ„æ€§ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚\neach.key ã¨ each.value ã®å‹•ä½œ # ãƒ‡ãƒ¼ã‚¿å‹ each.key each.value é›†åˆï¼ˆsetï¼‰ å€¤ãã®ã‚‚ã® å€¤ãã®ã‚‚ã®ï¼ˆkey ã¨åŒã˜ï¼‰ ãƒãƒƒãƒ—ï¼ˆmapï¼‰ ã‚­ãƒ¼ å€¤ for_each ã«ã‚ˆã‚‹é€”ä¸­è¦ç´ ã®å‰Šé™¤ # [\u0026quot;user1\u0026quot;, \u0026quot;user2\u0026quot;, \u0026quot;user3\u0026quot;] ã‹ã‚‰ user2 ã‚’å‰Šé™¤ã—ãŸå ´åˆã®å‹•ä½œã‚’æ¯”è¼ƒã—ã¾ã™ã€‚\nfor_each ã®å ´åˆï¼ˆæ­£ã—ãå‹•ä½œï¼‰ï¼š\nã‚­ãƒ¼ å¤‰æ›´å‰ å¤‰æ›´å¾Œ å‹•ä½œ \u0026ldquo;user1\u0026rdquo; user1 user1 ç¶­æŒ \u0026ldquo;user2\u0026rdquo; user2 - å‰Šé™¤ï¼ˆæ„å›³é€šã‚Šï¼‰ \u0026ldquo;user3\u0026rdquo; user3 user3 ç¶­æŒ for_each ã¯ã‚­ãƒ¼ã§è­˜åˆ¥ã™ã‚‹ãŸã‚ã€user2 ã®ã¿ãŒæ­£ã—ãå‰Šé™¤ã•ã‚Œã¾ã™ã€‚\nfor_each ã§ä½œæˆã—ãŸãƒªã‚½ãƒ¼ã‚¹ã®å‚ç…§ # for_each ã§ä½œæˆã™ã‚‹ã¨ãƒªã‚½ãƒ¼ã‚¹ã¯ãƒãƒƒãƒ—å½¢å¼ã«ãªã‚Šã¾ã™ã€‚ARN ã‚’å–ã‚Šå‡ºã™ã«ã¯ values() é–¢æ•°ã‚’ä½¿ã„ã¾ã™ã€‚\noutput \u0026#34;all_arns\u0026#34; { value = values(aws_iam_user.example)[*].arn } dynamic ãƒ–ãƒ­ãƒƒã‚¯ã«ã‚ˆã‚‹ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ãƒ–ãƒ­ãƒƒã‚¯ã®å‹•çš„ç”Ÿæˆ # for_each ã‚’ä½¿ç”¨ã™ã‚‹ã¨ãƒªã‚½ãƒ¼ã‚¹å†…ã®ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ãƒ–ãƒ­ãƒƒã‚¯ã‚’è¤‡æ•°ä½œæˆã§ãã¾ã™ã€‚\ndynamic \u0026#34;tag\u0026#34; { for_each = var.custom_tags content { key = tag.key value = tag.value propagate_at_launch = true } } ã¾ã¨ã‚ # çŠ¶æ³ æ¨å¥¨ å˜ç´”ãªæ•°ã«ã‚ˆã‚‹ç¹°ã‚Šè¿”ã— count é€”ä¸­ã®è¦ç´ ã‚’å‰Šé™¤ã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ for_each ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ãƒ–ãƒ­ãƒƒã‚¯ã‚’å‹•çš„ç”Ÿæˆ for_eachï¼ˆdynamic ãƒ–ãƒ­ãƒƒã‚¯ï¼‰ ã‚­ãƒ¼/åå‰ã§ãƒªã‚½ãƒ¼ã‚¹ã‚’ç®¡ç†ã—ãŸã„ for_each count ã¯ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã§ç®¡ç†ã€for_each ã¯ã‚­ãƒ¼ã§ç®¡ç† é€”ä¸­ã®è¦ç´ å‰Šé™¤ãŒæƒ³å®šã•ã‚Œã‚‹å ´åˆã¯ for_each ã‚’ä½¿ã† ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ãƒ–ãƒ­ãƒƒã‚¯ã®å‹•çš„ç”Ÿæˆã«ã¯ dynamic ãƒ–ãƒ­ãƒƒã‚¯ã¨ for_each ã‚’çµ„ã¿åˆã‚ã›ã‚‹ å‚è€ƒ # è©³è§£ Terraform ç¬¬3ç‰ˆ - Yevgeniy Brikmanè‘—ã€æ¾æµ¦éš¼äººè¨³ã€ã‚ªãƒ©ã‚¤ãƒªãƒ¼ã‚¸ãƒ£ãƒ‘ãƒ³ã€2023å¹´ The count Meta-Argument The for_each Meta-Argument Dynamic Blocks ","date":"2025å¹´ 12æœˆ 2æ—¥","externalUrl":null,"permalink":"/posts/251202082522_terraform-loops-count-and-for-each-usage/","section":"Posts","summary":"","title":"Terraformãƒ«ãƒ¼ãƒ—ã®åŸºç¤ï¼šcountã¨for_eachã®ä½¿ã„åˆ†ã‘","type":"posts"},{"content":"","date":"2025å¹´ 12æœˆ 2æ—¥","externalUrl":null,"permalink":"/tags/git/","section":"Tags","summary":"","title":"Git","type":"tags"},{"content":" ä»Šæ—¥å­¦ã‚“ã ã“ã¨ # ä»¥å‰ã€Zennã«æŠ•ç¨¿ã—ãŸè¨˜äº‹ã‚’ä¿®æ­£ã—ã¦TILã¨ã—ã¦æŠ•ç¨¿ã—ã¾ã™ã€‚\nGitHub CLIã® gh issue view ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ã†ã¨ã€Issuesã‚’Markdownãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã§ãã¾ã™ã€‚ã•ã‚‰ã« jq ã‚³ãƒãƒ³ãƒ‰ã¨çµ„ã¿åˆã‚ã›ã‚‹ã“ã¨ã§ã€æ—¥æ™‚ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã‚’æ—¥æœ¬èªè¡¨è¨˜ã«å¤‰æ›ã—ã€èª­ã¿ã‚„ã™ã„å½¢å¼ã§å‡ºåŠ›ã§ãã‚‹ã“ã¨ã‚’å­¦ã³ã¾ã—ãŸã€‚\nå­¦ç¿’å†…å®¹ # èƒŒæ™¯ã¨å¯¾è±¡èª­è€… # GitHubã®ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãƒªãƒã‚¸ãƒˆãƒªã§Issuesã‚’ä½œæ¥­ãƒ¡ãƒ¢ã¨ã—ã¦æ´»ç”¨ã—ã¦ã„ã¾ã—ãŸãŒã€æ›¸ãæºœã‚ãŸå†…å®¹ã‚’ã‚³ãƒ”ãƒ¼\u0026amp;ãƒšãƒ¼ã‚¹ãƒˆã§å–ã‚Šå‡ºã™æ–¹æ³•ã—ã‹ãªãã€åŠ¹ç‡çš„ã«æ´»ç”¨ã§ãã¦ã„ã¾ã›ã‚“ã§ã—ãŸã€‚ã“ã®å•é¡Œã‚’è§£æ±ºã™ã‚‹ãŸã‚ã€Issuesã‚’Markdownãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã™ã‚‹æ–¹æ³•ã‚’èª¿ã¹ã¾ã—ãŸã€‚\nå¯¾è±¡èª­è€…ï¼š\nGitHub CLIã®åŸºæœ¬çš„ãªä½¿ã„æ–¹ã‚’çŸ¥ã£ã¦ã„ã‚‹æ–¹ ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆä½œæˆã‚„è¨˜äº‹åŸ·ç­†ã®ç´ æã¨ã—ã¦Issuesã‚’æ´»ç”¨ã—ãŸã„æ–¹ å‰ææ¡ä»¶ï¼š\nLinuxï¼ˆUbuntuï¼‰ç’°å¢ƒï¼ˆWSL2å«ã‚€ï¼‰ å¯¾è±¡ãƒªãƒã‚¸ãƒˆãƒªã¸ã®ã‚¢ã‚¯ã‚»ã‚¹æ¨©é™ã‚’ä¿æœ‰ã—ã¦ã„ã‚‹ ãƒ‘ãƒ–ãƒªãƒƒã‚¯ãƒªãƒã‚¸ãƒˆãƒªã¾ãŸã¯æœ‰æ–™ãƒ—ãƒ©ãƒ³ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®å ´åˆã¯ã€GitHub Wikiæ©Ÿèƒ½ãªã©äº’æ›æ€§ã®ã‚ã‚‹æ©Ÿèƒ½ãŒã‚ã‚‹ãŸã‚ã€ãã¡ã‚‰ã‚’åˆ©ç”¨ã™ã‚‹ã»ã†ãŒæ‰‹é †ã‚‚ç°¡å˜ã§åŠ¹ç‡çš„ã§ã™ã€‚\nStep 1: ç’°å¢ƒã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ— # GitHub CLIã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« # # ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«çŠ¶æ³ã®ç¢ºèª gh --version # GitHub CLIã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ï¼ˆå¿…è¦ãªå ´åˆï¼‰ sudo apt install gh GitHub CLIã¸ã®ãƒ­ã‚°ã‚¤ãƒ³ # # ãƒ­ã‚°ã‚¤ãƒ³çŠ¶æ³ã®ç¢ºèª gh auth status # GitHub CLIã¸ãƒ­ã‚°ã‚¤ãƒ³å®Ÿè¡Œ gh auth login Step 2: Issuesä¸€è¦§ã®ç¢ºèª # gh issue list --repo \u0026lt;OWNER/REPO\u0026gt; å®Ÿè¡Œä¾‹ï¼š\ngh issue list --repo mr110825/github-issues-to-markdown å‡ºåŠ›ä¾‹ï¼š\nID TITLE LABELS UPDATED #1 ã‚µãƒ³ãƒ—ãƒ«ç”¨ã®Issues about 1 hour ago Step 3: Issueã®å–å¾—ï¼ˆ4ã¤ã®æ–¹æ³•ï¼‰ # æ–¹æ³•2ãƒ»3ã¯ --json comments ã‚’æŒ‡å®šã—ã¦ã„ã‚‹ãŸã‚ã€ã‚³ãƒ¡ãƒ³ãƒˆã®ã¿ãŒå‡ºåŠ›ã•ã‚Œã¾ã™ã€‚Issueæœ¬æ–‡ã‚‚å«ã‚ãŸã„å ´åˆã¯æ–¹æ³•4ã‚’ä½¿ç”¨ã—ã¦ãã ã•ã„ã€‚\næ–¹æ³•1: ã‚·ãƒ³ãƒ—ãƒ«ãªå–å¾— # gh issue view \u0026lt;ISSUE_NUMBER\u0026gt; --repo \u0026lt;OWNER/REPO\u0026gt; --comments \u0026gt; \u0026lt;FILENAME\u0026gt;.md å‡ºåŠ›ä¾‹ï¼š\nauthor:\tmr110825 association:\towner edited:\ttrue status:\tnone -- è¨˜äº‹ã‚’æŠ•ç¨¿ã™ã‚‹ã®ã§æ§‹æˆã‚’ã¾ã¨ã‚ã‚‹ -- ã“ã®æ–¹æ³•ã¯æœ€ã‚‚ã‚·ãƒ³ãƒ—ãƒ«ã§ã™ãŒã€ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ãŒå¤šãå«ã¾ã‚Œã€å†…å®¹ãŒèª­ã¿ã«ãããªã‚Šã¾ã™ã€‚\næ–¹æ³•2: ã‚³ãƒ¡ãƒ³ãƒˆã®ã¿å–å¾—ï¼ˆISOå½¢å¼ï¼‰ # gh issue view \u0026lt;ISSUE_NUMBER\u0026gt; --repo \u0026lt;OWNER/REPO\u0026gt; --comments --json comments --template \u0026#39;{{range .comments}}## ã‚³ãƒ¡ãƒ³ãƒˆ ({{.createdAt}}) {{.body}} --- {{end}}\u0026#39; \u0026gt; \u0026lt;FILENAME\u0026gt;.md å‡ºåŠ›ä¾‹ï¼š\n## ã‚³ãƒ¡ãƒ³ãƒˆ (2025-06-28T12:24:28Z) è¨˜äº‹ã‚’æŠ•ç¨¿ã™ã‚‹ã®ã§æ§‹æˆã‚’ã¾ã¨ã‚ã‚‹ --- ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ãŒé™¤å»ã•ã‚Œã€ã‚³ãƒ¡ãƒ³ãƒˆã®å†…å®¹ã¨æŠ•ç¨¿æ—¥æ™‚ãŒæ˜ç¢ºã«è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚ãŸã ã—ã€ISOå½¢å¼ã®æ—¥æ™‚è¡¨è¨˜ã¯èª­ã¿ã¥ã‚‰ã„ã§ã™ã€‚\næ–¹æ³•3: æ—¥æœ¬èªè¡¨è¨˜ã§å–å¾—ï¼ˆæ¨å¥¨ï¼‰ # gh issue view \u0026lt;ISSUE_NUMBER\u0026gt; --repo \u0026lt;OWNER/REPO\u0026gt; --comments --json comments | jq -r \u0026#39;.comments[] | \u0026#34;## ã‚³ãƒ¡ãƒ³ãƒˆ (\u0026#34; + (.createdAt | strptime(\u0026#34;%Y-%m-%dT%H:%M:%SZ\u0026#34;) | strftime(\u0026#34;%Yå¹´%mæœˆ%dæ—¥ %Hæ™‚%Måˆ†\u0026#34;)) + \u0026#34;)\\n\\n\u0026#34; + .body + \u0026#34;\\n\\n---\\n\u0026#34;\u0026#39; \u0026gt; \u0026lt;FILENAME\u0026gt;.md jq ã‚³ãƒãƒ³ãƒ‰ãŒå¿…è¦ã§ã™ï¼š\nsudo apt install jq å‡ºåŠ›ä¾‹ï¼š\n## ã‚³ãƒ¡ãƒ³ãƒˆ (2025å¹´06æœˆ28æ—¥ 12æ™‚24åˆ†) è¨˜äº‹ã‚’æŠ•ç¨¿ã™ã‚‹ã®ã§æ§‹æˆã‚’ã¾ã¨ã‚ã‚‹ --- æ—¥æœ¬èªè¡¨è¨˜ã«ã‚ˆã‚Šæ—¥æ™‚ãŒç›´æ„Ÿçš„ã«ç†è§£ã§ãã€æœ€ã‚‚å®Ÿç”¨çš„ãªæ–¹æ³•ã§ã™ã€‚\næ³¨æ„: å‡ºåŠ›ã•ã‚Œã‚‹æ—¥æ™‚ã¯UTCï¼ˆå”å®šä¸–ç•Œæ™‚ï¼‰ã§ã™ã€‚æ—¥æœ¬æ™‚é–“ï¼ˆJSTï¼‰ã«å¤‰æ›ã—ãŸã„å ´åˆã¯ã€dateã‚³ãƒãƒ³ãƒ‰ã¨ã®çµ„ã¿åˆã‚ã›ã‚„ã€jqå†…ã§9æ™‚é–“åŠ ç®—ã™ã‚‹å‡¦ç†ãŒå¿…è¦ã§ã™ã€‚\næ–¹æ³•4: Issueæœ¬æ–‡ã¨ã‚³ãƒ¡ãƒ³ãƒˆã‚’å–å¾—ï¼ˆæ¨å¥¨ï¼‰ # gh issue view \u0026lt;ISSUE_NUMBER\u0026gt; --repo \u0026lt;OWNER/REPO\u0026gt; --json title,body,comments | jq -r \u0026#39; \u0026#34;# \u0026#34; + .title + \u0026#34;\\n\\n\u0026#34; + .body + \u0026#34;\\n\\n---\\n\\n\u0026#34; + ([.comments[] | \u0026#34;## ã‚³ãƒ¡ãƒ³ãƒˆ (\u0026#34; + (.createdAt | strptime(\u0026#34;%Y-%m-%dT%H:%M:%SZ\u0026#34;) | strftime(\u0026#34;%Yå¹´%mæœˆ%dæ—¥ %Hæ™‚%Måˆ†\u0026#34;)) + \u0026#34;)\\n\\n\u0026#34; + .body] | join(\u0026#34;\\n\\n---\\n\\n\u0026#34;)) \u0026#39; \u0026gt; \u0026lt;FILENAME\u0026gt;.md å‡ºåŠ›ä¾‹ï¼š\n# ã‚µãƒ³ãƒ—ãƒ«ç”¨ã®Issues ã“ã‚Œã¯ã‚µãƒ³ãƒ—ãƒ«ã®Issueã§ã™ã€‚ --- ## ã‚³ãƒ¡ãƒ³ãƒˆ (2025å¹´06æœˆ28æ—¥ 12æ™‚24åˆ†) è¨˜äº‹ã‚’æŠ•ç¨¿ã™ã‚‹ã®ã§æ§‹æˆã‚’ã¾ã¨ã‚ã‚‹ --- ## ã‚³ãƒ¡ãƒ³ãƒˆ (2025å¹´06æœˆ28æ—¥ 12æ™‚25åˆ†) å¿…è¦ãªæ‰‹é † - [x] æ–‡ç« ä¼ç”»ã‚’æ§‹æˆ - [x] ã‚µãƒ³ãƒ—ãƒ«ã®ãƒªãƒã‚¸ãƒˆãƒªã‚’ä½œæˆ - [x] è¨˜äº‹ä½œæˆ - [x] è¨˜äº‹æŠ•ç¨¿ Issueæœ¬æ–‡ï¼ˆã‚¿ã‚¤ãƒˆãƒ«ãƒ»æ¦‚è¦ï¼‰ã¨ã‚³ãƒ¡ãƒ³ãƒˆã®ä¸¡æ–¹ã‚’å–å¾—ã§ãã‚‹ãŸã‚ã€Issueã®å…¨ä½“åƒã‚’æŠŠæ¡ã—ãŸã„å ´åˆã«æœ€é©ã§ã™ã€‚\nã¾ã¨ã‚ # æ–¹æ³• ç‰¹å¾´ æ¨å¥¨åº¦ æ–¹æ³•1ï¼ˆã‚·ãƒ³ãƒ—ãƒ«ï¼‰ ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ãŒå¤šãèª­ã¿ã«ãã„ â–³ æ–¹æ³•2ï¼ˆISOå½¢å¼ï¼‰ ã‚³ãƒ¡ãƒ³ãƒˆã®ã¿æŠ½å‡ºã€æ—¥æ™‚ãŒèª­ã¿ã«ãã„ â—‹ æ–¹æ³•3ï¼ˆæ—¥æœ¬èªè¡¨è¨˜ï¼‰ ã‚³ãƒ¡ãƒ³ãƒˆã®ã¿ã€èª­ã¿ã‚„ã™ãå®Ÿç”¨çš„ â—‹ æ–¹æ³•4ï¼ˆæœ¬æ–‡+ã‚³ãƒ¡ãƒ³ãƒˆï¼‰ Issueå…¨ä½“ã‚’å–å¾—ã€æœ€ã‚‚å®Ÿç”¨çš„ â— gh issue view ã‚³ãƒãƒ³ãƒ‰ã§Issuesã‚’Markdownã¨ã—ã¦å–å¾—ã§ãã‚‹ --json ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§ comments ã®ã¿ã€ã¾ãŸã¯ title,body,comments ã‚’æŒ‡å®šã—ã¦å‡ºåŠ›å†…å®¹ã‚’åˆ¶å¾¡å¯èƒ½ jq ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ãˆã°æ—¥æ™‚ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã‚’æ—¥æœ¬èªè¡¨è¨˜ã«å¤‰æ›ã§ãã‚‹ ã‚ªãƒ•ãƒ©ã‚¤ãƒ³ç’°å¢ƒã§ã‚‚Issuesã®å†…å®¹ã‚’å‚ç…§ã§ãã€ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆä½œæˆã®ç´ æã¨ã—ã¦æ´»ç”¨ã§ãã‚‹ å‚è€ƒ # GitHub CLI ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆ ã€Git ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã€‘GitHub CLI ã‚’ä½¿ã£ã¦ GitHub ã«æ¥ç¶šã™ã‚‹ ","date":"2025å¹´ 12æœˆ 2æ—¥","externalUrl":null,"permalink":"/posts/251202080329_download-github-issues-as-markdown-files/","section":"Posts","summary":"","title":"Github-CLIã§Issuesã‚’Markdownãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã™ã‚‹æ–¹æ³•","type":"posts"},{"content":" ä»Šæ—¥å­¦ã‚“ã ã“ã¨ # NANDå‹RSãƒ•ãƒªãƒƒãƒ—ãƒ•ãƒ­ãƒƒãƒ—ã®ä»•çµ„ã¿ã¨å‹•ä½œåŸç†ã‚’å­¦ã³ã¾ã—ãŸã€‚2ã¤ã®NANDã‚²ãƒ¼ãƒˆã‚’ãŸã™ããŒã‘ã«æ¥ç¶šã™ã‚‹ã“ã¨ã§ã€1ãƒ“ãƒƒãƒˆã®æƒ…å ±ã‚’è¨˜æ†¶ãƒ»ä¿æŒã§ãã‚‹åŸºæœ¬çš„ãªé †åºå›è·¯ã§ã™ã€‚\nå­¦ç¿’å†…å®¹ # NANDå‹RSãƒ•ãƒªãƒƒãƒ—ãƒ•ãƒ­ãƒƒãƒ—ã¨ã¯ # NANDã‚²ãƒ¼ãƒˆã‚’2ã¤ãŸã™ããŒã‘ã™ã‚‹ã“ã¨ã§æ§‹æˆã•ã‚Œã‚‹è«–ç†å›è·¯ã§ã™ã€‚\nãƒ‡ã‚¸ã‚¿ãƒ«å›è·¯ã«ãŠã‘ã‚‹åŸºæœ¬çš„ãªè¨˜æ†¶ç´ å­ã®ä¸€ã¤ 1ãƒ“ãƒƒãƒˆã®æƒ…å ±ï¼ˆ0ã‹1ï¼‰ã‚’è¨˜æ†¶ã—ã€ä¿æŒã™ã‚‹ã“ã¨ãŒå¯èƒ½ RSãƒ•ãƒªãƒƒãƒ—ãƒ•ãƒ­ãƒƒãƒ—ã®ã€ŒRSã€ã¯ã€ãã‚Œãã‚Œ**ã‚»ãƒƒãƒˆï¼ˆSetï¼‰ã¨ãƒªã‚»ãƒƒãƒˆï¼ˆResetï¼‰**ã®é ­æ–‡å­—ã«ç”±æ¥ â”Œâ”€â”€â”€â”€â”€â”€â”€â” S â”€â”€â”€â”€â”€â”€â”¤ â”‚ â”‚ NAND â”œâ”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€ Q â”Œâ”€â”€â”€â”¤ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â” â”‚ â””â”€â”€â”€â”¤ â”œâ”€â”€â”˜ â”‚ NAND â”‚ â”Œâ”€â”€â”€â”¤ â”œâ”€â”€â”€â”€â”€â”€â”€â”€ QÌ„ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ R â”€â”€â”˜ ãªãœè¨˜æ†¶ã§ãã‚‹ã®ã‹ # NANDå‹RSãƒ•ãƒªãƒƒãƒ—ãƒ•ãƒ­ãƒƒãƒ—ãŒè¨˜æ†¶ã§ãã‚‹ç†ç”±ã¯ã€ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯æ§‹é€ ã«ã‚ã‚Šã¾ã™ã€‚\nå„NANDã‚²ãƒ¼ãƒˆã®å‡ºåŠ›ãŒã€ã‚‚ã†ä¸€æ–¹ã®NANDã‚²ãƒ¼ãƒˆã®å…¥åŠ›ã«æ¥ç¶šã•ã‚Œã¦ã„ã‚‹ ã“ã®ç›¸äº’æ¥ç¶šã«ã‚ˆã‚Šã€ä¸€åº¦ã‚»ãƒƒãƒˆã¾ãŸã¯ãƒªã‚»ãƒƒãƒˆã•ã‚ŒãŸçŠ¶æ…‹ãŒè‡ªå·±ä¿æŒã•ã‚Œã‚‹ å…¥åŠ›Sã€RãŒã¨ã‚‚ã«ã€Œ1ã€ã«ãªã£ã¦ã‚‚ã€å‡ºåŠ›ã¯ç›´å‰ã®çŠ¶æ…‹ã‚’ç¶­æŒã—ç¶šã‘ã‚‹ ã¤ã¾ã‚Šã€2ã¤ã®NANDã‚²ãƒ¼ãƒˆãŒäº’ã„ã«ã€Œæ”¯ãˆåˆã†ã€ã“ã¨ã§ã€é›»æºãŒä¾›çµ¦ã•ã‚Œã¦ã„ã‚‹é™ã‚ŠçŠ¶æ…‹ã‚’ä¿æŒã§ãã¾ã™ã€‚\nNANDå‹RSãƒ•ãƒªãƒƒãƒ—ãƒ•ãƒ­ãƒƒãƒ—ã®ç‰¹å¾´ # 2ã¤ã®å‡ºåŠ›ï¼ˆQã¨QÌ„ï¼‰ã¯äº’ã„ã«é€†ã®å€¤ã«ãªã‚‹\nS=R=0ã®ç¦æ­¢çŠ¶æ…‹ã‚’é™¤ãã€Qã¨QÌ„ã¯å¿…ãšäº’ã„ã«é€†ã®å€¤ã«ãªã‚Šã¾ã™ã€‚ Sï¼0ï¼ŒRï¼1ã§ã‚»ãƒƒãƒˆï¼ˆQï¼1ï¼‰\nå…¥åŠ›Sã«ã€Œ0ã€ã€Rã«ã€Œ1ã€ãŒå…¥åŠ›ã•ã‚Œã‚‹ã¨ã€å‡ºåŠ›Qã¯ã€Œ1ã€ã«ã‚»ãƒƒãƒˆã•ã‚Œã¾ã™ã€‚ SãŒå…¥åŠ›ã•ã‚Œã‚‹NANDã‚²ãƒ¼ãƒˆã¯ã€å…¥åŠ›ã«ã€Œ0ã€ãŒã‚ã‚‹ãŸã‚å‡ºåŠ›ï¼ˆQï¼‰ãŒå¿…ãšã€Œ1ã€ã«ãªã‚Šã¾ã™ã€‚ ãã®çµæœã€ã‚‚ã†ä¸€æ–¹ã®NANDã‚²ãƒ¼ãƒˆã®å…¥åŠ›ã¯ä¸¡æ–¹ã¨ã‚‚ã€Œ1ã€ã¨ãªã‚Šã€å‡ºåŠ›ï¼ˆQÌ„ï¼‰ã¯ã€Œ0ã€ã«ãªã‚Šã¾ã™ã€‚ Sï¼1ï¼ŒRï¼0ã§ãƒªã‚»ãƒƒãƒˆï¼ˆQï¼0ï¼‰\nå…¥åŠ›Sã«ã€Œ1ã€ã€Rã«ã€Œ0ã€ãŒå…¥åŠ›ã•ã‚Œã‚‹ã¨ã€å‡ºåŠ›Qã¯ã€Œ0ã€ã«ãƒªã‚»ãƒƒãƒˆã•ã‚Œã¾ã™ã€‚ RãŒå…¥åŠ›ã•ã‚Œã‚‹NANDã‚²ãƒ¼ãƒˆã®å‡ºåŠ›ï¼ˆQÌ„ï¼‰ãŒã€Œ1ã€ã«ãªã‚Šã€ãã®çµæœã€ã‚‚ã†ä¸€æ–¹ã®NANDã‚²ãƒ¼ãƒˆã®å‡ºåŠ›ï¼ˆQï¼‰ãŒã€Œ0ã€ã«ãªã‚Šã¾ã™ã€‚ Sï¼Rï¼1ã§çŠ¶æ…‹ä¿æŒ\nå…¥åŠ›Sã¨RãŒã¨ã‚‚ã«ã€Œ1ã€ã®å ´åˆã€ãƒ•ãƒªãƒƒãƒ—ãƒ•ãƒ­ãƒƒãƒ—ã¯ç›´å‰ã®å‡ºåŠ›çŠ¶æ…‹ã‚’ä¿æŒã—ã¾ã™ã€‚ ä¾‹ãˆã°ã€QãŒã€Œ1ã€ã§ã‚ã‚Œã°ã€Œ1ã€ã®ã¾ã¾ã€QãŒã€Œ0ã€ã§ã‚ã‚Œã°ã€Œ0ã€ã®ã¾ã¾ã¨ãªã‚Šã¾ã™ã€‚ ã“ã‚Œã¯ã€NANDã‚²ãƒ¼ãƒˆã®å‡ºåŠ›ãŒã‚‚ã†ä¸€æ–¹ã®å…¥åŠ›ã«å½±éŸ¿ã‚’ä¸ãˆåˆã„ã€å®‰å®šã—ãŸçŠ¶æ…‹ã‚’ç¶­æŒã™ã‚‹ãŸã‚ã§ã™ã€‚ çœŸç†å€¤è¡¨ # S R Qn+1 QÌ„n+1 çŠ¶æ…‹ 0 0 1 1 ç¦æ­¢ 0 1 1 0 ã‚»ãƒƒãƒˆ 1 0 0 1 ãƒªã‚»ãƒƒãƒˆ 1 1 Qn QÌ„n ä¿æŒ ï¼ˆQnã¯ç¾åœ¨ã®çŠ¶æ…‹ã€Qn+1ã¯æ¬¡ã®çŠ¶æ…‹ã‚’ç¤ºã—ã¾ã™ï¼‰\nã¾ã¨ã‚ # NANDå‹RSãƒ•ãƒªãƒƒãƒ—ãƒ•ãƒ­ãƒƒãƒ—ã¯ã€2ã¤ã®NANDã‚²ãƒ¼ãƒˆã‚’ãŸã™ããŒã‘ã«æ¥ç¶šã—ãŸè¨˜æ†¶ç´ å­ S=0, R=1 ã§å‡ºåŠ›Qã‚’ã€Œ1ã€ã«ã‚»ãƒƒãƒˆ S=1, R=0 ã§å‡ºåŠ›Qã‚’ã€Œ0ã€ã«ãƒªã‚»ãƒƒãƒˆ S=R=1 ã§ç›´å‰ã®çŠ¶æ…‹ã‚’ä¿æŒ S=R=0 ã¯ç¦æ­¢çŠ¶æ…‹ï¼ˆä¸¡å‡ºåŠ›ãŒã€Œ1ã€ã«ãªã‚Šã€Qã¨QÌ„ãŒé€†ã«ãªã‚‰ãªã„ã€‚ã•ã‚‰ã«æ¬¡ã«ä¸¡å…¥åŠ›ãŒåŒæ™‚ã«ã€Œ1ã€ã«æˆ»ã‚‹ã¨å‡ºåŠ›ãŒä¸å®šã«ãªã‚‹ï¼‰ å‚è€ƒ # Wikipediaï¼šãƒ•ãƒªãƒƒãƒ—ãƒ•ãƒ­ãƒƒãƒ— å¿œç”¨æƒ…å ±æŠ€è¡“è€…éå»å•é“å ´ï¼šå¹³æˆ27å¹´ç§‹æœŸ å•22 ","date":"2025å¹´ 12æœˆ 1æ—¥","externalUrl":null,"permalink":"/posts/251201221916_nand-type-rs-flip-flop/","section":"Posts","summary":"","title":"1ãƒ“ãƒƒãƒˆã‚’è¨˜æ†¶ã™ã‚‹ä»•çµ„ã¿ï¼šNANDå‹RSãƒ•ãƒªãƒƒãƒ—ãƒ•ãƒ­ãƒƒãƒ—","type":"posts"},{"content":"","date":"2025å¹´ 12æœˆ 1æ—¥","externalUrl":null,"permalink":"/tags/%E3%83%87%E3%82%B8%E3%82%BF%E3%83%AB%E5%9B%9E%E8%B7%AF/","section":"Tags","summary":"","title":"ãƒ‡ã‚¸ã‚¿ãƒ«å›è·¯","type":"tags"},{"content":"","date":"2025å¹´ 12æœˆ 1æ—¥","externalUrl":null,"permalink":"/tags/%E8%AA%AD%E6%9B%B8%E3%83%A1%E3%83%A2/","section":"Tags","summary":"","title":"èª­æ›¸ãƒ¡ãƒ¢","type":"tags"},{"content":" ä»Šæ—¥å­¦ã‚“ã ã“ã¨ # ã€ŒæŒ‡ç¤ºé€šã‚Šã«ã§ããªã„ã€åŸå› ã¯ã€èªçŸ¥èƒ½åŠ›ãƒ»ãƒ¡ã‚¿èªçŸ¥èƒ½åŠ›ãƒ»éèªçŸ¥èƒ½åŠ›ã®3ã¤ã«åˆ†é¡ã§ãã€ãã‚Œãã‚Œèª­æ›¸ãƒ»å†…çœãƒ»å¯¾è©±ã¨ã„ã£ãŸãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ã§æ”¹å–„å¯èƒ½ã§ã‚ã‚‹ã“ã¨ã‚’å­¦ã³ã¾ã—ãŸã€‚\nå­¦ç¿’å†…å®¹ # æ›¸ç±ã«ã¤ã„ã¦ # æ¦æœ¬åšæ˜è‘—ã€ã€ŒæŒ‡ç¤ºé€šã‚Šã€ãŒã§ããªã„äººãŸã¡ã€ï¼ˆ2024å¹´ã€æ—¥çµŒBPï¼‰ã‚’èª­ã¿ã¾ã—ãŸã€‚è‡ªèº«ã®ã‚½ãƒ•ãƒˆã‚¹ã‚­ãƒ«ã€ç‰¹ã«éèªçŸ¥èƒ½åŠ›ã®æ”¹å–„ãƒ’ãƒ³ãƒˆã‚’å¾—ãŸã„ã¨è€ƒãˆãŸã®ãŒè³¼å…¥ã®ãã£ã‹ã‘ã§ã™ã€‚\næœ¬æ›¸ã®æ§‹æˆ # æœ¬æ›¸ã¯ã€ŒæŒ‡ç¤ºé€šã‚Šã€ã«æ¥­å‹™ã‚’é‚è¡Œã§ããªã„äººã€…ã‚’ä»¥ä¸‹ã®3ã‚¿ã‚¤ãƒ—ã«åˆ†é¡ã—ã€ãã‚Œãã‚Œã®ã‚±ãƒ¼ã‚¹ã¨åŸå› ã€æ”¹å–„ç­–ã‚’è§£èª¬ã—ã¦ã„ã¾ã™ã€‚\nèªçŸ¥èƒ½åŠ›ã«èª²é¡ŒãŒã‚ã‚‹äºº ãƒ¡ã‚¿èªçŸ¥èƒ½åŠ›ã«èª²é¡ŒãŒã‚ã‚‹äºº éèªçŸ¥èƒ½åŠ›ã«èª²é¡ŒãŒã‚ã‚‹äºº æ”¹å–„ç­–ã®æŸ±ã¨ã—ã¦ã€Œèª­æ›¸ã€ã‚„ã€Œæ–‡ç« ã®è¦ç´„ã€ã«ã‚ˆã‚‹èª­è§£åŠ›ã®å¼·åŒ–ãŒæè¨€ã•ã‚Œã¦ã„ã¾ã™ã€‚ã¾ãŸã€é–¢é€£æ›¸ç±ã¨ã—ã¦ãƒ€ãƒ‹ã‚¨ãƒ«ãƒ»ã‚´ãƒ¼ãƒ«ãƒ‰ãƒãƒ³ã®ã€EQ ã“ã“ã‚ã®çŸ¥èƒ½æŒ‡æ•°ã€ã‚‚ç´¹ä»‹ã•ã‚Œã¦ãŠã‚Šã€æ„Ÿæƒ…çš„çŸ¥æ€§ã®é‡è¦æ€§ã«ã‚‚è§¦ã‚Œã‚‰ã‚Œã¦ã„ã¾ã™ã€‚\nå°è±¡ã«æ®‹ã£ãŸã‚±ãƒ¼ã‚¹ # èªçŸ¥èƒ½åŠ›ï¼šãƒ‘ãƒ‹ãƒƒã‚¯ã«å¼±ã„äºº # è¤‡æ•°ã®ã‚¿ã‚¹ã‚¯ã‚’åŒæ™‚ã«æŒ¯ã‚‰ã‚Œã‚‹ã¨æ··ä¹±ã—ã¦ã—ã¾ã†ã‚±ãƒ¼ã‚¹ã€‚ãƒ¯ãƒ¼ã‚­ãƒ³ã‚°ãƒ¡ãƒ¢ãƒªã®å®¹é‡ãŒå°‘ãªã„ã“ã¨ãŒä¸€å› ã¨ã•ã‚Œã¦ã„ã¾ã™ã€‚\næ”¹å–„ç­–: ã‚¿ã‚¹ã‚¯ã®å„ªå…ˆé †ä½ã‚’éƒ½åº¦æ˜ç¢ºã«ã—ã€ä¸€ã¤ã®ä½œæ¥­ã«é›†ä¸­ã™ã‚‹ç’°å¢ƒã‚’æ„è­˜çš„ã«ä½œã‚‹ã€‚\nãƒ¡ã‚¿èªçŸ¥èƒ½åŠ›ï¼šåŒã˜ãƒŸã‚¹ã‚’ç¹°ã‚Šè¿”ã™äºº # éå»ã®æŒ‡æ‘˜ã‚’å¿˜ã‚Œã€åŒæ§˜ã®å¤±æ•—ã‚’ç¹°ã‚Šè¿”ã™ã‚±ãƒ¼ã‚¹ã€‚å˜ãªã‚‹è¨˜æ†¶åŠ›ã®å•é¡Œã§ã¯ãªãã€è‡ªèº«ã®è¡Œå‹•ã‚’å®¢è¦³è¦–ã§ãã¦ã„ãªã„ã“ã¨ã«èµ·å› ã—ã¾ã™ã€‚\næ”¹å–„ç­–: æŒ‡æ‘˜ã‚’ãã®å ´ã§ãƒ¡ãƒ¢ã«å–ã‚‹ã€æ—¥è¨˜ã§è‡ªèº«ã®è¡Œå‹•ã‚’æŒ¯ã‚Šè¿”ã‚‹ãªã©ã€å†…çœã‚’ç¿’æ…£åŒ–ã™ã‚‹ã€‚\néèªçŸ¥èƒ½åŠ›ï¼šèƒ½åŠ›ã¯é«˜ã„ãŒå¯¾äººé–¢ä¿‚ãŒè‹¦æ‰‹ãªäºº # æ¥­å‹™é‚è¡Œèƒ½åŠ›ã‚„çŸ¥è­˜ã¯è±Šå¯Œã ãŒã€é¡§å®¢ã¨ã®äº¤æ¸‰ãªã©å¯¾äººé–¢ä¿‚ã«å¼·ã„ä¸å®‰ã‚’æ„Ÿã˜ã€ã‚­ãƒ£ãƒªã‚¢ã®æ©Ÿä¼šã‚’é€ƒã—ã¦ã—ã¾ã†ã‚±ãƒ¼ã‚¹ã€‚\næ”¹å–„ç­–: ã€Œå¯¾äººä¸å®‰ã€ã¯å¤šãã®äººãŒæŠ±ãˆã‚‹æ™®éçš„ãªæ„Ÿæƒ…ã§ã‚ã‚‹ã¨å—ã‘å…¥ã‚Œã€å°ã•ãªæˆåŠŸä½“é¨“ã‚’ç©ã‚€ã“ã¨ã§å¾ã€…ã«å…‹æœã—ã¦ã„ãã€‚\nä»Šå¾Œã®è¡Œå‹• # æœ¬æ›¸ã®æè¨€ã‚’è¸ã¾ãˆã€ä»¥ä¸‹ã‚’ç¶™ç¶šçš„ã«å®Ÿè·µã—ã¦ã„ãã¾ã™ã€‚\nèª­æ›¸ãƒ¡ãƒ¢ã®ä½œæˆ: å†…å®¹ã‚’è¦ç´„ã™ã‚‹ç¿’æ…£ã§èª­è§£åŠ›ã‚’é¤Šã† æ—¥è¨˜ã«ã‚ˆã‚‹æŒ¯ã‚Šè¿”ã‚Š: è‡ªèº«ã®è¡Œå‹•ã‚„æ„Ÿæƒ…ã‚’å®¢è¦³çš„ã«å†…çœã™ã‚‹ ã¾ã¨ã‚ # èª²é¡Œã®ã‚¿ã‚¤ãƒ— ä¾‹ æ”¹å–„ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ èªçŸ¥èƒ½åŠ› ãƒ‘ãƒ‹ãƒƒã‚¯ã«å¼±ã„ å„ªå…ˆé †ä½ã®æ˜ç¢ºåŒ–ã€é›†ä¸­ç’°å¢ƒã®æ§‹ç¯‰ ãƒ¡ã‚¿èªçŸ¥èƒ½åŠ› åŒã˜ãƒŸã‚¹ã‚’ç¹°ã‚Šè¿”ã™ ãƒ¡ãƒ¢ãƒ»æ—¥è¨˜ã«ã‚ˆã‚‹å†…çœã®ç¿’æ…£åŒ– éèªçŸ¥èƒ½åŠ› å¯¾äººé–¢ä¿‚ãŒè‹¦æ‰‹ ä¸å®‰ã®å—å®¹ã¨å°ã•ãªæˆåŠŸä½“é¨“ã®ç©ã¿é‡ã­ å…±é€šã™ã‚‹æ”¹å–„ç­–ã¯ã€Œèª­æ›¸ã¨è¦ç´„ã€ã€Œæ—¥ã€…ã®å†…çœã€ã€Œä»–è€…ã¨ã®å¯¾è©±ã€ã®3ã¤ã§ã™ã€‚\nå‚è€ƒ # æ¦æœ¬åšæ˜ã€ã€ŒæŒ‡ç¤ºé€šã‚Šã€ãŒã§ããªã„äººãŸã¡ã€æ—¥çµŒBPã€2024å¹´ ","date":"2025å¹´ 12æœˆ 1æ—¥","externalUrl":null,"permalink":"/posts/251201082613_reading-memo-people-who-cant-follow-instructions/","section":"Posts","summary":"","title":"èª­æ›¸ãƒ¡ãƒ¢ï¼šæŒ‡ç¤ºé€šã‚ŠãŒã§ããªã„äººãŸã¡","type":"posts"},{"content":" æ›¸ç±æƒ…å ± # ã‚¿ã‚¤ãƒˆãƒ«ï¼šç§‘å­¦çš„æ ¹æ‹ ã«åŸºã¥ãæœ€é«˜ã®å‹‰å¼·æ³• è‘—è€…ï¼šå®‰å· åº·ä»‹ å‡ºç‰ˆç¤¾ï¼šKADOKAWA ç™ºå£²æ—¥ï¼š2024/2/15 æœ¬æ›¸ã®Ch.1ã¨Ch.2ã‚’ä¸­å¿ƒã«ã¾ã¨ã‚ãŸèª­æ›¸ãƒ¡ãƒ¢ã€‚\nçµè«–ï¼šæœ€é«˜ã®å‹‰å¼·æ³•ã¯ã€Œé€£ç¶šçš„å†å­¦ç¿’ã€ # æœ¬æ›¸ãŒæå”±ã™ã‚‹æœ€é«˜ã®å‹‰å¼·æ³•ã¯ é€£ç¶šçš„å†å­¦ç¿’ ã§ã‚ã‚‹ã€‚\né€£ç¶šçš„å†å­¦ç¿’ ï¼ ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãƒªã‚³ãƒ¼ãƒ« ï¼‹ åˆ†æ•£å­¦ç¿’\nã“ã®çµè«–ã¯ã€ãƒ€ãƒ³ãƒ­ã‚¹ã‚­ãƒ¼æ•™æˆã«ã‚ˆã‚‹å‹‰å¼·æ³•ã®å ±å‘Šæ›¸ã‚„ãƒ–ãƒ«ãƒ¼ãƒ ã‚¿ã‚­ã‚½ãƒãƒŸãƒ¼ãªã©ã®ç ”ç©¶ã«åŸºã¥ã„ã¦ã„ã‚‹ã€‚\nåŠ¹æœãŒä½ã„å‹‰å¼·æ³• # ä»¥ä¸‹ã®å‹‰å¼·æ³•ã¯åŠ¹æœãŒä½ã„ã¨ã•ã‚Œã¦ã„ã‚‹ã€‚\nå†èª­ ãƒãƒ¼ãƒˆã¸ã®è¦ç´„ ãƒã‚¤ãƒ©ã‚¤ãƒˆ ãªãœåŠ¹æœã®ä½ã„æ–¹æ³•ãŒãƒ¡ã‚¸ãƒ£ãƒ¼ãªã®ã‹ï¼Ÿ # åŸå› ã¯ ã€Œæµæš¢æ€§ã®èª¤è¬¬ã€ ã«ã‚ã‚‹ã€‚\nå®Ÿæ„Ÿã¨ã—ã¦ã¯åŠ¹æœãŒã‚ã‚‹ã‚ˆã†ã«æ„Ÿã˜ã‚‹ ã—ã‹ã—å®Ÿéš›ã®ãƒ†ã‚¹ãƒˆçµæœã¯å‘ä¸Šã—ã¦ã„ãªã„ ã¾ãŸã¯å€‹äººå·®ãŒå¤§ãã„ ä¸€æ–¹ã€ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãƒªã‚³ãƒ¼ãƒ«ã‚„åˆ†æ•£å­¦ç¿’ã¯å®Ÿæ„ŸãŒè–„ã„ã‚‚ã®ã®ã€ãƒ†ã‚¹ãƒˆç­‰ã§å®Ÿéš›ã«çµæœãŒå‡ºã¦ã„ã‚‹ã€‚\nå®Ÿæ„Ÿã«æƒ‘ã‚ã•ã‚Œãšã€æœ¬å½“ã«åŠ¹æœã®ã‚ã‚‹æ–¹æ³•ã‚’é¸ã¶ã¹ãã€‚\nã‚­ãƒ¼ã‚³ãƒ³ã‚»ãƒ—ãƒˆï¼šæœ›ã¾ã—ã„å›°é›£ # è„³ã«è² è·ã‚’ã‹ã‘ã¦ã€Œæœ›ã¾ã—ã„å›°é›£ã€ã‚’ä½œã‚Šå‡ºã™ã“ã¨ãŒãƒã‚¤ãƒ³ãƒˆã€‚ã‚¤ãƒ³ãƒ—ãƒƒãƒˆã ã‘ã§ãªãã‚¢ã‚¦ãƒˆãƒ—ãƒƒãƒˆã®é‡è¦æ€§ã‚’èªè­˜ã™ã‚‹ã“ã¨ãŒå¤§åˆ‡ã€‚\nè‡ªåˆ†ã®å®Ÿè·µãƒ—ãƒ©ãƒ³ # NotebookLMã§ãƒ•ãƒ©ãƒƒã‚·ãƒ¥ã‚«ãƒ¼ãƒ‰ä½œæˆ - TILã¨ã—ã¦æ›¸ã„ã¦ã„ã‚‹æŠ€è¡“ãƒ–ãƒ­ã‚°ã‚’èª­ã¿è¾¼ã¾ã›ã¦ãƒ•ãƒ©ãƒƒã‚·ãƒ¥ã‚«ãƒ¼ãƒ‰ã‚’ç”Ÿæˆã™ã‚‹ ç™½ç´™ã‹ã‚‰æ›¸ãå‡ºã™ - ãƒ’ãƒ³ãƒˆãŒå°‘ãªã„çŠ¶æ…‹ã‹ã‚‰å›ç­”ã‚’å†ç¾ã™ã‚‹ ã‚´ãƒ¼ãƒ«æç¤ºå‹ãƒãƒ³ã‚ºã‚ªãƒ³ - ã‚´ãƒ¼ãƒ«ã ã‘ç¤ºã—ã¦ã€å¯èƒ½ãªé™ã‚Šãƒ’ãƒ³ãƒˆãªã—ã§å®Ÿè·µã™ã‚‹ ","date":"2025å¹´ 11æœˆ 30æ—¥","externalUrl":null,"permalink":"/posts/251130211705_best-learning-method-continuous-relearning/","section":"Posts","summary":"","title":"æœ€é«˜ã®å‹‰å¼·æ³•ï¼šé€£ç¶šçš„å†å­¦ç¿’ã®ã™ã™ã‚","type":"posts"},{"content":"","date":"2025å¹´ 11æœˆ 30æ—¥","externalUrl":null,"permalink":"/series/docker%E7%92%B0%E5%A2%83%E3%81%A7node.js%E3%82%92%E5%AD%A6%E3%81%BC%E3%81%86/","section":"Series","summary":"","title":"Dockerç’°å¢ƒã§Node.jsã‚’å­¦ã¼ã†","type":"series"},{"content":" ã¯ã˜ã‚ã« # ğŸ¯ ã“ã®ãƒ¡ãƒ¢ã§ç†è§£ã™ã¹ã3ã¤ã®è¦ç‚¹ # yarnï¼šnpmã®ä»£æ›¿ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼\nnpmã‚ˆã‚Šé«˜é€Ÿã§å³å¯†ãªãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç† yarn.lockã«ã‚ˆã‚‹ä¾å­˜é–¢ä¿‚ã®å›ºå®š Sassï¼šCSSã®æ‹¡å¼µè¨€èª\nãƒã‚¹ãƒˆæ§‹æ–‡ã€å¤‰æ•°ã€ãƒŸãƒƒã‚¯ã‚¹ã‚¤ãƒ³ã§CSSé–‹ç™ºã‚’åŠ¹ç‡åŒ– SCSSãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰CSSãƒ•ã‚¡ã‚¤ãƒ«ã¸ã‚³ãƒ³ãƒ‘ã‚¤ãƒ« nvm/nodenvï¼šNode.jsãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†\nãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã”ã¨ã«ç•°ãªã‚‹Node.jsãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ä½¿ç”¨ ãƒãƒ¼ãƒ å†…ã§ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’çµ±ä¸€ âš ï¸ ã‚ˆãã‚ã‚‹åˆå¿ƒè€…ã®é–“é•ã„ # âŒ npmã¨yarnã‚’åŒã˜ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§æ··ç”¨ã—ã¦ã—ã¾ã† âŒ Sassã¨SCSSã€node-sassã¨Dart Sassã®é•ã„ã‚’ç†è§£ã—ã¦ã„ãªã„ âŒ nvm useã®è¨­å®šãŒæ–°ã—ã„ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã§å¼•ãç¶™ãŒã‚Œãªã„ å‰ææ¡ä»¶ # Part 1 ã‚’å®Œäº†ã—ã¦ã„ã‚‹ã“ã¨ï¼ˆDockeråŸºç¤ã€Node.js/npmåŸºç¤ï¼‰ Docker DesktopãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ã“ã¨ Section 1: yarnï¼ˆãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ï¼‰ # 1.1 yarnã¨ã¯ï¼Ÿ # yarnã¯ã€Metaï¼ˆæ—§Facebookï¼‰ãŒé–‹ç™ºã—ãŸãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ã§ã™ã€‚\nnpmã¨yarnã®æ¯”è¼ƒ # é …ç›® npm yarn é–‹ç™ºå…ƒ npm, Inc. Metaï¼ˆæ—§Facebookï¼‰ ç™»å ´å¹´ 2010å¹´ 2016å¹´ é€Ÿåº¦ æ¨™æº–çš„ é«˜é€Ÿï¼ˆä¸¦åˆ—ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ï¼‰ ãƒ­ãƒƒã‚¯ãƒ•ã‚¡ã‚¤ãƒ« package-lock.json yarn.lock ã‚ªãƒ•ãƒ©ã‚¤ãƒ³ã‚­ãƒ£ãƒƒã‚·ãƒ¥ ã‚ã‚Š ã‚ˆã‚Šå¼·åŠ› yarnç™»å ´ã®èƒŒæ™¯ # npmã®å•é¡Œç‚¹ï¼ˆç‰¹ã«2016å¹´å½“æ™‚ï¼‰ã‚’è§£æ±ºã™ã‚‹ãŸã‚ã«é–‹ç™ºã•ã‚Œã¾ã—ãŸï¼š\nã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«é€Ÿåº¦ã®é…ã• ä¾å­˜é–¢ä¿‚ã®ä¸å®‰å®šã• ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã®æ‡¸å¿µ ç¾åœ¨ã®npmã¯å¤§å¹…ã«æ”¹å–„ã•ã‚Œã¦ãŠã‚Šã€ã©ã¡ã‚‰ã‚’ä½¿ã†ã‹ã¯ãƒãƒ¼ãƒ ã®æ–¹é‡æ¬¡ç¬¬ã§ã™ã€‚\n1.2 ãƒãƒ³ã‚ºã‚ªãƒ³ï¼šyarnç’°å¢ƒæ§‹ç¯‰ # å­¦ç¿’ç”¨ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ä½œæˆ # # ãƒ­ãƒ¼ã‚«ãƒ«ã§ä½œæ¥­ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä½œæˆ mkdir yarn-study \u0026amp;\u0026amp; cd yarn-study # Dockerã‚³ãƒ³ãƒ†ãƒŠã‚’èµ·å‹• docker run -it --rm -v $(pwd):/work -w /work node:20 bash yarnã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç¢ºèª # # Node.js 20ã«ã¯yarnãŒå«ã¾ã‚Œã¦ã„ã‚‹ï¼ˆCorepackçµŒç”±ï¼‰ corepack enable yarn --version Corepackï¼šNode.js 16.10ä»¥é™ã«å«ã¾ã‚Œã‚‹ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ç®¡ç†ãƒ„ãƒ¼ãƒ«\n1.3 yarnã§ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåˆæœŸåŒ– # # ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåˆæœŸåŒ– yarn init -y # package.jsonã‚’ç¢ºèª cat package.json ç”Ÿæˆã•ã‚Œã‚‹package.json # { \u0026#34;name\u0026#34;: \u0026#34;work\u0026#34;, \u0026#34;version\u0026#34;: \u0026#34;1.0.0\u0026#34;, \u0026#34;main\u0026#34;: \u0026#34;index.js\u0026#34;, \u0026#34;license\u0026#34;: \u0026#34;MIT\u0026#34; } 1.4 ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« # # ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’è¿½åŠ  yarn add lodash # é–‹ç™ºç”¨ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’è¿½åŠ  yarn add --dev jest # ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ç¢ºèª cat package.json yarnã¨npmã®ã‚³ãƒãƒ³ãƒ‰å¯¾æ¯” # npm yarn èª¬æ˜ npm init -y yarn init -y åˆæœŸåŒ– npm install yarn ã¾ãŸã¯ yarn install ä¾å­˜é–¢ä¿‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« npm install \u0026lt;pkg\u0026gt; yarn add \u0026lt;pkg\u0026gt; ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸è¿½åŠ  npm install -D \u0026lt;pkg\u0026gt; yarn add --dev \u0026lt;pkg\u0026gt; é–‹ç™ºç”¨ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸è¿½åŠ  npm uninstall \u0026lt;pkg\u0026gt; yarn remove \u0026lt;pkg\u0026gt; ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸å‰Šé™¤ npm run \u0026lt;script\u0026gt; yarn \u0026lt;script\u0026gt; ã‚¹ã‚¯ãƒªãƒ—ãƒˆå®Ÿè¡Œ npm update yarn upgrade ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸æ›´æ–° 1.5 yarn.lockã®å½¹å‰² # # yarn.lockã‚’ç¢ºèª cat yarn.lock yarn.lockã®ç‰¹å¾´ # ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚ŒãŸæ­£ç¢ºãªãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’è¨˜éŒ² ãƒãƒ¼ãƒ ãƒ¡ãƒ³ãƒãƒ¼å…¨å“¡ãŒåŒã˜ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ä½¿ç”¨ å¿…ãšGitã«ã‚³ãƒŸãƒƒãƒˆã™ã‚‹ 1.6 ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®å®Ÿè¡Œ # # package.jsonã‚’æ›´æ–° cat \u0026lt;\u0026lt; \u0026#39;EOF\u0026#39; \u0026gt; package.json { \u0026#34;name\u0026#34;: \u0026#34;yarn-study\u0026#34;, \u0026#34;version\u0026#34;: \u0026#34;1.0.0\u0026#34;, \u0026#34;scripts\u0026#34;: { \u0026#34;hello\u0026#34;: \u0026#34;echo \u0026#39;Hello from yarn!\u0026#39;\u0026#34;, \u0026#34;test\u0026#34;: \u0026#34;jest\u0026#34; }, \u0026#34;dependencies\u0026#34;: { \u0026#34;lodash\u0026#34;: \u0026#34;^4.17.21\u0026#34; }, \u0026#34;devDependencies\u0026#34;: { \u0026#34;jest\u0026#34;: \u0026#34;^29.0.0\u0026#34; } } EOF # ã‚¹ã‚¯ãƒªãƒ—ãƒˆå®Ÿè¡Œï¼ˆrunã‚’çœç•¥å¯èƒ½ï¼‰ yarn hello 1.7 ä¾¿åˆ©ãªyarnã‚³ãƒãƒ³ãƒ‰ # # ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ¸ˆã¿ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ä¸€è¦§ yarn list --depth=0 # ç‰¹å®šãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®æƒ…å ± yarn info lodash # ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®ã‚¯ãƒªã‚¢ yarn cache clean # ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰å¯èƒ½ãªãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ç¢ºèª yarn outdated 1.8 npmã¨yarnã®æ··ç”¨ã«æ³¨æ„ # é‡è¦ï¼šåŒã˜ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§npmã¨yarnã‚’æ··ç”¨ã—ãªã„ã§ãã ã•ã„ã€‚\nçŠ¶æ³ å•é¡Œ package-lock.jsonã¨yarn.lockãŒä¸¡æ–¹ã‚ã‚‹ ä¾å­˜é–¢ä¿‚ã®ä¸æ•´åˆ npm installå¾Œã«yarn add ãƒ­ãƒƒã‚¯ãƒ•ã‚¡ã‚¤ãƒ«ã®ç«¶åˆ å¯¾ç­–ï¼šãƒãƒ¼ãƒ ã§çµ±ä¸€ã—ã¦ã€ã©ã¡ã‚‰ã‹ä¸€æ–¹ã®ã¿ã‚’ä½¿ç”¨ã™ã‚‹\n1.9 ã‚³ãƒ³ãƒ†ãƒŠçµ‚äº† # exit âœ… ã“ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§å­¦ã‚“ã ã“ã¨ # yarnã¯npmã®ä»£æ›¿ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ï¼ˆé«˜é€Ÿã€å³å¯†ãªãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†ï¼‰ yarn addã§ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸è¿½åŠ ã€yarnã§ä¾å­˜é–¢ä¿‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« yarn.lockã§ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’å›ºå®šã—ã€ãƒãƒ¼ãƒ ã§çµ±ä¸€ é‡è¦ï¼šnpmã¨yarnã‚’åŒã˜ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§æ··ç”¨ã—ãªã„ Section 2: Sassï¼ˆCSSãƒ—ãƒªãƒ—ãƒ­ã‚»ãƒƒã‚µï¼‰ # 2.1 Sassã¨ã¯ï¼Ÿ # **Sassï¼ˆSyntactically Awesome Style Sheetsï¼‰**ã¯ã€CSSã‚’æ‹¡å¼µã—ãŸãƒ¡ã‚¿è¨€èªã§ã™ã€‚\nSassã®ä¸»ãªæ©Ÿèƒ½ # æ©Ÿèƒ½ èª¬æ˜ ãƒ¡ãƒªãƒƒãƒˆ ãƒã‚¹ãƒˆ ã‚»ãƒ¬ã‚¯ã‚¿ã‚’å…¥ã‚Œå­ã§è¨˜è¿° æ§‹é€ ãŒæ˜ç¢ºã« å¤‰æ•° å€¤ã‚’å¤‰æ•°ã«æ ¼ç´ ä¸€æ‹¬å¤‰æ›´ãŒå®¹æ˜“ ãƒŸãƒƒã‚¯ã‚¹ã‚¤ãƒ³ ã‚¹ã‚¿ã‚¤ãƒ«ã®å†åˆ©ç”¨ DRYåŸå‰‡ ç¶™æ‰¿ ã‚¹ã‚¿ã‚¤ãƒ«ã®ç¶™æ‰¿ ã‚³ãƒ¼ãƒ‰å‰Šæ¸› æ¼”ç®— è¨ˆç®—å¼ãŒä½¿ç”¨å¯èƒ½ å‹•çš„ãªå€¤è¨­å®š SCSS vs Sassè¨˜æ³• # è¨˜æ³• æ‹¡å¼µå­ ç‰¹å¾´ SCSS .scss CSSã¨äº’æ›æ€§ã‚ã‚Šï¼ˆä¸­æ‹¬å¼§ä½¿ç”¨ï¼‰ Sass .sass ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆãƒ™ãƒ¼ã‚¹ï¼ˆä¸­æ‹¬å¼§ãªã—ï¼‰ ç¾åœ¨ã¯SCSSè¨˜æ³•ãŒä¸»æµã§ã™ã€‚\n2.2 CSSã¨SCSSã®æ¯”è¼ƒ # CSSï¼ˆå¾“æ¥ï¼‰ # /* å¾“æ¥ã®CSSï¼šã‚»ãƒ¬ã‚¯ã‚¿ãŒé•·ããªã‚ŠãŒã¡ */ .navbar { background-color: #333; } .navbar ul { list-style: none; } .navbar ul li { display: inline-block; } .navbar ul li a { color: white; padding: 10px; } .navbar ul li a:hover { color: #007bff; } SCSSï¼ˆSassï¼‰ # /* SCSSï¼šãƒã‚¹ãƒˆã§æ§‹é€ ãŒæ˜ç¢º */ $primary-color: #007bff; $dark-bg: #333; .navbar { background-color: $dark-bg; ul { list-style: none; li { display: inline-block; a { color: white; padding: 10px; \u0026amp;:hover { color: $primary-color; } } } } } 2.3 ãƒãƒ³ã‚ºã‚ªãƒ³ï¼šSassç’°å¢ƒæ§‹ç¯‰ # å­¦ç¿’ç”¨ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ä½œæˆ # # ãƒ­ãƒ¼ã‚«ãƒ«ã§ä½œæ¥­ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä½œæˆ mkdir sass-study \u0026amp;\u0026amp; cd sass-study # Dockerã‚³ãƒ³ãƒ†ãƒŠã‚’èµ·å‹• docker run -it --rm -v $(pwd):/work -w /work node:20 bash ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåˆæœŸåŒ–ã¨Sassã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« # # ã‚³ãƒ³ãƒ†ãƒŠå†…ã§å®Ÿè¡Œ npm init -y # Sassã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ï¼ˆDart Sassï¼‰ npm install --save-dev sass æ³¨æ„ï¼šnode-sassã¯éæ¨å¥¨ã§ã™ã€‚å…¬å¼ã®sassï¼ˆDart Sassï¼‰ã‚’ä½¿ç”¨ã—ã¦ãã ã•ã„ã€‚\n2.4 ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ ã®ä½œæˆ # # ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä½œæˆ mkdir -p src/scss dist/css 2.5 SCSSãƒ•ã‚¡ã‚¤ãƒ«ã®ä½œæˆ # å¤‰æ•°ã¨ãƒ™ãƒ¼ã‚¹ã‚¹ã‚¿ã‚¤ãƒ« # # å¤‰æ•°ãƒ•ã‚¡ã‚¤ãƒ« cat \u0026lt;\u0026lt; \u0026#39;EOF\u0026#39; \u0026gt; src/scss/_variables.scss // ã‚«ãƒ©ãƒ¼ãƒ‘ãƒ¬ãƒƒãƒˆ $primary-color: #007bff; $secondary-color: #6c757d; $success-color: #28a745; $danger-color: #dc3545; $dark-color: #343a40; $light-color: #f8f9fa; // ãƒ•ã‚©ãƒ³ãƒˆ $font-family-base: \u0026#39;Helvetica Neue\u0026#39;, Arial, sans-serif; $font-size-base: 16px; // ã‚¹ãƒšãƒ¼ã‚·ãƒ³ã‚° $spacing-unit: 8px; EOF ãƒŸãƒƒã‚¯ã‚¹ã‚¤ãƒ³ # # ãƒŸãƒƒã‚¯ã‚¹ã‚¤ãƒ³ãƒ•ã‚¡ã‚¤ãƒ« cat \u0026lt;\u0026lt; \u0026#39;EOF\u0026#39; \u0026gt; src/scss/_mixins.scss // ãƒ•ãƒ¬ãƒƒã‚¯ã‚¹ãƒœãƒƒã‚¯ã‚¹ã‚»ãƒ³ã‚¿ãƒªãƒ³ã‚° @mixin flex-center { display: flex; justify-content: center; align-items: center; } // ãƒœã‚¿ãƒ³ã‚¹ã‚¿ã‚¤ãƒ« @mixin button-style($bg-color, $text-color: white) { background-color: $bg-color; color: $text-color; padding: $spacing-unit * 1.5 $spacing-unit * 3; border: none; border-radius: 4px; cursor: pointer; transition: opacity 0.2s; \u0026amp;:hover { opacity: 0.9; } } // ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒ–ãƒ¬ãƒ¼ã‚¯ãƒã‚¤ãƒ³ãƒˆ @mixin respond-to($breakpoint) { @if $breakpoint == \u0026#39;sm\u0026#39; { @media (max-width: 576px) { @content; } } @else if $breakpoint == \u0026#39;md\u0026#39; { @media (max-width: 768px) { @content; } } @else if $breakpoint == \u0026#39;lg\u0026#39; { @media (max-width: 992px) { @content; } } } EOF ãƒ¡ã‚¤ãƒ³ã‚¹ã‚¿ã‚¤ãƒ« # # ãƒ¡ã‚¤ãƒ³SCSSãƒ•ã‚¡ã‚¤ãƒ« cat \u0026lt;\u0026lt; \u0026#39;EOF\u0026#39; \u0026gt; src/scss/style.scss // ãƒ‘ãƒ¼ã‚·ãƒ£ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆ @use \u0026#39;variables\u0026#39; as *; @use \u0026#39;mixins\u0026#39; as *; // ãƒªã‚»ãƒƒãƒˆ * { margin: 0; padding: 0; box-sizing: border-box; } // ãƒ™ãƒ¼ã‚¹ã‚¹ã‚¿ã‚¤ãƒ« body { font-family: $font-family-base; font-size: $font-size-base; line-height: 1.6; color: $dark-color; background-color: $light-color; } // ãƒ˜ãƒƒãƒ€ãƒ¼ .header { background-color: $dark-color; padding: $spacing-unit * 2; \u0026amp;__title { color: white; font-size: $font-size-base * 1.5; } \u0026amp;__nav { margin-top: $spacing-unit; ul { list-style: none; @include flex-center; gap: $spacing-unit * 2; li a { color: $light-color; text-decoration: none; \u0026amp;:hover { color: $primary-color; } } } } } // ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ .main { padding: $spacing-unit * 4; max-width: 1200px; margin: 0 auto; @include respond-to(\u0026#39;md\u0026#39;) { padding: $spacing-unit * 2; } } // ã‚«ãƒ¼ãƒ‰ .card { background-color: white; border-radius: 8px; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); padding: $spacing-unit * 3; margin-bottom: $spacing-unit * 3; \u0026amp;__title { color: $primary-color; margin-bottom: $spacing-unit * 2; } \u0026amp;__content { color: $secondary-color; } } // ãƒœã‚¿ãƒ³ .btn { \u0026amp;--primary { @include button-style($primary-color); } \u0026amp;--secondary { @include button-style($secondary-color); } \u0026amp;--success { @include button-style($success-color); } \u0026amp;--danger { @include button-style($danger-color); } } EOF 2.6 Sassã®ã‚³ãƒ³ãƒ‘ã‚¤ãƒ« # # SCSSã‚’CSSã«ã‚³ãƒ³ãƒ‘ã‚¤ãƒ« npx sass src/scss/style.scss dist/css/style.css # ç”Ÿæˆã•ã‚ŒãŸCSSã‚’ç¢ºèª cat dist/css/style.css 2.7 ã‚¦ã‚©ãƒƒãƒãƒ¢ãƒ¼ãƒ‰ï¼ˆå¤‰æ›´ç›£è¦–ï¼‰ # # package.jsonã‚’æ›´æ–° cat \u0026lt;\u0026lt; \u0026#39;EOF\u0026#39; \u0026gt; package.json { \u0026#34;name\u0026#34;: \u0026#34;sass-study\u0026#34;, \u0026#34;version\u0026#34;: \u0026#34;1.0.0\u0026#34;, \u0026#34;scripts\u0026#34;: { \u0026#34;sass\u0026#34;: \u0026#34;sass src/scss/style.scss dist/css/style.css\u0026#34;, \u0026#34;sass:watch\u0026#34;: \u0026#34;sass --watch src/scss/style.scss:dist/css/style.css\u0026#34;, \u0026#34;sass:compressed\u0026#34;: \u0026#34;sass src/scss/style.scss dist/css/style.min.css --style=compressed\u0026#34; }, \u0026#34;devDependencies\u0026#34;: { \u0026#34;sass\u0026#34;: \u0026#34;^1.69.0\u0026#34; } } EOF # ã‚¦ã‚©ãƒƒãƒãƒ¢ãƒ¼ãƒ‰ã§èµ·å‹•ï¼ˆå¤‰æ›´ã‚’è‡ªå‹•æ¤œçŸ¥ï¼‰ npm run sass:watch Ctrl + C ã§åœæ­¢\n2.8 åœ§ç¸®ç‰ˆCSSã®ç”Ÿæˆ # # åœ§ç¸®ç‰ˆã‚’ç”Ÿæˆï¼ˆæœ¬ç•ªç”¨ï¼‰ npm run sass:compressed # åœ§ç¸®ç‰ˆã‚’ç¢ºèª cat dist/css/style.min.css 2.9 HTMLãƒ•ã‚¡ã‚¤ãƒ«ã§ç¢ºèª # # HTMLãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆ cat \u0026lt;\u0026lt; \u0026#39;EOF\u0026#39; \u0026gt; dist/index.html \u0026lt;!DOCTYPE html\u0026gt; \u0026lt;html lang=\u0026#34;ja\u0026#34;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta charset=\u0026#34;UTF-8\u0026#34;\u0026gt; \u0026lt;meta name=\u0026#34;viewport\u0026#34; content=\u0026#34;width=device-width, initial-scale=1.0\u0026#34;\u0026gt; \u0026lt;title\u0026gt;Sass Study\u0026lt;/title\u0026gt; \u0026lt;link rel=\u0026#34;stylesheet\u0026#34; href=\u0026#34;css/style.css\u0026#34;\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;header class=\u0026#34;header\u0026#34;\u0026gt; \u0026lt;h1 class=\u0026#34;header__title\u0026#34;\u0026gt;Sass Study\u0026lt;/h1\u0026gt; \u0026lt;nav class=\u0026#34;header__nav\u0026#34;\u0026gt; \u0026lt;ul\u0026gt; \u0026lt;li\u0026gt;\u0026lt;a href=\u0026#34;#\u0026#34;\u0026gt;Home\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt; \u0026lt;li\u0026gt;\u0026lt;a href=\u0026#34;#\u0026#34;\u0026gt;About\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt; \u0026lt;li\u0026gt;\u0026lt;a href=\u0026#34;#\u0026#34;\u0026gt;Contact\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt; \u0026lt;/ul\u0026gt; \u0026lt;/nav\u0026gt; \u0026lt;/header\u0026gt; \u0026lt;main class=\u0026#34;main\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;card\u0026#34;\u0026gt; \u0026lt;h2 class=\u0026#34;card__title\u0026#34;\u0026gt;Sassã®ç‰¹å¾´\u0026lt;/h2\u0026gt; \u0026lt;p class=\u0026#34;card__content\u0026#34;\u0026gt; ãƒã‚¹ãƒˆã€å¤‰æ•°ã€ãƒŸãƒƒã‚¯ã‚¹ã‚¤ãƒ³ãªã©ã®æ©Ÿèƒ½ã§CSSã®é–‹ç™ºåŠ¹ç‡ãŒå‘ä¸Šã—ã¾ã™ã€‚ \u0026lt;/p\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;card\u0026#34;\u0026gt; \u0026lt;h2 class=\u0026#34;card__title\u0026#34;\u0026gt;ãƒœã‚¿ãƒ³ã‚µãƒ³ãƒ—ãƒ«\u0026lt;/h2\u0026gt; \u0026lt;div class=\u0026#34;card__content\u0026#34;\u0026gt; \u0026lt;button class=\u0026#34;btn btn--primary\u0026#34;\u0026gt;Primary\u0026lt;/button\u0026gt; \u0026lt;button class=\u0026#34;btn btn--secondary\u0026#34;\u0026gt;Secondary\u0026lt;/button\u0026gt; \u0026lt;button class=\u0026#34;btn btn--success\u0026#34;\u0026gt;Success\u0026lt;/button\u0026gt; \u0026lt;button class=\u0026#34;btn btn--danger\u0026#34;\u0026gt;Danger\u0026lt;/button\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/main\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; EOF 2.10 ã‚³ãƒ³ãƒ†ãƒŠçµ‚äº† # exit âœ… ã“ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§å­¦ã‚“ã ã“ã¨ # Sassã¯CSSã‚’æ‹¡å¼µã—ãŸãƒ¡ã‚¿è¨€èªï¼ˆãƒã‚¹ãƒˆã€å¤‰æ•°ã€ãƒŸãƒƒã‚¯ã‚¹ã‚¤ãƒ³ãªã©ï¼‰ SCSSè¨˜æ³•ï¼ˆ.scssï¼‰ãŒç¾åœ¨ã®ä¸»æµ npx sass \u0026lt;input\u0026gt; \u0026lt;output\u0026gt;ã§ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã€--watchã§å¤‰æ›´ç›£è¦– --style=compressedã§æœ¬ç•ªç”¨ã®åœ§ç¸®ç‰ˆCSSã‚’ç”Ÿæˆ Section 3: nvm / nodenvï¼ˆNode.jsãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†ï¼‰ # ğŸ’¡ Dockerç’°å¢ƒã§ã¯ä¸è¦ï¼šã“ã®ã‚·ãƒªãƒ¼ã‚ºã§å­¦ã‚“ã§ã„ã‚‹Dockerç’°å¢ƒã§ã¯ã€node:18ã€node:20ãªã©ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’å¤‰ãˆã‚‹ã ã‘ã§ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’åˆ‡ã‚Šæ›¿ãˆã‚‰ã‚Œã‚‹ãŸã‚ã€nvm/nodenvã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã¯ä¸è¦ã§ã™ã€‚ã“ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã¯ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã‚’æ§‹ç¯‰ã™ã‚‹å ´åˆã®å‚è€ƒæƒ…å ±ã¨ã—ã¦è¨˜è¼‰ã—ã¦ã„ã¾ã™ã€‚\n3.1 ãªãœãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†ãŒå¿…è¦ï¼Ÿ # çŠ¶æ³ å•é¡Œ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆAã¯Node.js 18ãŒå¿…è¦ ã‚°ãƒ­ãƒ¼ãƒãƒ«ã®Node.jsã¯1ã¤ã ã‘ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆBã¯Node.js 20ãŒå¿…è¦ åˆ‡ã‚Šæ›¿ãˆãŒæ‰‹å‹•ã§é¢å€’ å¤ã„ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ å¤ã„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒå¿…è¦ è§£æ±ºç­–ï¼šãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†ãƒ„ãƒ¼ãƒ« # ãƒ„ãƒ¼ãƒ« ç‰¹å¾´ nvm æœ€ã‚‚æ™®åŠã€ã‚·ã‚§ãƒ«ã‚¹ã‚¯ãƒªãƒ—ãƒˆãƒ™ãƒ¼ã‚¹ nodenv rbenvç³»ã€.node-versionãƒ•ã‚¡ã‚¤ãƒ« volta Rustãƒ™ãƒ¼ã‚¹ã€é«˜é€Ÿ fnm Rustãƒ™ãƒ¼ã‚¹ã€ã‚¯ãƒ­ã‚¹ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ  3.2 Dockerç’°å¢ƒã§ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç† # Dockerã§ã¯ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’å¤‰ãˆã‚‹ã ã‘ã§Node.jsãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’åˆ‡ã‚Šæ›¿ãˆã‚‰ã‚Œã¾ã™ã€‚\n# Node.js 18 docker run -it --rm node:18 node -v # å‡ºåŠ›: v18.x.x # Node.js 20 docker run -it --rm node:20 node -v # å‡ºåŠ›: v20.x.x # Node.js 22 docker run -it --rm node:22 node -v # å‡ºåŠ›: v22.x.x ãƒ¡ãƒªãƒƒãƒˆï¼šnvm/nodenvã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹å¿…è¦ãŒãªã„\n3.3 ãƒãƒ³ã‚ºã‚ªãƒ³ï¼šnvmï¼ˆãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒå‘ã‘ï¼‰ # æ³¨æ„ï¼šä»¥ä¸‹ã¯ãƒ­ãƒ¼ã‚«ãƒ«ãƒã‚·ãƒ³ï¼ˆMac/Linuxï¼‰ã§ã®æ‰‹é †ã§ã™ã€‚Dockerå†…ã§ã¯é€šå¸¸ä¸è¦ã§ã™ã€‚\nnvmã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« # æ³¨æ„ï¼šä»¥ä¸‹ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ï¼ˆv0.40.1ï¼‰ã¯åŸ·ç­†æ™‚ç‚¹ã®ã‚‚ã®ã§ã™ã€‚æœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã¯nvmå…¬å¼ãƒªãƒã‚¸ãƒˆãƒªã§ç¢ºèªã—ã¦ãã ã•ã„ã€‚\n# nvmã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ï¼ˆæœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã¯å…¬å¼ãƒªãƒã‚¸ãƒˆãƒªã‚’ç¢ºèªï¼‰ curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.40.1/install.sh | bash # ã‚·ã‚§ãƒ«è¨­å®šã‚’å†èª­ã¿è¾¼ã¿ source ~/.bashrc # ã¾ãŸã¯ ~/.zshrc # ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ç¢ºèª nvm --version Node.jsãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®ç®¡ç† # # ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å¯èƒ½ãªãƒãƒ¼ã‚¸ãƒ§ãƒ³ä¸€è¦§ nvm ls-remote # LTSç‰ˆã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« nvm install --lts # ç‰¹å®šãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« nvm install 18.19.0 nvm install 20.10.0 # ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ¸ˆã¿ãƒãƒ¼ã‚¸ãƒ§ãƒ³ä¸€è¦§ nvm ls # ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’åˆ‡ã‚Šæ›¿ãˆï¼ˆç¾åœ¨ã®ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã®ã¿ï¼‰ nvm use 18.19.0 # ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’è¨­å®šï¼ˆæ°¸ç¶šåŒ–ï¼‰ nvm alias default 20.10.0 .nvmrcãƒ•ã‚¡ã‚¤ãƒ« # # ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’å›ºå®š echo \u0026#34;20.10.0\u0026#34; \u0026gt; .nvmrc # .nvmrcã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ä½¿ç”¨ nvm use 3.4 ãƒãƒ³ã‚ºã‚ªãƒ³ï¼šnodenvï¼ˆãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒå‘ã‘ï¼‰ # nodenvã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« # # nodenvã‚’ã‚¯ãƒ­ãƒ¼ãƒ³ git clone https://github.com/nodenv/nodenv.git ~/.nodenv # node-buildãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« git clone https://github.com/nodenv/node-build.git ~/.nodenv/plugins/node-build # ãƒ‘ã‚¹ã‚’é€šã™ï¼ˆ~/.bashrcã¾ãŸã¯~/.zshrcã«è¿½åŠ ï¼‰ echo \u0026#39;export PATH=\u0026#34;$HOME/.nodenv/bin:$PATH\u0026#34;\u0026#39; \u0026gt;\u0026gt; ~/.bashrc echo \u0026#39;eval \u0026#34;$(nodenv init -)\u0026#34;\u0026#39; \u0026gt;\u0026gt; ~/.bashrc # å†èª­ã¿è¾¼ã¿ source ~/.bashrc # ç¢ºèª nodenv --version Node.jsãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®ç®¡ç† # # ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å¯èƒ½ãªãƒãƒ¼ã‚¸ãƒ§ãƒ³ä¸€è¦§ nodenv install -l # ç‰¹å®šãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« nodenv install 20.10.0 # ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’è¨­å®š nodenv global 20.10.0 # ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã”ã¨ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³è¨­å®šï¼ˆ.node-versionãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆï¼‰ nodenv local 18.19.0 # ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ¸ˆã¿ãƒãƒ¼ã‚¸ãƒ§ãƒ³ä¸€è¦§ nodenv versions # ç¾åœ¨ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç¢ºèª nodenv version node -v 3.5 nvmã¨nodenvã®æ¯”è¼ƒ # é …ç›® nvm nodenv è¨­å®šãƒ•ã‚¡ã‚¤ãƒ« .nvmrc .node-version åˆ‡ã‚Šæ›¿ãˆæ–¹æ³• nvm use è‡ªå‹•ï¼ˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªç§»å‹•æ™‚ï¼‰ ã‚·ã‚§ãƒ«çµ±åˆ æ‰‹å‹•ã§nvm useãŒå¿…è¦ è‡ªå‹•åˆ‡ã‚Šæ›¿ãˆ ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ  Mac/Linuxï¼ˆWindowsã¯nvm-windowsï¼‰ Mac/Linux 3.6 Dockerç’°å¢ƒã§ã®å®Ÿè·µä¾‹ # # ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã”ã¨ã«ç•°ãªã‚‹Node.jsãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ä½¿ç”¨ # ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆAï¼ˆNode.js 18ï¼‰ cd project-a docker run -it --rm -v $(pwd):/work -w /work node:18 bash # ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆBï¼ˆNode.js 20ï¼‰ cd project-b docker run -it --rm -v $(pwd):/work -w /work node:20 bash # ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆCï¼ˆNode.js 22ï¼‰ cd project-c docker run -it --rm -v $(pwd):/work -w /work node:22 bash 3.7 docker-compose.ymlã§ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³æŒ‡å®š # # ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆã«docker-compose.ymlã‚’ä½œæˆ cat \u0026lt;\u0026lt; \u0026#39;EOF\u0026#39; \u0026gt; docker-compose.yml services: app: image: node:20 # ã“ã“ã§ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’æŒ‡å®š volumes: - .:/work working_dir: /work command: bash tty: true stdin_open: true ports: - \u0026#34;3000:3000\u0026#34; EOF # èµ·å‹• docker compose up -d # ã‚³ãƒ³ãƒ†ãƒŠã«å…¥ã‚‹ docker compose exec app bash # çµ‚äº† docker compose down âœ… ã“ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§å­¦ã‚“ã ã“ã¨ # nvm/nodenvã¯ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã§Node.jsãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ç®¡ç†ã™ã‚‹ãƒ„ãƒ¼ãƒ« Dockerç’°å¢ƒã§ã¯ã‚¤ãƒ¡ãƒ¼ã‚¸æŒ‡å®šï¼ˆnode:18ã€node:20ãªã©ï¼‰ã§ä»£æ›¿å¯èƒ½ .nvmrcã‚„.node-versionã§ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã”ã¨ã«ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’å›ºå®š docker-compose.ymlã§ãƒãƒ¼ãƒ å…¨ä½“ã®Node.jsãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’çµ±ä¸€ã§ãã‚‹ ã¾ã¨ã‚ # ğŸ¯ å­¦ã‚“ã ã“ã¨ # yarn # ã‚³ãƒãƒ³ãƒ‰ ç”¨é€” yarn init -y ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåˆæœŸåŒ– yarn add \u0026lt;pkg\u0026gt; ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸è¿½åŠ  yarn add --dev \u0026lt;pkg\u0026gt; é–‹ç™ºç”¨ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸è¿½åŠ  yarn remove \u0026lt;pkg\u0026gt; ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸å‰Šé™¤ yarn ä¾å­˜é–¢ä¿‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« yarn \u0026lt;script\u0026gt; ã‚¹ã‚¯ãƒªãƒ—ãƒˆå®Ÿè¡Œ Sass # ã‚³ãƒãƒ³ãƒ‰ ç”¨é€” npx sass \u0026lt;input\u0026gt; \u0026lt;output\u0026gt; ã‚³ãƒ³ãƒ‘ã‚¤ãƒ« npx sass --watch \u0026lt;input\u0026gt;:\u0026lt;output\u0026gt; ç›£è¦–ãƒ¢ãƒ¼ãƒ‰ npx sass \u0026lt;input\u0026gt; \u0026lt;output\u0026gt; --style=compressed åœ§ç¸®ç‰ˆç”Ÿæˆ nvm/nodenvï¼ˆãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒï¼‰ # ã‚³ãƒãƒ³ãƒ‰ (nvm) ã‚³ãƒãƒ³ãƒ‰ (nodenv) ç”¨é€” nvm install \u0026lt;ver\u0026gt; nodenv install \u0026lt;ver\u0026gt; ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« nvm use \u0026lt;ver\u0026gt; nodenv local \u0026lt;ver\u0026gt; ãƒãƒ¼ã‚¸ãƒ§ãƒ³åˆ‡ã‚Šæ›¿ãˆ nvm alias default \u0026lt;ver\u0026gt; nodenv global \u0026lt;ver\u0026gt; ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆè¨­å®š nvm ls nodenv versions ä¸€è¦§è¡¨ç¤º Dockerï¼ˆæ¨å¥¨ï¼‰ # æ–¹æ³• ç”¨é€” docker run node:18 Node.js 18ã‚’ä½¿ç”¨ docker run node:20 Node.js 20ã‚’ä½¿ç”¨ docker-compose.ymlã§imageæŒ‡å®š ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆè¨­å®šã¨ã—ã¦ç®¡ç† ğŸ“š ã‚·ãƒªãƒ¼ã‚ºå…¨ä½“ã®æŒ¯ã‚Šè¿”ã‚Š # Part å†…å®¹ Part 1 Dockerç’°å¢ƒæ§‹ç¯‰ã€Node.js/npmåŸºç¤ Part 2 Babelã€Webpackã€Viteï¼ˆãƒ“ãƒ«ãƒ‰ãƒ„ãƒ¼ãƒ«ï¼‰ Part 3 ESLintã€Prettierï¼ˆã‚³ãƒ¼ãƒ‰å“è³ªï¼‰ Part 4 yarnã€Sassã€nvm/nodenvï¼ˆãã®ä»–ãƒ„ãƒ¼ãƒ«ï¼‰ ğŸ—‘ï¸ ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ— # # ã™ã¹ã¦ã®å­¦ç¿’ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’å‰Šé™¤ rm -rf yarn-study sass-study å‚è€ƒè³‡æ–™ # yarnå…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ Sasså…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ nvmå…¬å¼ãƒªãƒã‚¸ãƒˆãƒª nodenvå…¬å¼ãƒªãƒã‚¸ãƒˆãƒª ","date":"2025å¹´ 11æœˆ 30æ—¥","externalUrl":null,"permalink":"/posts/251130070710_docker-environment-nodejs-miscellaneous-tools/","section":"Posts","summary":"","title":"Dockerç’°å¢ƒã§Node.jsã‚’å­¦ã¼ã†_Part4_ãã®ä»–ãƒ„ãƒ¼ãƒ«ç·¨","type":"posts"},{"content":"","date":"2025å¹´ 11æœˆ 30æ—¥","externalUrl":null,"permalink":"/tags/sass/","section":"Tags","summary":"","title":"Sass","type":"tags"},{"content":"","date":"2025å¹´ 11æœˆ 30æ—¥","externalUrl":null,"permalink":"/series/","section":"Series","summary":"","title":"Series","type":"series"},{"content":"","date":"2025å¹´ 11æœˆ 30æ—¥","externalUrl":null,"permalink":"/tags/yarn/","section":"Tags","summary":"","title":"Yarn","type":"tags"},{"content":" ã¯ã˜ã‚ã« # ğŸ¯ ã“ã®ãƒ¡ãƒ¢ã§ç†è§£ã™ã¹ã3ã¤ã®è¦ç‚¹ # ESLintï¼šé™çš„ã‚³ãƒ¼ãƒ‰è§£æãƒ„ãƒ¼ãƒ«\nã‚³ãƒ¼ãƒ‰ã®å•é¡Œç‚¹ï¼ˆãƒã‚°ã®å¯èƒ½æ€§ã€éæ¨å¥¨ã®æ›¸ãæ–¹ï¼‰ã‚’æ¤œå‡º ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå…¨ä½“ã§ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ãƒ«ãƒ¼ãƒ«ã‚’çµ±ä¸€ Prettierï¼šã‚³ãƒ¼ãƒ‰ãƒ•ã‚©ãƒ¼ãƒãƒƒã‚¿ãƒ¼\nã‚³ãƒ¼ãƒ‰ã®è¦‹ãŸç›®ï¼ˆã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆã€æ”¹è¡Œã€å¼•ç”¨ç¬¦ãªã©ï¼‰ã‚’è‡ªå‹•æ•´å½¢ ãƒãƒ¼ãƒ å†…ã§ã‚³ãƒ¼ãƒ‰ã‚¹ã‚¿ã‚¤ãƒ«ã‚’çµ±ä¸€ ESLintã¨Prettierã®é•ã„ã¨ä½µç”¨\nESLint = å“è³ªãƒ»ãƒã‚°æ¤œå‡º Prettier = è¦‹ãŸç›®ã®æ•´å½¢ ä¸¡è€…ã¯ç«¶åˆã™ã‚‹éƒ¨åˆ†ãŒã‚ã‚‹ãŸã‚ã€è¨­å®šã§èª¿æ•´ãŒå¿…è¦ âš ï¸ ã‚ˆãã‚ã‚‹åˆå¿ƒè€…ã®é–“é•ã„ # âŒ ESLintã¨Prettierã®å½¹å‰²ã‚’æ··åŒã—ã¦ã„ã‚‹ âŒ ä¸¡æ–¹ã‚’å…¥ã‚ŒãŸã‚‰è¨­å®šãŒç«¶åˆã—ã¦ã‚¨ãƒ©ãƒ¼ã«ãªã‚‹ âŒ ãƒ«ãƒ¼ãƒ«ãŒå³ã—ã™ãã¦é–‹ç™ºåŠ¹ç‡ãŒè½ã¡ã‚‹ ğŸ”„ ESLintã¨Prettierã®é–¢ä¿‚ # ã€ã‚³ãƒ¼ãƒ‰å“è³ªã®2ã¤ã®å´é¢ã€‘ ESLintï¼ˆé™çš„è§£æï¼‰ â”œâ”€â”€ ãƒã‚°ã®å¯èƒ½æ€§ã‚’æ¤œå‡º â”œâ”€â”€ æœªä½¿ç”¨å¤‰æ•°ã®è­¦å‘Š â”œâ”€â”€ å±é™ºãªãƒ‘ã‚¿ãƒ¼ãƒ³ã®æ¤œå‡º â””â”€â”€ ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¦ç´„ã®å¼·åˆ¶ Prettierï¼ˆãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆï¼‰ â”œâ”€â”€ ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆã®çµ±ä¸€ â”œâ”€â”€ å¼•ç”¨ç¬¦ã®çµ±ä¸€ï¼ˆã‚·ãƒ³ã‚°ãƒ«/ãƒ€ãƒ–ãƒ«ï¼‰ â”œâ”€â”€ æ”¹è¡Œä½ç½®ã®èª¿æ•´ â””â”€â”€ è¡Œæœ«ã®ã‚»ãƒŸã‚³ãƒ­ãƒ³ å‰ææ¡ä»¶ # Part 1 ã‚’å®Œäº†ã—ã¦ã„ã‚‹ã“ã¨ï¼ˆDockeråŸºç¤ã€Node.js/npmåŸºç¤ï¼‰ Docker DesktopãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ã“ã¨ Section 1: ESLintï¼ˆé™çš„ã‚³ãƒ¼ãƒ‰è§£æï¼‰ # 1.1 ESLintã¨ã¯ï¼Ÿ # ESLintã¯ã€JavaScriptã®é™çš„ã‚³ãƒ¼ãƒ‰è§£æãƒ„ãƒ¼ãƒ«ã§ã™ã€‚\nESLintãŒã§ãã‚‹ã“ã¨ # æ©Ÿèƒ½ èª¬æ˜ ä¾‹ ã‚¨ãƒ©ãƒ¼æ¤œå‡º ãƒã‚°ã«ãªã‚Šãã†ãªã‚³ãƒ¼ãƒ‰ã‚’æ¤œå‡º æœªå®šç¾©å¤‰æ•°ã®ä½¿ç”¨ è­¦å‘Šè¡¨ç¤º éæ¨å¥¨ã®æ›¸ãæ–¹ã‚’æŒ‡æ‘˜ varã®ä½¿ç”¨ ã‚¹ã‚¿ã‚¤ãƒ«çµ±ä¸€ ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ãƒ«ãƒ¼ãƒ«ã®å¼·åˆ¶ ã‚»ãƒŸã‚³ãƒ­ãƒ³ã®æœ‰ç„¡ è‡ªå‹•ä¿®æ­£ ä¸€éƒ¨ã®å•é¡Œã‚’è‡ªå‹•ã§ä¿®æ­£ --fixã‚ªãƒ—ã‚·ãƒ§ãƒ³ æ¤œå‡ºã§ãã‚‹å•é¡Œã®ä¾‹ # // âŒ æœªä½¿ç”¨ã®å¤‰æ•° const unusedVar = \u0026#39;not used\u0026#39;; // âŒ æœªå®šç¾©ã®å¤‰æ•°ã‚’ä½¿ç”¨ console.log(undefinedVar); // âŒ æ¯”è¼ƒæ¼”ç®—å­ã®é–“é•ã„ if (value = 10) { } // ä»£å…¥ã«ãªã£ã¦ã„ã‚‹ // âŒ åˆ°é”ä¸èƒ½ã‚³ãƒ¼ãƒ‰ function test() { return; console.log(\u0026#39;never executed\u0026#39;); } 1.2 ãƒãƒ³ã‚ºã‚ªãƒ³ï¼šESLintç’°å¢ƒæ§‹ç¯‰ # å­¦ç¿’ç”¨ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ä½œæˆ # # ãƒ­ãƒ¼ã‚«ãƒ«ã§ä½œæ¥­ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä½œæˆ mkdir eslint-study \u0026amp;\u0026amp; cd eslint-study # Dockerã‚³ãƒ³ãƒ†ãƒŠã‚’èµ·å‹• docker run -it --rm -v $(pwd):/work -w /work node:20 bash ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåˆæœŸåŒ–ã¨ESLintã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« # # ã‚³ãƒ³ãƒ†ãƒŠå†…ã§å®Ÿè¡Œ npm init -y # ESLintã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« npm install --save-dev eslint 1.3 ESLintã®åˆæœŸè¨­å®š # # å¯¾è©±å½¢å¼ã§è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆ npm init @eslint/config æ³¨æ„ï¼šESLint v9ã‹ã‚‰ã¯ã€ŒFlat Configã€ãŒãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã«ãªã‚Šã€è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«å½¢å¼ãŒeslint.config.mjsã«å¤‰ã‚ã‚Šã¾ã—ãŸã€‚ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«ã‚ˆã£ã¦å¯¾è©±å½¢å¼ã®é¸æŠè‚¢ã‚„ç”Ÿæˆã•ã‚Œã‚‹è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ãŒç•°ãªã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚ä»¥ä¸‹ã¯ESLint v9ã§ã®ä¾‹ã§ã™ã€‚\nå¯¾è©±å½¢å¼ã§ã®é¸æŠï¼ˆæ¨å¥¨è¨­å®šï¼‰ # ? How would you like to use ESLint? â†’ To check syntax and find problems ? What type of modules does your project use? â†’ JavaScript modules (import/export) ? Which framework does your project use? â†’ None of these ? Does your project use TypeScript? â†’ No ? Where does your code run? â†’ Nodeï¼ˆã‚¹ãƒšãƒ¼ã‚¹ã‚­ãƒ¼ã§é¸æŠã€Enterã§ç¢ºå®šï¼‰ ? What format do you want your config file to be in? â†’ JavaScript ç”Ÿæˆã•ã‚Œã‚‹è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆeslint.config.mjsï¼‰ # import globals from \u0026#34;globals\u0026#34;; import pluginJs from \u0026#34;@eslint/js\u0026#34;; export default [ { languageOptions: { globals: globals.node } }, pluginJs.configs.recommended, ]; 1.4 ESLintã‚’è©¦ã—ã¦ã¿ã‚‹ # å•é¡Œã®ã‚ã‚‹ã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆ # # å•é¡Œã®ã‚ã‚‹ã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆ cat \u0026lt;\u0026lt; \u0026#39;EOF\u0026#39; \u0026gt; sample.js // å•é¡Œã®ã‚ã‚‹ã‚³ãƒ¼ãƒ‰ä¾‹ // 1. æœªä½¿ç”¨ã®å¤‰æ•° const unusedVariable = \u0026#39;I am not used\u0026#39;; // 2. varã®ä½¿ç”¨ï¼ˆletã‚„constãŒæ¨å¥¨ï¼‰ var oldStyle = \u0026#39;using var\u0026#39;; // 3. ã‚»ãƒŸã‚³ãƒ­ãƒ³ãªã—ï¼ˆè¨­å®šã«ã‚ˆã£ã¦ã¯ã‚¨ãƒ©ãƒ¼ï¼‰ const noSemicolon = \u0026#39;no semicolon\u0026#39; // 4. console.logã®ä½¿ç”¨ï¼ˆæœ¬ç•ªã§ã¯éæ¨å¥¨ã®å ´åˆã‚‚ï¼‰ console.log(\u0026#39;Hello, ESLint!\u0026#39;); // 5. æœªå®šç¾©å¤‰æ•°ã®ä½¿ç”¨ console.log(undefinedVar); // 6. é–¢æ•° function greet(name) { return \u0026#39;Hello, \u0026#39; + name; } // 7. é–¢æ•°ã‚’å‘¼ã³å‡ºã— const result = greet(\u0026#39;World\u0026#39;); console.log(result); EOF ESLintã‚’å®Ÿè¡Œ # # ESLintã§ãƒã‚§ãƒƒã‚¯ npx eslint sample.js æœŸå¾…ã•ã‚Œã‚‹å‡ºåŠ›ï¼ˆã‚¨ãƒ©ãƒ¼ãƒ»è­¦å‘Šï¼‰ # /work/sample.js 5:7 error \u0026#39;unusedVariable\u0026#39; is assigned a value but never used no-unused-vars 8:1 error Unexpected var, use let or const instead no-var 17:13 error \u0026#39;undefinedVar\u0026#39; is not defined no-undef âœ– 3 problems (3 errors, 0 warnings) 1 error and 0 warnings potentially fixable with the `--fix` option. 1.5 è‡ªå‹•ä¿®æ­£ã‚’è©¦ã™ # # è‡ªå‹•ä¿®æ­£å¯èƒ½ãªå•é¡Œã‚’ä¿®æ­£ npx eslint sample.js --fix # ä¿®æ­£å¾Œã®ã‚³ãƒ¼ãƒ‰ã‚’ç¢ºèª cat sample.js æ³¨æ„ï¼šã™ã¹ã¦ã®å•é¡ŒãŒè‡ªå‹•ä¿®æ­£ã•ã‚Œã‚‹ã‚ã‘ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚\n1.6 ESLintãƒ«ãƒ¼ãƒ«ã®ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º # # è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ›´æ–° cat \u0026lt;\u0026lt; \u0026#39;EOF\u0026#39; \u0026gt; eslint.config.mjs import globals from \u0026#34;globals\u0026#34;; import pluginJs from \u0026#34;@eslint/js\u0026#34;; export default [ { languageOptions: { globals: globals.node } }, pluginJs.configs.recommended, { rules: { // æœªä½¿ç”¨å¤‰æ•°ã‚’è­¦å‘Šã«å¤‰æ›´ï¼ˆã‚¨ãƒ©ãƒ¼â†’è­¦å‘Šï¼‰ \u0026#34;no-unused-vars\u0026#34;: \u0026#34;warn\u0026#34;, // console.logã‚’è¨±å¯ \u0026#34;no-console\u0026#34;: \u0026#34;off\u0026#34;, // varã‚’ç¦æ­¢ã—ã¦let/constã‚’å¼·åˆ¶ \u0026#34;no-var\u0026#34;: \u0026#34;error\u0026#34;, // ã‚»ãƒŸã‚³ãƒ­ãƒ³ã‚’å¿…é ˆã« \u0026#34;semi\u0026#34;: [\u0026#34;error\u0026#34;, \u0026#34;always\u0026#34;], // ã‚·ãƒ³ã‚°ãƒ«ã‚¯ã‚©ãƒ¼ãƒˆã‚’å¼·åˆ¶ \u0026#34;quotes\u0026#34;: [\u0026#34;error\u0026#34;, \u0026#34;single\u0026#34;] } } ]; EOF # å†åº¦ãƒã‚§ãƒƒã‚¯ npx eslint sample.js ãƒ«ãƒ¼ãƒ«ã®è¨­å®šå€¤ # å€¤ æ„å‘³ \u0026quot;off\u0026quot; ã¾ãŸã¯ 0 ãƒ«ãƒ¼ãƒ«ã‚’ç„¡åŠ¹åŒ– \u0026quot;warn\u0026quot; ã¾ãŸã¯ 1 è­¦å‘Šã¨ã—ã¦è¡¨ç¤º \u0026quot;error\u0026quot; ã¾ãŸã¯ 2 ã‚¨ãƒ©ãƒ¼ã¨ã—ã¦è¡¨ç¤º 1.7 package.jsonã«ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’è¿½åŠ  # # package.jsonã‚’æ›´æ–° cat \u0026lt;\u0026lt; \u0026#39;EOF\u0026#39; \u0026gt; package.json { \u0026#34;name\u0026#34;: \u0026#34;eslint-study\u0026#34;, \u0026#34;version\u0026#34;: \u0026#34;1.0.0\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;module\u0026#34;, \u0026#34;scripts\u0026#34;: { \u0026#34;lint\u0026#34;: \u0026#34;eslint .\u0026#34;, \u0026#34;lint:fix\u0026#34;: \u0026#34;eslint . --fix\u0026#34; }, \u0026#34;devDependencies\u0026#34;: { \u0026#34;@eslint/js\u0026#34;: \u0026#34;^9.0.0\u0026#34;, \u0026#34;eslint\u0026#34;: \u0026#34;^9.0.0\u0026#34;, \u0026#34;globals\u0026#34;: \u0026#34;^15.0.0\u0026#34; } } EOF # ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§å®Ÿè¡Œ npm run lint 1.8 ç‰¹å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’é™¤å¤– # # .eslintignoreãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆï¼ˆã¾ãŸã¯è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã§æŒ‡å®šï¼‰ cat \u0026lt;\u0026lt; \u0026#39;EOF\u0026#39; \u0026gt; .eslintignore node_modules/ dist/ build/ *.min.js EOF 1.9 ã‚³ãƒ³ãƒ†ãƒŠçµ‚äº† # exit âœ… ã“ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§å­¦ã‚“ã ã“ã¨ # ESLintã¯ã‚³ãƒ¼ãƒ‰ã®å•é¡Œç‚¹ï¼ˆãƒã‚°ã®å¯èƒ½æ€§ã€éæ¨å¥¨ã®æ›¸ãæ–¹ï¼‰ã‚’æ¤œå‡ºã™ã‚‹é™çš„è§£æãƒ„ãƒ¼ãƒ« ãƒ«ãƒ¼ãƒ«ã¯\u0026quot;off\u0026quot;/\u0026quot;warn\u0026quot;/\u0026quot;error\u0026quot;ã§åˆ¶å¾¡å¯èƒ½ --fixã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§è‡ªå‹•ä¿®æ­£å¯èƒ½ãªå•é¡Œã‚’ä¿®æ­£ã§ãã‚‹ .eslintignoreã§é™¤å¤–ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æŒ‡å®š Section 2: Prettierï¼ˆã‚³ãƒ¼ãƒ‰ãƒ•ã‚©ãƒ¼ãƒãƒƒã‚¿ãƒ¼ï¼‰ # 2.1 Prettierã¨ã¯ï¼Ÿ # Prettierã¯ã€ã‚³ãƒ¼ãƒ‰ã‚’è‡ªå‹•æ•´å½¢ã™ã‚‹ãƒ•ã‚©ãƒ¼ãƒãƒƒã‚¿ãƒ¼ã§ã™ã€‚\nESLintã¨Prettierã®é•ã„ # è¦³ç‚¹ ESLint Prettier ä¸»ãªç›®çš„ ã‚³ãƒ¼ãƒ‰å“è³ªãƒ»ãƒã‚°æ¤œå‡º ã‚³ãƒ¼ãƒ‰ã‚¹ã‚¿ã‚¤ãƒ«çµ±ä¸€ å¯¾è±¡ ä¸»ã«JavaScript/TypeScript JS, CSS, HTML, JSON, Markdownãªã© è¨­å®š ç´°ã‹ã„ãƒ«ãƒ¼ãƒ«è¨­å®šãŒå¯èƒ½ è¨­å®šé …ç›®ã¯å°‘ãªã„ï¼ˆæ„è¦‹ä»˜ããƒ„ãƒ¼ãƒ«ï¼‰ å“²å­¦ æŸ”è»Ÿæ€§é‡è¦– è­°è«–ã‚’æ¸›ã‚‰ã™ï¼ˆopinionatedï¼‰ PrettierãŒæ•´å½¢ã™ã‚‹å†…å®¹ # // æ•´å½¢å‰ï¼ˆãƒãƒ©ãƒãƒ©ãªã‚¹ã‚¿ã‚¤ãƒ«ï¼‰ const foo={a:1,b:2,c:3}; function bar( x,y ){return x+y} const arr = [1,2,3,4,5] // æ•´å½¢å¾Œï¼ˆçµ±ä¸€ã•ã‚ŒãŸã‚¹ã‚¿ã‚¤ãƒ«ï¼‰ const foo = { a: 1, b: 2, c: 3 }; function bar(x, y) { return x + y; } const arr = [1, 2, 3, 4, 5]; 2.2 ãƒãƒ³ã‚ºã‚ªãƒ³ï¼šPrettierç’°å¢ƒæ§‹ç¯‰ # å­¦ç¿’ç”¨ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ä½œæˆ # # ãƒ­ãƒ¼ã‚«ãƒ«ã§ä½œæ¥­ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä½œæˆ mkdir prettier-study \u0026amp;\u0026amp; cd prettier-study # Dockerã‚³ãƒ³ãƒ†ãƒŠã‚’èµ·å‹• docker run -it --rm -v $(pwd):/work -w /work node:20 bash ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåˆæœŸåŒ–ã¨Prettierã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« # # ã‚³ãƒ³ãƒ†ãƒŠå†…ã§å®Ÿè¡Œ npm init -y # Prettierã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ï¼ˆãƒãƒ¼ã‚¸ãƒ§ãƒ³å›ºå®šæ¨å¥¨ï¼‰ npm install --save-dev --save-exact prettier --save-exactã®ç†ç”±ï¼šPrettierã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒå¤‰ã‚ã‚‹ã¨æ•´å½¢çµæœãŒå¤‰ã‚ã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ãŸã‚ã€ãƒãƒ¼ãƒ å†…ã§ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’å›ºå®šã—ã¾ã™ã€‚\n2.3 Prettierã‚’è©¦ã—ã¦ã¿ã‚‹ # æ•´å½¢å‰ã®ã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆ # # æ•´å½¢å‰ã®ã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆ cat \u0026lt;\u0026lt; \u0026#39;EOF\u0026#39; \u0026gt; sample.js // æ•´å½¢å‰ã®ã‚³ãƒ¼ãƒ‰ï¼ˆã‚ã–ã¨æ±šãæ›¸ãï¼‰ const user={name:\u0026#34;Alice\u0026#34;,age:25,email:\u0026#34;alice@example.com\u0026#34;}; function greet(name){console.log(\u0026#34;Hello, \u0026#34;+name+\u0026#34;!\u0026#34;);} const numbers=[1,2,3,4,5]; const doubled=numbers.map(n=\u0026gt;n*2); if(user.age\u0026gt;=18){console.log(\u0026#34;Adult\u0026#34;)}else{console.log(\u0026#34;Minor\u0026#34;)} EOF # å†…å®¹ç¢ºèª cat sample.js Prettierã§ãƒã‚§ãƒƒã‚¯ï¼ˆæ•´å½¢ã›ãšã«ç¢ºèªï¼‰ # # æ•´å½¢ãŒå¿…è¦ã‹ãƒã‚§ãƒƒã‚¯ npx prettier --check sample.js æœŸå¾…ã•ã‚Œã‚‹å‡ºåŠ› # Checking formatting... [warn] sample.js [warn] Code style issues found in the above file. Run Prettier with --write to fix. Prettierã§æ•´å½¢ # # æ•´å½¢ã‚’å®Ÿè¡Œ npx prettier --write sample.js # æ•´å½¢å¾Œã®ã‚³ãƒ¼ãƒ‰ã‚’ç¢ºèª cat sample.js æœŸå¾…ã•ã‚Œã‚‹å‡ºåŠ›ï¼ˆæ•´å½¢å¾Œï¼‰ # // æ•´å½¢å‰ã®ã‚³ãƒ¼ãƒ‰ï¼ˆã‚ã–ã¨æ±šãæ›¸ãï¼‰ const user = { name: \u0026#34;Alice\u0026#34;, age: 25, email: \u0026#34;alice@example.com\u0026#34; }; function greet(name) { console.log(\u0026#34;Hello, \u0026#34; + name + \u0026#34;!\u0026#34;); } const numbers = [1, 2, 3, 4, 5]; const doubled = numbers.map((n) =\u0026gt; n * 2); if (user.age \u0026gt;= 18) { console.log(\u0026#34;Adult\u0026#34;); } else { console.log(\u0026#34;Minor\u0026#34;); } 2.4 Prettierè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®ä½œæˆ # # .prettierrcãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆ cat \u0026lt;\u0026lt; \u0026#39;EOF\u0026#39; \u0026gt; .prettierrc { \u0026#34;semi\u0026#34;: true, \u0026#34;singleQuote\u0026#34;: true, \u0026#34;tabWidth\u0026#34;: 2, \u0026#34;trailingComma\u0026#34;: \u0026#34;es5\u0026#34;, \u0026#34;printWidth\u0026#34;: 80, \u0026#34;bracketSpacing\u0026#34;: true, \u0026#34;arrowParens\u0026#34;: \u0026#34;always\u0026#34; } EOF è¨­å®šé …ç›®ã®èª¬æ˜ # é …ç›® èª¬æ˜ ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ è¨­å®šä¾‹ semi ã‚»ãƒŸã‚³ãƒ­ãƒ³ã‚’ä»˜ã‘ã‚‹ã‹ true true singleQuote ã‚·ãƒ³ã‚°ãƒ«ã‚¯ã‚©ãƒ¼ãƒˆã‚’ä½¿ã†ã‹ false true tabWidth ã‚¿ãƒ–ã®å¹… 2 2 trailingComma æœ«å°¾ã‚«ãƒ³ãƒ \u0026quot;all\u0026quot; \u0026quot;es5\u0026quot; printWidth 1è¡Œã®æœ€å¤§æ–‡å­—æ•° 80 80 bracketSpacing ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®æ‹¬å¼§å†…ã‚¹ãƒšãƒ¼ã‚¹ true true arrowParens ã‚¢ãƒ­ãƒ¼é–¢æ•°ã®æ‹¬å¼§ \u0026quot;always\u0026quot; \u0026quot;always\u0026quot; 2.5 è¨­å®šã‚’åæ˜ ã—ã¦å†æ•´å½¢ # # è¨­å®šã‚’åæ˜ ã—ã¦å†æ•´å½¢ npx prettier --write sample.js # çµæœã‚’ç¢ºèªï¼ˆã‚·ãƒ³ã‚°ãƒ«ã‚¯ã‚©ãƒ¼ãƒˆã«å¤‰ã‚ã‚‹ï¼‰ cat sample.js æœŸå¾…ã•ã‚Œã‚‹å‡ºåŠ› # // æ•´å½¢å‰ã®ã‚³ãƒ¼ãƒ‰ï¼ˆã‚ã–ã¨æ±šãæ›¸ãï¼‰ const user = { name: \u0026#39;Alice\u0026#39;, age: 25, email: \u0026#39;alice@example.com\u0026#39; }; function greet(name) { console.log(\u0026#39;Hello, \u0026#39; + name + \u0026#39;!\u0026#39;); } const numbers = [1, 2, 3, 4, 5]; const doubled = numbers.map((n) =\u0026gt; n * 2); if (user.age \u0026gt;= 18) { console.log(\u0026#39;Adult\u0026#39;); } else { console.log(\u0026#39;Minor\u0026#39;); } 2.6 è¤‡æ•°ãƒ•ã‚¡ã‚¤ãƒ«ã®æ•´å½¢ # # è¤‡æ•°ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆ mkdir src cat \u0026lt;\u0026lt; \u0026#39;EOF\u0026#39; \u0026gt; src/utils.js const add=(a,b)=\u0026gt;a+b; const subtract=(a,b)=\u0026gt;a-b; module.exports={add,subtract}; EOF cat \u0026lt;\u0026lt; \u0026#39;EOF\u0026#39; \u0026gt; src/index.js const {add,subtract}=require(\u0026#39;./utils\u0026#39;); console.log(add(5,3)); console.log(subtract(10,4)); EOF # srcãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªå†…ã®ã™ã¹ã¦ã®JSãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ•´å½¢ npx prettier --write \u0026#34;src/**/*.js\u0026#34; 2.7 é™¤å¤–ãƒ•ã‚¡ã‚¤ãƒ«ã®è¨­å®š # # .prettierignoreãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆ cat \u0026lt;\u0026lt; \u0026#39;EOF\u0026#39; \u0026gt; .prettierignore node_modules/ dist/ build/ *.min.js package-lock.json EOF 2.8 package.jsonã«ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’è¿½åŠ  # # package.jsonã‚’æ›´æ–° cat \u0026lt;\u0026lt; \u0026#39;EOF\u0026#39; \u0026gt; package.json { \u0026#34;name\u0026#34;: \u0026#34;prettier-study\u0026#34;, \u0026#34;version\u0026#34;: \u0026#34;1.0.0\u0026#34;, \u0026#34;scripts\u0026#34;: { \u0026#34;format\u0026#34;: \u0026#34;prettier --write .\u0026#34;, \u0026#34;format:check\u0026#34;: \u0026#34;prettier --check .\u0026#34; }, \u0026#34;devDependencies\u0026#34;: { \u0026#34;prettier\u0026#34;: \u0026#34;3.3.0\u0026#34; } } EOF # ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§å®Ÿè¡Œ npm run format:check npm run format 2.9 ã‚³ãƒ³ãƒ†ãƒŠçµ‚äº† # exit âœ… ã“ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§å­¦ã‚“ã ã“ã¨ # Prettierã¯ã‚³ãƒ¼ãƒ‰ã®è¦‹ãŸç›®ï¼ˆã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆã€å¼•ç”¨ç¬¦ã€æ”¹è¡Œãªã©ï¼‰ã‚’è‡ªå‹•æ•´å½¢ã™ã‚‹ãƒ•ã‚©ãƒ¼ãƒãƒƒã‚¿ãƒ¼ .prettierrcã§æ•´å½¢ãƒ«ãƒ¼ãƒ«ã‚’è¨­å®šï¼ˆsingleQuoteã€semiãªã©ï¼‰ --checkã§ãƒã‚§ãƒƒã‚¯ã®ã¿ã€--writeã§æ•´å½¢ã‚’å®Ÿè¡Œ --save-exactã§ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’å›ºå®šã—ã¦ãƒãƒ¼ãƒ å†…ã§æ•´å½¢çµæœã‚’çµ±ä¸€ Section 3: ESLintã¨Prettierã®ä½µç”¨ # 3.1 ãªãœä½µç”¨ã™ã‚‹ã®ã‹ï¼Ÿ # ãƒ„ãƒ¼ãƒ« å½¹å‰² ESLint ã‚³ãƒ¼ãƒ‰ã®å“è³ªãƒã‚§ãƒƒã‚¯ï¼ˆãƒã‚°æ¤œå‡ºï¼‰ Prettier ã‚³ãƒ¼ãƒ‰ã®è¦‹ãŸç›®ã‚’æ•´å½¢ ä¸¡æ–¹ä½¿ã†ã“ã¨ã§ï¼šå“è³ªã®é«˜ã„ã€è¦‹ãŸç›®ã‚‚çµ±ä¸€ã•ã‚ŒãŸã‚³ãƒ¼ãƒ‰ã«ãªã‚Šã¾ã™ã€‚\n3.2 ç«¶åˆã®å•é¡Œ # ESLintã¨Prettierã«ã¯ã‚¹ã‚¿ã‚¤ãƒ«ã«é–¢ã™ã‚‹ãƒ«ãƒ¼ãƒ«ãŒé‡è¤‡ã—ã¦ã„ã¾ã™ã€‚\nã€ç«¶åˆã®ä¾‹ã€‘ ESLint: \u0026#34;ã‚»ãƒŸã‚³ãƒ­ãƒ³ã¯å¿…é ˆï¼\u0026#34; Prettier: \u0026#34;ã‚»ãƒŸã‚³ãƒ­ãƒ³ãªã—ã§æ•´å½¢ã—ã¾ã—ãŸ\u0026#34; â†’ çŸ›ç›¾ãŒç™ºç”Ÿ 3.3 ãƒãƒ³ã‚ºã‚ªãƒ³ï¼šESLint + Prettier # å­¦ç¿’ç”¨ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ä½œæˆ # # ãƒ­ãƒ¼ã‚«ãƒ«ã§ä½œæ¥­ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä½œæˆ mkdir eslint-prettier-study \u0026amp;\u0026amp; cd eslint-prettier-study # Dockerã‚³ãƒ³ãƒ†ãƒŠã‚’èµ·å‹• docker run -it --rm -v $(pwd):/work -w /work node:20 bash å¿…è¦ãªãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« # # ã‚³ãƒ³ãƒ†ãƒŠå†…ã§å®Ÿè¡Œ npm init -y # ESLintã¨Prettierã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« npm install --save-dev eslint prettier # ç«¶åˆã‚’è§£æ±ºã™ã‚‹ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ npm install --save-dev eslint-config-prettier ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®èª¬æ˜ # ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ å½¹å‰² eslint é™çš„ã‚³ãƒ¼ãƒ‰è§£æ prettier ã‚³ãƒ¼ãƒ‰ãƒ•ã‚©ãƒ¼ãƒãƒƒã‚¿ãƒ¼ eslint-config-prettier ESLintã®ã‚¹ã‚¿ã‚¤ãƒ«ãƒ«ãƒ¼ãƒ«ã‚’ç„¡åŠ¹åŒ–ï¼ˆPrettierã¨ç«¶åˆã—ãªã„ã‚ˆã†ã«ï¼‰ 3.4 è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®ä½œæˆ # ESLintè¨­å®š # # eslint.config.mjsã‚’ä½œæˆ cat \u0026lt;\u0026lt; \u0026#39;EOF\u0026#39; \u0026gt; eslint.config.mjs import globals from \u0026#34;globals\u0026#34;; import pluginJs from \u0026#34;@eslint/js\u0026#34;; import eslintConfigPrettier from \u0026#34;eslint-config-prettier\u0026#34;; export default [ { languageOptions: { globals: globals.node } }, pluginJs.configs.recommended, // Prettierã¨ç«¶åˆã™ã‚‹ãƒ«ãƒ¼ãƒ«ã‚’ç„¡åŠ¹åŒ–ï¼ˆæœ€å¾Œã«é…ç½®ï¼‰ eslintConfigPrettier, { rules: { \u0026#34;no-unused-vars\u0026#34;: \u0026#34;warn\u0026#34;, \u0026#34;no-console\u0026#34;: \u0026#34;off\u0026#34; } } ]; EOF é‡è¦ï¼šeslintConfigPrettierã¯æœ€å¾Œã«é…ç½®ã—ã¦ã€ç«¶åˆã™ã‚‹ãƒ«ãƒ¼ãƒ«ã‚’ä¸Šæ›¸ãã—ã¾ã™ã€‚\nPrettierè¨­å®š # # .prettierrcã‚’ä½œæˆ cat \u0026lt;\u0026lt; \u0026#39;EOF\u0026#39; \u0026gt; .prettierrc { \u0026#34;semi\u0026#34;: true, \u0026#34;singleQuote\u0026#34;: true, \u0026#34;tabWidth\u0026#34;: 2, \u0026#34;trailingComma\u0026#34;: \u0026#34;es5\u0026#34; } EOF 3.5 ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ã®ä½œæˆã¨å®Ÿè¡Œ # # å•é¡Œã®ã‚ã‚‹ã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆ cat \u0026lt;\u0026lt; \u0026#39;EOF\u0026#39; \u0026gt; sample.js // å•é¡Œã®ã‚ã‚‹ã‚³ãƒ¼ãƒ‰ const unusedVar=\u0026#34;not used\u0026#34;; const user={name:\u0026#34;Alice\u0026#34;,age:25}; function greet(name){console.log(\u0026#34;Hello, \u0026#34;+name)} console.log(undefinedVar); EOF # ESLintã§ãƒã‚§ãƒƒã‚¯ï¼ˆå“è³ªã®å•é¡Œã‚’æ¤œå‡ºï¼‰ npx eslint sample.js æœŸå¾…ã•ã‚Œã‚‹å‡ºåŠ› # /work/sample.js 2:7 warning \u0026#39;unusedVar\u0026#39; is assigned a value but never used no-unused-vars 5:13 error \u0026#39;undefinedVar\u0026#39; is not defined no-undef âœ– 2 problems (1 error, 1 warning) # Prettierã§æ•´å½¢ï¼ˆè¦‹ãŸç›®ã‚’çµ±ä¸€ï¼‰ npx prettier --write sample.js # æ•´å½¢å¾Œã®ã‚³ãƒ¼ãƒ‰ã‚’ç¢ºèª cat sample.js æ•´å½¢å¾Œã®ã‚³ãƒ¼ãƒ‰ # // å•é¡Œã®ã‚ã‚‹ã‚³ãƒ¼ãƒ‰ const unusedVar = \u0026#39;not used\u0026#39;; const user = { name: \u0026#39;Alice\u0026#39;, age: 25 }; function greet(name) { console.log(\u0026#39;Hello, \u0026#39; + name); } console.log(undefinedVar); 3.6 package.jsonã«ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’è¿½åŠ  # # package.jsonã‚’æ›´æ–° cat \u0026lt;\u0026lt; \u0026#39;EOF\u0026#39; \u0026gt; package.json { \u0026#34;name\u0026#34;: \u0026#34;eslint-prettier-study\u0026#34;, \u0026#34;version\u0026#34;: \u0026#34;1.0.0\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;module\u0026#34;, \u0026#34;scripts\u0026#34;: { \u0026#34;lint\u0026#34;: \u0026#34;eslint .\u0026#34;, \u0026#34;lint:fix\u0026#34;: \u0026#34;eslint . --fix\u0026#34;, \u0026#34;format\u0026#34;: \u0026#34;prettier --write .\u0026#34;, \u0026#34;format:check\u0026#34;: \u0026#34;prettier --check .\u0026#34;, \u0026#34;check\u0026#34;: \u0026#34;npm run lint \u0026amp;\u0026amp; npm run format:check\u0026#34;, \u0026#34;fix\u0026#34;: \u0026#34;npm run lint:fix \u0026amp;\u0026amp; npm run format\u0026#34; }, \u0026#34;devDependencies\u0026#34;: { \u0026#34;@eslint/js\u0026#34;: \u0026#34;^9.0.0\u0026#34;, \u0026#34;eslint\u0026#34;: \u0026#34;^9.0.0\u0026#34;, \u0026#34;eslint-config-prettier\u0026#34;: \u0026#34;^9.0.0\u0026#34;, \u0026#34;globals\u0026#34;: \u0026#34;^15.0.0\u0026#34;, \u0026#34;prettier\u0026#34;: \u0026#34;^3.0.0\u0026#34; } } EOF ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®ä½¿ã„åˆ†ã‘ # ã‚¹ã‚¯ãƒªãƒ—ãƒˆ ç”¨é€” npm run lint ESLintã§ãƒã‚§ãƒƒã‚¯ npm run format:check Prettierã§ãƒã‚§ãƒƒã‚¯ npm run check ä¸¡æ–¹ã§ãƒã‚§ãƒƒã‚¯ npm run fix ä¸¡æ–¹ã§è‡ªå‹•ä¿®æ­£ 3.7 æ¨å¥¨ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ # # 1. ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã # 2. ä¿å­˜æ™‚ã«è‡ªå‹•æ•´å½¢ï¼ˆã‚¨ãƒ‡ã‚£ã‚¿è¨­å®šæ¨å¥¨ï¼‰ # 3. ã‚³ãƒŸãƒƒãƒˆå‰ã«ãƒã‚§ãƒƒã‚¯ npm run check # 4. å•é¡ŒãŒã‚ã‚Œã°ä¿®æ­£ npm run fix 3.8 ã‚³ãƒ³ãƒ†ãƒŠçµ‚äº† # exit âœ… ã“ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§å­¦ã‚“ã ã“ã¨ # ESLintï¼ˆå“è³ªãƒã‚§ãƒƒã‚¯ï¼‰ã¨Prettierï¼ˆæ•´å½¢ï¼‰ã¯å½¹å‰²ãŒç•°ãªã‚‹ãŸã‚ä½µç”¨ãŒåŠ¹æœçš„ eslint-config-prettierã§ESLintã®ã‚¹ã‚¿ã‚¤ãƒ«ãƒ«ãƒ¼ãƒ«ã‚’ç„¡åŠ¹åŒ–ã—ç«¶åˆã‚’é˜²æ­¢ è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã§eslintConfigPrettierã¯æœ€å¾Œã«é…ç½®ã™ã‚‹ npm run checkã§ãƒã‚§ãƒƒã‚¯ã€npm run fixã§è‡ªå‹•ä¿®æ­£ã®ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’æ§‹ç¯‰ Section 4: VSCodeé€£æºï¼ˆè£œè¶³ï¼‰ # 4.1 æ¨å¥¨æ‹¡å¼µæ©Ÿèƒ½ # æ‹¡å¼µæ©Ÿèƒ½ æ©Ÿèƒ½ ESLint ESLintã®çµæœã‚’ã‚¨ãƒ‡ã‚£ã‚¿ã«è¡¨ç¤º Prettier ä¿å­˜æ™‚ã«è‡ªå‹•æ•´å½¢ 4.2 settings.jsonã®è¨­å®šä¾‹ # { \u0026#34;editor.formatOnSave\u0026#34;: true, \u0026#34;editor.defaultFormatter\u0026#34;: \u0026#34;esbenp.prettier-vscode\u0026#34;, \u0026#34;editor.codeActionsOnSave\u0026#34;: { \u0026#34;source.fixAll.eslint\u0026#34;: true }, \u0026#34;[javascript]\u0026#34;: { \u0026#34;editor.defaultFormatter\u0026#34;: \u0026#34;esbenp.prettier-vscode\u0026#34; } } 4.3 Dev Containersï¼ˆVSCode + Dockerï¼‰ # VSCodeã®Dev Containersæ‹¡å¼µæ©Ÿèƒ½ã‚’ä½¿ãˆã°ã€Dockerç’°å¢ƒã§ã‚‚VSCodeã®æ©Ÿèƒ½ã‚’ãƒ•ãƒ«æ´»ç”¨ã§ãã¾ã™ã€‚\nã¾ã¨ã‚ # ğŸ¯ å­¦ã‚“ã ã“ã¨ # ESLint # ã‚³ãƒãƒ³ãƒ‰ ç”¨é€” npx eslint \u0026lt;file\u0026gt; ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒã‚§ãƒƒã‚¯ npx eslint . å…¨ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒã‚§ãƒƒã‚¯ npx eslint . --fix è‡ªå‹•ä¿®æ­£ Prettier # ã‚³ãƒãƒ³ãƒ‰ ç”¨é€” npx prettier --check \u0026lt;file\u0026gt; æ•´å½¢ãŒå¿…è¦ã‹ãƒã‚§ãƒƒã‚¯ npx prettier --write \u0026lt;file\u0026gt; æ•´å½¢ã‚’å®Ÿè¡Œ npx prettier --write . å…¨ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ•´å½¢ ä½µç”¨æ™‚ã®è¨­å®š # ãƒ•ã‚¡ã‚¤ãƒ« å½¹å‰² eslint.config.mjs ESLintè¨­å®š + eslint-config-prettier .prettierrc Prettierè¨­å®š .eslintignore ESLinté™¤å¤–ãƒ•ã‚¡ã‚¤ãƒ« .prettierignore Prettieré™¤å¤–ãƒ•ã‚¡ã‚¤ãƒ« ğŸ“š æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ— # Part 4: ãã®ä»–ãƒ„ãƒ¼ãƒ«ç·¨ï¼ˆyarnã€Sassã€nvm/nodenvï¼‰ ğŸ—‘ï¸ ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ— # # å­¦ç¿’ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’å‰Šé™¤ rm -rf eslint-study prettier-study eslint-prettier-study å‚è€ƒè³‡æ–™ # ESLintå…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ Prettierå…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ eslint-config-prettier ","date":"2025å¹´ 11æœˆ 30æ—¥","externalUrl":null,"permalink":"/posts/251130070546_docker-environment-nodejs-code-quality-tools/","section":"Posts","summary":"","title":"Dockerç’°å¢ƒã§Node.jsã‚’å­¦ã¼ã†_Part3_ã‚³ãƒ¼ãƒ‰å“è³ªãƒ„ãƒ¼ãƒ«ç·¨","type":"posts"},{"content":"","date":"2025å¹´ 11æœˆ 30æ—¥","externalUrl":null,"permalink":"/tags/eslint/","section":"Tags","summary":"","title":"ESLint","type":"tags"},{"content":"","date":"2025å¹´ 11æœˆ 30æ—¥","externalUrl":null,"permalink":"/tags/prettier/","section":"Tags","summary":"","title":"Prettier","type":"tags"},{"content":"","date":"2025å¹´ 11æœˆ 30æ—¥","externalUrl":null,"permalink":"/tags/babel/","section":"Tags","summary":"","title":"Babel","type":"tags"},{"content":" ã¯ã˜ã‚ã« # ğŸ¯ ã“ã®ãƒ¡ãƒ¢ã§ç†è§£ã™ã¹ã3ã¤ã®è¦ç‚¹ # Babelï¼šJavaScriptãƒˆãƒ©ãƒ³ã‚¹ãƒ‘ã‚¤ãƒ©\næœ€æ–°ã®JavaScriptï¼ˆES2015+ï¼‰ã‚’å¤ã„ãƒ–ãƒ©ã‚¦ã‚¶ã§ã‚‚å‹•ãã‚³ãƒ¼ãƒ‰ã«å¤‰æ› ãƒ—ãƒªã‚»ãƒƒãƒˆã§å¤‰æ›ãƒ«ãƒ¼ãƒ«ã‚’ç®¡ç† Webpackï¼šãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãƒãƒ³ãƒ‰ãƒ©ãƒ¼\nè¤‡æ•°ã®ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆJSã€CSSã€ç”»åƒï¼‰ã‚’1ã¤ã«ã¾ã¨ã‚ã‚‹ ãƒ­ãƒ¼ãƒ€ãƒ¼ã§æ§˜ã€…ãªãƒ•ã‚¡ã‚¤ãƒ«å½¢å¼ã«å¯¾å¿œ Viteï¼šæ¬¡ä¸–ä»£ãƒ“ãƒ«ãƒ‰ãƒ„ãƒ¼ãƒ«\nWebpackã‚ˆã‚Šé«˜é€Ÿãªé–‹ç™ºã‚µãƒ¼ãƒãƒ¼ ESModulesã‚’æ´»ç”¨ã—ãŸãƒ¢ãƒ€ãƒ³ãªè¨­è¨ˆ âš ï¸ ã‚ˆãã‚ã‚‹åˆå¿ƒè€…ã®é–“é•ã„ # âŒ Babelã®è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆ.babelrcï¼‰ã‚’ä½œã‚Šå¿˜ã‚Œã¦ãƒˆãƒ©ãƒ³ã‚¹ãƒ‘ã‚¤ãƒ«ãŒå‹•ã‹ãªã„ âŒ Webpackã®ãƒ­ãƒ¼ãƒ€ãƒ¼ã®å‡¦ç†é †åºï¼ˆå³ã‹ã‚‰å·¦ï¼‰ã‚’ç†è§£ã—ã¦ã„ãªã„ âŒ é–‹ç™ºç”¨ï¼ˆdevï¼‰ã¨æœ¬ç•ªç”¨ï¼ˆbuildï¼‰ã®é•ã„ã‚’æ„è­˜ã—ã¦ã„ãªã„ ğŸ”„ ãƒ„ãƒ¼ãƒ«ã®é–¢ä¿‚æ€§ # ã€é–‹ç™ºæ™‚ã®æµã‚Œã€‘ ES2015+ JavaScript â†“ [Babel] ãƒˆãƒ©ãƒ³ã‚¹ãƒ‘ã‚¤ãƒ«ï¼ˆå¤‰æ›ï¼‰ â†“ ES5 JavaScriptï¼ˆå¤ã„ãƒ–ãƒ©ã‚¦ã‚¶å¯¾å¿œï¼‰ â†“ [Webpack/Vite] ãƒãƒ³ãƒ‰ãƒ«ï¼ˆã¾ã¨ã‚ã‚‹ï¼‰ â†“ bundle.jsï¼ˆæœ¬ç•ªç”¨ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰ å‰ææ¡ä»¶ # Part 1 ã‚’å®Œäº†ã—ã¦ã„ã‚‹ã“ã¨ï¼ˆDockeråŸºç¤ã€Node.js/npmåŸºç¤ï¼‰ Docker DesktopãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ã“ã¨ Section 1: Babelï¼ˆãƒˆãƒ©ãƒ³ã‚¹ãƒ‘ã‚¤ãƒ©ï¼‰ # 1.1 Babelã¨ã¯ï¼Ÿ # Babelã¯ã€JavaScriptã®ãƒˆãƒ©ãƒ³ã‚¹ãƒ‘ã‚¤ãƒ©ï¼ˆå¤‰æ›ãƒ„ãƒ¼ãƒ«ï¼‰ã§ã™ã€‚\nãªãœBabelãŒå¿…è¦ï¼Ÿ # // ES2015+ï¼ˆãƒ¢ãƒ€ãƒ³ãªæ›¸ãæ–¹ï¼‰ const greet = (name) =\u0026gt; `Hello, ${name}!`; const numbers = [1, 2, 3]; const doubled = numbers.map(n =\u0026gt; n * 2); // ES5ï¼ˆå¤ã„ãƒ–ãƒ©ã‚¦ã‚¶å¯¾å¿œï¼‰ã«å¤‰æ›å¾Œ var greet = function(name) { return \u0026#34;Hello, \u0026#34; + name + \u0026#34;!\u0026#34;; }; var numbers = [1, 2, 3]; var doubled = numbers.map(function(n) { return n * 2; }); ä¸»ãªç”¨é€” # ç”¨é€” èª¬æ˜ ãƒ–ãƒ©ã‚¦ã‚¶äº’æ›æ€§ å¤ã„ãƒ–ãƒ©ã‚¦ã‚¶ã§ã‚‚æœ€æ–°æ§‹æ–‡ã‚’ä½¿ç”¨å¯èƒ½ã« React JSX JSXæ§‹æ–‡ã‚’é€šå¸¸ã®JavaScriptã«å¤‰æ› TypeScript TypeScriptã‹ã‚‰JavaScriptã¸ã®å¤‰æ›ï¼ˆâ€»ï¼‰ â€»TypeScriptå¤‰æ›ã®æ³¨æ„ç‚¹ï¼šBabelã§ã®å¤‰æ›ã¯ãƒˆãƒ©ãƒ³ã‚¹ãƒ‘ã‚¤ãƒ«ï¼ˆæ§‹æ–‡å¤‰æ›ï¼‰ã®ã¿ã§ã€å‹ãƒã‚§ãƒƒã‚¯ã¯è¡Œã‚ã‚Œã¾ã›ã‚“ã€‚å‹ãƒã‚§ãƒƒã‚¯ãŒå¿…è¦ãªå ´åˆã¯tscï¼ˆTypeScriptã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ï¼‰ã¨ä½µç”¨ã™ã‚‹ã‹ã€tscå˜ä½“ã§ã®å¤‰æ›ã‚’æ¤œè¨ã—ã¦ãã ã•ã„ã€‚\n1.2 ãƒãƒ³ã‚ºã‚ªãƒ³ï¼šBabelç’°å¢ƒæ§‹ç¯‰ # å­¦ç¿’ç”¨ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ä½œæˆ # # ãƒ­ãƒ¼ã‚«ãƒ«ã§ä½œæ¥­ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä½œæˆ mkdir babel-study \u0026amp;\u0026amp; cd babel-study # Dockerã‚³ãƒ³ãƒ†ãƒŠã‚’èµ·å‹• docker run -it --rm -v $(pwd):/work -w /work node:20 bash ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåˆæœŸåŒ–ã¨Babelã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« # # ã‚³ãƒ³ãƒ†ãƒŠå†…ã§å®Ÿè¡Œ npm init -y # Babelé–¢é€£ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« npm install --save-dev @babel/cli @babel/core @babel/preset-env ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®èª¬æ˜ # ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ å½¹å‰² @babel/core Babelæœ¬ä½“ï¼ˆå¤‰æ›ã‚¨ãƒ³ã‚¸ãƒ³ï¼‰ @babel/cli ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ãƒ„ãƒ¼ãƒ« @babel/preset-env ç’°å¢ƒã«å¿œã˜ãŸå¤‰æ›ãƒ«ãƒ¼ãƒ«ã‚»ãƒƒãƒˆ 1.3 Babelè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®ä½œæˆ # # .babelrcãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆ cat \u0026lt;\u0026lt; \u0026#39;EOF\u0026#39; \u0026gt; .babelrc { \u0026#34;presets\u0026#34;: [\u0026#34;@babel/preset-env\u0026#34;] } EOF ãƒ—ãƒªã‚»ãƒƒãƒˆï¼ˆpresetï¼‰ã¨ã¯ï¼Ÿ # å¤‰æ›ã«å¿…è¦ãªãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã®é›†åˆä½“ã§ã™ã€‚\nãƒ—ãƒªã‚»ãƒƒãƒˆ ç”¨é€” @babel/preset-env æœ€æ–°JSâ†’ã‚¿ãƒ¼ã‚²ãƒƒãƒˆç’°å¢ƒå¯¾å¿œJS @babel/preset-react JSXâ†’JavaScriptå¤‰æ› @babel/preset-typescript TypeScriptâ†’JavaScriptå¤‰æ› 1.4 ãƒˆãƒ©ãƒ³ã‚¹ãƒ‘ã‚¤ãƒ«ã®å®Ÿè¡Œ # ã‚½ãƒ¼ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«ã®ä½œæˆ # # ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ ã‚’ä½œæˆ mkdir src dist # ES2015+ã®ã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆ cat \u0026lt;\u0026lt; \u0026#39;EOF\u0026#39; \u0026gt; src/app.js // ã‚¢ãƒ­ãƒ¼é–¢æ•° const greet = (name) =\u0026gt; { console.log(`Hello, ${name}!`); }; // ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãƒªãƒ†ãƒ©ãƒ« const message = `Current time: ${new Date().toLocaleString()}`; // åˆ†å‰²ä»£å…¥ const user = { name: \u0026#39;Alice\u0026#39;, age: 25 }; const { name, age } = user; // ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰æ§‹æ–‡ const numbers = [1, 2, 3]; const moreNumbers = [...numbers, 4, 5]; // ã‚¯ãƒ©ã‚¹æ§‹æ–‡ class Animal { constructor(name) { this.name = name; } speak() { console.log(`${this.name} makes a sound.`); } } // å®Ÿè¡Œ greet(\u0026#39;World\u0026#39;); console.log(message); console.log(`User: ${name}, Age: ${age}`); console.log(\u0026#39;Numbers:\u0026#39;, moreNumbers); const dog = new Animal(\u0026#39;Dog\u0026#39;); dog.speak(); EOF ãƒˆãƒ©ãƒ³ã‚¹ãƒ‘ã‚¤ãƒ«å®Ÿè¡Œ # # Babelã§ãƒˆãƒ©ãƒ³ã‚¹ãƒ‘ã‚¤ãƒ« npx babel src/app.js -o dist/app.js # çµæœã‚’ç¢ºèª cat dist/app.js æœŸå¾…ã•ã‚Œã‚‹å‡ºåŠ›ï¼ˆES5ã«å¤‰æ›æ¸ˆã¿ï¼‰ # \u0026#34;use strict\u0026#34;; function _typeof(o) { /* ... */ } function _classCallCheck(a, n) { /* ... */ } function _defineProperties(e, r) { /* ... */ } function _createClass(e, r, t) { /* ... */ } function _toConsumableArray(r) { /* ... */ } var greet = function greet(name) { console.log(\u0026#34;Hello, \u0026#34;.concat(name, \u0026#34;!\u0026#34;)); }; var message = \u0026#34;Current time: \u0026#34;.concat(new Date().toLocaleString()); // ... ä»¥ä¸‹ç•¥ 1.5 package.jsonã«ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’è¿½åŠ  # # package.jsonã‚’æ›´æ–° cat \u0026lt;\u0026lt; \u0026#39;EOF\u0026#39; \u0026gt; package.json { \u0026#34;name\u0026#34;: \u0026#34;babel-study\u0026#34;, \u0026#34;version\u0026#34;: \u0026#34;1.0.0\u0026#34;, \u0026#34;scripts\u0026#34;: { \u0026#34;build\u0026#34;: \u0026#34;babel src -d dist\u0026#34;, \u0026#34;watch\u0026#34;: \u0026#34;babel src -d dist --watch\u0026#34; }, \u0026#34;devDependencies\u0026#34;: { \u0026#34;@babel/cli\u0026#34;: \u0026#34;^7.23.0\u0026#34;, \u0026#34;@babel/core\u0026#34;: \u0026#34;^7.23.0\u0026#34;, \u0026#34;@babel/preset-env\u0026#34;: \u0026#34;^7.23.0\u0026#34; } } EOF # ãƒ“ãƒ«ãƒ‰å®Ÿè¡Œ npm run build # å¤‰æ›å¾Œã®ã‚³ãƒ¼ãƒ‰ã‚’å®Ÿè¡Œ node dist/app.js æœŸå¾…ã•ã‚Œã‚‹å‡ºåŠ› # Hello, World! Current time: 11/30/2025, 10:00:00 AM User: Alice, Age: 25 Numbers: [ 1, 2, 3, 4, 5 ] Dog makes a sound. 1.6 ã‚³ãƒ³ãƒ†ãƒŠçµ‚äº†ã¨ç¢ºèª # # ã‚³ãƒ³ãƒ†ãƒŠã‚’çµ‚äº† exit # ãƒ­ãƒ¼ã‚«ãƒ«ã§ãƒ•ã‚¡ã‚¤ãƒ«ç¢ºèª ls babel-study/ # å‡ºåŠ›: dist node_modules package-lock.json package.json src âœ… ã“ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§å­¦ã‚“ã ã“ã¨ # Babelã¯æœ€æ–°ã®JavaScriptã‚’å¤ã„ãƒ–ãƒ©ã‚¦ã‚¶å¯¾å¿œã®ã‚³ãƒ¼ãƒ‰ã«å¤‰æ›ã™ã‚‹ãƒˆãƒ©ãƒ³ã‚¹ãƒ‘ã‚¤ãƒ© @babel/preset-envã§ç’°å¢ƒã«å¿œã˜ãŸå¤‰æ›ãƒ«ãƒ¼ãƒ«ã‚’é©ç”¨ npx babel src -d distã§ãƒˆãƒ©ãƒ³ã‚¹ãƒ‘ã‚¤ãƒ«ã€--watchã§å¤‰æ›´ç›£è¦– Section 2: Webpackï¼ˆãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãƒãƒ³ãƒ‰ãƒ©ãƒ¼ï¼‰ # 2.1 Webpackã¨ã¯ï¼Ÿ # Webpackã¯ã€è¤‡æ•°ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’1ã¤ã«ã¾ã¨ã‚ã‚‹ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãƒãƒ³ãƒ‰ãƒ©ãƒ¼ã§ã™ã€‚\nWebpackã®å½¹å‰² # ã€ãƒãƒ³ãƒ‰ãƒ«å‰ã€‘ src/ â”œâ”€â”€ index.js ï¼ˆã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆï¼‰ â”œâ”€â”€ utils.js ï¼ˆãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ï¼‰ â”œâ”€â”€ api.js ï¼ˆAPIå‡¦ç†ï¼‰ â””â”€â”€ style.css ï¼ˆã‚¹ã‚¿ã‚¤ãƒ«ï¼‰ ã€ãƒãƒ³ãƒ‰ãƒ«å¾Œã€‘ dist/ â””â”€â”€ bundle.js ï¼ˆã™ã¹ã¦ã¾ã¨ã¾ã£ãŸ1ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰ ãªãœãƒãƒ³ãƒ‰ãƒ«ãŒå¿…è¦ï¼Ÿ # ç†ç”± èª¬æ˜ HTTPãƒªã‚¯ã‚¨ã‚¹ãƒˆå‰Šæ¸› è¤‡æ•°ãƒ•ã‚¡ã‚¤ãƒ«â†’1ãƒ•ã‚¡ã‚¤ãƒ«ã§ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ•°æ¸›å°‘ ä¾å­˜é–¢ä¿‚è§£æ±º ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«é–“ã®ä¾å­˜ã‚’è‡ªå‹•è§£æ±º æœ€é©åŒ– ã‚³ãƒ¼ãƒ‰åœ§ç¸®ã€ä¸è¦ã‚³ãƒ¼ãƒ‰å‰Šé™¤ å¤‰æ›å‡¦ç† ãƒ­ãƒ¼ãƒ€ãƒ¼ã§CSSã€ç”»åƒãªã©ã‚‚å‡¦ç†å¯èƒ½ 2.2 ãƒãƒ³ã‚ºã‚ªãƒ³ï¼šWebpackç’°å¢ƒæ§‹ç¯‰ # å­¦ç¿’ç”¨ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ä½œæˆ # # ãƒ­ãƒ¼ã‚«ãƒ«ã§ä½œæ¥­ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä½œæˆ mkdir webpack-study \u0026amp;\u0026amp; cd webpack-study # Dockerã‚³ãƒ³ãƒ†ãƒŠã‚’èµ·å‹• docker run -it --rm -v $(pwd):/work -w /work node:20 bash ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåˆæœŸåŒ–ã¨Webpackã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« # # ã‚³ãƒ³ãƒ†ãƒŠå†…ã§å®Ÿè¡Œ npm init -y # Webpacké–¢é€£ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« npm install --save-dev webpack webpack-cli 2.3 ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ ã®ä½œæˆ # # ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã¨ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆ mkdir -p src/modules dist # ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆ cat \u0026lt;\u0026lt; \u0026#39;EOF\u0026#39; \u0026gt; src/modules/math.js // æ•°å­¦é–¢é€£ã®é–¢æ•° export const add = (a, b) =\u0026gt; a + b; export const subtract = (a, b) =\u0026gt; a - b; export const multiply = (a, b) =\u0026gt; a * b; export const divide = (a, b) =\u0026gt; a / b; EOF cat \u0026lt;\u0026lt; \u0026#39;EOF\u0026#39; \u0026gt; src/modules/greeting.js // æŒ¨æ‹¶é–¢é€£ã®é–¢æ•° export const hello = (name) =\u0026gt; `Hello, ${name}!`; export const goodbye = (name) =\u0026gt; `Goodbye, ${name}!`; EOF # ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆã‚’ä½œæˆ cat \u0026lt;\u0026lt; \u0026#39;EOF\u0026#39; \u0026gt; src/index.js // ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆ import { add, multiply } from \u0026#39;./modules/math.js\u0026#39;; import { hello, goodbye } from \u0026#39;./modules/greeting.js\u0026#39;; // ä½¿ç”¨ä¾‹ console.log(\u0026#39;=== Math Operations ===\u0026#39;); console.log(`5 + 3 = ${add(5, 3)}`); console.log(`5 * 3 = ${multiply(5, 3)}`); console.log(\u0026#39;\\n=== Greetings ===\u0026#39;); console.log(hello(\u0026#39;Webpack\u0026#39;)); console.log(goodbye(\u0026#39;Webpack\u0026#39;)); EOF # HTMLãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆ cat \u0026lt;\u0026lt; \u0026#39;EOF\u0026#39; \u0026gt; dist/index.html \u0026lt;!DOCTYPE html\u0026gt; \u0026lt;html lang=\u0026#34;ja\u0026#34;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta charset=\u0026#34;UTF-8\u0026#34;\u0026gt; \u0026lt;meta name=\u0026#34;viewport\u0026#34; content=\u0026#34;width=device-width, initial-scale=1.0\u0026#34;\u0026gt; \u0026lt;title\u0026gt;Webpack Study\u0026lt;/title\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;h1\u0026gt;Webpack ãƒãƒ³ãƒ‰ãƒ«ãƒ†ã‚¹ãƒˆ\u0026lt;/h1\u0026gt; \u0026lt;p\u0026gt;ãƒ–ãƒ©ã‚¦ã‚¶ã®ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã‚’ç¢ºèªã—ã¦ãã ã•ã„\u0026lt;/p\u0026gt; \u0026lt;script src=\u0026#34;bundle.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; EOF 2.4 Webpackè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®ä½œæˆ # # webpack.config.jsã‚’ä½œæˆ cat \u0026lt;\u0026lt; \u0026#39;EOF\u0026#39; \u0026gt; webpack.config.js const path = require(\u0026#39;path\u0026#39;); module.exports = { // ãƒ¢ãƒ¼ãƒ‰: developmentï¼ˆé–‹ç™ºï¼‰ã¾ãŸã¯ productionï¼ˆæœ¬ç•ªï¼‰ mode: \u0026#39;development\u0026#39;, // ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆ: ãƒãƒ³ãƒ‰ãƒ«ã®é–‹å§‹åœ°ç‚¹ entry: \u0026#39;./src/index.js\u0026#39;, // å‡ºåŠ›è¨­å®š output: { filename: \u0026#39;bundle.js\u0026#39;, path: path.resolve(__dirname, \u0026#39;dist\u0026#39;) } }; EOF è¨­å®šé …ç›®ã®è§£èª¬ # é …ç›® èª¬æ˜ å€¤ mode ãƒ“ãƒ«ãƒ‰ãƒ¢ãƒ¼ãƒ‰ development / production entry ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆ ./src/index.js output.filename å‡ºåŠ›ãƒ•ã‚¡ã‚¤ãƒ«å bundle.js output.path å‡ºåŠ›ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª dist/ 2.5 ãƒãƒ³ãƒ‰ãƒ«å®Ÿè¡Œ # # package.jsonã«ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’è¿½åŠ  cat \u0026lt;\u0026lt; \u0026#39;EOF\u0026#39; \u0026gt; package.json { \u0026#34;name\u0026#34;: \u0026#34;webpack-study\u0026#34;, \u0026#34;version\u0026#34;: \u0026#34;1.0.0\u0026#34;, \u0026#34;scripts\u0026#34;: { \u0026#34;build\u0026#34;: \u0026#34;webpack\u0026#34;, \u0026#34;dev\u0026#34;: \u0026#34;webpack --mode development --watch\u0026#34; }, \u0026#34;devDependencies\u0026#34;: { \u0026#34;webpack\u0026#34;: \u0026#34;^5.89.0\u0026#34;, \u0026#34;webpack-cli\u0026#34;: \u0026#34;^5.1.4\u0026#34; } } EOF # ãƒ“ãƒ«ãƒ‰å®Ÿè¡Œ npm run build æœŸå¾…ã•ã‚Œã‚‹å‡ºåŠ› # asset bundle.js 4.5 KiB [emitted] (name: main) runtime modules 670 bytes 3 modules cacheable modules 524 bytes ./src/index.js 389 bytes [built] [code generated] ./src/modules/math.js 178 bytes [built] [code generated] ./src/modules/greeting.js 135 bytes [built] [code generated] webpack 5.89.0 compiled successfully in 150 ms # ãƒãƒ³ãƒ‰ãƒ«çµæœã‚’Node.jsã§å®Ÿè¡Œ node dist/bundle.js æœŸå¾…ã•ã‚Œã‚‹å‡ºåŠ› # === Math Operations === 5 + 3 = 8 5 * 3 = 15 === Greetings === Hello, Webpack! Goodbye, Webpack! 2.6 CSSã®ãƒãƒ³ãƒ‰ãƒ« # ãƒ­ãƒ¼ãƒ€ãƒ¼ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« # # CSSãƒ­ãƒ¼ãƒ€ãƒ¼ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« npm install --save-dev css-loader style-loader CSSãƒ•ã‚¡ã‚¤ãƒ«ã®ä½œæˆ # # CSSãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆ cat \u0026lt;\u0026lt; \u0026#39;EOF\u0026#39; \u0026gt; src/style.css body { font-family: Arial, sans-serif; background-color: #f0f0f0; margin: 0; padding: 20px; } h1 { color: #333; border-bottom: 2px solid #007bff; padding-bottom: 10px; } p { color: #666; } EOF ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆã§CSSã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆ # # index.jsã‚’æ›´æ–° cat \u0026lt;\u0026lt; \u0026#39;EOF\u0026#39; \u0026gt; src/index.js // CSSã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆï¼ˆWebpackãŒå‡¦ç†ï¼‰ import \u0026#39;./style.css\u0026#39;; // ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆ import { add, multiply } from \u0026#39;./modules/math.js\u0026#39;; import { hello, goodbye } from \u0026#39;./modules/greeting.js\u0026#39;; // ä½¿ç”¨ä¾‹ console.log(\u0026#39;=== Math Operations ===\u0026#39;); console.log(`5 + 3 = ${add(5, 3)}`); console.log(`5 * 3 = ${multiply(5, 3)}`); console.log(\u0026#39;\\n=== Greetings ===\u0026#39;); console.log(hello(\u0026#39;Webpack\u0026#39;)); console.log(goodbye(\u0026#39;Webpack\u0026#39;)); // DOMæ“ä½œ document.addEventListener(\u0026#39;DOMContentLoaded\u0026#39;, () =\u0026gt; { const result = document.createElement(\u0026#39;div\u0026#39;); result.innerHTML = ` \u0026lt;h2\u0026gt;è¨ˆç®—çµæœ\u0026lt;/h2\u0026gt; \u0026lt;p\u0026gt;5 + 3 = ${add(5, 3)}\u0026lt;/p\u0026gt; \u0026lt;p\u0026gt;5 Ã— 3 = ${multiply(5, 3)}\u0026lt;/p\u0026gt; `; document.body.appendChild(result); }); EOF Webpackè¨­å®šã«ãƒ­ãƒ¼ãƒ€ãƒ¼ã‚’è¿½åŠ  # # webpack.config.jsã‚’æ›´æ–° cat \u0026lt;\u0026lt; \u0026#39;EOF\u0026#39; \u0026gt; webpack.config.js const path = require(\u0026#39;path\u0026#39;); module.exports = { mode: \u0026#39;development\u0026#39;, entry: \u0026#39;./src/index.js\u0026#39;, output: { filename: \u0026#39;bundle.js\u0026#39;, path: path.resolve(__dirname, \u0026#39;dist\u0026#39;) }, // ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«è¨­å®šï¼ˆãƒ­ãƒ¼ãƒ€ãƒ¼ï¼‰ module: { rules: [ { test: /\\.css$/, // .cssãƒ•ã‚¡ã‚¤ãƒ«ã‚’å¯¾è±¡ use: [\u0026#39;style-loader\u0026#39;, \u0026#39;css-loader\u0026#39;] // å³ã‹ã‚‰å·¦ã®é †ã§å‡¦ç† } ] } }; EOF # å†ãƒ“ãƒ«ãƒ‰ npm run build ãƒ­ãƒ¼ãƒ€ãƒ¼ã®å‡¦ç†é †åº # ã€å‡¦ç†ã®æµã‚Œã€‘ style.css â†“ css-loaderï¼ˆCSSã‚’JSã§æ‰±ãˆã‚‹å½¢å¼ã«å¤‰æ›ï¼‰ â†“ style-loaderï¼ˆ\u0026lt;style\u0026gt;ã‚¿ã‚°ã¨ã—ã¦HTMLã«æŒ¿å…¥ï¼‰ â†“ bundle.js ã«å«ã¾ã‚Œã‚‹ é‡è¦ï¼šuseé…åˆ—ã¯å³ã‹ã‚‰å·¦ã®é †ã§å‡¦ç†ã•ã‚Œã¾ã™ã€‚\n2.7 ãƒ–ãƒ©ã‚¦ã‚¶ã§ç¢ºèªï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰ # # ã‚³ãƒ³ãƒ†ãƒŠã‚’ä¸€åº¦çµ‚äº† exit # ãƒãƒ¼ãƒˆå…¬é–‹ã§å†èµ·å‹•ï¼ˆç°¡æ˜“ã‚µãƒ¼ãƒãƒ¼ç”¨ï¼‰ docker run -it --rm -v $(pwd):/work -w /work -p 8080:8080 node:20 bash # ç°¡æ˜“ã‚µãƒ¼ãƒãƒ¼ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãƒ»èµ·å‹• npm install --save-dev http-server npx http-server dist -p 8080 ãƒ–ãƒ©ã‚¦ã‚¶ã§ http://localhost:8080 ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ç¢ºèªã€‚\n2.8 ã‚³ãƒ³ãƒ†ãƒŠçµ‚äº† # # Ctrl + C ã§ã‚µãƒ¼ãƒãƒ¼åœæ­¢ exit âœ… ã“ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§å­¦ã‚“ã ã“ã¨ # Webpackã¯è¤‡æ•°ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’1ã¤ã«ã¾ã¨ã‚ã‚‹ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãƒãƒ³ãƒ‰ãƒ©ãƒ¼ entryã§ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆã€outputã§å‡ºåŠ›å…ˆã‚’è¨­å®š ãƒ­ãƒ¼ãƒ€ãƒ¼ï¼ˆcss-loaderã€style-loaderãªã©ï¼‰ã§æ§˜ã€…ãªãƒ•ã‚¡ã‚¤ãƒ«å½¢å¼ã«å¯¾å¿œ ãƒ­ãƒ¼ãƒ€ãƒ¼ã®å‡¦ç†é †åºã¯useé…åˆ—ã®å³ã‹ã‚‰å·¦ Section 3: Viteï¼ˆæ¬¡ä¸–ä»£ãƒ“ãƒ«ãƒ‰ãƒ„ãƒ¼ãƒ«ï¼‰ # 3.1 Viteã¨ã¯ï¼Ÿ # Viteï¼ˆãƒ´ã‚£ãƒ¼ãƒˆï¼šãƒ•ãƒ©ãƒ³ã‚¹èªã§ã€Œé€Ÿã„ã€ï¼‰ã¯ã€Webpackã‚ˆã‚Šé«˜é€Ÿãªãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãƒ“ãƒ«ãƒ‰ãƒ„ãƒ¼ãƒ«ã§ã™ã€‚\nViteã¨Webpackã®é•ã„ # é …ç›® Webpack Vite èµ·å‹•é€Ÿåº¦ é…ã„ï¼ˆå…¨ä½“ã‚’äº‹å‰ãƒãƒ³ãƒ‰ãƒ«ï¼‰ é€Ÿã„ï¼ˆå¿…è¦ãªéƒ¨åˆ†ã ã‘å‡¦ç†ï¼‰ HMR ã‚„ã‚„é…ã„ éå¸¸ã«é«˜é€Ÿ è¨­å®š è¤‡é›‘ã«ãªã‚ŠãŒã¡ ã‚·ãƒ³ãƒ—ãƒ« æœ¬ç•ªãƒ“ãƒ«ãƒ‰ ç‹¬è‡ªãƒãƒ³ãƒ‰ãƒ©ãƒ¼ Rollupä½¿ç”¨ ViteãŒé«˜é€Ÿãªç†ç”± # ã€Webpackã€‘ èµ·å‹•æ™‚: å…¨ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è§£æ â†’ ãƒãƒ³ãƒ‰ãƒ« â†’ ã‚µãƒ¼ãƒãƒ¼èµ·å‹• ã€Viteã€‘ èµ·å‹•æ™‚: ã‚µãƒ¼ãƒãƒ¼èµ·å‹• â†’ ãƒªã‚¯ã‚¨ã‚¹ãƒˆã«å¿œã˜ã¦å¿…è¦ãªãƒ•ã‚¡ã‚¤ãƒ«ã ã‘å‡¦ç† 3.2 ãƒãƒ³ã‚ºã‚ªãƒ³ï¼šViteãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä½œæˆ # å­¦ç¿’ç”¨ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ä½œæˆ # # ãƒ­ãƒ¼ã‚«ãƒ«ã§ä½œæ¥­ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä½œæˆ mkdir vite-study \u0026amp;\u0026amp; cd vite-study # Dockerã‚³ãƒ³ãƒ†ãƒŠã‚’èµ·å‹•ï¼ˆãƒãƒ¼ãƒˆå…¬é–‹ï¼‰ docker run -it --rm -v $(pwd):/work -w /work -p 5173:5173 node:20 bash Viteãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ä½œæˆ # # ã‚³ãƒ³ãƒ†ãƒŠå†…ã§å®Ÿè¡Œ npm create vite@latest my-vite-app å¯¾è©±å½¢å¼ã§ã®é¸æŠ # ? Select a framework: â€º Vanilla ? Select a variant: â€º JavaScript ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯é¸æŠè‚¢ï¼š\nVanillaï¼ˆç´ ã®JSï¼‰ Vue React Svelte ãã®ä»– 3.3 ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹é€ ã®ç¢ºèª # # ä½œæˆã•ã‚ŒãŸãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ç§»å‹• cd my-vite-app # æ§‹é€ ã‚’ç¢ºèª ls -la ç”Ÿæˆã•ã‚Œã‚‹ãƒ•ã‚¡ã‚¤ãƒ«æ§‹é€  # my-vite-app/ â”œâ”€â”€ index.html # ã‚¨ãƒ³ãƒˆãƒªãƒ¼HTML â”œâ”€â”€ package.json # ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆè¨­å®š â”œâ”€â”€ public/ # é™çš„ãƒ•ã‚¡ã‚¤ãƒ« â”‚ â””â”€â”€ vite.svg â”œâ”€â”€ src/ # ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ â”‚ â”œâ”€â”€ counter.js â”‚ â”œâ”€â”€ javascript.svg â”‚ â”œâ”€â”€ main.js â”‚ â””â”€â”€ style.css â””â”€â”€ vite.config.js # Viteè¨­å®šï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰ 3.4 ä¾å­˜é–¢ä¿‚ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã¨èµ·å‹• # # ä¾å­˜é–¢ä¿‚ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« npm install # é–‹ç™ºã‚µãƒ¼ãƒãƒ¼ã‚’èµ·å‹• npm run dev -- --host --hostã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼šDockerã‚³ãƒ³ãƒ†ãƒŠå¤–ã‹ã‚‰ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½ã«ã™ã‚‹\næœŸå¾…ã•ã‚Œã‚‹å‡ºåŠ› # VITE v5.x.x ready in xxx ms âœ Local: http://localhost:5173/ âœ Network: http://172.x.x.x:5173/ ãƒ–ãƒ©ã‚¦ã‚¶ã§ http://localhost:5173 ã«ã‚¢ã‚¯ã‚»ã‚¹ã€‚\n3.5 HMRï¼ˆHot Module Replacementï¼‰ã®ä½“é¨“ # é–‹ç™ºã‚µãƒ¼ãƒãƒ¼ã‚’èµ·å‹•ã—ãŸã¾ã¾ã€åˆ¥ã®ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã§ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç·¨é›†ï¼š\n# åˆ¥ã®ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã§ã‚³ãƒ³ãƒ†ãƒŠã«å…¥ã‚‹ docker exec -it $(docker ps -q) bash # ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç·¨é›† cd /work/my-vite-app cat \u0026lt;\u0026lt; \u0026#39;EOF\u0026#39; \u0026gt; src/main.js import \u0026#39;./style.css\u0026#39; document.querySelector(\u0026#39;#app\u0026#39;).innerHTML = ` \u0026lt;div\u0026gt; \u0026lt;h1\u0026gt;Hello Vite!\u0026lt;/h1\u0026gt; \u0026lt;p\u0026gt;ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç·¨é›†ã™ã‚‹ã¨è‡ªå‹•ã§åæ˜ ã•ã‚Œã¾ã™\u0026lt;/p\u0026gt; \u0026lt;p\u0026gt;ç¾åœ¨æ™‚åˆ»: ${new Date().toLocaleString()}\u0026lt;/p\u0026gt; \u0026lt;/div\u0026gt; ` EOF ãƒ–ãƒ©ã‚¦ã‚¶ã‚’ç¢ºèªï¼šãƒšãƒ¼ã‚¸ã‚’ãƒªãƒ­ãƒ¼ãƒ‰ã›ãšã«å¤‰æ›´ãŒåæ˜ ã•ã‚Œã¾ã™ã€‚\n3.6 æœ¬ç•ªç”¨ãƒ“ãƒ«ãƒ‰ # # é–‹ç™ºã‚µãƒ¼ãƒãƒ¼ã‚’åœæ­¢ï¼ˆCtrl + Cï¼‰å¾Œ npm run build æœŸå¾…ã•ã‚Œã‚‹å‡ºåŠ› # vite v5.x.x building for production... âœ“ 2 modules transformed. dist/index.html 0.xx kB â”‚ gzip: 0.xx kB dist/assets/index-xxxxx.css 0.xx kB â”‚ gzip: 0.xx kB dist/assets/index-xxxxx.js 0.xx kB â”‚ gzip: 0.xx kB âœ“ built in xxxms # ãƒ“ãƒ«ãƒ‰çµæœã‚’ç¢ºèª ls dist/ # å‡ºåŠ›: assets index.html vite.svg 3.7 ãƒ“ãƒ«ãƒ‰çµæœã®ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ # # ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚µãƒ¼ãƒãƒ¼ã‚’èµ·å‹• npm run preview -- --host ãƒ–ãƒ©ã‚¦ã‚¶ã§ http://localhost:4173 ã«ã‚¢ã‚¯ã‚»ã‚¹ã€‚\n3.8 package.jsonã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆç¢ºèª # cat package.json { \u0026#34;name\u0026#34;: \u0026#34;my-vite-app\u0026#34;, \u0026#34;private\u0026#34;: true, \u0026#34;version\u0026#34;: \u0026#34;0.0.0\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;module\u0026#34;, \u0026#34;scripts\u0026#34;: { \u0026#34;dev\u0026#34;: \u0026#34;vite\u0026#34;, // é–‹ç™ºã‚µãƒ¼ãƒãƒ¼èµ·å‹• \u0026#34;build\u0026#34;: \u0026#34;vite build\u0026#34;, // æœ¬ç•ªç”¨ãƒ“ãƒ«ãƒ‰ \u0026#34;preview\u0026#34;: \u0026#34;vite preview\u0026#34; // ãƒ“ãƒ«ãƒ‰çµæœã®ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ }, \u0026#34;devDependencies\u0026#34;: { \u0026#34;vite\u0026#34;: \u0026#34;^5.0.0\u0026#34; } } 3.9 ã‚³ãƒ³ãƒ†ãƒŠçµ‚äº† # exit âœ… ã“ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§å­¦ã‚“ã ã“ã¨ # Viteã¯Webpackã‚ˆã‚Šé«˜é€Ÿãªæ¬¡ä¸–ä»£ãƒ“ãƒ«ãƒ‰ãƒ„ãƒ¼ãƒ« ESModulesã‚’æ´»ç”¨ã—ã€å¿…è¦ãªãƒ•ã‚¡ã‚¤ãƒ«ã ã‘ã‚’å‡¦ç†ã™ã‚‹ãŸã‚èµ·å‹•ãŒé€Ÿã„ npm run devã§é–‹ç™ºã‚µãƒ¼ãƒãƒ¼ã€npm run buildã§æœ¬ç•ªãƒ“ãƒ«ãƒ‰ HMRï¼ˆHot Module Replacementï¼‰ã§ãƒ•ã‚¡ã‚¤ãƒ«å¤‰æ›´ãŒå³åº§ã«åæ˜  Section 4: ãƒ„ãƒ¼ãƒ«æ¯”è¼ƒã¨ä½¿ã„åˆ†ã‘ # 4.1 å„ãƒ„ãƒ¼ãƒ«ã®å½¹å‰²ã¾ã¨ã‚ # ãƒ„ãƒ¼ãƒ« ã‚«ãƒ†ã‚´ãƒª ä¸»ãªå½¹å‰² Babel ãƒˆãƒ©ãƒ³ã‚¹ãƒ‘ã‚¤ãƒ© æ–°ã—ã„JSâ†’å¤ã„JSå¤‰æ› Webpack ãƒãƒ³ãƒ‰ãƒ©ãƒ¼ è¤‡æ•°ãƒ•ã‚¡ã‚¤ãƒ«ã‚’1ã¤ã«ã¾ã¨ã‚ã‚‹ Vite ãƒ“ãƒ«ãƒ‰ãƒ„ãƒ¼ãƒ« é«˜é€Ÿãªé–‹ç™ºç’°å¢ƒ + ãƒ“ãƒ«ãƒ‰ 4.2 çµ„ã¿åˆã‚ã›ãƒ‘ã‚¿ãƒ¼ãƒ³ # ã€ãƒ‘ã‚¿ãƒ¼ãƒ³1: Webpack + Babelï¼ˆå¾“æ¥å‹ï¼‰ã€‘ - å¤§è¦æ¨¡ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ - ç´°ã‹ã„è¨­å®šãŒå¿…è¦ãªå ´åˆ - ãƒ¬ã‚¬ã‚·ãƒ¼ãƒ–ãƒ©ã‚¦ã‚¶å¯¾å¿œãŒå¿…é ˆ ã€ãƒ‘ã‚¿ãƒ¼ãƒ³2: Viteï¼ˆãƒ¢ãƒ€ãƒ³å‹ï¼‰ã€‘ - æ–°è¦ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ - é«˜é€Ÿãªé–‹ç™ºä½“é¨“ã‚’é‡è¦– - ãƒ¢ãƒ€ãƒ³ãƒ–ãƒ©ã‚¦ã‚¶ãŒã‚¿ãƒ¼ã‚²ãƒƒãƒˆ ã€ãƒ‘ã‚¿ãƒ¼ãƒ³3: ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã®CLIã€‘ - React: Create React App / Next.js - Vue: Vue CLI / Nuxt.js - å†…éƒ¨ã§Webpackã‚„Viteã‚’ä½¿ç”¨ 4.3 å­¦ç¿’ã®å„ªå…ˆé †ä½ # Viteï¼ˆæ¨å¥¨ï¼‰ï¼šæ–°è¦ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãªã‚‰ã“ã‚Œã‹ã‚‰å§‹ã‚ã‚‹ Webpackï¼šæ—¢å­˜ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ä½¿ã‚ã‚Œã¦ã„ã‚‹ã“ã¨ãŒå¤šã„ Babelï¼šWebpackã¨çµ„ã¿åˆã‚ã›ã¦ä½¿ã†ã€ã¾ãŸã¯å˜ä½“ã§å­¦ã¶ ã¾ã¨ã‚ # ğŸ¯ å­¦ã‚“ã ã“ã¨ # Babel # ã‚³ãƒãƒ³ãƒ‰ ç”¨é€” npx babel src -d dist srcã‚’distã«ãƒˆãƒ©ãƒ³ã‚¹ãƒ‘ã‚¤ãƒ« npx babel src -d dist --watch å¤‰æ›´ã‚’ç›£è¦–ã—ã¦è‡ªå‹•å¤‰æ› Webpack # ã‚³ãƒãƒ³ãƒ‰ ç”¨é€” npx webpack ãƒãƒ³ãƒ‰ãƒ«å®Ÿè¡Œ npx webpack --mode development é–‹ç™ºãƒ¢ãƒ¼ãƒ‰ã§ãƒ“ãƒ«ãƒ‰ npx webpack --mode production æœ¬ç•ªãƒ¢ãƒ¼ãƒ‰ã§ãƒ“ãƒ«ãƒ‰ npx webpack --watch å¤‰æ›´ã‚’ç›£è¦– Vite # ã‚³ãƒãƒ³ãƒ‰ ç”¨é€” npm create vite@latest ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä½œæˆ npm run dev é–‹ç™ºã‚µãƒ¼ãƒãƒ¼èµ·å‹• npm run build æœ¬ç•ªç”¨ãƒ“ãƒ«ãƒ‰ npm run preview ãƒ“ãƒ«ãƒ‰çµæœãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ ğŸ“š æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ— # Part 3: ã‚³ãƒ¼ãƒ‰å“è³ªãƒ„ãƒ¼ãƒ«ç·¨ï¼ˆESLintã€Prettierï¼‰ Part 4: ãã®ä»–ãƒ„ãƒ¼ãƒ«ç·¨ï¼ˆyarnã€Sassã€nvm/nodenvï¼‰ ğŸ—‘ï¸ ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ— # # å­¦ç¿’ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’å‰Šé™¤ rm -rf babel-study webpack-study vite-study å‚è€ƒè³‡æ–™ # Babelå…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ Webpackå…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ Viteå…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ ","date":"2025å¹´ 11æœˆ 30æ—¥","externalUrl":null,"permalink":"/posts/251130070132_docker-environment-nodejs-frontend-dev-tools/","section":"Posts","summary":"","title":"Dockerç’°å¢ƒã§Node.jsã‚’å­¦ã¼ã†_Part2_ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰é–‹ç™ºãƒ„ãƒ¼ãƒ«ç·¨","type":"posts"},{"content":"","date":"2025å¹´ 11æœˆ 30æ—¥","externalUrl":null,"permalink":"/tags/vite/","section":"Tags","summary":"","title":"Vite","type":"tags"},{"content":"","date":"2025å¹´ 11æœˆ 30æ—¥","externalUrl":null,"permalink":"/tags/webpack/","section":"Tags","summary":"","title":"Webpack","type":"tags"},{"content":"","date":"2025å¹´ 11æœˆ 30æ—¥","externalUrl":null,"permalink":"/tags/docker/","section":"Tags","summary":"","title":"Docker","type":"tags"},{"content":" ã¯ã˜ã‚ã« # ğŸ¯ ã“ã®ãƒ¡ãƒ¢ã§ç†è§£ã™ã¹ã3ã¤ã®è¦ç‚¹ # Dockerã«ã‚ˆã‚‹ä½¿ã„æ¨ã¦å­¦ç¿’ç’°å¢ƒã®æ§‹ç¯‰\nãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã‚’æ±šã•ãšã«Node.jsã‚’å­¦ç¿’ docker run --rmã§çµ‚äº†æ™‚ã«è‡ªå‹•å‰Šé™¤ã•ã‚Œã‚‹ç’°å¢ƒ Node.jsã®åŸºæœ¬æ¦‚å¿µã¨å½¹å‰²\nã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰JavaScriptå®Ÿè¡Œç’°å¢ƒ ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰é–‹ç™ºãƒ„ãƒ¼ãƒ«ã®åŸºç›¤ npmã‚’ä½¿ã£ãŸãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç®¡ç†ã®åŸºç¤\npackage.jsonã«ã‚ˆã‚‹ä¾å­˜é–¢ä¿‚ç®¡ç† ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã¨å®Ÿè¡Œ âš ï¸ ã‚ˆãã‚ã‚‹åˆå¿ƒè€…ã®é–“é•ã„ # âŒ Dockerã‚³ãƒ³ãƒ†ãƒŠå†…ã§ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ãŸãŒã€ãƒã‚¦ãƒ³ãƒˆã—ã¦ã„ãªã„ã®ã§æ¶ˆãˆã¦ã—ã¾ã† âŒ ã‚³ãƒ³ãƒ†ãƒŠã‚’exitã—ãŸå¾Œã€--rmã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§ã‚³ãƒ³ãƒ†ãƒŠãŒå‰Šé™¤ã•ã‚ŒãŸã“ã¨ã«æ°—ã¥ã‹ãªã„ âŒ node_modulesãƒ•ã‚©ãƒ«ãƒ€ã®è‚¥å¤§åŒ–ã‚’çŸ¥ã‚‰ãšã«ãƒ­ãƒ¼ã‚«ãƒ«ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ã—ã¾ã† âœ… ã“ã®å­¦ç¿’æ–¹æ³•ã®ãƒ¡ãƒªãƒƒãƒˆ # ğŸ§¹ ã‚¯ãƒªãƒ¼ãƒ³ãªç’°å¢ƒç¶­æŒï¼šãƒ­ãƒ¼ã‚«ãƒ«PCã«Node.jsã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ä¸è¦ ğŸ”„ å†ç¾æ€§ï¼šåŒã˜ç’°å¢ƒã‚’ä½•åº¦ã§ã‚‚å†æ§‹ç¯‰å¯èƒ½ ğŸ—‘ï¸ ä½¿ã„æ¨ã¦ï¼šå­¦ç¿’å¾Œã¯ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªå‰Šé™¤ã§å®Œå…¨ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ— ğŸ”’ éš”é›¢ï¼šä»–ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¸ã®å½±éŸ¿ãªã— å‰ææ¡ä»¶ # å¿…è¦ãªã‚‚ã® # Docker DesktopãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ã“ã¨ ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ï¼ˆã‚³ãƒãƒ³ãƒ‰ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã€PowerShellã€Terminal.appç­‰ï¼‰ã®åŸºæœ¬æ“ä½œ Dockerã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ç¢ºèª # # Dockerã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç¢ºèª docker --version # å‡ºåŠ›ä¾‹: Docker version 24.0.7, build afdd53b # DockerãŒå‹•ä½œã—ã¦ã„ã‚‹ã‹ç¢ºèª docker run hello-world Part 1: DockeråŸºç¤ï¼ˆä½¿ã„æ¨ã¦ç’°å¢ƒã®ç†è§£ï¼‰ # 1.1 ä½¿ã„æ¨ã¦ã‚³ãƒ³ãƒ†ãƒŠã®åŸºæœ¬å½¢ # # åŸºæœ¬å½¢ï¼šå¯¾è©±ãƒ¢ãƒ¼ãƒ‰ã§èµ·å‹•ã—ã€çµ‚äº†æ™‚ã«è‡ªå‹•å‰Šé™¤ docker run -it --rm \u0026lt;ã‚¤ãƒ¡ãƒ¼ã‚¸å\u0026gt; bash ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã®æ„å‘³ # ã‚ªãƒ—ã‚·ãƒ§ãƒ³ æ„å‘³ é‡è¦åº¦ -it å¯¾è©±ãƒ¢ãƒ¼ãƒ‰ï¼ˆã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã§æ“ä½œå¯èƒ½ï¼‰ â­â­â­ --rm ã‚³ãƒ³ãƒ†ãƒŠçµ‚äº†æ™‚ã«è‡ªå‹•å‰Šé™¤ â­â­â­ -v $(pwd):/work ã‚«ãƒ¬ãƒ³ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ãƒã‚¦ãƒ³ãƒˆ â­â­â­ -w /work ä½œæ¥­ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’æŒ‡å®š â­â­ 1.2 ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ®‹ã™ãƒ‘ã‚¿ãƒ¼ãƒ³ # # ãƒ­ãƒ¼ã‚«ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚³ãƒ³ãƒ†ãƒŠå†…ã«ãƒã‚¦ãƒ³ãƒˆ docker run -it --rm -v $(pwd):/work -w /work \u0026lt;ã‚¤ãƒ¡ãƒ¼ã‚¸å\u0026gt; bash é‡è¦ï¼šãƒã‚¦ãƒ³ãƒˆã—ãŸãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªï¼ˆ/workï¼‰ã§ä½œæˆã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ã¯ã€ã‚³ãƒ³ãƒ†ãƒŠçµ‚äº†å¾Œã‚‚ãƒ­ãƒ¼ã‚«ãƒ«ã«æ®‹ã‚Šã¾ã™ã€‚\nâœ… ã“ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§å­¦ã‚“ã ã“ã¨ # docker run -it --rmã§ä½¿ã„æ¨ã¦ã‚³ãƒ³ãƒ†ãƒŠã‚’èµ·å‹• -v $(pwd):/workã§ãƒ­ãƒ¼ã‚«ãƒ«ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ãƒã‚¦ãƒ³ãƒˆï¼ˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ°¸ç¶šåŒ–ï¼‰ --rmã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§ã‚³ãƒ³ãƒ†ãƒŠçµ‚äº†æ™‚ã«è‡ªå‹•å‰Šé™¤ Part 2: Node.jsæ¦‚è¦ # 2.1 Node.jsã¨ã¯ï¼Ÿ # Node.jsã¯ã€JavaScriptã‚’ã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰ã§å®Ÿè¡Œã™ã‚‹ãŸã‚ã®å®Ÿè¡Œç’°å¢ƒï¼ˆãƒ©ãƒ³ã‚¿ã‚¤ãƒ ï¼‰ã§ã™ã€‚\nJavaScriptã®å®Ÿè¡Œç’°å¢ƒã®å¤‰é· # ã€å¾“æ¥ã€‘ JavaScript â†’ ãƒ–ãƒ©ã‚¦ã‚¶ã§ã®ã¿å®Ÿè¡Œå¯èƒ½ï¼ˆã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚µã‚¤ãƒ‰ï¼‰ ã€Node.jsç™»å ´å¾Œã€‘ JavaScript â†’ ãƒ–ãƒ©ã‚¦ã‚¶ + ã‚µãƒ¼ãƒãƒ¼ + CLI + é–‹ç™ºãƒ„ãƒ¼ãƒ« Node.jsã®ç‰¹å¾´ # ç‰¹å¾´ èª¬æ˜ V8ã‚¨ãƒ³ã‚¸ãƒ³ Google Chromeã¨åŒã˜é«˜é€ŸJavaScriptã‚¨ãƒ³ã‚¸ãƒ³ ãƒãƒ³ãƒ–ãƒ­ãƒƒã‚­ãƒ³ã‚°I/O éåŒæœŸå‡¦ç†ã«ã‚ˆã‚‹é«˜ã„ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ ã‚·ãƒ³ã‚°ãƒ«ã‚¹ãƒ¬ãƒƒãƒ‰ ã‚¤ãƒ™ãƒ³ãƒˆãƒ«ãƒ¼ãƒ—ã«ã‚ˆã‚‹åŠ¹ç‡çš„ãªå‡¦ç† npm ä¸–ç•Œæœ€å¤§ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚¨ã‚³ã‚·ã‚¹ãƒ†ãƒ  2.2 ãªãœNode.jsã‚’å­¦ã¶ã®ã‹ï¼Ÿ # ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰é–‹ç™ºã«ãŠã‘ã‚‹å¿…è¦æ€§ # ç¾ä»£ã®ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰é–‹ç™ºã§ã¯ã€ä»¥ä¸‹ã®ãƒ„ãƒ¼ãƒ«ãŒNode.jsä¸Šã§å‹•ä½œã—ã¾ã™ï¼š\nãƒ„ãƒ¼ãƒ« ç”¨é€” npm / yarn ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ç®¡ç† Webpack / Vite ãƒãƒ³ãƒ‰ãƒ«ãƒ»ãƒ“ãƒ«ãƒ‰ Babel ãƒˆãƒ©ãƒ³ã‚¹ãƒ‘ã‚¤ãƒ«ï¼ˆæ–°ã—ã„JSâ†’å¤ã„JSå¤‰æ›ï¼‰ ESLint é™çš„ã‚³ãƒ¼ãƒ‰è§£æ Prettier ã‚³ãƒ¼ãƒ‰ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ Sass CSSãƒ—ãƒªãƒ—ãƒ­ã‚»ãƒƒã‚µ ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰é–‹ç™ºã§ã®æ´»ç”¨ # ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ ç”¨é€” Express Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³API NestJS ã‚¨ãƒ³ã‚¿ãƒ¼ãƒ—ãƒ©ã‚¤ã‚ºå‘ã‘ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ Next.js React SSR/SSGãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ âœ… ã“ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§å­¦ã‚“ã ã“ã¨ # Node.jsã¯JavaScriptã‚’ã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰ã§å®Ÿè¡Œã™ã‚‹ç’°å¢ƒ V8ã‚¨ãƒ³ã‚¸ãƒ³ã€ãƒãƒ³ãƒ–ãƒ­ãƒƒã‚­ãƒ³ã‚°I/Oã€npmãŒä¸»ãªç‰¹å¾´ ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰é–‹ç™ºãƒ„ãƒ¼ãƒ«ï¼ˆWebpackã€Babelã€ESLintãªã©ï¼‰ã®åŸºç›¤ Part 3: ãƒãƒ³ã‚ºã‚ªãƒ³â‘  æœ€åˆã®Node.jsä½“é¨“ # 3.1 å­¦ç¿’ç”¨ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ä½œæˆ # # ä½œæ¥­ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä½œæˆ mkdir nodejs-study \u0026amp;\u0026amp; cd nodejs-study 3.2 Node.jsã‚³ãƒ³ãƒ†ãƒŠã®èµ·å‹• # # Node.js 20ã®ã‚³ãƒ³ãƒ†ãƒŠã‚’èµ·å‹•ï¼ˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒã‚¦ãƒ³ãƒˆï¼‰ docker run -it --rm -v $(pwd):/work -w /work node:20 bash æœŸå¾…ã•ã‚Œã‚‹çµæœï¼š\nroot@ã‚³ãƒ³ãƒ†ãƒŠID:/work# ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆãŒå¤‰ã‚ã‚Šã€ã‚³ãƒ³ãƒ†ãƒŠå†…ã«å…¥ã£ãŸã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚\n3.3 Node.jsã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç¢ºèª # # ã‚³ãƒ³ãƒ†ãƒŠå†…ã§å®Ÿè¡Œ node -v # å‡ºåŠ›ä¾‹: v20.x.x npm -v # å‡ºåŠ›ä¾‹: 10.x.x 3.4 Node.jsã§Hello World # æ–¹æ³•1: å¯¾è©±ãƒ¢ãƒ¼ãƒ‰ï¼ˆREPLï¼‰ # # Node.js REPLã‚’èµ·å‹• node # ä»¥ä¸‹ã‚’REPLå†…ã§å…¥åŠ› \u0026gt; console.log(\u0026#34;Hello, Node.js!\u0026#34;); Hello, Node.js! undefined \u0026gt; 1 + 2 3 \u0026gt; const message = \u0026#34;Docker + Node.js å­¦ç¿’ä¸­ï¼\u0026#34;; undefined \u0026gt; message \u0026#39;Docker + Node.js å­¦ç¿’ä¸­ï¼\u0026#39; # REPLã‚’çµ‚äº† \u0026gt; .exit æ–¹æ³•2: ã‚¹ã‚¯ãƒªãƒ—ãƒˆãƒ•ã‚¡ã‚¤ãƒ«å®Ÿè¡Œ # # ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆ echo \u0026#39;console.log(\u0026#34;Hello from script!\u0026#34;);\u0026#39; \u0026gt; hello.js # ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œ node hello.js # å‡ºåŠ›: Hello from script! 3.5 ã‚³ãƒ³ãƒ†ãƒŠã®çµ‚äº† # # ã‚³ãƒ³ãƒ†ãƒŠã‹ã‚‰æŠœã‘ã‚‹ exit ç¢ºèªãƒã‚¤ãƒ³ãƒˆï¼šãƒ­ãƒ¼ã‚«ãƒ«ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«hello.jsãŒæ®‹ã£ã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèª\n# ãƒ­ãƒ¼ã‚«ãƒ«ã§ç¢ºèª ls # å‡ºåŠ›: hello.js cat hello.js # å‡ºåŠ›: console.log(\u0026#34;Hello from script!\u0026#34;); âœ… ã“ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§å­¦ã‚“ã ã“ã¨ # node:20ã‚¤ãƒ¡ãƒ¼ã‚¸ã§Node.jsç’°å¢ƒã‚’èµ·å‹• nodeã‚³ãƒãƒ³ãƒ‰ã§REPLï¼ˆå¯¾è©±ãƒ¢ãƒ¼ãƒ‰ï¼‰ã‚’èµ·å‹• node \u0026lt;file.js\u0026gt;ã§ã‚¹ã‚¯ãƒªãƒ—ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’å®Ÿè¡Œ ãƒã‚¦ãƒ³ãƒˆã—ãŸãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ä½œæˆã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ã¯ã‚³ãƒ³ãƒ†ãƒŠçµ‚äº†å¾Œã‚‚æ®‹ã‚‹ Part 4: ãƒãƒ³ã‚ºã‚ªãƒ³â‘¡ npmãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®åˆæœŸåŒ– # 4.1 ã‚³ãƒ³ãƒ†ãƒŠã®å†èµ·å‹• # # åŒã˜ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã§ docker run -it --rm -v $(pwd):/work -w /work node:20 bash 4.2 package.jsonã®ä½œæˆ # # å¯¾è©±å½¢å¼ã§åˆæœŸåŒ– npm init # ã¾ãŸã¯ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆè¨­å®šã§ä¸€æ‹¬ä½œæˆ npm init -y å¯¾è©±å½¢å¼ã§ã®è³ªå•ã¨å›ç­”ä¾‹ # package name: (work) my-first-nodejs version: (1.0.0) description: Node.jså­¦ç¿’ç”¨ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ entry point: (index.js) test command: git repository: keywords: nodejs, learning author: Your Name license: (ISC) MIT ç”Ÿæˆã•ã‚Œã‚‹package.json # { \u0026#34;name\u0026#34;: \u0026#34;my-first-nodejs\u0026#34;, \u0026#34;version\u0026#34;: \u0026#34;1.0.0\u0026#34;, \u0026#34;description\u0026#34;: \u0026#34;Node.jså­¦ç¿’ç”¨ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ\u0026#34;, \u0026#34;main\u0026#34;: \u0026#34;index.js\u0026#34;, \u0026#34;scripts\u0026#34;: { \u0026#34;test\u0026#34;: \u0026#34;echo \\\u0026#34;Error: no test specified\\\u0026#34; \u0026amp;\u0026amp; exit 1\u0026#34; }, \u0026#34;keywords\u0026#34;: [ \u0026#34;nodejs\u0026#34;, \u0026#34;learning\u0026#34; ], \u0026#34;author\u0026#34;: \u0026#34;Your Name\u0026#34;, \u0026#34;license\u0026#34;: \u0026#34;MIT\u0026#34; } 4.3 package.jsonã®é‡è¦ãªé …ç›® # ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ å½¹å‰² ä¾‹ name ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå my-first-nodejs version ãƒãƒ¼ã‚¸ãƒ§ãƒ³ 1.0.0 main ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆ index.js scripts npmã‚¹ã‚¯ãƒªãƒ—ãƒˆ { \u0026quot;start\u0026quot;: \u0026quot;node index.js\u0026quot; } dependencies æœ¬ç•ªç”¨ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ { \u0026quot;express\u0026quot;: \u0026quot;^4.18.0\u0026quot; } devDependencies é–‹ç™ºç”¨ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ { \u0026quot;nodemon\u0026quot;: \u0026quot;^3.0.0\u0026quot; } âœ… ã“ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§å­¦ã‚“ã ã“ã¨ # npm init -yã§package.jsonã‚’ä½œæˆ package.jsonã¯ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆåå‰ã€ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã€ä¾å­˜é–¢ä¿‚ãªã©ï¼‰ scriptsãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã§npmã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®šç¾© Part 5: ãƒãƒ³ã‚ºã‚ªãƒ³â‘¢ ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« # 5.1 ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ä½“é¨“ # # äººæ°—ã®ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« npm install lodash å®Ÿè¡Œçµæœã®ä¾‹ # added 1 package, and audited 2 packages in 1s found 0 vulnerabilities 5.2 ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å¾Œã®å¤‰åŒ–ã‚’ç¢ºèª # # package.jsonã®ç¢ºèª cat package.json { \u0026#34;name\u0026#34;: \u0026#34;my-first-nodejs\u0026#34;, \u0026#34;version\u0026#34;: \u0026#34;1.0.0\u0026#34;, \u0026#34;dependencies\u0026#34;: { \u0026#34;lodash\u0026#34;: \u0026#34;^4.17.21\u0026#34; // â† è¿½åŠ ã•ã‚ŒãŸï¼ } } # node_modulesãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ç¢ºèª ls node_modules/ # å‡ºåŠ›: lodash 5.3 ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ãŸãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ä½¿ã† # # index.jsãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆ cat \u0026lt;\u0026lt; \u0026#39;EOF\u0026#39; \u0026gt; index.js // lodashã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆ const _ = require(\u0026#39;lodash\u0026#39;); // é…åˆ—æ“ä½œã®ä¾‹ const numbers = [1, 2, 3, 4, 5]; const doubled = _.map(numbers, n =\u0026gt; n * 2); console.log(\u0026#39;å…ƒã®é…åˆ—:\u0026#39;, numbers); console.log(\u0026#39;2å€ã«ã—ãŸé…åˆ—:\u0026#39;, doubled); // ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæ“ä½œã®ä¾‹ const users = [ { name: \u0026#39;Alice\u0026#39;, age: 25 }, { name: \u0026#39;Bob\u0026#39;, age: 30 }, { name: \u0026#39;Charlie\u0026#39;, age: 25 } ]; const grouped = _.groupBy(users, \u0026#39;age\u0026#39;); console.log(\u0026#39;å¹´é½¢ã§ã‚°ãƒ«ãƒ¼ãƒ—åŒ–:\u0026#39;, grouped); EOF # å®Ÿè¡Œ node index.js æœŸå¾…ã•ã‚Œã‚‹å‡ºåŠ› # å…ƒã®é…åˆ—: [ 1, 2, 3, 4, 5 ] 2å€ã«ã—ãŸé…åˆ—: [ 2, 4, 6, 8, 10 ] å¹´é½¢ã§ã‚°ãƒ«ãƒ¼ãƒ—åŒ–: { \u0026#39;25\u0026#39;: [ { name: \u0026#39;Alice\u0026#39;, age: 25 }, { name: \u0026#39;Charlie\u0026#39;, age: 25 } ], \u0026#39;30\u0026#39;: [ { name: \u0026#39;Bob\u0026#39;, age: 30 } ] } 5.4 npmã‚¹ã‚¯ãƒªãƒ—ãƒˆã®è¨­å®š # # package.jsonã®scriptsã‚’ç·¨é›† cat \u0026lt;\u0026lt; \u0026#39;EOF\u0026#39; \u0026gt; package.json { \u0026#34;name\u0026#34;: \u0026#34;my-first-nodejs\u0026#34;, \u0026#34;version\u0026#34;: \u0026#34;1.0.0\u0026#34;, \u0026#34;description\u0026#34;: \u0026#34;Node.jså­¦ç¿’ç”¨ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ\u0026#34;, \u0026#34;main\u0026#34;: \u0026#34;index.js\u0026#34;, \u0026#34;scripts\u0026#34;: { \u0026#34;start\u0026#34;: \u0026#34;node index.js\u0026#34;, \u0026#34;hello\u0026#34;: \u0026#34;echo \u0026#39;Hello from npm script!\u0026#39;\u0026#34; }, \u0026#34;dependencies\u0026#34;: { \u0026#34;lodash\u0026#34;: \u0026#34;^4.17.21\u0026#34; } } EOF # ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œ npm run hello # å‡ºåŠ›: Hello from npm script! npm start # index.jsã®å®Ÿè¡ŒçµæœãŒè¡¨ç¤ºã•ã‚Œã‚‹ âœ… ã“ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§å­¦ã‚“ã ã“ã¨ # npm install \u0026lt;pkg\u0026gt;ã§ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ãŸãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¯node_modules/ã«é…ç½® require()ã§ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ã¦ä½¿ç”¨ npm run \u0026lt;script\u0026gt;ã§npmã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œ Part 6: ãƒãƒ³ã‚ºã‚ªãƒ³â‘£ é–‹ç™ºç”¨ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ # 6.1 devDependenciesã¨ã¯ # ç¨®é¡ ç”¨é€” ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã‚³ãƒãƒ³ãƒ‰ dependencies æœ¬ç•ªç’°å¢ƒã§å¿…è¦ npm install \u0026lt;pkg\u0026gt; devDependencies é–‹ç™ºæ™‚ã®ã¿å¿…è¦ npm install -D \u0026lt;pkg\u0026gt; 6.2 nodemonã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« # # é–‹ç™ºç”¨ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¨ã—ã¦ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« npm install -D nodemon package.jsonã®å¤‰åŒ– # { \u0026#34;dependencies\u0026#34;: { \u0026#34;lodash\u0026#34;: \u0026#34;^4.17.21\u0026#34; }, \u0026#34;devDependencies\u0026#34;: { \u0026#34;nodemon\u0026#34;: \u0026#34;^3.0.0\u0026#34; // â† è¿½åŠ ã•ã‚ŒãŸï¼ } } 6.3 nodemonã‚’ä½¿ã£ãŸé–‹ç™ºä½“é¨“ # # package.jsonã®scriptsã‚’æ›´æ–° cat \u0026lt;\u0026lt; \u0026#39;EOF\u0026#39; \u0026gt; package.json { \u0026#34;name\u0026#34;: \u0026#34;my-first-nodejs\u0026#34;, \u0026#34;version\u0026#34;: \u0026#34;1.0.0\u0026#34;, \u0026#34;main\u0026#34;: \u0026#34;index.js\u0026#34;, \u0026#34;scripts\u0026#34;: { \u0026#34;start\u0026#34;: \u0026#34;node index.js\u0026#34;, \u0026#34;dev\u0026#34;: \u0026#34;nodemon index.js\u0026#34; }, \u0026#34;dependencies\u0026#34;: { \u0026#34;lodash\u0026#34;: \u0026#34;^4.17.21\u0026#34; }, \u0026#34;devDependencies\u0026#34;: { \u0026#34;nodemon\u0026#34;: \u0026#34;^3.0.0\u0026#34; } } EOF # nodemonã§èµ·å‹•ï¼ˆãƒ•ã‚¡ã‚¤ãƒ«å¤‰æ›´ã‚’ç›£è¦–ï¼‰ npm run dev nodemonã®ç‰¹å¾´ï¼š\nãƒ•ã‚¡ã‚¤ãƒ«ã®å¤‰æ›´ã‚’æ¤œçŸ¥ã—ã¦è‡ªå‹•ã§å†èµ·å‹• é–‹ç™ºåŠ¹ç‡ãŒå¤§å¹…ã«å‘ä¸Š Ctrl + Cã§çµ‚äº† 6.4 ã‚³ãƒ³ãƒ†ãƒŠã‚’çµ‚äº† # exit âœ… ã“ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§å­¦ã‚“ã ã“ã¨ # npm install -D \u0026lt;pkg\u0026gt;ã§é–‹ç™ºç”¨ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« dependenciesã¯æœ¬ç•ªç’°å¢ƒã§å¿…è¦ã€devDependenciesã¯é–‹ç™ºæ™‚ã®ã¿å¿…è¦ nodemonã¯ãƒ•ã‚¡ã‚¤ãƒ«å¤‰æ›´ã‚’æ¤œçŸ¥ã—ã¦è‡ªå‹•å†èµ·å‹•ã™ã‚‹ãƒ„ãƒ¼ãƒ« Part 7: ãƒãƒ³ã‚ºã‚ªãƒ³â‘¤ ä¾å­˜é–¢ä¿‚ã®å†ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« # 7.1 node_modulesã‚’å‰Šé™¤ã—ã¦ã¿ã‚‹ # # ãƒ­ãƒ¼ã‚«ãƒ«ã§å®Ÿè¡Œï¼ˆã‚³ãƒ³ãƒ†ãƒŠã®å¤–ï¼‰ rm -rf node_modules ls # å‡ºåŠ›: hello.js index.js package-lock.json package.json 7.2 npm installã§å¾©å…ƒ # # ã‚³ãƒ³ãƒ†ãƒŠã‚’èµ·å‹• docker run -it --rm -v $(pwd):/work -w /work node:20 bash # ä¾å­˜é–¢ä¿‚ã‚’å†ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« npm install å®Ÿè¡Œçµæœ # added 2 packages, and audited 3 packages in 2s found 0 vulnerabilities é‡è¦ï¼špackage.jsonãŒã‚ã‚Œã°ã€npm installã§ä¾å­˜ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’å®Œå…¨ã«å¾©å…ƒã§ãã¾ã™ã€‚\n7.3 package-lock.jsonã®å½¹å‰² # ãƒ•ã‚¡ã‚¤ãƒ« å½¹å‰² package.json å¿…è¦ãªãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¨ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç¯„å›²ã‚’è¨˜éŒ² package-lock.json å®Ÿéš›ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚ŒãŸæ­£ç¢ºãªãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’è¨˜éŒ² ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ï¼š\nâœ… package.jsonã¨package-lock.jsonã¯Gitã«ã‚³ãƒŸãƒƒãƒˆ âŒ node_modulesã¯Gitã«ã‚³ãƒŸãƒƒãƒˆã—ãªã„ âœ… ã“ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§å­¦ã‚“ã ã“ã¨ # node_modulesã‚’å‰Šé™¤ã—ã¦ã‚‚npm installã§å¾©å…ƒå¯èƒ½ package-lock.jsonã¯æ­£ç¢ºãªãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’è¨˜éŒ² node_modulesã¯Gitã«ã‚³ãƒŸãƒƒãƒˆã—ãªã„ï¼ˆpackage.jsonã‹ã‚‰å¾©å…ƒå¯èƒ½ï¼‰ Part 8: ãƒãƒ³ã‚ºã‚ªãƒ³â‘¥ ç°¡å˜ãªWebã‚µãƒ¼ãƒãƒ¼ # 8.1 Expressã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« # # ã‚³ãƒ³ãƒ†ãƒŠå†…ã§ npm install express 8.2 Webã‚µãƒ¼ãƒãƒ¼ã®ä½œæˆ # # server.jsã‚’ä½œæˆ cat \u0026lt;\u0026lt; \u0026#39;EOF\u0026#39; \u0026gt; server.js const express = require(\u0026#39;express\u0026#39;); const app = express(); const PORT = 3000; // ãƒ«ãƒ¼ãƒˆãƒ‘ã‚¹ã¸ã®GETãƒªã‚¯ã‚¨ã‚¹ãƒˆ app.get(\u0026#39;/\u0026#39;, (req, res) =\u0026gt; { res.send(\u0026#39;Hello from Express in Docker!\u0026#39;); }); // JSONã‚’è¿”ã™API app.get(\u0026#39;/api/info\u0026#39;, (req, res) =\u0026gt; { res.json({ message: \u0026#39;Docker + Node.js + Express\u0026#39;, timestamp: new Date().toISOString(), nodeVersion: process.version }); }); // ã‚µãƒ¼ãƒãƒ¼èµ·å‹• app.listen(PORT, () =\u0026gt; { console.log(`Server running at http://localhost:${PORT}`); }); EOF 8.3 ãƒãƒ¼ãƒˆã‚’å…¬é–‹ã—ã¦ã‚³ãƒ³ãƒ†ãƒŠã‚’èµ·å‹• # # ä¸€åº¦exitã—ã¦ã‹ã‚‰ã€ãƒãƒ¼ãƒˆæŒ‡å®šã§å†èµ·å‹• exit # ãƒãƒ¼ãƒˆ3000ã‚’å…¬é–‹ã—ã¦ã‚³ãƒ³ãƒ†ãƒŠã‚’èµ·å‹• docker run -it --rm -v $(pwd):/work -w /work -p 3000:3000 node:20 bash # ã‚µãƒ¼ãƒãƒ¼ã‚’èµ·å‹• node server.js 8.4 å‹•ä½œç¢ºèª # åˆ¥ã®ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã‚’é–‹ã„ã¦ï¼š\n# curlã§ç¢ºèª curl http://localhost:3000 # å‡ºåŠ›: Hello from Express in Docker! curl http://localhost:3000/api/info # å‡ºåŠ›: {\u0026#34;message\u0026#34;:\u0026#34;Docker + Node.js + Express\u0026#34;,\u0026#34;timestamp\u0026#34;:\u0026#34;...\u0026#34;,\u0026#34;nodeVersion\u0026#34;:\u0026#34;v20.x.x\u0026#34;} ã¾ãŸã¯ãƒ–ãƒ©ã‚¦ã‚¶ã§ http://localhost:3000 ã«ã‚¢ã‚¯ã‚»ã‚¹\n8.5 ã‚µãƒ¼ãƒãƒ¼ã®åœæ­¢ # # Ctrl + C ã§ã‚µãƒ¼ãƒãƒ¼åœæ­¢ # exitã§ã‚³ãƒ³ãƒ†ãƒŠçµ‚äº† exit âœ… ã“ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§å­¦ã‚“ã ã“ã¨ # Expressã¯äººæ°—ã®Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ -p 3000:3000ã§ã‚³ãƒ³ãƒ†ãƒŠã®ãƒãƒ¼ãƒˆã‚’ãƒ›ã‚¹ãƒˆã«å…¬é–‹ app.get()ã§ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚’å®šç¾©ã€res.send()/res.json()ã§ãƒ¬ã‚¹ãƒãƒ³ã‚¹ Part 9: å¾Œç‰‡ä»˜ã‘ã¨å­¦ç¿’ã®æŒ¯ã‚Šè¿”ã‚Š # 9.1 å­¦ç¿’ãƒ•ã‚¡ã‚¤ãƒ«ã®ç¢ºèª # # ãƒ­ãƒ¼ã‚«ãƒ«ã§ç¢ºèª ls -la # å‡ºåŠ›: # hello.js # index.js # node_modules/ # package-lock.json # package.json # server.js 9.2 ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ— # # å­¦ç¿’ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’å‰Šé™¤ cd .. rm -rf nodejs-study # ã¾ãŸã¯ã€node_modulesã ã‘å‰Šé™¤ã—ã¦è»½é‡åŒ– rm -rf nodejs-study/node_modules âœ… ã“ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§å­¦ã‚“ã ã“ã¨ # å­¦ç¿’å¾Œã¯rm -rf \u0026lt;directory\u0026gt;ã§ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ— node_modulesã ã‘å‰Šé™¤ã™ã‚Œã°ãƒ‡ã‚£ã‚¹ã‚¯å®¹é‡ã‚’ç¯€ç´„ã§ãã‚‹ å¿…è¦ã«ãªã£ãŸã‚‰npm installã§å¾©å…ƒå¯èƒ½ ã¾ã¨ã‚ # ğŸ¯ å­¦ã‚“ã ã“ã¨ # Dockeré–¢é€£ # ã‚³ãƒãƒ³ãƒ‰ ç”¨é€” docker run -it --rm ä½¿ã„æ¨ã¦ã‚³ãƒ³ãƒ†ãƒŠã‚’èµ·å‹• -v $(pwd):/work ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ãƒã‚¦ãƒ³ãƒˆ -w /work ä½œæ¥­ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’è¨­å®š -p 3000:3000 ãƒãƒ¼ãƒˆã‚’å…¬é–‹ Node.jsé–¢é€£ # ã‚³ãƒãƒ³ãƒ‰ ç”¨é€” node -v ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç¢ºèª node \u0026lt;file.js\u0026gt; ã‚¹ã‚¯ãƒªãƒ—ãƒˆå®Ÿè¡Œ node REPLèµ·å‹• npmé–¢é€£ # ã‚³ãƒãƒ³ãƒ‰ ç”¨é€” npm init -y ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåˆæœŸåŒ– npm install \u0026lt;pkg\u0026gt; ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« npm install -D \u0026lt;pkg\u0026gt; é–‹ç™ºç”¨ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« npm install ä¾å­˜é–¢ä¿‚ã‚’å†ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« npm run \u0026lt;script\u0026gt; ã‚¹ã‚¯ãƒªãƒ—ãƒˆå®Ÿè¡Œ ğŸ“š æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ— # npm / yarn ã®æ·±æ˜ã‚Š\nã‚»ãƒãƒ³ãƒ†ã‚£ãƒƒã‚¯ãƒãƒ¼ã‚¸ãƒ§ãƒ‹ãƒ³ã‚° ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« vs ãƒ­ãƒ¼ã‚«ãƒ«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰é–‹ç™ºãƒ„ãƒ¼ãƒ«\nWebpack / Vite ã§ã®ãƒãƒ³ãƒ‰ãƒ« Babel ã§ã®ãƒˆãƒ©ãƒ³ã‚¹ãƒ‘ã‚¤ãƒ« ESLint / Prettier ã§ã®ã‚³ãƒ¼ãƒ‰å“è³ªç®¡ç† ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰é–‹ç™º\nExpress ã§ã® REST API æ§‹ç¯‰ ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹é€£æº Node.jsãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†\nnvm / nodenv ã§ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³åˆ‡ã‚Šæ›¿ãˆ ğŸ’¡ Tips: å­¦ç¿’ç”¨ã‚³ãƒãƒ³ãƒ‰ãƒãƒ¼ãƒˆã‚·ãƒ¼ãƒˆ # # Node.jså­¦ç¿’ç’°å¢ƒã‚’ä¸€ç™ºã§èµ·å‹• mkdir study \u0026amp;\u0026amp; cd study docker run -it --rm -v $(pwd):/work -w /work node:20 bash # ãƒãƒ¼ãƒˆå…¬é–‹ä»˜ãï¼ˆWebã‚µãƒ¼ãƒãƒ¼å­¦ç¿’ç”¨ï¼‰ docker run -it --rm -v $(pwd):/work -w /work -p 3000:3000 node:20 bash # ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåˆæœŸåŒ–ã‹ã‚‰ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã¾ã§ npm init -y \u0026amp;\u0026amp; npm install express # å­¦ç¿’çµ‚äº†å¾Œã®ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ— cd .. \u0026amp;\u0026amp; rm -rf study å‚è€ƒè³‡æ–™ # Dockerå…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ Node.jså…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ npmå…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ Expresså…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ ","date":"2025å¹´ 11æœˆ 30æ—¥","externalUrl":null,"permalink":"/posts/251130065841_docker-environment-nodejs-basics-part1/","section":"Posts","summary":"","title":"Dockerç’°å¢ƒã§Node.jsã‚’å­¦ã¼ã†_Part1_Node.jsåŸºç¤ç·¨","type":"posts"},{"content":"","date":"2025å¹´ 11æœˆ 30æ—¥","externalUrl":null,"permalink":"/tags/node.js/","section":"Tags","summary":"","title":"Node.js","type":"tags"},{"content":" ä»Šæ—¥å­¦ã‚“ã ã“ã¨ # å‰å›ã®è¨˜äº‹ã§ãƒ•ã‚¡ã‚¤ãƒ«ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã«ã‚ˆã‚‹ç’°å¢ƒåˆ†é›¢ã‚’å­¦ã‚“ã ãŒã€ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ã¨æœ¬ç•ªã§åŒã˜ã‚³ãƒ¼ãƒ‰ã‚’é‡è¤‡ã—ã¦æ›¸ãå•é¡ŒãŒæ®‹ã£ã¦ã„ãŸã€‚ä»Šå›ã¯Terraformãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ä½¿ã£ã¦ã€DRYåŸå‰‡ã‚’ã‚¤ãƒ³ãƒ•ãƒ©ã‚³ãƒ¼ãƒ‰ã«é©ç”¨ã™ã‚‹æ–¹æ³•ã‚’å­¦ã‚“ã ã€‚\nãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«åŒ–ã§å¾—ã‚‰ã‚Œã‚‹ãƒ¡ãƒªãƒƒãƒˆ # ãƒ¡ãƒªãƒƒãƒˆ èª¬æ˜ DRYåŸå‰‡ åŒã˜ã‚³ãƒ¼ãƒ‰ã‚’è¤‡æ•°ç’°å¢ƒã§å†åˆ©ç”¨ ä¿å®ˆæ€§ 1ç®‡æ‰€ã®ä¿®æ­£ã§å…¨ç’°å¢ƒã«åæ˜  æŸ”è»Ÿæ€§ å…¥åŠ›å¤‰æ•°ã§ç’°å¢ƒã”ã¨ã®ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º å®‰å…¨æ€§ ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†ã§ãƒ†ã‚¹ãƒˆæ¸ˆã¿ã‚³ãƒ¼ãƒ‰ã®ã¿æœ¬ç•ªé©ç”¨ ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã¨ã¯ # ãƒ•ã‚©ãƒ«ãƒ€å†…ã«ã‚ã‚‹Terraformè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆ.tfãƒ•ã‚¡ã‚¤ãƒ«ï¼‰ã®é›†ã¾ã‚Š = ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«\nã¤ã¾ã‚Šã€ã“ã‚Œã¾ã§ä½œæˆã—ã¦ããŸãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚‚ã€Œãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã€ã¨ã„ãˆã‚‹ã€‚\nç¨®é¡ èª¬æ˜ ãƒ«ãƒ¼ãƒˆãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ« terraform applyã‚’ç›´æ¥å®Ÿè¡Œã™ã‚‹ãƒ•ã‚©ãƒ«ãƒ€ å†åˆ©ç”¨å¯èƒ½ãªãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ« ä»–ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‹ã‚‰å‘¼ã³å‡ºã•ã‚Œã‚‹ãƒ•ã‚©ãƒ«ãƒ€ åŸºæœ¬æ§‹æ–‡ # module \u0026#34;\u0026lt;NAME\u0026gt;\u0026#34; { source = \u0026#34;\u0026lt;SOURCE\u0026gt;\u0026#34; # è¨­å®šï¼ˆå…¥åŠ›å¤‰æ•°ãªã©ï¼‰ } sourceã«ã¯ãƒ­ãƒ¼ã‚«ãƒ«ãƒ‘ã‚¹ã€GitHub URLã€Terraform Registryãªã©ã‚’æŒ‡å®šã§ãã‚‹ã€‚\nãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆã®å¤‰æ›´ # å‰å›ã®stage/ã®ã¿ã®æ§‹æˆã‹ã‚‰ã€ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’åˆ†é›¢ã—ãŸæ§‹æˆã«å¤‰æ›´ã€‚\nâ”œâ”€â”€ modules/ # å†åˆ©ç”¨å¯èƒ½ãªãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ« â”‚ â””â”€â”€ services/ â”‚ â””â”€â”€ webserver-cluster/ â”‚ â”œâ”€â”€ main.tf â”‚ â”œâ”€â”€ variables.tf â”‚ â”œâ”€â”€ outputs.tf â”‚ â””â”€â”€ user-data.sh â”‚ â””â”€â”€ live/ â”œâ”€â”€ stage/ # ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ç’°å¢ƒ â”‚ â””â”€â”€ services/ â”‚ â””â”€â”€ webserver-cluster/ â”‚ â””â”€â”€ main.tf â””â”€â”€ prod/ # æœ¬ç•ªç’°å¢ƒ â””â”€â”€ services/ â””â”€â”€ webserver-cluster/ â””â”€â”€ main.tf ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª å½¹å‰² modules/ ç’°å¢ƒã«ä¾å­˜ã—ãªã„å†åˆ©ç”¨å¯èƒ½ã‚³ãƒ¼ãƒ‰ live/stage/ ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ç’°å¢ƒã®ãƒ«ãƒ¼ãƒˆãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ« live/prod/ æœ¬ç•ªç’°å¢ƒã®ãƒ«ãƒ¼ãƒˆãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ« ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®æ§‹æˆè¦ç´  # ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã®é–¢æ•°ã¨å¯¾æ¯”ã™ã‚‹ã¨ç†è§£ã—ã‚„ã™ã„ã€‚\nTerraformãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ« ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚° èª¬æ˜ ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ« é–¢æ•° å†åˆ©ç”¨å¯èƒ½ãªã‚³ãƒ¼ãƒ‰ã®å¡Š variable å¼•æ•° ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã«å€¤ã‚’æ¸¡ã™ locals ãƒ­ãƒ¼ã‚«ãƒ«å¤‰æ•° ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«å†…éƒ¨ã®è¨ˆç®—ãƒ»å®šæ•° output æˆ»ã‚Šå€¤ ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‹ã‚‰å€¤ã‚’è¿”ã™ ä»¥é™ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§ã€ãã‚Œãã‚Œã®è©³ç´°ã¨ä½¿ã„æ–¹ã‚’è¦‹ã¦ã„ãã€‚\nå…¥åŠ›å¤‰æ•°ï¼ˆvariableï¼‰ # ãªãœå¿…è¦ã‹ # å‰å›ã®ã‚³ãƒ¼ãƒ‰ã«ã¯ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‰ã•ã‚ŒãŸå€¤ãŒå¤šã„ã€‚\nãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‰ å•é¡Œ instance_type = \u0026quot;t2.micro\u0026quot; prodã§ã¯å¤§ãã„ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãŒå¿…è¦ min_size = 2 ç’°å¢ƒã”ã¨ã«ã‚¹ã‚±ãƒ¼ãƒ«ã‚’å¤‰ãˆãŸã„ key = \u0026quot;stage/...\u0026quot; prodã§ä½¿ã†ã¨stageã®DBã‚’å‚ç…§ å®šç¾©ä¾‹ # modules/services/webserver-cluster/variables.tf\nvariable \u0026#34;cluster_name\u0026#34; { description = \u0026#34;ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ãƒªã‚½ãƒ¼ã‚¹ã®åå‰\u0026#34; type = string } variable \u0026#34;instance_type\u0026#34; { description = \u0026#34;èµ·å‹•ã™ã‚‹EC2ã‚¿ã‚¤ãƒ—ã®ç¨®é¡\u0026#34; type = string } variable \u0026#34;min_size\u0026#34; { description = \u0026#34;EC2ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®ASGã®æœ€å°å€¤\u0026#34; type = number } variable \u0026#34;max_size\u0026#34; { description = \u0026#34;EC2ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®ASGã®æœ€å¤§å€¤\u0026#34; type = number } variable \u0026#34;db_remote_state_bucket\u0026#34; { description = \u0026#34;S3ãƒã‚±ãƒƒãƒˆã®åå‰ï¼ˆãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ãƒªãƒ¢ãƒ¼ãƒˆã‚¹ãƒ†ãƒ¼ãƒˆï¼‰\u0026#34; type = string } variable \u0026#34;db_remote_state_key\u0026#34; { description = \u0026#34;S3ã§ã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ãƒªãƒ¢ãƒ¼ãƒˆã‚¹ãƒ†ãƒ¼ãƒˆã®ãƒ‘ã‚¹\u0026#34; type = string } å‘¼ã³å‡ºã—å´ã§ã®å€¤ã®æŒ‡å®š # live/stage/services/webserver-cluster/main.tf\nprovider \u0026#34;aws\u0026#34; { region = \u0026#34;ap-northeast-1\u0026#34; } module \u0026#34;webserver_cluster\u0026#34; { source = \u0026#34;../../../modules/services/webserver-cluster\u0026#34; cluster_name = \u0026#34;webservers-stage\u0026#34; db_remote_state_bucket = \u0026#34;tf-state-backend-20251128\u0026#34; db_remote_state_key = \u0026#34;stage/data-stores/mysql/terraform.tfstate\u0026#34; instance_type = \u0026#34;t2.micro\u0026#34; min_size = 2 max_size = 2 } live/prod/services/webserver-cluster/main.tf\nmodule \u0026#34;webserver_cluster\u0026#34; { source = \u0026#34;../../../modules/services/webserver-cluster\u0026#34; cluster_name = \u0026#34;webservers-prod\u0026#34; db_remote_state_bucket = \u0026#34;tf-state-backend-20251128\u0026#34; db_remote_state_key = \u0026#34;prod/data-stores/mysql/terraform.tfstate\u0026#34; instance_type = \u0026#34;m4.large\u0026#34; # ã‚ˆã‚Šå¤§ãã„ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ min_size = 2 max_size = 10 # ã‚¹ã‚±ãƒ¼ãƒ«ã‚¢ã‚¦ãƒˆå¯èƒ½ } ãƒ­ãƒ¼ã‚«ãƒ«å€¤ï¼ˆlocalsï¼‰ # variable ã¨ã®é•ã„ # ç¨®é¡ å¤–éƒ¨ã‹ã‚‰è¨­å®š ç”¨é€” variable å¯èƒ½ ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®APIï¼ˆå¤–éƒ¨ã«å…¬é–‹ï¼‰ locals ä¸å¯ ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«å†…éƒ¨ã®å®šæ•°ãƒ»è¨ˆç®— ãƒãƒ¼ãƒˆç•ªå·ãªã©å¤‰æ›´ã•ã‚ŒãŸããªã„å€¤ã¯localsã§å®šç¾©ã™ã‚‹ã€‚\nlocals { http_port = 80 any_port = 0 any_protocol = \u0026#34;-1\u0026#34; tcp_protocol = \u0026#34;tcp\u0026#34; all_ips = [\u0026#34;0.0.0.0/0\u0026#34;] } resource \u0026#34;aws_security_group_rule\u0026#34; \u0026#34;allow_http_inbound\u0026#34; { type = \u0026#34;ingress\u0026#34; security_group_id = aws_security_group.alb.id from_port = local.http_port # 80 to_port = local.http_port protocol = local.tcp_protocol cidr_blocks = local.all_ips } ãƒã‚¸ãƒƒã‚¯ãƒŠãƒ³ãƒãƒ¼ 80 ã‚ˆã‚Š local.http_port ã®æ–¹ãŒæ„å›³ãŒæ˜ç¢ºã€‚\nå‡ºåŠ›ï¼ˆoutputï¼‰ # ãªãœå¿…è¦ã‹ # æœ¬ç•ªç’°å¢ƒã®ã¿ã«ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«è¨­å®šã‚’è¿½åŠ ã—ãŸã„å ´åˆã€ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«å†…ã®ASGåã‚’å¤–éƒ¨ã‹ã‚‰å‚ç…§ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚\nmodules/services/webserver-cluster/outputs.tf\noutput \u0026#34;asg_name\u0026#34; { value = aws_autoscaling_group.example.name description = \u0026#34;The name of the Auto Scaling Group\u0026#34; } output \u0026#34;alb_security_group_id\u0026#34; { value = aws_security_group.alb.id description = \u0026#34;ALBã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚°ãƒ«ãƒ¼ãƒ—ID\u0026#34; } live/prod/main.tfï¼ˆæœ¬ç•ªã®ã¿ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«è¿½åŠ ï¼‰\nresource \u0026#34;aws_autoscaling_schedule\u0026#34; \u0026#34;scale_out_during_business_hours\u0026#34; { scheduled_action_name = \u0026#34;scale-out-during-business-hours\u0026#34; min_size = 2 max_size = 10 desired_capacity = 10 recurrence = \u0026#34;0 9 * * *\u0026#34; # æ¯æ—¥9æ™‚ autoscaling_group_name = module.webserver_cluster.asg_name # å‡ºåŠ›ã‚’å‚ç…§ } æ³¨æ„ç‚¹1: ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ # å•é¡Œ # ç›¸å¯¾ãƒ‘ã‚¹ \u0026quot;user-data.sh\u0026quot; ã¯ãƒ«ãƒ¼ãƒˆãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‹ã‚‰ã®ç›¸å¯¾ãƒ‘ã‚¹ã¨ã—ã¦è§£é‡ˆã•ã‚Œã‚‹ã€‚ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«å†…ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‚ç…§ã§ããªã„ã€‚\nè§£æ±ºç­–: path.module # # Beforeï¼ˆå‹•ã‹ãªã„ï¼‰ user_data = base64encode(templatefile(\u0026#34;user-data.sh\u0026#34;, { ... })) # Afterï¼ˆæ­£ã—ãå‹•ãï¼‰ user_data = base64encode(templatefile(\u0026#34;${path.module}/user-data.sh\u0026#34;, { ... })) ãƒ‘ã‚¹å‚ç…§ æŒ‡ã™å ´æ‰€ path.module ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«å®šç¾©ãŒã‚ã‚‹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª path.root ãƒ«ãƒ¼ãƒˆãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª path.cwd terraform applyã‚’å®Ÿè¡Œã—ãŸãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª æ³¨æ„ç‚¹2: ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ãƒ–ãƒ­ãƒƒã‚¯ # å•é¡Œ # ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚°ãƒ«ãƒ¼ãƒ—ã®ingress/egressã«ã¯2ã¤ã®æ›¸ãæ–¹ãŒã‚ã‚‹ã€‚\nã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ãƒ–ãƒ­ãƒƒã‚¯\nresource \u0026#34;aws_security_group\u0026#34; \u0026#34;alb\u0026#34; { name = \u0026#34;${var.cluster_name}-alb\u0026#34; ingress { # ãƒªã‚½ãƒ¼ã‚¹å†…ã«ç›´æ¥æ›¸ã from_port = 80 to_port = 80 protocol = \u0026#34;tcp\u0026#34; cidr_blocks = [\u0026#34;0.0.0.0/0\u0026#34;] } } åˆ¥ãƒªã‚½ãƒ¼ã‚¹\nresource \u0026#34;aws_security_group\u0026#34; \u0026#34;alb\u0026#34; { name = \u0026#34;${var.cluster_name}-alb\u0026#34; } resource \u0026#34;aws_security_group_rule\u0026#34; \u0026#34;allow_http\u0026#34; { type = \u0026#34;ingress\u0026#34; security_group_id = aws_security_group.alb.id from_port = 80 to_port = 80 protocol = \u0026#34;tcp\u0026#34; cidr_blocks = [\u0026#34;0.0.0.0/0\u0026#34;] } ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã§ã¯åˆ¥ãƒªã‚½ãƒ¼ã‚¹ã‚’æ¨å¥¨ # æ–¹æ³• æŸ”è»Ÿæ€§ ç†ç”± ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ãƒ–ãƒ­ãƒƒã‚¯ ä½ å‘¼ã³å‡ºã—å´ã§ãƒ«ãƒ¼ãƒ«è¿½åŠ ä¸å¯ åˆ¥ãƒªã‚½ãƒ¼ã‚¹ é«˜ å‘¼ã³å‡ºã—å´ã§è¿½åŠ ãƒ«ãƒ¼ãƒ«å®šç¾©å¯èƒ½ åˆ¥ãƒªã‚½ãƒ¼ã‚¹ã«ã™ã‚Œã°ã€ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ç’°å¢ƒã®ã¿ãƒ†ã‚¹ãƒˆç”¨ãƒãƒ¼ãƒˆã‚’è¿½åŠ ã€ã¨ã„ã£ãŸã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºãŒå¯èƒ½ã€‚\n# live/stage/main.tf - ãƒ†ã‚¹ãƒˆç”¨ãƒãƒ¼ãƒˆã‚’è¿½åŠ  resource \u0026#34;aws_security_group_rule\u0026#34; \u0026#34;allow_testing\u0026#34; { type = \u0026#34;ingress\u0026#34; security_group_id = module.webserver_cluster.alb_security_group_id from_port = 12345 to_port = 12345 protocol = \u0026#34;tcp\u0026#34; cidr_blocks = [\u0026#34;0.0.0.0/0\u0026#34;] } ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç† # å•é¡Œ # ãƒ­ãƒ¼ã‚«ãƒ«ãƒ‘ã‚¹å‚ç…§ã§ã¯ã€ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’å¤‰æ›´ã™ã‚‹ã¨å…¨ç’°å¢ƒã«å³åº§ã«å½±éŸ¿ã™ã‚‹ã€‚\nè§£æ±ºç­–: Gitãƒªãƒã‚¸ãƒˆãƒªã¨SemVer # ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’åˆ¥ãƒªãƒã‚¸ãƒˆãƒªã«åˆ†é›¢ Gitã‚¿ã‚°ã§ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ä»˜ä¸ git tag -a \u0026#34;v0.0.1\u0026#34; -m \u0026#34;First release\u0026#34; git push --follow-tags ç’°å¢ƒã”ã¨ã«ç•°ãªã‚‹ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’å‚ç…§ # stage: æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ãƒ†ã‚¹ãƒˆ source = \u0026#34;github.com/user/modules//services/webserver-cluster?ref=v0.0.2\u0026#34; # prod: å®‰å®šç‰ˆã‚’ç¶­æŒ source = \u0026#34;github.com/user/modules//services/webserver-cluster?ref=v0.0.1\u0026#34; GitHubã§ã‚½ãƒ¼ã‚¹URLæŒ‡å®šæ–¹æ³•ï¼šgithub.com/user/repo\nã‚»ãƒãƒ³ãƒ†ã‚£ãƒƒã‚¯ãƒãƒ¼ã‚¸ãƒ§ãƒ‹ãƒ³ã‚° # å¤‰æ›´å†…å®¹ ãƒãƒ¼ã‚¸ãƒ§ãƒ³ ãƒã‚°ä¿®æ­£ PATCHï¼ˆv0.0.1 â†’ v0.0.2ï¼‰ å¾Œæ–¹äº’æ›ã®ã‚ã‚‹æ©Ÿèƒ½è¿½åŠ  MINORï¼ˆv0.0.2 â†’ v0.1.0ï¼‰ ç ´å£Šçš„å¤‰æ›´ MAJORï¼ˆv0.1.0 â†’ v1.0.0ï¼‰ ã‚¨ãƒ©ãƒ¼å¯¾å¿œãƒ¡ãƒ¢ # terraform init ã®å®Ÿè¡Œå ´æ‰€ # Terraform initialized in an empty directory! â†’ .tfãƒ•ã‚¡ã‚¤ãƒ«ãŒã‚ã‚‹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªï¼ˆãƒ«ãƒ¼ãƒˆãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ï¼‰ã§å®Ÿè¡Œã™ã‚‹ã“ã¨ã€‚\nbackendè¨­å®šãŒãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«å†…ã«æ®‹ã£ã¦ã„ã‚‹ # Error: Failed to get existing workspaces: S3 bucket does not exist. â†’ providerã¨terraform { backend }ã¯ãƒ«ãƒ¼ãƒˆãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®ã¿ã«æ›¸ãã€‚å†åˆ©ç”¨å¯èƒ½ãªãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‹ã‚‰ã¯å‰Šé™¤ã€‚\nãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã«å«ã‚ã‚‹ã¹ãã‚‚ã® # è¨­å®š modules/ live/ provider - å¿…é ˆ terraform { backend } - å¿…é ˆ resource å¿…é ˆ ä»»æ„ variable å¿…é ˆ ä»»æ„ output å¿…é ˆ ä»»æ„ locals ä»»æ„ ä»»æ„ å‚ç…§æ–¹æ³•ã®æ¯”è¼ƒ # ã“ã“ã¾ã§å­¦ã‚“ã å„è¦ç´ ã®å‚ç…§æ–¹æ³•ã‚’ã¾ã¨ã‚ã‚‹ã€‚\nç¨®é¡ æ–‡æ³• ä¾‹ å…¥åŠ›å¤‰æ•° var.\u0026lt;NAME\u0026gt; var.cluster_name ãƒ­ãƒ¼ã‚«ãƒ«å€¤ local.\u0026lt;NAME\u0026gt; local.http_port ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«å‡ºåŠ› module.\u0026lt;MODULE\u0026gt;.\u0026lt;OUTPUT\u0026gt; module.webserver_cluster.asg_name ãƒ‘ã‚¹å‚ç…§ path.\u0026lt;TYPE\u0026gt; path.module ã¾ã¨ã‚ # å­¦ã‚“ã ã“ã¨ å†…å®¹ ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®åŸºç¤ ãƒ•ã‚©ãƒ«ãƒ€ = ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ« å…¥åŠ›å¤‰æ•°ï¼ˆvariableï¼‰ ç’°å¢ƒã”ã¨ã®é•ã„ã‚’å¸å ãƒ­ãƒ¼ã‚«ãƒ«å€¤ï¼ˆlocalsï¼‰ å¤‰æ›´ã•ã‚ŒãŸããªã„å†…éƒ¨å®šæ•° å‡ºåŠ›ï¼ˆoutputï¼‰ å¤–éƒ¨ã‹ã‚‰å‚ç…§å¯èƒ½ãªå€¤ ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ path.moduleã§æ­£ã—ãå‚ç…§ ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ãƒ–ãƒ­ãƒƒã‚¯ åˆ¥ãƒªã‚½ãƒ¼ã‚¹ã®æ–¹ãŒæŸ”è»Ÿ ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç† Git + SemVerã§å®‰å…¨ãªãƒ‡ãƒ—ãƒ­ã‚¤ ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«åŒ–ã®ãƒ¡ãƒªãƒƒãƒˆ # DRYåŸå‰‡: åŒã˜ã‚³ãƒ¼ãƒ‰ã‚’è¤‡æ•°ç’°å¢ƒã§å†åˆ©ç”¨ ä¿å®ˆæ€§: 1ç®‡æ‰€ã®ä¿®æ­£ã§å…¨ç’°å¢ƒã«åæ˜  æŸ”è»Ÿæ€§: å…¥åŠ›å¤‰æ•°ã§ç’°å¢ƒã”ã¨ã®ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º å®‰å…¨æ€§: ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†ã§ãƒ†ã‚¹ãƒˆæ¸ˆã¿ã‚³ãƒ¼ãƒ‰ã®ã¿æœ¬ç•ªé©ç”¨ å‚è€ƒ # è©³è§£ Terraform ç¬¬3ç‰ˆ - Yevgeniy Brikmanè‘—ã€æ¾æµ¦éš¼äººè¨³ã€ã‚ªãƒ©ã‚¤ãƒªãƒ¼ã‚¸ãƒ£ãƒ‘ãƒ³ã€2023å¹´ Terraformå…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ å‰å›ã®è¨˜äº‹: ãƒ•ã‚¡ã‚¤ãƒ«ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã¨terraform_remote_state ","date":"2025å¹´ 11æœˆ 29æ—¥","externalUrl":null,"permalink":"/posts/251129154214_terraform-reusable-infrastructure-modules/","section":"Posts","summary":"","title":"Terraformãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã§å†åˆ©ç”¨å¯èƒ½ãªã‚¤ãƒ³ãƒ•ãƒ©ã‚’ä½œã‚‹","type":"posts"},{"content":" ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ¡ãƒ¢ãƒªã®ã‚¢ãƒ‰ãƒ¬ã‚¹ãƒãƒƒãƒ”ãƒ³ã‚°æ–¹å¼ã¨ã¯ï¼Ÿ # ä¸»è¨˜æ†¶ä¸Šã®æ ¼ç´ä½ç½®ã¨ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ¡ãƒ¢ãƒªä¸Šã®æ ¼ç´ä½ç½®ã¨ã‚’ã©ã®ã‚ˆã†ã«å¯¾å¿œã•ã›ã‚‹ã‹ã‚’æ±ºã‚ã‚‹æ–¹å¼ã¨ã—ã¦ã€ãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆãƒãƒƒãƒ—ã€ãƒ•ãƒ«ã‚¢ã‚½ã‚·ã‚¨ã‚¤ãƒ†ã‚£ãƒ–ã€ã‚»ãƒƒãƒˆã‚¢ã‚½ã‚·ã‚¨ã‚¤ãƒ†ã‚£ãƒ–ãŒã‚ã‚‹ã€‚\nãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆãƒãƒƒãƒ— # ä¸»è¨˜æ†¶ã®ã‚¢ãƒ‰ãƒ¬ã‚¹ã‹ã‚‰ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ¡ãƒ¢ãƒªä¸Šã®æ ¼ç´ä½ç½®ï¼ˆãƒ–ãƒ­ãƒƒã‚¯ç•ªå·ï¼‰ãŒä¸€æ„ã«æ±ºã¾ã‚‹æ–¹å¼\nä¸»è¨˜æ†¶ã®ã‚¢ãƒ‰ãƒ¬ã‚¹ã®ä¸€éƒ¨ï¼ˆä¸‹ä½ãƒ“ãƒƒãƒˆï¼‰ã‚’ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã¨ã—ã¦ä½¿ç”¨ã—ã€æ ¼ç´å…ˆã‚’æ±ºå®š å›è·¯æ§‹æˆãŒå˜ç´”ã§ã‚³ã‚¹ãƒˆãŒä½ã„ ä¸»è¨˜æ†¶ä¸Šã®ç•°ãªã‚‹ã‚¢ãƒ‰ãƒ¬ã‚¹ãŒã€ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ¡ãƒ¢ãƒªä¸Šã®åŒã˜å ´æ‰€ã«å‰²ã‚Šå½“ã¦ã‚‰ã‚Œã‚‹ã€Œã‚³ãƒ³ãƒ•ãƒªã‚¯ãƒˆã€ãŒç™ºç”Ÿã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ ã‚³ãƒ³ãƒ•ãƒªã‚¯ãƒˆã¯ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ’ãƒƒãƒˆç‡ãŒä½ä¸‹ã™ã‚‹åŸå› ã«ã‚‚ãªã‚‹ ãƒ•ãƒ«ã‚¢ã‚½ã‚·ã‚¨ã‚¤ãƒ†ã‚£ãƒ– # ä¸»è¨˜æ†¶ã®ãƒ–ãƒ­ãƒƒã‚¯ã‚’ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ¡ãƒ¢ãƒªä¸Šã®ã©ã®ãƒ–ãƒ­ãƒƒã‚¯ã«ã‚‚æ ¼ç´ã™ã‚‹ã“ã¨ãŒã§ãã‚‹æ–¹å¼\nã‚³ãƒ³ãƒ•ãƒªã‚¯ãƒˆãŒç™ºç”Ÿã—ã«ããã€ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ’ãƒƒãƒˆç‡ãŒé«˜ã„ æ¤œç´¢ã«CAMï¼ˆContent Addressable Memoryï¼šé€£æƒ³ãƒ¡ãƒ¢ãƒªï¼‰ã‚’ä½¿ç”¨ã™ã‚‹ãŸã‚ã€å›è·¯ãŒéå¸¸ã«è¤‡é›‘ã§é«˜ã‚³ã‚¹ãƒˆ å°å®¹é‡ã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥ï¼ˆTLBãªã©ï¼‰ã§ä½¿ç”¨ã•ã‚Œã‚‹ã“ã¨ãŒå¤šã„ ã‚»ãƒƒãƒˆã‚¢ã‚½ã‚·ã‚¨ã‚¤ãƒ†ã‚£ãƒ– # ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ¡ãƒ¢ãƒªã‚’ã„ãã¤ã‹ã®ã€Œã‚»ãƒƒãƒˆã€ã¨å‘¼ã°ã‚Œã‚‹ã‚°ãƒ«ãƒ¼ãƒ—ã«åˆ†ã‘ã€ä¸»è¨˜æ†¶ã®ã‚¢ãƒ‰ãƒ¬ã‚¹ã‹ã‚‰ã¯ã¾ãšç‰¹å®šã®ã‚»ãƒƒãƒˆãŒæ±ºå®šã•ã‚Œã‚‹ã€‚ãã®ã‚»ãƒƒãƒˆã®ä¸­ã§ã‚ã‚Œã°ã€ã©ã®ãƒ–ãƒ­ãƒƒã‚¯ã«ã§ã‚‚æ ¼ç´ã™ã‚‹ã“ã¨ãŒã§ãã‚‹ã€‚\nãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆãƒãƒƒãƒ—ã¨ãƒ•ãƒ«ã‚¢ã‚½ã‚·ã‚¨ã‚¤ãƒ†ã‚£ãƒ–ã®ä¸­é–“çš„ãªå­˜åœ¨ ç¾åœ¨ã®ä¸»æµã®æ–¹å¼ï¼ˆã‚³ã‚¹ãƒˆã¨ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã®ãƒãƒ©ãƒ³ã‚¹ãŒè‰¯ã„ï¼‰ n-way ã‚»ãƒƒãƒˆã‚¢ã‚½ã‚·ã‚¨ã‚¤ãƒ†ã‚£ãƒ–: 1ã¤ã®ã‚»ãƒƒãƒˆå†…ã«æ ¼ç´ã§ãã‚‹ãƒ–ãƒ­ãƒƒã‚¯æ•°ã‚’ã€Œnã€ã§è¡¨ã™ 2-way: 1ã‚»ãƒƒãƒˆã«2ãƒ–ãƒ­ãƒƒã‚¯æ ¼ç´å¯èƒ½ 4-way: 1ã‚»ãƒƒãƒˆã«4ãƒ–ãƒ­ãƒƒã‚¯æ ¼ç´å¯èƒ½ nãŒå¤§ãã„ã»ã©ãƒ•ãƒ«ã‚¢ã‚½ã‚·ã‚¨ã‚¤ãƒ†ã‚£ãƒ–ã«è¿‘ã¥ãã€ãƒ’ãƒƒãƒˆç‡ã¯ä¸ŠãŒã‚‹ãŒã‚³ã‚¹ãƒˆã‚‚å¢—åŠ  3æ–¹å¼ã®æ¯”è¼ƒ # æ–¹å¼ æ ¼ç´ä½ç½®ã®è‡ªç”±åº¦ å›è·¯ã®è¤‡é›‘ã• ã‚³ã‚¹ãƒˆ ãƒ’ãƒƒãƒˆç‡ ãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆãƒãƒƒãƒ— ä½ï¼ˆ1ç®‡æ‰€å›ºå®šï¼‰ å˜ç´” ä½ ä½ ãƒ•ãƒ«ã‚¢ã‚½ã‚·ã‚¨ã‚¤ãƒ†ã‚£ãƒ– é«˜ï¼ˆã©ã“ã§ã‚‚å¯ï¼‰ è¤‡é›‘ é«˜ é«˜ ã‚»ãƒƒãƒˆã‚¢ã‚½ã‚·ã‚¨ã‚¤ãƒ†ã‚£ãƒ– ä¸­ï¼ˆã‚»ãƒƒãƒˆå†…ã§è‡ªç”±ï¼‰ ä¸­ç¨‹åº¦ ä¸­ ä¸­ å‚è€ƒãƒªãƒ³ã‚¯ # å¿œç”¨æƒ…å ±æŠ€è¡“è€…éå»å•é“å ´ï¼šä»¤å’Œ4å¹´æ˜¥æœŸ å•10 å‡ºå…¸ï¼šå¿œç”¨æƒ…å ±æŠ€è¡“è€…ï¼šä»¤å’Œ4å¹´æ˜¥æœŸ å•10 ","date":"2025å¹´ 11æœˆ 29æ—¥","externalUrl":null,"permalink":"/posts/251129115424_cache-memory-address-mapping/","section":"Posts","summary":"","title":"ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ¡ãƒ¢ãƒªã®ã‚¢ãƒ‰ãƒ¬ã‚¹ãƒãƒƒãƒ”ãƒ³ã‚°æ–¹å¼","type":"posts"},{"content":" å•é¡Œ # å‡ºå…¸ï¼šå¿œç”¨æƒ…å ±æŠ€è¡“è€…å¹³æˆ26å¹´æ˜¥æœŸå•18 ä»®æƒ³è¨˜æ†¶æ–¹å¼ã«ãŠã„ã¦ã€è«–ç†ã‚¢ãƒ‰ãƒ¬ã‚¹ã‹ã‚‰ç‰©ç†ã‚¢ãƒ‰ãƒ¬ã‚¹ã¸ã®å¤‰æ›ã‚’è¡Œã†ã®ã¯ã„ã¤ã‹ã€‚\né¸æŠè‚¢\nãƒšãƒ¼ã‚¸ã‚’è£œåŠ©è¨˜æ†¶ã«ãƒšãƒ¼ã‚¸ã‚¢ã‚¦ãƒˆã™ã‚‹ã¨ã ãƒšãƒ¼ã‚¸ãƒ•ã‚©ãƒ¼ãƒ«ãƒˆãŒç™ºç”Ÿã—ãŸã¨ã ä¸»è¨˜æ†¶ã«å­˜åœ¨ã™ã‚‹ãƒšãƒ¼ã‚¸ã‚’ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã¨ã ãƒšãƒ¼ã‚¸ã‚’ä¸»è¨˜æ†¶ã«ãƒšãƒ¼ã‚¸ã‚¤ãƒ³ã™ã‚‹ã¨ã æ­£è§£ï¼šä¸»è¨˜æ†¶ã«å­˜åœ¨ã™ã‚‹ãƒšãƒ¼ã‚¸ã‚’ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã¨ã # åŸºæœ¬çš„ãªä»•çµ„ã¿ # è«–ç†ã‚¢ãƒ‰ãƒ¬ã‚¹ã‹ã‚‰ç‰©ç†ã‚¢ãƒ‰ãƒ¬ã‚¹ã¸ã®å¤‰æ›ã¯ã€CPUãŒãƒ¡ãƒ¢ãƒªã‚¢ã‚¯ã‚»ã‚¹ã‚’è¡Œã†ãŸã³ã«å®Ÿè¡Œã•ã‚Œã¾ã™ã€‚\næ‹…å½“ãƒãƒ¼ãƒ‰ã‚¦ã‚§ã‚¢: MMUï¼ˆãƒ¡ãƒ¢ãƒªç®¡ç†ãƒ¦ãƒ‹ãƒƒãƒˆï¼‰ ä½¿ç”¨ã™ã‚‹å¯¾å¿œè¡¨: ãƒšãƒ¼ã‚¸ãƒ†ãƒ¼ãƒ–ãƒ« å®Ÿè¡Œã‚¿ã‚¤ãƒŸãƒ³ã‚°: ä¸»è¨˜æ†¶ä¸Šã®ãƒšãƒ¼ã‚¸ã¸ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã¨ãï¼ˆæ¯å›ï¼‰ å‡¦ç†é€Ÿåº¦: é«˜é€Ÿï¼ˆãƒãƒ¼ãƒ‰ã‚¦ã‚§ã‚¢å‡¦ç†ï¼‰ ä»–ã®é¸æŠè‚¢ãŒä¸æ­£è§£ãªç†ç”± # ãƒšãƒ¼ã‚¸ã‚¢ã‚¦ãƒˆ # ä¸»è¨˜æ†¶ã®ç©ºãå®¹é‡ç¢ºä¿ã®ãŸã‚ã€ä½¿ç”¨é »åº¦ã®ä½ã„ãƒšãƒ¼ã‚¸ã‚’è£œåŠ©è¨˜æ†¶ã«é€€é¿ã™ã‚‹å‡¦ç† OSã«ã‚ˆã‚‹ãƒ¡ãƒ¢ãƒªç®¡ç†å‹•ä½œã§ã‚ã‚Šã€ã‚¢ãƒ‰ãƒ¬ã‚¹å¤‰æ›å‡¦ç†ãã®ã‚‚ã®ã§ã¯ãªã„ ãƒšãƒ¼ã‚¸ãƒ•ã‚©ãƒ¼ãƒ«ãƒˆ # ã‚¢ãƒ‰ãƒ¬ã‚¹å¤‰æ›ã‚’è©¦ã¿ãŸçµæœã€å¤±æ•—ã—ãŸã¨ãã«ç™ºç”Ÿã™ã‚‹ä¾‹å¤–ï¼ˆå‰²ã‚Šè¾¼ã¿ï¼‰ å¤‰æ›ãŒè¡Œã‚ã‚Œã‚‹ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§ã¯ãªãã€å¤‰æ›å¤±æ•—ã®çµæœç™ºç”Ÿã™ã‚‹äº‹è±¡ ãƒšãƒ¼ã‚¸ã‚¤ãƒ³ # ãƒšãƒ¼ã‚¸ãƒ•ã‚©ãƒ¼ãƒ«ãƒˆç™ºç”Ÿå¾Œã€è£œåŠ©è¨˜æ†¶ã‹ã‚‰ä¸»è¨˜æ†¶ã«ãƒšãƒ¼ã‚¸ã‚’èª­ã¿è¾¼ã‚€å‡¦ç† ãƒšãƒ¼ã‚¸ã‚¤ãƒ³å®Œäº†å¾Œã«ã€æ”¹ã‚ã¦ã‚¢ãƒ‰ãƒ¬ã‚¹å¤‰æ›ãŒè¡Œã‚ã‚Œã‚‹ Q\u0026amp;Aï¼šã‚ˆãã‚ã‚‹èª¤è§£ # Q1. ãƒšãƒ¼ã‚¸ã‚¤ãƒ³ãƒ»ãƒšãƒ¼ã‚¸ã‚¢ã‚¦ãƒˆã§ã‚‚å¤‰æ›ãŒç™ºç”Ÿã™ã‚‹ï¼Ÿ # A. ã„ã„ãˆã€å³å¯†ã«ã¯ç•°ãªã‚Šã¾ã™ã€‚\nã‚¢ãƒ‰ãƒ¬ã‚¹å¤‰æ›ã¯CPUã®å‘½ä»¤å®Ÿè¡Œã«ä¼´ã†å‡¦ç†ã§ã‚ã‚Šã€ãƒšãƒ¼ã‚¸ã‚¤ãƒ³ãƒ»ãƒšãƒ¼ã‚¸ã‚¢ã‚¦ãƒˆã®æœ€ä¸­ã«è¡Œã‚ã‚Œã‚‹ã‚ã‘ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚\nQ2. ã‚¢ãƒ‰ãƒ¬ã‚¹å¤‰æ›ãŒå¤±æ•—ã—ãŸã‚‰ã©ã†ãªã‚‹ï¼Ÿ # A. ä»¥ä¸‹ã®æµã‚Œã§å‡¦ç†ã•ã‚Œã¾ã™ã€‚\nã‚¢ãƒ‰ãƒ¬ã‚¹å¤‰æ›å¤±æ•— â†“ ãƒšãƒ¼ã‚¸ãƒ•ã‚©ãƒ¼ãƒ«ãƒˆç™ºç”Ÿ â†“ OSä»‹å…¥ï¼ˆãƒšãƒ¼ã‚¸ã‚¤ãƒ³å‡¦ç†ï¼‰ â†“ å¤‰æ›æˆåŠŸï¼ˆãƒ¡ãƒ¢ãƒªã‚¢ã‚¯ã‚»ã‚¹å®Ÿè¡Œï¼‰ è©³ç´°ï¼šå„å‡¦ç†ã¨ã‚¢ãƒ‰ãƒ¬ã‚¹å¤‰æ›ã®é–¢ä¿‚ # ã‚¢ãƒ‰ãƒ¬ã‚¹å¤‰æ›ãŒè¡Œã‚ã‚Œã‚‹ã‚¿ã‚¤ãƒŸãƒ³ã‚° # CPUãŒãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’å®Ÿè¡Œã—ã€ãƒ¡ãƒ¢ãƒªã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ãŸã³ã«MMUãŒè«–ç†ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ç‰©ç†ã‚¢ãƒ‰ãƒ¬ã‚¹ã«å¤‰æ›ã—ã¾ã™ã€‚ã“ã‚Œã¯ä¸»è¨˜æ†¶ä¸Šã®ãƒšãƒ¼ã‚¸ãŒå­˜åœ¨ã™ã‚‹å ´åˆã«æ¯å›å®Ÿè¡Œã•ã‚Œã‚‹é«˜é€Ÿå‡¦ç†ã§ã™ã€‚\nãƒšãƒ¼ã‚¸ã‚¤ãƒ³ã¨ã‚¢ãƒ‰ãƒ¬ã‚¹å¤‰æ› # ãƒšãƒ¼ã‚¸ã‚¤ãƒ³ã¯ã‚¢ãƒ‰ãƒ¬ã‚¹å¤‰æ›ã®å¤±æ•—ãŒãã£ã‹ã‘ã§ç™ºç”Ÿã—ã¾ã™ã€‚\nCPUãŒè«–ç†ã‚¢ãƒ‰ãƒ¬ã‚¹ã«ã‚¢ã‚¯ã‚»ã‚¹ â†’ MMUãŒã‚¢ãƒ‰ãƒ¬ã‚¹å¤‰æ›ã‚’è©¦è¡Œ ãƒšãƒ¼ã‚¸ãŒä¸»è¨˜æ†¶ã«å­˜åœ¨ã—ãªã„ â†’ å¤‰æ›å¤±æ•— â†’ ãƒšãƒ¼ã‚¸ãƒ•ã‚©ãƒ¼ãƒ«ãƒˆç™ºç”Ÿ OSãŒè£œåŠ©è¨˜æ†¶è£…ç½®ã‹ã‚‰å¿…è¦ãªãƒšãƒ¼ã‚¸ã‚’ä¸»è¨˜æ†¶ã«èª­ã¿è¾¼ã‚€ï¼ˆãƒšãƒ¼ã‚¸ã‚¤ãƒ³ï¼‰ ãƒšãƒ¼ã‚¸ãƒ†ãƒ¼ãƒ–ãƒ«æ›´æ–° ä¸­æ–­ã—ã¦ã„ãŸå‘½ä»¤ã‚’å†é–‹ â†’ MMUãŒå†åº¦ã‚¢ãƒ‰ãƒ¬ã‚¹å¤‰æ›ã‚’è©¦è¡Œ â†’ æˆåŠŸ ãƒšãƒ¼ã‚¸ã‚¢ã‚¦ãƒˆã¨ã‚¢ãƒ‰ãƒ¬ã‚¹å¤‰æ› # ãƒšãƒ¼ã‚¸ã‚¢ã‚¦ãƒˆã¯ã€ãƒšãƒ¼ã‚¸ã‚¤ãƒ³ã®ãŸã‚ã®ç©ºãé ˜åŸŸç¢ºä¿ã‚’ç›®çš„ã¨ã—ãŸOSã®ãƒ¡ãƒ¢ãƒªç®¡ç†å‹•ä½œã§ã™ã€‚\nãƒšãƒ¼ã‚¸ãƒ•ã‚©ãƒ¼ãƒ«ãƒˆç™ºç”Ÿ â†’ ãƒšãƒ¼ã‚¸ã‚¤ãƒ³å¿…è¦ â†’ ä¸»è¨˜æ†¶ã«ç©ºããŒãªã„ OSãŒãƒšãƒ¼ã‚¸ã®ç½®ãæ›ãˆå¯¾è±¡ã‚’æ±ºå®š é¸ã°ã‚ŒãŸãƒšãƒ¼ã‚¸ã‚’è£œåŠ©è¨˜æ†¶è£…ç½®ã«æ›¸ãå‡ºã™ï¼ˆãƒšãƒ¼ã‚¸ã‚¢ã‚¦ãƒˆï¼‰ CPUã«ã‚ˆã‚‹ã‚¢ãƒ‰ãƒ¬ã‚¹å¤‰æ›å‡¦ç†ãã®ã‚‚ã®ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚\nã¾ã¨ã‚ # å‡¦ç† å½¹å‰² ã‚¢ãƒ‰ãƒ¬ã‚¹å¤‰æ›ã¨ã®é–¢ä¿‚ ã‚¢ãƒ‰ãƒ¬ã‚¹å¤‰æ› MMUã«ã‚ˆã‚‹è«–ç†â†’ç‰©ç†ã‚¢ãƒ‰ãƒ¬ã‚¹å¤‰æ› ä¸»è¨˜æ†¶ã‚¢ã‚¯ã‚»ã‚¹æ™‚ã«æ¯å›å®Ÿè¡Œ ãƒšãƒ¼ã‚¸ãƒ•ã‚©ãƒ¼ãƒ«ãƒˆ ã‚¢ãƒ‰ãƒ¬ã‚¹å¤‰æ›å¤±æ•—æ™‚ã®ä¾‹å¤– å¤‰æ›å¤±æ•—ã®çµæœ ãƒšãƒ¼ã‚¸ã‚¤ãƒ³ è£œåŠ©è¨˜æ†¶â†’ä¸»è¨˜æ†¶ã¸ã®ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿ å®Œäº†å¾Œã«å¤‰æ›ãŒå†å®Ÿè¡Œã•ã‚Œã‚‹ ãƒšãƒ¼ã‚¸ã‚¢ã‚¦ãƒˆ ä¸»è¨˜æ†¶â†’è£œåŠ©è¨˜æ†¶ã¸ã®ãƒšãƒ¼ã‚¸é€€é¿ å¤‰æ›å‡¦ç†ã§ã¯ãªã„ï¼ˆãƒ¡ãƒ¢ãƒªç®¡ç†ï¼‰ ä»®æƒ³è¨˜æ†¶ã®å‡¦ç†ãƒ•ãƒ­ãƒ¼ # 1. ã‚¢ãƒ‰ãƒ¬ã‚¹å¤‰æ›ã®è©¦è¡Œ â”œâ”€ æˆåŠŸ â†’ ãƒ¡ãƒ¢ãƒªã‚¢ã‚¯ã‚»ã‚¹å®Ÿè¡Œ â””â”€ å¤±æ•— â†’ 2ã¸ 2. ãƒšãƒ¼ã‚¸ãƒ•ã‚©ãƒ¼ãƒ«ãƒˆç™ºç”Ÿï¼ˆä¾‹å¤–å‰²ã‚Šè¾¼ã¿ï¼‰ â””â”€ OSã«åˆ¶å¾¡ç§»è¡Œ 3. OSå‡¦ç† â”œâ”€ ãƒšãƒ¼ã‚¸æ¤œç´¢ï¼ˆè£œåŠ©è¨˜æ†¶è£…ç½®ï¼‰ â”œâ”€ ç©ºãé ˜åŸŸç¢ºä¿ï¼ˆå¿…è¦ãªã‚‰4ã¸ï¼‰ â””â”€ ãƒšãƒ¼ã‚¸ã‚¤ãƒ³å®Ÿè¡Œ 4. ãƒšãƒ¼ã‚¸ã‚¢ã‚¦ãƒˆï¼ˆç©ºãå®¹é‡ä¸è¶³æ™‚ï¼‰ â”œâ”€ ç½®ãæ›ãˆå¯¾è±¡é¸æŠ â””â”€ è£œåŠ©è¨˜æ†¶ã¸é€€é¿ 5. ãƒšãƒ¼ã‚¸ãƒ†ãƒ¼ãƒ–ãƒ«æ›´æ–° 6. å‡¦ç†å†é–‹ â†’ 1ã¸æˆ»ã‚‹ï¼ˆä»Šåº¦ã¯æˆåŠŸï¼‰ é‡è¦ãƒã‚¤ãƒ³ãƒˆ: ãƒšãƒ¼ã‚¸ã‚¤ãƒ³ãƒ»ãƒšãƒ¼ã‚¸ã‚¢ã‚¦ãƒˆã¯ã€ã‚¢ãƒ‰ãƒ¬ã‚¹å¤‰æ›ã‚’å††æ»‘ã«å‹•ã‹ã™ãŸã‚ã®OSã«ã‚ˆã‚‹è£æ–¹ã®ç®¡ç†ä½œæ¥­ã§ã™ã€‚\n","date":"2025å¹´ 11æœˆ 29æ—¥","externalUrl":null,"permalink":"/posts/251129114929_virtual-memory-address-translation/","section":"Posts","summary":"","title":"ä»®æƒ³è¨˜æ†¶ã®ã‚¢ãƒ‰ãƒ¬ã‚¹å¤‰æ›","type":"posts"},{"content":"","date":"2025å¹´ 11æœˆ 29æ—¥","externalUrl":null,"permalink":"/tags/vscode/","section":"Tags","summary":"","title":"VSCode","type":"tags"},{"content":" VSCode ãƒãƒ«ãƒã‚«ãƒ¼ã‚½ãƒ«ç·¨é›†ã¨ã¯ï¼Ÿ # è¤‡æ•°ç®‡æ‰€ã‚’åŒæ™‚ç·¨é›†ã§ãã‚‹ä¾¿åˆ©æ©Ÿèƒ½ã€‚ å¤‰æ•°åã®ä¸€æ‹¬å¤‰æ›´ã‚„ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆèª¿æ•´ãªã©ã€ç¹°ã‚Šè¿”ã—ä½œæ¥­ã‚’å¤§å¹…ã«åŠ¹ç‡åŒ–ã§ãã‚‹ã€‚\nã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆä¸€è¦§ # æ“ä½œ Windows Mac ä»»æ„ã®ä½ç½®ã«ã‚«ãƒ¼ã‚½ãƒ«è¿½åŠ  Alt + ã‚¯ãƒªãƒƒã‚¯ Option + ã‚¯ãƒªãƒƒã‚¯ ä¸Šä¸‹ã«é€£ç¶šã‚«ãƒ¼ã‚½ãƒ«è¿½åŠ  Ctrl + Alt + â†‘/â†“ Cmd + Option + â†‘/â†“ çŸ©å½¢ï¼ˆãƒœãƒƒã‚¯ã‚¹ï¼‰é¸æŠ Alt + Shift + ãƒ‰ãƒ©ãƒƒã‚° Option + Shift + ãƒ‰ãƒ©ãƒƒã‚° è¡Œé ­ã¸ç§»å‹• Home Cmd + â† åŒã˜å˜èªã‚’å…¨é¸æŠ Ctrl + Shift + L Cmd + Shift + L ä½¿ã„åˆ†ã‘ # ã‚·ãƒ¼ãƒ³ æ¨å¥¨æ“ä½œ é£›ã³é£›ã³ã®è¡Œã‚’ç·¨é›† Alt + ã‚¯ãƒªãƒƒã‚¯ é€£ç¶šã—ãŸè¡Œã‚’ç·¨é›† Ctrl + Alt + â†“ ã§ä¸€æ°—ã«è¿½åŠ  ç¸¦ã«æƒã£ãŸç¯„å›²ã‚’ç·¨é›† çŸ©å½¢é¸æŠ å®Ÿè·µä¾‹ # é€£ç¶šè¡Œã®å…ˆé ­ã«ã‚³ãƒ¡ãƒ³ãƒˆè¿½åŠ \næœ€åˆã®è¡Œã®å…ˆé ­ã«ã‚«ãƒ¼ã‚½ãƒ«ã‚’ç½®ã Ctrl + Alt + â†“ ã§ä¸‹æ–¹å‘ã«ã‚«ãƒ¼ã‚½ãƒ«ã‚’å¢—ã‚„ã™ // ã‚’å…¥åŠ› â†’ å…¨è¡Œã«ä¸€æ‹¬æŒ¿å…¥ ç·´ç¿’ç”¨ãƒ†ã‚­ã‚¹ãƒˆ # ä¸‹è¨˜ã®ãƒ†ã‚­ã‚¹ãƒˆã§ãƒãƒ«ãƒã‚«ãƒ¼ã‚½ãƒ«ç·¨é›†ã‚’è©¦ã—ã¦ã¿ã‚ˆã†ï¼š\nä¾‹1: è¡Œé ­ã« const ã‚’è¿½åŠ ã—ã¦ã¿ã‚ˆã†\nname = \u0026#34;Alice\u0026#34; age = 25 city = \u0026#34;Tokyo\u0026#34; email = \u0026#34;alice@example.com\u0026#34; ä¾‹2: è¡Œæœ«ã« ; ã‚’è¿½åŠ ã—ã¦ã¿ã‚ˆã†\nimport React from \u0026#39;react\u0026#39; import useState from \u0026#39;react\u0026#39; import useEffect from \u0026#39;react\u0026#39; ä¾‹3: å„è¡Œã‚’ console.log() ã§å›²ã‚“ã§ã¿ã‚ˆã†\nuser.name user.age user.email ","date":"2025å¹´ 11æœˆ 29æ—¥","externalUrl":null,"permalink":"/posts/251129112924_vscode-multi-cursor-editing/","section":"Posts","summary":"","title":"VSCode_ãƒãƒ«ãƒã‚«ãƒ¼ã‚½ãƒ«ç·¨é›†","type":"posts"},{"content":" ä»Šæ—¥å­¦ã‚“ã ã“ã¨ # å‰å›ã®è¨˜äº‹ã§ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ã«ã‚ˆã‚‹ã‚¹ãƒ†ãƒ¼ãƒˆåˆ†é›¢ã‚’å­¦ã‚“ã ãŒã€æœ¬ç•ªç’°å¢ƒã®åˆ†é›¢ã«ã¯ä¸ååˆ†ã ã£ãŸã€‚ä»Šå›ã¯ãƒ•ã‚¡ã‚¤ãƒ«ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã«ã‚ˆã‚‹åˆ†é›¢ã‚’å®Ÿè·µã—ã€RDSã¨Webã‚µãƒ¼ãƒãƒ¼ã‚’åˆ¥ã€…ã«ç®¡ç†ã—ãªãŒã‚‰terraform_remote_stateã§é€£æºã•ã›ã‚‹æ–¹æ³•ã‚’å­¦ã‚“ã ã€‚\nå‰å›ã®æŒ¯ã‚Šè¿”ã‚Š: ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ã®é™ç•Œ # Part1ã§ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ã®æ¬ ç‚¹ã‚’ç¢ºèªã—ãŸã€‚\næ¬ ç‚¹ èª¬æ˜ åŒä¸€ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ å…¨ç’°å¢ƒãŒåŒã˜S3/DynamoDBã‚’ä½¿ç”¨ï¼ˆæ¨©é™åˆ†é›¢ãŒå›°é›£ï¼‰ å¯è¦–æ€§ãŒä½ã„ ä»Šã©ã®ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ã«ã„ã‚‹ã‹åˆ†ã‹ã‚Šã«ãã„ èª¤æ“ä½œãƒªã‚¹ã‚¯ terraform workspace select prod ã‚’å¿˜ã‚Œã¦æœ¬ç•ªã‚’ç ´å£Šã™ã‚‹å¯èƒ½æ€§ ã“ã‚Œã‚‰ã®å•é¡Œã‚’è§£æ±ºã™ã‚‹ã®ãŒãƒ•ã‚¡ã‚¤ãƒ«ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã«ã‚ˆã‚‹åˆ†é›¢ã€‚\nãƒ•ã‚¡ã‚¤ãƒ«ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã«ã‚ˆã‚‹åˆ†é›¢ã¨ã¯ # ç’°å¢ƒã”ã¨ãƒ»ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã”ã¨ã«åˆ¥ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã§ç®¡ç†ã™ã‚‹æ–¹æ³•ã€‚\nterraform-project/ â”œâ”€â”€ stage/ # ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ç’°å¢ƒ â”‚ â”œâ”€â”€ data-stores/mysql/ # DBå±¤ï¼ˆå¤‰æ›´é »åº¦: ä½ï¼‰ â”‚ â””â”€â”€ services/webserver-cluster/ # Appå±¤ï¼ˆå¤‰æ›´é »åº¦: é«˜ï¼‰ â””â”€â”€ prod/ # æœ¬ç•ªç’°å¢ƒï¼ˆå®Œå…¨ã«åˆ¥ç®¡ç†ï¼‰ â”œâ”€â”€ data-stores/mysql/ â””â”€â”€ services/webserver-cluster/ ãªãœã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚‚åˆ†é›¢ã™ã‚‹ã®ã‹ # ãƒ¬ã‚¤ãƒ¤ãƒ¼ å¤‰æ›´é »åº¦ ãƒªã‚¹ã‚¯ VPC/ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ æœˆ1å›ç¨‹åº¦ é«˜ï¼ˆå…¨ä½“ã«å½±éŸ¿ï¼‰ ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ é€±1å›ç¨‹åº¦ é«˜ï¼ˆãƒ‡ãƒ¼ã‚¿æå¤±ï¼‰ Webã‚µãƒ¼ãƒãƒ¼ 1æ—¥æ•°å› ä½ï¼ˆå†ãƒ‡ãƒ—ãƒ­ã‚¤å¯èƒ½ï¼‰ é »ç¹ã«å¤‰æ›´ã™ã‚‹Webã‚µãƒ¼ãƒãƒ¼ã¨ã€ã‚ã£ãŸã«å¤‰æ›´ã—ãªã„DBã‚’åŒã˜ã‚¹ãƒ†ãƒ¼ãƒˆã§ç®¡ç†ã™ã‚‹ã¨ã€Webã‚µãƒ¼ãƒãƒ¼ã®å¤‰æ›´æ™‚ã«èª¤ã£ã¦DBã‚’ç ´å£Šã™ã‚‹ãƒªã‚¹ã‚¯ãŒã‚ã‚‹ã€‚\nåˆ†é›¢ã•ã‚ŒãŸã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆé–“ã®é€£æº # å•é¡Œ: RDSã¨Webã‚µãƒ¼ãƒãƒ¼ãŒåˆ¥ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«ãªã‚‹ã¨ã€Webã‚µãƒ¼ãƒãƒ¼ã¯RDSã®æ¥ç¶šæƒ…å ±ã‚’ã©ã†ã‚„ã£ã¦çŸ¥ã‚‹ã®ã‹ï¼Ÿ\nè§£æ±º: terraform_remote_stateã§åˆ¥ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ã‚¹ãƒ†ãƒ¼ãƒˆã‹ã‚‰outputã‚’å‚ç…§ã™ã‚‹ã€‚\n[mysql/] [webserver-cluster/] â”‚ â”‚ â””â”€â”€ outputs.tf ã§ address/port ã‚’å‡ºåŠ› â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â†’ terraform_remote_state ã§å‚ç…§ Step 1: RDSã®æ§‹ç¯‰ # ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆ # mkdir -p stage/data-stores/mysql cd stage/data-stores/mysql variables.tf # variable \u0026#34;db_name\u0026#34; { description = \u0026#34;ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹å\u0026#34; type = string default = \u0026#34;example_database\u0026#34; } variable \u0026#34;db_username\u0026#34; { description = \u0026#34;ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼å\u0026#34; type = string sensitive = true } variable \u0026#34;db_password\u0026#34; { description = \u0026#34;ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰\u0026#34; type = string sensitive = true } sensitive = trueã‚’æŒ‡å®šã™ã‚‹ã¨ã€terraform planã‚„terraform applyã®å‡ºåŠ›ã§ãƒã‚¹ã‚¯ã•ã‚Œã‚‹ã€‚\nmain.tf # provider \u0026#34;aws\u0026#34; { region = \u0026#34;ap-northeast-1\u0026#34; } terraform { backend \u0026#34;s3\u0026#34; { # é‡è¦: keyã¯RDSå°‚ç”¨ã®ãƒ‘ã‚¹ã«ã™ã‚‹ key = \u0026#34;stage/data-stores/mysql/terraform.tfstate\u0026#34; bucket = \u0026#34;tf-state-backend-20251128\u0026#34; region = \u0026#34;ap-northeast-1\u0026#34; dynamodb_table = \u0026#34;tf-state-locks\u0026#34; encrypt = true } } resource \u0026#34;aws_db_instance\u0026#34; \u0026#34;example\u0026#34; { identifier_prefix = \u0026#34;terraform-up-and-running\u0026#34; engine = \u0026#34;mysql\u0026#34; allocated_storage = 10 instance_class = \u0026#34;db.t3.micro\u0026#34; skip_final_snapshot = true db_name = var.db_name username = var.db_username password = var.db_password } outputs.tfï¼ˆé‡è¦ï¼‰ # Webã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰å‚ç…§ã™ã‚‹ãŸã‚ã«ã€æ¥ç¶šæƒ…å ±ã‚’outputã¨ã—ã¦å…¬é–‹ã™ã‚‹ã€‚\noutput \u0026#34;address\u0026#34; { value = aws_db_instance.example.address description = \u0026#34;ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®æ¥ç¶šã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ\u0026#34; } output \u0026#34;port\u0026#34; { value = aws_db_instance.example.port description = \u0026#34;ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ãƒãƒ¼ãƒˆç•ªå·\u0026#34; } ãƒ‡ãƒ—ãƒ­ã‚¤ # terraform init terraform apply # var.db_username: admin # var.db_password: yourpassword123 RDSã®ä½œæˆã«ã¯5-10åˆ†ã‹ã‹ã‚‹ã€‚å®Œäº†ã—ãŸã‚‰terraform outputã§æ¥ç¶šæƒ…å ±ã‚’ç¢ºèªã§ãã‚‹ã€‚\nStep 2: Webã‚µãƒ¼ãƒãƒ¼ã‚¯ãƒ©ã‚¹ã‚¿ã®æ§‹ç¯‰ # ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆ # mkdir -p stage/services/webserver-cluster cd stage/services/webserver-cluster terraform_remote_stateã¨ã¯ # ãªãœå¿…è¦ãªã®ã‹ # ãƒ•ã‚¡ã‚¤ãƒ«ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã§åˆ†é›¢ã™ã‚‹ã¨ã€RDSã¨Webã‚µãƒ¼ãƒãƒ¼ã¯åˆ¥ã€…ã®Terraformãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«ãªã‚‹ã€‚ãã‚Œãã‚ŒãŒç‹¬è‡ªã®ã‚¹ãƒ†ãƒ¼ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’æŒã¤ãŸã‚ã€é€šå¸¸ã®æ–¹æ³•ã§ã¯äº’ã„ã®ãƒªã‚½ãƒ¼ã‚¹æƒ…å ±ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ããªã„ã€‚\n[mysql/] [webserver-cluster/] terraform.tfstate terraform.tfstate â”‚ â”‚ â””â”€â”€ RDSã®address/portã‚’ä¿æŒ â””â”€â”€ RDSã®æƒ…å ±ãŒå¿…è¦ã ãŒ...ï¼Ÿ Webã‚µãƒ¼ãƒãƒ¼ãŒRDSã«æ¥ç¶šã™ã‚‹ã«ã¯ã€RDSã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆï¼ˆaddress/portï¼‰ãŒå¿…è¦ã€‚ã“ã‚Œã‚’è§£æ±ºã™ã‚‹ã®ãŒterraform_remote_stateã€‚\nä»•çµ„ã¿ # terraform_remote_stateã¯èª­ã¿å–ã‚Šå°‚ç”¨ã®ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ã§ã€åˆ¥ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ã‚¹ãƒ†ãƒ¼ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰outputã§å…¬é–‹ã•ã‚ŒãŸå€¤ã‚’å–å¾—ã™ã‚‹ã€‚\n[mysql/] [webserver-cluster/] â”‚ â”‚ â”œâ”€â”€ outputs.tf ã§ address/port ã‚’å…¬é–‹ â”‚ â”‚ â”‚ â”‚ â”‚ â–¼ â”‚ â”‚ S3ã«ä¿å­˜ã•ã‚ŒãŸã‚¹ãƒ†ãƒ¼ãƒˆ â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚ (stage/data-stores/mysql/ â”‚ â”‚ terraform.tfstate) â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ terraform_remote_state ã§èª­ã¿å–ã‚Š â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶ db_address, db_port ã¨ã—ã¦ä½¿ç”¨ é‡è¦: terraform_remote_stateã§èª­ã¿å–ã‚Œã‚‹ã®ã¯outputã§æ˜ç¤ºçš„ã«å…¬é–‹ã•ã‚ŒãŸå€¤ã®ã¿ã€‚ã‚¹ãƒ†ãƒ¼ãƒˆãƒ•ã‚¡ã‚¤ãƒ«å†…ã®å…¨ãƒªã‚½ãƒ¼ã‚¹æƒ…å ±ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ã‚ã‘ã§ã¯ãªã„ã€‚\nåŸºæœ¬æ§‹æ–‡ # data \u0026#34;terraform_remote_state\u0026#34; \u0026#34;db\u0026#34; { backend = \u0026#34;s3\u0026#34; # ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã®ç¨®é¡ config = { bucket = \u0026#34;tf-state-backend-20251128\u0026#34; key = \u0026#34;stage/data-stores/mysql/terraform.tfstate\u0026#34; # RDSã®ã‚¹ãƒ†ãƒ¼ãƒˆã®key region = \u0026#34;ap-northeast-1\u0026#34; } } å±æ€§ èª¬æ˜ backend å‚ç…§å…ˆã®ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ç¨®é¡ï¼ˆs3, gcs, azurermç­‰ï¼‰ config.bucket S3ãƒã‚±ãƒƒãƒˆå config.key å‚ç…§å…ˆãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ã‚¹ãƒ†ãƒ¼ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã®key config.region S3ãƒã‚±ãƒƒãƒˆã®ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ å‚ç…§æ–¹æ³• # # outputs.address ã‚’å‚ç…§ data.terraform_remote_state.db.outputs.address # outputs.port ã‚’å‚ç…§ data.terraform_remote_state.db.outputs.port ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‰ã¨ã®æ¯”è¼ƒ # æ–¹å¼ ã‚³ãƒ¼ãƒ‰ä¾‹ å•é¡Œç‚¹ ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‰ db_address = \u0026quot;terraform-xxx.rds.amazonaws.com\u0026quot; RDSå†ä½œæˆæ™‚ã«æ‰‹å‹•æ›´æ–°ãŒå¿…è¦ terraform_remote_state db_address = data.terraform_remote_state.db.outputs.address è‡ªå‹•çš„ã«æœ€æ–°å€¤ã‚’å–å¾— # NG: ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‰ db_address = \u0026#34;terraform-xxx.rds.amazonaws.com\u0026#34; # â†’ RDSã‚’å†ä½œæˆã™ã‚‹ã¨ã‚¢ãƒ‰ãƒ¬ã‚¹ãŒå¤‰ã‚ã‚Šã€æ‰‹å‹•æ›´æ–°ãŒå¿…è¦ # â†’ è¤‡æ•°ç’°å¢ƒã§ç•°ãªã‚‹å€¤ã‚’ç®¡ç†ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ # OK: terraform_remote_state db_address = data.terraform_remote_state.db.outputs.address # â†’ RDSãŒå¤‰ã‚ã£ã¦ã‚‚ terraform plan/apply æ™‚ã«æœ€æ–°ã®ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å–å¾— # â†’ ç’°å¢ƒã”ã¨ã«keyã‚’å¤‰ãˆã‚‹ã ã‘ã§å¯¾å¿œå¯èƒ½ æ³¨æ„ç‚¹ # æ³¨æ„ç‚¹ èª¬æ˜ keyã®ä¸€è‡´ terraform_remote_stateã®keyã¯ã€å‚ç…§å…ˆãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®backendè¨­å®šã¨å®Œå…¨ã«ä¸€è‡´ã•ã›ã‚‹ã“ã¨ outputã®å…¬é–‹ å‚ç…§ã—ãŸã„å€¤ã¯å‚ç…§å…ˆã§outputã¨ã—ã¦å®šç¾©ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ ä¾å­˜é–¢ä¿‚ å‚ç…§å…ˆï¼ˆRDSï¼‰ã‚’å…ˆã«ãƒ‡ãƒ—ãƒ­ã‚¤ã—ã¦ã‹ã‚‰Webã‚µãƒ¼ãƒãƒ¼ã‚’ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹ã“ã¨ èª­ã¿å–ã‚Šå°‚ç”¨ ã‚¹ãƒ†ãƒ¼ãƒˆã®èª­ã¿å–ã‚Šã®ã¿å¯èƒ½ã€‚å¤‰æ›´ã¯ã§ããªã„ templatefileé–¢æ•° # å¤–éƒ¨ãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã¿ã€å¤‰æ•°ã‚’åŸ‹ã‚è¾¼ã‚€é–¢æ•°ã€‚\nuser_data = base64encode(templatefile(\u0026#34;user-data.sh\u0026#34;, { server_port = var.server_port db_address = data.terraform_remote_state.db.outputs.address db_port = data.terraform_remote_state.db.outputs.port })) HCLã¨bashã‚’åˆ†é›¢ã™ã‚‹ã“ã¨ã§å¯èª­æ€§ãŒå‘ä¸Šã—ã€ã‚¹ã‚¯ãƒªãƒ—ãƒˆå˜ä½“ã§ã®ãƒ†ã‚¹ãƒˆã‚‚å¯èƒ½ã«ãªã‚‹ã€‚\nuser-data.sh # #!/bin/bash cd /home/ec2-user cat \u0026gt; index.html \u0026lt;\u0026lt;EOF \u0026lt;h1\u0026gt;Hello, World\u0026lt;/h1\u0026gt; \u0026lt;p\u0026gt;DB address: ${db_address}\u0026lt;/p\u0026gt; \u0026lt;p\u0026gt;DB port: ${db_port}\u0026lt;/p\u0026gt; EOF nohup python3 -m http.server ${server_port} \u0026amp; æ³¨æ„: ã“ã®ã‚³ãƒ¼ãƒ‰ã¯ terraform_remote_state ã®å‹•ä½œç¢ºèªç”¨ã‚µãƒ³ãƒ—ãƒ«ã§ã™ã€‚ãƒ–ãƒ©ã‚¦ã‚¶ã§ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã¨DBã®æ¥ç¶šæƒ…å ±ãŒç”»é¢ã«è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚å®Ÿéš›ã®é‹ç”¨ç’°å¢ƒã§ã¯ã€ã“ã®ã‚ˆã†ãªæ©Ÿå¯†æƒ…å ±ã‚’HTMLãƒšãƒ¼ã‚¸ã«è¡¨ç¤ºã›ãšã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å†…éƒ¨ã§ã®ã¿ä½¿ç”¨ã—ã¦ãã ã•ã„ã€‚\nvariables.tf # variable \u0026#34;server_port\u0026#34; { description = \u0026#34;HTTPãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å—ã‘ä»˜ã‘ã‚‹ãƒãƒ¼ãƒˆç•ªå·\u0026#34; type = number default = 8080 } variable \u0026#34;alb_name\u0026#34; { description = \u0026#34;ALBã®åå‰\u0026#34; type = string default = \u0026#34;terraform-asg-example\u0026#34; } variable \u0026#34;alb_security_group_name\u0026#34; { description = \u0026#34;ALBç”¨ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚°ãƒ«ãƒ¼ãƒ—ã®åå‰\u0026#34; type = string default = \u0026#34;terraform-example-alb\u0026#34; } variable \u0026#34;instance_security_group_name\u0026#34; { description = \u0026#34;EC2ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ç”¨ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚°ãƒ«ãƒ¼ãƒ—ã®åå‰\u0026#34; type = string default = \u0026#34;terraform-example-instance\u0026#34; } main.tf # provider \u0026#34;aws\u0026#34; { region = \u0026#34;ap-northeast-1\u0026#34; } terraform { backend \u0026#34;s3\u0026#34; { bucket = \u0026#34;tf-state-backend-20251128\u0026#34; key = \u0026#34;stage/services/webserver-cluster/terraform.tfstate\u0026#34; region = \u0026#34;ap-northeast-1\u0026#34; dynamodb_table = \u0026#34;tf-state-locks\u0026#34; encrypt = true } } # ----------------------------------------------------------------------------- # Data Sources # ----------------------------------------------------------------------------- data \u0026#34;aws_vpc\u0026#34; \u0026#34;default\u0026#34; { default = true } data \u0026#34;aws_subnets\u0026#34; \u0026#34;default\u0026#34; { filter { name = \u0026#34;vpc-id\u0026#34; values = [data.aws_vpc.default.id] } } # RDSã®çŠ¶æ…‹ã‚’ãƒªãƒ¢ãƒ¼ãƒˆã‚¹ãƒ†ãƒ¼ãƒˆã‹ã‚‰å–å¾— data \u0026#34;terraform_remote_state\u0026#34; \u0026#34;db\u0026#34; { backend = \u0026#34;s3\u0026#34; config = { bucket = \u0026#34;tf-state-backend-20251128\u0026#34; key = \u0026#34;stage/data-stores/mysql/terraform.tfstate\u0026#34; region = \u0026#34;ap-northeast-1\u0026#34; } } # ----------------------------------------------------------------------------- # Launch Template \u0026amp; Auto Scaling Group # ----------------------------------------------------------------------------- resource \u0026#34;aws_launch_template\u0026#34; \u0026#34;example\u0026#34; { image_id = \u0026#34;ami-03852a41f1e05c8e4\u0026#34; instance_type = \u0026#34;t2.micro\u0026#34; vpc_security_group_ids = [aws_security_group.instance.id] user_data = base64encode(templatefile(\u0026#34;user-data.sh\u0026#34;, { server_port = var.server_port db_address = data.terraform_remote_state.db.outputs.address db_port = data.terraform_remote_state.db.outputs.port })) } resource \u0026#34;aws_autoscaling_group\u0026#34; \u0026#34;example\u0026#34; { vpc_zone_identifier = data.aws_subnets.default.ids launch_template { id = aws_launch_template.example.id version = \u0026#34;$Latest\u0026#34; } target_group_arns = [aws_lb_target_group.asg.arn] health_check_type = \u0026#34;ELB\u0026#34; min_size = 2 max_size = 10 tag { key = \u0026#34;Name\u0026#34; value = \u0026#34;terraform-asg-example\u0026#34; propagate_at_launch = true } } # ----------------------------------------------------------------------------- # Security Groups # ----------------------------------------------------------------------------- resource \u0026#34;aws_security_group\u0026#34; \u0026#34;instance\u0026#34; { name = var.instance_security_group_name ingress { from_port = var.server_port to_port = var.server_port protocol = \u0026#34;tcp\u0026#34; cidr_blocks = [\u0026#34;0.0.0.0/0\u0026#34;] } } resource \u0026#34;aws_security_group\u0026#34; \u0026#34;alb\u0026#34; { name = var.alb_security_group_name ingress { from_port = 80 to_port = 80 protocol = \u0026#34;tcp\u0026#34; cidr_blocks = [\u0026#34;0.0.0.0/0\u0026#34;] } egress { from_port = 0 to_port = 0 protocol = \u0026#34;-1\u0026#34; cidr_blocks = [\u0026#34;0.0.0.0/0\u0026#34;] } } # ----------------------------------------------------------------------------- # Application Load Balancer # ----------------------------------------------------------------------------- resource \u0026#34;aws_lb\u0026#34; \u0026#34;example\u0026#34; { name = var.alb_name load_balancer_type = \u0026#34;application\u0026#34; subnets = data.aws_subnets.default.ids security_groups = [aws_security_group.alb.id] } resource \u0026#34;aws_lb_listener\u0026#34; \u0026#34;http\u0026#34; { load_balancer_arn = aws_lb.example.arn port = 80 protocol = \u0026#34;HTTP\u0026#34; default_action { type = \u0026#34;fixed-response\u0026#34; fixed_response { content_type = \u0026#34;text/plain\u0026#34; message_body = \u0026#34;404: page not found\u0026#34; status_code = 404 } } } resource \u0026#34;aws_lb_target_group\u0026#34; \u0026#34;asg\u0026#34; { name = var.alb_name port = var.server_port protocol = \u0026#34;HTTP\u0026#34; vpc_id = data.aws_vpc.default.id health_check { path = \u0026#34;/\u0026#34; protocol = \u0026#34;HTTP\u0026#34; matcher = \u0026#34;200\u0026#34; interval = 15 timeout = 3 healthy_threshold = 2 unhealthy_threshold = 2 } } resource \u0026#34;aws_lb_listener_rule\u0026#34; \u0026#34;asg\u0026#34; { listener_arn = aws_lb_listener.http.arn priority = 100 condition { path_pattern { values = [\u0026#34;*\u0026#34;] } } action { type = \u0026#34;forward\u0026#34; target_group_arn = aws_lb_target_group.asg.arn } } outputs.tf # output \u0026#34;alb_dns_name\u0026#34; { value = aws_lb.example.dns_name description = \u0026#34;ãƒ­ãƒ¼ãƒ‰ãƒãƒ©ãƒ³ã‚µãƒ¼ã®DNSå\u0026#34; } output \u0026#34;asg_name\u0026#34; { value = aws_autoscaling_group.example.name description = \u0026#34;Auto Scaling Groupã®åå‰\u0026#34; } ãƒ‡ãƒ—ãƒ­ã‚¤ # terraform init terraform apply Step 3: å‹•ä½œç¢ºèª # terraform consoleã§ç¢ºèª # terraform console \u0026gt; data.terraform_remote_state.db.outputs { \u0026#34;address\u0026#34; = \u0026#34;terraform-up-and-running-xxx.rds.amazonaws.com\u0026#34; \u0026#34;port\u0026#34; = 3306 } \u0026gt; exit ãƒ–ãƒ©ã‚¦ã‚¶ã§ç¢ºèª # # ALBã®DNSåã‚’å–å¾— terraform output alb_dns_name # curlã§ç¢ºèª curl http://\u0026lt;ALB_DNS_NAME\u0026gt; ã€ŒHello, Worldã€ã¨ã€ŒDB addressã€ã€ŒDB portã€ãŒè¡¨ç¤ºã•ã‚Œã‚Œã°æˆåŠŸã€‚\nã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—: ä¾å­˜é–¢ä¿‚ã¨å‰Šé™¤é †åº # ãªãœå‰Šé™¤é †åºãŒé‡è¦ãªã®ã‹ # Terraformãƒªã‚½ãƒ¼ã‚¹ã«ã¯ä¾å­˜é–¢ä¿‚ãŒã‚ã‚‹ã€‚ä¾å­˜ã•ã‚Œã¦ã„ã‚‹ãƒªã‚½ãƒ¼ã‚¹ã‚’å…ˆã«å‰Šé™¤ã—ã‚ˆã†ã¨ã™ã‚‹ã¨ã‚¨ãƒ©ãƒ¼ã«ãªã‚‹ã€‚\n[Webã‚µãƒ¼ãƒãƒ¼] â”€â”€ä¾å­˜â”€â”€â†’ [RDS] â”‚ â”‚ â”‚ â””â”€â”€ æ¥ç¶šæƒ…å ±ï¼ˆaddress/portï¼‰ã‚’å‚ç…§ â”‚ â””â”€â”€ terraform_remote_state ã§RDSã®ã‚¹ãƒ†ãƒ¼ãƒˆã‚’å‚ç…§ [S3/DynamoDB] â”‚ â””â”€â”€ å…¨ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ã‚¹ãƒ†ãƒ¼ãƒˆã‚’ä¿ç®¡ãƒ»ãƒ­ãƒƒã‚¯ æ­£ã—ã„å‰Šé™¤é †åº: ä¾å­˜ã™ã‚‹å´ â†’ ä¾å­˜ã•ã‚Œã‚‹å´\n# 1. Webã‚µãƒ¼ãƒãƒ¼ï¼ˆRDSã«ä¾å­˜ï¼‰ cd stage/services/webserver-cluster terraform destroy # 2. RDS cd ../../../stage/data-stores/mysql terraform destroy # 3. S3/DynamoDBï¼ˆå…¨ä½“ã®ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ï¼‰- å¿…è¦ãªå ´åˆã®ã¿ é€†é †ã§å‰Šé™¤ã—ã‚ˆã†ã¨ã—ãŸå ´åˆ:\nS3ã‚’å…ˆã«å‰Šé™¤ â†’ Webã‚µãƒ¼ãƒãƒ¼ã®ã‚¹ãƒ†ãƒ¼ãƒˆã«ã‚¢ã‚¯ã‚»ã‚¹ã§ããšã‚¨ãƒ©ãƒ¼ RDSã‚’å…ˆã«å‰Šé™¤ â†’ Webã‚µãƒ¼ãƒãƒ¼ã® terraform_remote_state ãŒã‚¨ãƒ©ãƒ¼ æ§‹ç¯‰ã—ãŸã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ # â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ S3 Backend â”‚ â”‚ â”œâ”€â”€ stage/data-stores/mysql/terraform.tfstate â† RDSã®çŠ¶æ…‹ â”‚ â”‚ â””â”€â”€ stage/services/webserver-cluster/terraform.tfstate â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ terraform_remote_state ã§å‚ç…§ â–¼ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ Webã‚µãƒ¼ãƒãƒ¼ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ ALB (port 80) â”‚â”€â”€â”€â–¶â”‚ ASG (EC2 x2) â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ DBæ¥ç¶šæƒ…å ±ã‚’å–å¾— â”‚ â”‚ â–¼ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ RDS (MySQL) â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ å®Œæˆå½¢ã®ã‚³ãƒ¼ãƒ‰ # ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆ # stage/ â”œâ”€â”€ data-stores/ â”‚ â””â”€â”€ mysql/ â”‚ â”œâ”€â”€ main.tf â”‚ â”œâ”€â”€ variables.tf â”‚ â””â”€â”€ outputs.tf â””â”€â”€ services/ â””â”€â”€ webserver-cluster/ â”œâ”€â”€ main.tf â”œâ”€â”€ variables.tf â”œâ”€â”€ outputs.tf â””â”€â”€ user-data.sh stage/data-stores/mysql/ main.tf\nprovider \u0026#34;aws\u0026#34; { region = \u0026#34;ap-northeast-1\u0026#34; } terraform { backend \u0026#34;s3\u0026#34; { key = \u0026#34;stage/data-stores/mysql/terraform.tfstate\u0026#34; bucket = \u0026#34;tf-state-backend-20251128\u0026#34; region = \u0026#34;ap-northeast-1\u0026#34; dynamodb_table = \u0026#34;tf-state-locks\u0026#34; encrypt = true } } resource \u0026#34;aws_db_instance\u0026#34; \u0026#34;example\u0026#34; { identifier_prefix = \u0026#34;terraform-up-and-running\u0026#34; engine = \u0026#34;mysql\u0026#34; allocated_storage = 10 instance_class = \u0026#34;db.t3.micro\u0026#34; skip_final_snapshot = true db_name = var.db_name username = var.db_username password = var.db_password } variables.tf\nvariable \u0026#34;db_name\u0026#34; { description = \u0026#34;ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹å\u0026#34; type = string default = \u0026#34;example_database\u0026#34; } variable \u0026#34;db_username\u0026#34; { description = \u0026#34;ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼å\u0026#34; type = string sensitive = true } variable \u0026#34;db_password\u0026#34; { description = \u0026#34;ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰\u0026#34; type = string sensitive = true } outputs.tf\noutput \u0026#34;address\u0026#34; { value = aws_db_instance.example.address description = \u0026#34;ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®æ¥ç¶šã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ\u0026#34; } output \u0026#34;port\u0026#34; { value = aws_db_instance.example.port description = \u0026#34;ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ãƒãƒ¼ãƒˆç•ªå·\u0026#34; } stage/services/webserver-cluster/ main.tf\nprovider \u0026#34;aws\u0026#34; { region = \u0026#34;ap-northeast-1\u0026#34; } terraform { backend \u0026#34;s3\u0026#34; { bucket = \u0026#34;tf-state-backend-20251128\u0026#34; key = \u0026#34;stage/services/webserver-cluster/terraform.tfstate\u0026#34; region = \u0026#34;ap-northeast-1\u0026#34; dynamodb_table = \u0026#34;tf-state-locks\u0026#34; encrypt = true } } # ----------------------------------------------------------------------------- # Data Sources # ----------------------------------------------------------------------------- data \u0026#34;aws_vpc\u0026#34; \u0026#34;default\u0026#34; { default = true } data \u0026#34;aws_subnets\u0026#34; \u0026#34;default\u0026#34; { filter { name = \u0026#34;vpc-id\u0026#34; values = [data.aws_vpc.default.id] } } data \u0026#34;terraform_remote_state\u0026#34; \u0026#34;db\u0026#34; { backend = \u0026#34;s3\u0026#34; config = { bucket = \u0026#34;tf-state-backend-20251128\u0026#34; key = \u0026#34;stage/data-stores/mysql/terraform.tfstate\u0026#34; region = \u0026#34;ap-northeast-1\u0026#34; } } # ----------------------------------------------------------------------------- # Launch Template \u0026amp; Auto Scaling Group # ----------------------------------------------------------------------------- resource \u0026#34;aws_launch_template\u0026#34; \u0026#34;example\u0026#34; { image_id = \u0026#34;ami-03852a41f1e05c8e4\u0026#34; instance_type = \u0026#34;t2.micro\u0026#34; vpc_security_group_ids = [aws_security_group.instance.id] user_data = base64encode(templatefile(\u0026#34;user-data.sh\u0026#34;, { server_port = var.server_port db_address = data.terraform_remote_state.db.outputs.address db_port = data.terraform_remote_state.db.outputs.port })) } resource \u0026#34;aws_autoscaling_group\u0026#34; \u0026#34;example\u0026#34; { vpc_zone_identifier = data.aws_subnets.default.ids launch_template { id = aws_launch_template.example.id version = \u0026#34;$Latest\u0026#34; } target_group_arns = [aws_lb_target_group.asg.arn] health_check_type = \u0026#34;ELB\u0026#34; min_size = 2 max_size = 10 tag { key = \u0026#34;Name\u0026#34; value = \u0026#34;terraform-asg-example\u0026#34; propagate_at_launch = true } } # ----------------------------------------------------------------------------- # Security Groups # ----------------------------------------------------------------------------- resource \u0026#34;aws_security_group\u0026#34; \u0026#34;instance\u0026#34; { name = var.instance_security_group_name ingress { from_port = var.server_port to_port = var.server_port protocol = \u0026#34;tcp\u0026#34; cidr_blocks = [\u0026#34;0.0.0.0/0\u0026#34;] } } resource \u0026#34;aws_security_group\u0026#34; \u0026#34;alb\u0026#34; { name = var.alb_security_group_name ingress { from_port = 80 to_port = 80 protocol = \u0026#34;tcp\u0026#34; cidr_blocks = [\u0026#34;0.0.0.0/0\u0026#34;] } egress { from_port = 0 to_port = 0 protocol = \u0026#34;-1\u0026#34; cidr_blocks = [\u0026#34;0.0.0.0/0\u0026#34;] } } # ----------------------------------------------------------------------------- # Application Load Balancer # ----------------------------------------------------------------------------- resource \u0026#34;aws_lb\u0026#34; \u0026#34;example\u0026#34; { name = var.alb_name load_balancer_type = \u0026#34;application\u0026#34; subnets = data.aws_subnets.default.ids security_groups = [aws_security_group.alb.id] } resource \u0026#34;aws_lb_listener\u0026#34; \u0026#34;http\u0026#34; { load_balancer_arn = aws_lb.example.arn port = 80 protocol = \u0026#34;HTTP\u0026#34; default_action { type = \u0026#34;fixed-response\u0026#34; fixed_response { content_type = \u0026#34;text/plain\u0026#34; message_body = \u0026#34;404: page not found\u0026#34; status_code = 404 } } } resource \u0026#34;aws_lb_target_group\u0026#34; \u0026#34;asg\u0026#34; { name = var.alb_name port = var.server_port protocol = \u0026#34;HTTP\u0026#34; vpc_id = data.aws_vpc.default.id health_check { path = \u0026#34;/\u0026#34; protocol = \u0026#34;HTTP\u0026#34; matcher = \u0026#34;200\u0026#34; interval = 15 timeout = 3 healthy_threshold = 2 unhealthy_threshold = 2 } } resource \u0026#34;aws_lb_listener_rule\u0026#34; \u0026#34;asg\u0026#34; { listener_arn = aws_lb_listener.http.arn priority = 100 condition { path_pattern { values = [\u0026#34;*\u0026#34;] } } action { type = \u0026#34;forward\u0026#34; target_group_arn = aws_lb_target_group.asg.arn } } variables.tf\nvariable \u0026#34;server_port\u0026#34; { description = \u0026#34;HTTPãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å—ã‘ä»˜ã‘ã‚‹ãƒãƒ¼ãƒˆç•ªå·\u0026#34; type = number default = 8080 } variable \u0026#34;alb_name\u0026#34; { description = \u0026#34;ALBã®åå‰\u0026#34; type = string default = \u0026#34;terraform-asg-example\u0026#34; } variable \u0026#34;alb_security_group_name\u0026#34; { description = \u0026#34;ALBç”¨ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚°ãƒ«ãƒ¼ãƒ—ã®åå‰\u0026#34; type = string default = \u0026#34;terraform-example-alb\u0026#34; } variable \u0026#34;instance_security_group_name\u0026#34; { description = \u0026#34;EC2ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ç”¨ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚°ãƒ«ãƒ¼ãƒ—ã®åå‰\u0026#34; type = string default = \u0026#34;terraform-example-instance\u0026#34; } outputs.tf\noutput \u0026#34;alb_dns_name\u0026#34; { value = aws_lb.example.dns_name description = \u0026#34;ãƒ­ãƒ¼ãƒ‰ãƒãƒ©ãƒ³ã‚µãƒ¼ã®DNSå\u0026#34; } output \u0026#34;asg_name\u0026#34; { value = aws_autoscaling_group.example.name description = \u0026#34;Auto Scaling Groupã®åå‰\u0026#34; } user-data.sh\n#!/bin/bash cd /home/ec2-user cat \u0026gt; index.html \u0026lt;\u0026lt;EOF \u0026lt;h1\u0026gt;Hello, World\u0026lt;/h1\u0026gt; \u0026lt;p\u0026gt;DB address: ${db_address}\u0026lt;/p\u0026gt; \u0026lt;p\u0026gt;DB port: ${db_port}\u0026lt;/p\u0026gt; EOF nohup python3 -m http.server ${server_port} \u0026amp; ã¾ã¨ã‚ # å­¦ã‚“ã ã“ã¨ # é …ç›® å†…å®¹ ãƒ•ã‚¡ã‚¤ãƒ«ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆåˆ†é›¢ ç’°å¢ƒãƒ»ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã”ã¨ã«ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’åˆ†ã‘ã¦å®Œå…¨åˆ†é›¢ outputs.tf ä»–ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«å…¬é–‹ã—ãŸã„å€¤ã‚’å®šç¾© terraform_remote_state åˆ¥ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®outputã‚’å‚ç…§ templatefile å¤–éƒ¨ãƒ•ã‚¡ã‚¤ãƒ«ã«å¤‰æ•°ã‚’åŸ‹ã‚è¾¼ã‚€ å‰Šé™¤é †åº ä¾å­˜ã™ã‚‹å´ â†’ ä¾å­˜ã•ã‚Œã‚‹å´ã®é †ã§å‰Šé™¤ ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ vs ãƒ•ã‚¡ã‚¤ãƒ«ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ # è¦³ç‚¹ ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ ãƒ•ã‚¡ã‚¤ãƒ«ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ è¨­å®šã®æ‰‹è»½ã• ç°¡å˜ ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆãŒå¿…è¦ æ¨©é™åˆ†é›¢ å›°é›£ï¼ˆåŒä¸€ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ï¼‰ å¯èƒ½ï¼ˆåˆ¥ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ï¼‰ å¯è¦–æ€§ ä½ã„ é«˜ã„ï¼ˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªåã§æ˜ç¢ºï¼‰ ã‚³ãƒ¼ãƒ‰é‡è¤‡ ãªã— ã‚ã‚Šï¼ˆch4ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã§è§£æ±ºï¼‰ æ¨å¥¨ç”¨é€” å€‹äººé–‹ç™ºãƒ»å®Ÿé¨“ æœ¬ç•ªç’°å¢ƒãƒ»ãƒãƒ¼ãƒ é–‹ç™º ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ # å„ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®keyã¯ä¸€æ„ã‹ RDSã®outputs.tfã§address/portã‚’å‡ºåŠ›ã—ã¦ã„ã‚‹ã‹ terraform_remote_stateã®keyã¯RDSã¨ä¸€è‡´ã—ã¦ã„ã‚‹ã‹ å‰Šé™¤ã¯ä¾å­˜é–¢ä¿‚ã®é€†é †ã§è¡Œã£ã¦ã„ã‚‹ã‹ å‚è€ƒ # è©³è§£ Terraform ç¬¬3ç‰ˆ â€•Infrastructure as Codeã‚’å®Ÿç¾ã™ã‚‹ è‘—è€…ï¼šYevgeniy Brikman è¨³è€…ï¼šæ¾æµ¦ éš¼äºº å‡ºç‰ˆç¤¾ï¼šã‚ªãƒ©ã‚¤ãƒªãƒ¼ã‚¸ãƒ£ãƒ‘ãƒ³ å‡ºç‰ˆå¹´ï¼š2023å¹´ Terraformå…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ Terraformã‚¹ãƒ†ãƒ¼ãƒˆç®¡ç† Part1 - S3ãƒªãƒ¢ãƒ¼ãƒˆãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã¨ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ ","date":"2025å¹´ 11æœˆ 28æ—¥","externalUrl":null,"permalink":"/posts/251128193149_terraform-file-layout-separation/","section":"Posts","summary":"","title":"Terraformã‚¹ãƒ†ãƒ¼ãƒˆç®¡ç† Part2 - ãƒ•ã‚¡ã‚¤ãƒ«ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã¨terraform_remote_state","type":"posts"},{"content":" ä»Šæ—¥å­¦ã‚“ã ã“ã¨ # Terraformã®ã‚¹ãƒ†ãƒ¼ãƒˆç®¡ç†ã«ã¤ã„ã¦ã€S3ãƒªãƒ¢ãƒ¼ãƒˆãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã®æ§‹ç¯‰ã‹ã‚‰ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ã«ã‚ˆã‚‹ç’°å¢ƒåˆ†é›¢ã¾ã§å®Ÿè·µã—ãŸã€‚é€”ä¸­ã§ã‚¹ãƒ†ãƒ¼ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã®ä¸Šæ›¸ãäº‹æ•…ã‚‚çµŒé¨“ã—ã€ãã®å¾©æ—§ä½œæ¥­ã‹ã‚‰å¤šãã®æ•™è¨“ã‚’å¾—ãŸã€‚\nTerraformã‚¹ãƒ†ãƒ¼ãƒˆã¨ã¯ # Terraformã¯ã‚¤ãƒ³ãƒ•ãƒ©ã®ç¾åœ¨çŠ¶æ…‹ã‚’terraform.tfstateã¨ã„ã†ãƒ•ã‚¡ã‚¤ãƒ«ã«è¨˜éŒ²ã—ã¦ã„ã‚‹ã€‚terraform planã‚„terraform applyã‚’å®Ÿè¡Œã™ã‚‹ã¨ã€ã“ã®ã‚¹ãƒ†ãƒ¼ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã¨AWSã®å®Ÿéš›ã®çŠ¶æ…‹ã‚’æ¯”è¼ƒã—ã¦å·®åˆ†ã‚’æ¤œå‡ºã™ã‚‹ã€‚\n{ \u0026#34;version\u0026#34;: 4, \u0026#34;terraform_version\u0026#34;: \u0026#34;1.6.0\u0026#34;, \u0026#34;serial\u0026#34;: 42, \u0026#34;resources\u0026#34;: [] } å€‹äººé–‹ç™ºã§ã¯ãƒ­ãƒ¼ã‚«ãƒ«ä¿å­˜ã§å•é¡Œãªã„ãŒã€ãƒãƒ¼ãƒ é–‹ç™ºã§ã¯ä»¥ä¸‹ã®èª²é¡ŒãŒç™ºç”Ÿã™ã‚‹\nèª²é¡Œ å•é¡Œç‚¹ å…±æœ‰ ãƒ¡ãƒ³ãƒãƒ¼é–“ã§ã‚¹ãƒ†ãƒ¼ãƒˆã‚’å…±æœ‰ã§ããªã„ ãƒ­ãƒƒã‚¯ åŒæ™‚ç·¨é›†ã§ç«¶åˆãŒç™ºç”Ÿã™ã‚‹ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ æ©Ÿå¯†æƒ…å ±ãŒãƒ­ãƒ¼ã‚«ãƒ«ã«æ®‹ã‚‹ ã“ã‚Œã‚’è§£æ±ºã™ã‚‹ã®ãŒãƒªãƒ¢ãƒ¼ãƒˆãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã€‚\nStep 1: ãƒªãƒ¢ãƒ¼ãƒˆãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ç”¨ã®S3ãƒ»DynamoDBã‚’ä½œæˆ # ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªä½œæˆ # mkdir -p ~/terraform-state-study cd ~/terraform-state-study main.tfã‚’ä½œæˆ # # main.tf provider \u0026#34;aws\u0026#34; { region = \u0026#34;ap-northeast-1\u0026#34; } # S3ãƒã‚±ãƒƒãƒˆï¼ˆã‚¹ãƒ†ãƒ¼ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ä¿ç®¡ç”¨ï¼‰ resource \u0026#34;aws_s3_bucket\u0026#34; \u0026#34;terraform_state\u0026#34; { # é‡è¦: ãƒã‚±ãƒƒãƒˆåã¯AWSå…¨ä½“ã§ã‚°ãƒ­ãƒ¼ãƒãƒ«ã«ä¸€æ„ã«ã™ã‚‹ã“ã¨ bucket = \u0026#34;tf-state-backend-20251128\u0026#34; # èª¤å‰Šé™¤é˜²æ­¢ï¼ˆå­¦ç¿’æ™‚ã¯ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆï¼‰ # lifecycle { # prevent_destroy = true # } } # ãƒãƒ¼ã‚¸ãƒ§ãƒ‹ãƒ³ã‚°æœ‰åŠ¹åŒ–ï¼ˆãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯å¯èƒ½ã«ï¼‰ resource \u0026#34;aws_s3_bucket_versioning\u0026#34; \u0026#34;enabled\u0026#34; { bucket = aws_s3_bucket.terraform_state.id versioning_configuration { status = \u0026#34;Enabled\u0026#34; } } # ã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰æš—å·åŒ– resource \u0026#34;aws_s3_bucket_server_side_encryption_configuration\u0026#34; \u0026#34;default\u0026#34; { bucket = aws_s3_bucket.terraform_state.id rule { apply_server_side_encryption_by_default { sse_algorithm = \u0026#34;AES256\u0026#34; } } } # ãƒ‘ãƒ–ãƒªãƒƒã‚¯ã‚¢ã‚¯ã‚»ã‚¹ãƒ–ãƒ­ãƒƒã‚¯ resource \u0026#34;aws_s3_bucket_public_access_block\u0026#34; \u0026#34;public_access\u0026#34; { bucket = aws_s3_bucket.terraform_state.id block_public_acls = true block_public_policy = true ignore_public_acls = true restrict_public_buckets = true } # DynamoDBãƒ†ãƒ¼ãƒ–ãƒ«ï¼ˆãƒ­ãƒƒã‚¯ç”¨ï¼‰ resource \u0026#34;aws_dynamodb_table\u0026#34; \u0026#34;terraform_locks\u0026#34; { name = \u0026#34;tf-state-locks\u0026#34; billing_mode = \u0026#34;PAY_PER_REQUEST\u0026#34; hash_key = \u0026#34;LockID\u0026#34; # å¤§æ–‡å­—å°æ–‡å­—ã‚’å®Œå…¨ä¸€è‡´ã•ã›ã‚‹ã“ã¨ attribute { name = \u0026#34;LockID\u0026#34; type = \u0026#34;S\u0026#34; } } ãƒ‡ãƒ—ãƒ­ã‚¤ # terraform init terraform validate terraform apply æœ€åˆã«tf-state-backendã¨ã„ã†ãƒã‚±ãƒƒãƒˆåã§è©¦ã—ãŸã¨ã“ã‚ã€æ—¢ã«ä»–ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ä½¿ã‚ã‚Œã¦ã„ã¦ã‚¨ãƒ©ãƒ¼ã«ãªã£ãŸã€‚S3ãƒã‚±ãƒƒãƒˆåã¯ã‚°ãƒ­ãƒ¼ãƒãƒ«ã§ä¸€æ„ã§ã‚ã‚‹å¿…è¦ãŒã‚ã‚‹ãŸã‚ã€æ—¥ä»˜ã‚’è¿½åŠ ã—ã¦è§£æ±ºã—ãŸã€‚\nlifecycleã¯èª¤å‰Šé™¤ã‚’é˜²æ­¢ã™ã‚‹ã“ã¨ãŒç›®çš„ãªã®ã§ã€ãƒªã‚½ãƒ¼ã‚¹å‰Šé™¤æ™‚ã¯ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆãŒå¿…è¦ã€‚\nlifecycle { prevent_destroy = true } Step 2: ã‚¹ãƒ†ãƒ¼ãƒˆã‚’S3ã«ç§»è¡Œ # ã“ã®æ™‚ç‚¹ã§ã¯ã‚¹ãƒ†ãƒ¼ãƒˆã¯ã¾ã ãƒ­ãƒ¼ã‚«ãƒ«ã«ä¿å­˜ã•ã‚Œã¦ã„ã‚‹ã€‚S3ã«ç§»è¡Œã™ã‚‹ãŸã‚ã«backendè¨­å®šã‚’è¿½åŠ ã™ã‚‹ã€‚\nbackend.hclã‚’ä½œæˆï¼ˆéƒ¨åˆ†è¨­å®šï¼‰ # backendãƒ–ãƒ­ãƒƒã‚¯ã§ã¯å¤‰æ•°ãŒä½¿ãˆãªã„ãŸã‚ã€å…±é€šè¨­å®šã‚’å¤–éƒ¨ãƒ•ã‚¡ã‚¤ãƒ«ã«åˆ‡ã‚Šå‡ºã™ã€‚\n# backend.hcl bucket = \u0026#34;tf-state-backend-20251128\u0026#34; region = \u0026#34;ap-northeast-1\u0026#34; dynamodb_table = \u0026#34;tf-state-locks\u0026#34; encrypt = true main.tfã«backendè¨­å®šã‚’è¿½åŠ  # terraform { backend \u0026#34;s3\u0026#34; { key = \u0026#34;global/s3/terraform.tfstate\u0026#34; } } ã‚¹ãƒ†ãƒ¼ãƒˆã‚’ç§»è¡Œ # terraform init -backend-config=backend.hcl ã€Œæ—¢å­˜ã®ã‚¹ãƒ†ãƒ¼ãƒˆã‚’S3ã«ã‚³ãƒ”ãƒ¼ã™ã‚‹ã‹ï¼Ÿã€ã¨èã‹ã‚Œã‚‹ã®ã§yesã‚’å…¥åŠ›ã€‚\nS3ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã§global/s3/terraform.tfstateãŒä½œæˆã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã§ããŸã€‚\nStep 3: ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ã«ã‚ˆã‚‹åˆ†é›¢ã‚’ä½“é¨“ # åŒã˜ã‚³ãƒ¼ãƒ‰ã§è¤‡æ•°ã®ç’°å¢ƒï¼ˆdefaultã€stagingã€prodãªã©ï¼‰ã‚’ç®¡ç†ã™ã‚‹ä»•çµ„ã¿ã€‚\nãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ç”¨ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªä½œæˆ # mkdir -p ~/terraform-state-study-workspace cd ~/terraform-state-study-workspace main.tfã‚’ä½œæˆ # provider \u0026#34;aws\u0026#34; { region = \u0026#34;ap-northeast-1\u0026#34; } resource \u0026#34;aws_instance\u0026#34; \u0026#34;example\u0026#34; { ami = \u0026#34;ami-03852a41f1e05c8e4\u0026#34; instance_type = \u0026#34;t2.micro\u0026#34; } terraform { backend \u0026#34;s3\u0026#34; { # é‡è¦: Step 1ï¼ˆãƒªãƒ¢ãƒ¼ãƒˆãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ç”¨ï¼‰ã¨ç•°ãªã‚‹keyã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ï¼ key = \u0026#34;workspace-example/terraform.tfstate\u0026#34; bucket = \u0026#34;tf-state-backend-20251128\u0026#34; region = \u0026#34;ap-northeast-1\u0026#34; dynamodb_table = \u0026#34;tf-state-locks\u0026#34; encrypt = true } } ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ã®æ“ä½œ # terraform init terraform apply # ç¾åœ¨ã®ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ç¢ºèª terraform workspace show # =\u0026gt; default # æ–°ã—ã„ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ä½œæˆ terraform workspace new example1 terraform apply # åˆ¥ã®EC2ãŒä½œæˆã•ã‚Œã‚‹ # ã•ã‚‰ã«ä½œæˆ terraform workspace new example2 terraform apply # ä¸€è¦§ç¢ºèª terraform workspace list # default # example1 # * example2 # åˆ‡ã‚Šæ›¿ãˆ terraform workspace select example1 S3ã«ã¯ä»¥ä¸‹ã®ãƒ‘ã‚¹ã§ã‚¹ãƒ†ãƒ¼ãƒˆãŒä¿å­˜ã•ã‚Œã‚‹ï¼š\ns3://bucket/ â”œâ”€â”€ workspace-example/terraform.tfstate # default â””â”€â”€ env:/ â”œâ”€â”€ example1/workspace-example/terraform.tfstate â””â”€â”€ example2/workspace-example/terraform.tfstate ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ— # # å„ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ã§destroy terraform workspace select example1 \u0026amp;\u0026amp; terraform destroy terraform workspace select example2 \u0026amp;\u0026amp; terraform destroy terraform workspace select default \u0026amp;\u0026amp; terraform destroy å®Ÿéš›ã«èµ·ããŸãƒˆãƒ©ãƒ–ãƒ«ã¨æ•™è¨“ # äº‹æ•…: åŒã˜keyã‚’ä½¿ã„å›ã—ã¦ã‚¹ãƒ†ãƒ¼ãƒˆãŒä¸Šæ›¸ãã•ã‚ŒãŸ # Step 3ï¼ˆãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ï¼‰ã§terraform applyã‚’å®Ÿè¡Œã—ãŸéš›ã€æœ€åˆã¯Step 1ã¨åŒã˜keyï¼ˆglobal/s3/terraform.tfstateï¼‰ã‚’ä½¿ã£ã¦ã—ã¾ã£ãŸã€‚\nãã®çµæœï¼š\nStep 1ã§ä½œæˆã—ãŸS3ãƒ»DynamoDBãƒªã‚½ãƒ¼ã‚¹ã®ã‚¹ãƒ†ãƒ¼ãƒˆãŒä¸Šæ›¸ãã•ã‚ŒãŸ Step 3ã®ã‚³ãƒ¼ãƒ‰ã«ã¯DynamoDBã®å®šç¾©ãŒãªã„ãŸã‚ã€Terraformã¯ã€Œå‰Šé™¤ã™ã¹ããƒªã‚½ãƒ¼ã‚¹ã€ã¨åˆ¤æ–­ DynamoDBãƒ†ãƒ¼ãƒ–ãƒ«ãŒå‰Šé™¤ã•ã‚ŒãŸ ä»¥é™ã®Terraformæ“ä½œã§ãƒ­ãƒƒã‚¯ãŒå–ã‚Œãšã‚¨ãƒ©ãƒ¼ Error: Error acquiring the state lock ResourceNotFoundException: Requested resource not found å¾©æ—§æ–¹æ³• # # ç·Šæ€¥æ™‚ã®ã¿: ãƒ­ãƒƒã‚¯ã‚’ã‚¹ã‚­ãƒƒãƒ—ã—ã¦destroy terraform destroy -lock=false S3ãƒã‚±ãƒƒãƒˆã¯ãƒãƒ¼ã‚¸ãƒ§ãƒ‹ãƒ³ã‚°ãŒæœ‰åŠ¹ãªãŸã‚ã€å…¨ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’å‰Šé™¤ã—ãªã„ã¨å‰Šé™¤ã§ããªã„ï¼š\n# ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãƒãƒ¼ã‚¸ãƒ§ãƒ³ç¢ºèª aws s3api list-object-versions --bucket \u0026lt;ãƒã‚±ãƒƒãƒˆå\u0026gt; --region ap-northeast-1 # å…¨ãƒãƒ¼ã‚¸ãƒ§ãƒ³å‰Šé™¤å¾Œã€ãƒã‚±ãƒƒãƒˆå‰Šé™¤ aws s3 rb s3://\u0026lt;ãƒã‚±ãƒƒãƒˆå\u0026gt; æ•™è¨“ # æ•™è¨“ å¯¾ç­– keyã¯å¿…ãšä¸€æ„ã«ã™ã‚‹ å„ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§project-name/terraform.tfstateã®ã‚ˆã†ã«åˆ†ã‘ã‚‹ ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã®ã‚¤ãƒ³ãƒ•ãƒ©ã¯æ…é‡ã« S3ãƒ»DynamoDBãŒç ´å£Šã•ã‚Œã‚‹ã¨å…¨ã¦ã«å½±éŸ¿ã™ã‚‹ -lock=falseã¯ç·Šæ€¥æ™‚ã®ã¿ ç«¶åˆãƒªã‚¹ã‚¯ãŒã‚ã‚‹ãŸã‚é€šå¸¸ã¯ä½¿ç”¨ã—ãªã„ ãƒ•ã‚¡ã‚¤ãƒ«ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã«ã‚ˆã‚‹åˆ†é›¢ï¼ˆæ¦‚è¦ï¼‰ # ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ã«ã¯ä»¥ä¸‹ã®æ¬ ç‚¹ãŒã‚ã‚‹ï¼š\nå…¨ç’°å¢ƒã§åŒã˜ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚’ä½¿ç”¨ï¼ˆæ¨©é™åˆ†é›¢ãŒå›°é›£ï¼‰ ã©ã®ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ã«ã„ã‚‹ã‹åˆ†ã‹ã‚Šã«ãã„ èª¤æ“ä½œã§æœ¬ç•ªç’°å¢ƒã‚’ç ´å£Šã™ã‚‹ãƒªã‚¹ã‚¯ ã‚ˆã‚Šå …ç‰¢ãªåˆ†é›¢ã«ã¯ã€ç’°å¢ƒã”ã¨ã«ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’åˆ†ã‘ã‚‹æ–¹æ³•ãŒæ¨å¥¨ã•ã‚Œã‚‹ï¼š\nterraform-project/ â”œâ”€â”€ stage/ # ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ç’°å¢ƒ â”‚ â”œâ”€â”€ data-stores/mysql/ # DBå±¤ â”‚ â””â”€â”€ services/webserver-cluster/ # Appå±¤ â””â”€â”€ prod/ # æœ¬ç•ªç’°å¢ƒï¼ˆå®Œå…¨ã«åˆ¥ç®¡ç†ï¼‰ åˆ†é›¢ã—ãŸã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆé–“ï¼ˆä¾‹: RDSã¨Webã‚µãƒ¼ãƒãƒ¼ï¼‰ã§æƒ…å ±ã‚’å…±æœ‰ã™ã‚‹ã«ã¯ã€terraform_remote_stateãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ã‚’ä½¿ç”¨ã™ã‚‹ã€‚\nè©³ç´°ãªå®Ÿè£…æ‰‹é †ï¼ˆRDSæ§‹ç¯‰ã€terraform_remote_stateã«ã‚ˆã‚‹é€£æºã€templatefileé–¢æ•°ã®æ´»ç”¨ï¼‰ã¯Part2ã§è§£èª¬ã€‚\nå®Œæˆå½¢ã®ã‚³ãƒ¼ãƒ‰ # ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆ # ~/terraform-state-study/ # Step 1: ãƒªãƒ¢ãƒ¼ãƒˆãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ç”¨ â”œâ”€â”€ main.tf â””â”€â”€ backend.hcl ~/terraform-state-study-workspace/ # Step 3: ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹æ¤œè¨¼ç”¨ â””â”€â”€ main.tf Step 1: ãƒªãƒ¢ãƒ¼ãƒˆãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ç”¨ï¼ˆ~/terraform-state-study/ï¼‰ main.tf\nprovider \u0026#34;aws\u0026#34; { region = \u0026#34;ap-northeast-1\u0026#34; } # S3ãƒã‚±ãƒƒãƒˆï¼ˆã‚¹ãƒ†ãƒ¼ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ä¿ç®¡ç”¨ï¼‰ resource \u0026#34;aws_s3_bucket\u0026#34; \u0026#34;terraform_state\u0026#34; { bucket = \u0026#34;tf-state-backend-20251128\u0026#34; # lifecycle { # prevent_destroy = true # } } # ãƒãƒ¼ã‚¸ãƒ§ãƒ‹ãƒ³ã‚°æœ‰åŠ¹åŒ– resource \u0026#34;aws_s3_bucket_versioning\u0026#34; \u0026#34;enabled\u0026#34; { bucket = aws_s3_bucket.terraform_state.id versioning_configuration { status = \u0026#34;Enabled\u0026#34; } } # ã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰æš—å·åŒ– resource \u0026#34;aws_s3_bucket_server_side_encryption_configuration\u0026#34; \u0026#34;default\u0026#34; { bucket = aws_s3_bucket.terraform_state.id rule { apply_server_side_encryption_by_default { sse_algorithm = \u0026#34;AES256\u0026#34; } } } # ãƒ‘ãƒ–ãƒªãƒƒã‚¯ã‚¢ã‚¯ã‚»ã‚¹ãƒ–ãƒ­ãƒƒã‚¯ resource \u0026#34;aws_s3_bucket_public_access_block\u0026#34; \u0026#34;public_access\u0026#34; { bucket = aws_s3_bucket.terraform_state.id block_public_acls = true block_public_policy = true ignore_public_acls = true restrict_public_buckets = true } # DynamoDBãƒ†ãƒ¼ãƒ–ãƒ«ï¼ˆãƒ­ãƒƒã‚¯ç”¨ï¼‰ resource \u0026#34;aws_dynamodb_table\u0026#34; \u0026#34;terraform_locks\u0026#34; { name = \u0026#34;tf-state-locks\u0026#34; billing_mode = \u0026#34;PAY_PER_REQUEST\u0026#34; hash_key = \u0026#34;LockID\u0026#34; attribute { name = \u0026#34;LockID\u0026#34; type = \u0026#34;S\u0026#34; } } terraform { backend \u0026#34;s3\u0026#34; { key = \u0026#34;global/s3/terraform.tfstate\u0026#34; } } backend.hcl\nbucket = \u0026#34;tf-state-backend-20251128\u0026#34; region = \u0026#34;ap-northeast-1\u0026#34; dynamodb_table = \u0026#34;tf-state-locks\u0026#34; encrypt = true Step 3: ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ç”¨ï¼ˆ~/terraform-state-study-workspace/ï¼‰ main.tf\nprovider \u0026#34;aws\u0026#34; { region = \u0026#34;ap-northeast-1\u0026#34; } resource \u0026#34;aws_instance\u0026#34; \u0026#34;example\u0026#34; { ami = \u0026#34;ami-03852a41f1e05c8e4\u0026#34; instance_type = \u0026#34;t2.micro\u0026#34; } terraform { backend \u0026#34;s3\u0026#34; { key = \u0026#34;workspace-example/terraform.tfstate\u0026#34; bucket = \u0026#34;tf-state-backend-20251128\u0026#34; region = \u0026#34;ap-northeast-1\u0026#34; dynamodb_table = \u0026#34;tf-state-locks\u0026#34; encrypt = true } } ã¾ã¨ã‚ # å­¦ã‚“ã ã“ã¨ # ãƒªãƒ¢ãƒ¼ãƒˆãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰: S3 + DynamoDBã§ã‚¹ãƒ†ãƒ¼ãƒˆç®¡ç†ã¨ãƒ­ãƒƒã‚¯ã‚’å®Ÿç¾ éƒ¨åˆ†è¨­å®š: backend.hclã§å…±é€šè¨­å®šã‚’åˆ‡ã‚Šå‡ºã—ã¦ã‚³ãƒ”ãƒšã‚’å‰Šæ¸› ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹: ç°¡æ˜“ãªç’°å¢ƒåˆ†é›¢ã ãŒã€å¯è¦–æ€§ãŒä½ãèª¤æ“ä½œãƒªã‚¹ã‚¯ã‚ã‚Š ãƒ•ã‚¡ã‚¤ãƒ«ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ: æœ¬ç•ªç’°å¢ƒã®åˆ†é›¢ã«ã¯ç’°å¢ƒã”ã¨ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªåˆ†å‰²ãŒæ¨å¥¨ï¼ˆPart2ã§å®Ÿè·µï¼‰ ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ # S3ãƒã‚±ãƒƒãƒˆåã¯ã‚°ãƒ­ãƒ¼ãƒãƒ«ã§ä¸€æ„ã‹ DynamoDBã®ãƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼ã¯LockIDï¼ˆå¤§æ–‡å­—å°æ–‡å­—ä¸€è‡´ï¼‰ã‹ å„ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®keyã¯ä¸€æ„ã‹ å‚è€ƒ # è©³è§£ Terraform ç¬¬3ç‰ˆ â€•Infrastructure as Codeã‚’å®Ÿç¾ã™ã‚‹ è‘—è€…ï¼šYevgeniy Brikman è¨³è€…ï¼šæ¾æµ¦ éš¼äºº å‡ºç‰ˆç¤¾ï¼šã‚ªãƒ©ã‚¤ãƒªãƒ¼ã‚¸ãƒ£ãƒ‘ãƒ³ å‡ºç‰ˆå¹´ï¼š2023å¹´ Terraformå…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ Terraformã‚¹ãƒ†ãƒ¼ãƒˆç®¡ç† Part2 - ãƒ•ã‚¡ã‚¤ãƒ«ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã¨terraform_remote_state ","date":"2025å¹´ 11æœˆ 28æ—¥","externalUrl":null,"permalink":"/posts/251128185824_terraform-state-management-intro/","section":"Posts","summary":"","title":"Terraformã‚¹ãƒ†ãƒ¼ãƒˆç®¡ç† Part1 - S3ãƒªãƒ¢ãƒ¼ãƒˆãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã¨ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹","type":"posts"},{"content":" ã¯ã˜ã‚ã« # æœ¬è¨˜äº‹ã¯ã€Œè©³è§£Terraformã€ã®ch2ã§å­¦ã‚“ã å†…å®¹ã‚’å‚è€ƒã«ã—ã¦ãƒãƒ³ã‚ºã‚ªãƒ³å½¢å¼ã§ã¾ã¨ã‚ãŸã‚‚ã®ã§ã™ã€‚ Terraformã‚’ä½¿ã£ã¦ã€ã‚¼ãƒ­ã‹ã‚‰AWSç’°å¢ƒã‚’æ§‹ç¯‰ã—ã€æœ€å¾Œã«ã™ã¹ã¦å‰Šé™¤ã™ã‚‹ã¾ã§ã‚’ä¸€æ°—ã«ä½“é¨“ã—ã¾ã™ã€‚\næœ€çµ‚çš„ã«ä½œã‚‹ã‚‚ã® # [ãƒ¦ãƒ¼ã‚¶ãƒ¼] â†’ [ALB:80] â†’ [ASG] â†’ [EC2 Ã— 2å°:8080] ALBï¼ˆApplication Load Balancerï¼‰ã§ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ã‚’å—ã‘ä»˜ã‘ Auto Scaling Groupï¼ˆASGï¼‰ã§2å°ã®EC2ã‚’ç®¡ç† å„EC2ã¯ãƒãƒ¼ãƒˆ8080ã§Webã‚µãƒ¼ãƒã‚’èµ·å‹• 1. äº‹å‰æº–å‚™ # 1-1. AWSã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®ä½œæˆ # AWSã‚¢ã‚«ã‚¦ãƒ³ãƒˆãŒãªã„å ´åˆã¯ã€AWSå…¬å¼ã‚µã‚¤ãƒˆã‹ã‚‰ä½œæˆã—ã¦ãã ã•ã„ã€‚\nä½œæ¥­ç”¨ã®IAMãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’ä½œæˆã—ã€é©åˆ‡ãªæ¨©é™ã‚’ä»˜ä¸ã™ã‚‹ã“ã¨ã‚’æ¨å¥¨ã—ã¾ã™ã€‚\n1-2. AWS CLIã®è¨­å®š # # AWS CLIã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ï¼ˆUbuntu/WSLï¼‰ sudo apt update sudo apt install -y unzip curl curl \u0026#34;https://awscli.amazonaws.com/awscli-exe-linux-x86_64.zip\u0026#34; -o \u0026#34;awscliv2.zip\u0026#34; unzip awscliv2.zip sudo ./aws/install # ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç¢ºèª aws --version # èªè¨¼æƒ…å ±ã‚’è¨­å®š aws configure # â†’ Access Key ID, Secret Access Key, Region(ap-northeast-1)ã‚’å…¥åŠ› 1-3. Terraformã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« # # Ubuntu/WSL sudo apt update \u0026amp;\u0026amp; sudo apt install -y gnupg software-properties-common # HashiCorpã®GPGã‚­ãƒ¼ã‚’è¿½åŠ  wget -O- https://apt.releases.hashicorp.com/gpg | \\ gpg --dearmor | \\ sudo tee /usr/share/keyrings/hashicorp-archive-keyring.gpg \u0026gt; /dev/null # ãƒªãƒã‚¸ãƒˆãƒªã‚’è¿½åŠ  echo \u0026#34;deb [signed-by=/usr/share/keyrings/hashicorp-archive-keyring.gpg] \\ https://apt.releases.hashicorp.com $(lsb_release -cs) main\u0026#34; | \\ sudo tee /etc/apt/sources.list.d/hashicorp.list # Terraformã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« sudo apt update \u0026amp;\u0026amp; sudo apt install -y terraform # ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç¢ºèª terraform version 1-4. ä½œæ¥­ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ä½œæˆ # mkdir terraform-handson cd terraform-handson 2. ã‚µãƒ¼ãƒ1å°ã ã‘ãƒ‡ãƒ—ãƒ­ã‚¤ # ã¾ãšã¯æœ€ã‚‚ã‚·ãƒ³ãƒ—ãƒ«ãªæ§‹æˆã‹ã‚‰ã€‚EC2ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹1å°ã‚’ãƒ‡ãƒ—ãƒ­ã‚¤ã—ã¾ã™ã€‚\nãªãœã“ã®å·¥ç¨‹ã‹ã‚‰å§‹ã‚ã‚‹ã®ã‹ï¼Ÿ Terraformã®åŸºæœ¬ã§ã‚ã‚‹providerï¼ˆã©ã®ã‚¯ãƒ©ã‚¦ãƒ‰ã‚’ä½¿ã†ã‹ï¼‰ã¨resourceï¼ˆä½•ã‚’ä½œã‚‹ã‹ï¼‰ã®æ¦‚å¿µã‚’ç†è§£ã™ã‚‹ãŸã‚ã€‚ã¾ãŸã€init â†’ plan â†’ applyã¨ã„ã†åŸºæœ¬ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’ä½“é¨“ã™ã‚‹ã“ã¨ã§ã€IaCã®ã€Œã‚³ãƒ¼ãƒ‰ã§ã‚¤ãƒ³ãƒ•ãƒ©ã‚’å®šç¾©ã—ã€ã‚³ãƒãƒ³ãƒ‰ã§æ§‹ç¯‰ã™ã‚‹ã€æµã‚Œã‚’æ´ã‚€ã€‚\n2-1. main.tfã‚’ä½œæˆ # provider \u0026#34;aws\u0026#34; { region = \u0026#34;ap-northeast-1\u0026#34; } resource \u0026#34;aws_instance\u0026#34; \u0026#34;example\u0026#34; { ami = \u0026#34;ami-03852a41f1e05c8e4\u0026#34; # Amazon Linux 2023ï¼ˆ2025å¹´11æœˆæ™‚ç‚¹ï¼‰ instance_type = \u0026#34;t2.micro\u0026#34; tags = { Name = \u0026#34;terraform-example\u0026#34; } } 2-2. Terraformã®åŸºæœ¬ã‚³ãƒãƒ³ãƒ‰ # # ãƒ—ãƒ­ãƒã‚¤ãƒ€ã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ï¼ˆåˆå›ã®ã¿ï¼‰ terraform init # å®Ÿè¡Œè¨ˆç”»ã‚’ç¢ºèªï¼ˆä½•ãŒä½œã‚‰ã‚Œã‚‹ã‹ï¼‰ terraform plan # å®Ÿéš›ã«ä½œæˆ terraform apply # â†’ \u0026#34;yes\u0026#34; ã¨å…¥åŠ› 2-3. ç¢ºèª # aws ec2 describe-instances \\ --filters \u0026#34;Name=tag:Name,Values=terraform-example\u0026#34; \\ --query \u0026#34;Reservations[].Instances[].{ID:InstanceId,State:State.Name}\u0026#34; \\ --output table ã“ã“ã¾ã§ã§å­¦ã‚“ã ã“ã¨ # è¦ç´  èª¬æ˜ provider ã©ã®ã‚¯ãƒ©ã‚¦ãƒ‰ã‚’ä½¿ã†ã‹ resource ä½•ã‚’ä½œã‚‹ã‹ terraform init åˆæœŸåŒ–ï¼ˆãƒ—ãƒ­ãƒã‚¤ãƒ€ã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ï¼‰ terraform plan å®Ÿè¡Œè¨ˆç”»ã®ç¢ºèª terraform apply å®Ÿéš›ã«é©ç”¨ 3. Webã‚µãƒ¼ãƒ1å°ã®ãƒ‡ãƒ—ãƒ­ã‚¤ # EC2ã‚’èµ·å‹•ã—ãŸã ã‘ã§ã¯ã‚¢ã‚¯ã‚»ã‚¹ã§ãã¾ã›ã‚“ã€‚ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚°ãƒ«ãƒ¼ãƒ—ã‚’è¿½åŠ ã—ã€Webã‚µãƒ¼ãƒã‚’å‹•ã‹ã—ã¾ã™ã€‚\nãªãœã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚°ãƒ«ãƒ¼ãƒ—ãŒå¿…è¦ãªã®ã‹ï¼Ÿ AWSã®EC2ã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã‚¤ãƒ³ãƒã‚¦ãƒ³ãƒ‰ãƒ»ã‚¢ã‚¦ãƒˆãƒã‚¦ãƒ³ãƒ‰ã®ä¸¡æ–¹ã®ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ã‚’è¨±å¯ã—ã¦ã„ãªã„ã€‚å¤–éƒ¨ã‹ã‚‰Webã‚µãƒ¼ãƒã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã«ã¯ã€ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚°ãƒ«ãƒ¼ãƒ—ã§æ˜ç¤ºçš„ã«ãƒãƒ¼ãƒˆã‚’é–‹æ”¾ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚\nãªãœãƒãƒ¼ãƒˆ8080ã‚’ä½¿ã†ã®ã‹ï¼Ÿ 1024ä»¥ä¸‹ã®ãƒãƒ¼ãƒˆï¼ˆ80ãªã©ï¼‰ã§ãƒªãƒƒã‚¹ãƒ³ã™ã‚‹ã«ã¯rootæ¨©é™ãŒå¿…è¦ã€‚ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¸Šã€ä¸€èˆ¬ãƒ¦ãƒ¼ã‚¶ãƒ¼æ¨©é™ã§èµ·å‹•ã§ãã‚‹8080ã‚’ä½¿ç”¨ã™ã‚‹ã€‚\nãªãœuser_dataã‚’ä½¿ã†ã®ã‹ï¼Ÿ EC2èµ·å‹•æ™‚ã«è‡ªå‹•ã§ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œã§ãã‚‹ã€‚æ‰‹å‹•ã§SSHæ¥ç¶šã—ã¦ã‚³ãƒãƒ³ãƒ‰ã‚’æ‰“ã¤å¿…è¦ãŒãªãã€ã‚¤ãƒ³ãƒ•ãƒ©æ§‹ç¯‰ã‚’å®Œå…¨ã«è‡ªå‹•åŒ–ã§ãã‚‹ã€‚\n3-1. main.tfã‚’æ›´æ–° # provider \u0026#34;aws\u0026#34; { region = \u0026#34;ap-northeast-1\u0026#34; } resource \u0026#34;aws_instance\u0026#34; \u0026#34;example\u0026#34; { ami = \u0026#34;ami-03852a41f1e05c8e4\u0026#34; # Amazon Linux 2023ï¼ˆ2025å¹´11æœˆæ™‚ç‚¹ï¼‰ instance_type = \u0026#34;t2.micro\u0026#34; vpc_security_group_ids = [aws_security_group.instance.id] user_data = \u0026lt;\u0026lt;-EOF #!/bin/bash cd /home/ec2-user echo \u0026#34;Hello, World\u0026#34; \u0026gt; index.html nohup python3 -m http.server 8080 \u0026amp; EOF user_data_replace_on_change = true tags = { Name = \u0026#34;terraform-example\u0026#34; } } resource \u0026#34;aws_security_group\u0026#34; \u0026#34;instance\u0026#34; { name = \u0026#34;terraform-example-instance\u0026#34; ingress { from_port = 8080 to_port = 8080 protocol = \u0026#34;tcp\u0026#34; cidr_blocks = [\u0026#34;0.0.0.0/0\u0026#34;] } } 3-2. é©ç”¨ã¨ç¢ºèª # terraform apply # ãƒ‘ãƒ–ãƒªãƒƒã‚¯IPã‚’å–å¾— PUBLIC_IP=$(aws ec2 describe-instances \\ --filters \u0026#34;Name=tag:Name,Values=terraform-example\u0026#34; \u0026#34;Name=instance-state-name,Values=running\u0026#34; \\ --query \u0026#34;Reservations[].Instances[].PublicIpAddress\u0026#34; \\ --output text) # ã‚¢ã‚¯ã‚»ã‚¹ç¢ºèª curl http://$PUBLIC_IP:8080 # â†’ \u0026#34;Hello, World\u0026#34; ãŒè¡¨ç¤ºã•ã‚Œã‚Œã°OK ã“ã“ã¾ã§ã§å­¦ã‚“ã ã“ã¨ # è¦ç´  èª¬æ˜ user_data èµ·å‹•æ™‚ã«å®Ÿè¡Œã™ã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆ aws_security_group ãƒ•ã‚¡ã‚¤ã‚¢ã‚¦ã‚©ãƒ¼ãƒ«è¨­å®š ãƒªã‚½ãƒ¼ã‚¹å‚ç…§ aws_security_group.instance.idã®ã‚ˆã†ã«ä»–ãƒªã‚½ãƒ¼ã‚¹ã‚’å‚ç…§ 4. è¨­å®šå¤‰æ›´å¯èƒ½ãªWebã‚µãƒ¼ãƒã®ãƒ‡ãƒ—ãƒ­ã‚¤ # ãƒãƒ¼ãƒˆç•ªå·ãŒã‚³ãƒ¼ãƒ‰å†…ã«æ•£ã‚‰ã°ã£ã¦ã„ã¾ã™ã€‚å¤‰æ•°åŒ–ã—ã¦DRYåŸå‰‡ã‚’å®ˆã‚Šã¾ã™ã€‚\nãªãœå¤‰æ•°åŒ–ãŒå¿…è¦ãªã®ã‹ï¼Ÿ ç¾çŠ¶ã€ãƒãƒ¼ãƒˆç•ªå·8080ãŒã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚°ãƒ«ãƒ¼ãƒ—ã¨user_dataã®2ç®‡æ‰€ã«æ›¸ã‹ã‚Œã¦ã„ã‚‹ã€‚ã“ã‚Œã¯DRYåŸå‰‡ï¼ˆDon\u0026rsquo;t Repeat Yourselfï¼‰ã«é•åã—ã¦ãŠã‚Šã€å¤‰æ›´æ™‚ã«ç‰‡æ–¹ã ã‘ä¿®æ­£ã—å¿˜ã‚Œã‚‹ãƒªã‚¹ã‚¯ãŒã‚ã‚‹ã€‚å¤‰æ•°åŒ–ã™ã‚‹ã“ã¨ã§ã€1ç®‡æ‰€ã®å¤‰æ›´ã§ã™ã¹ã¦ã«åæ˜ ã•ã‚Œã‚‹ã€‚\nå‡ºåŠ›å¤‰æ•°ï¼ˆoutputï¼‰ã®ç”¨é€”ã¯ï¼Ÿ terraform applyå¾Œã«ãƒ‘ãƒ–ãƒªãƒƒã‚¯IPãªã©ã®æƒ…å ±ã‚’è‡ªå‹•è¡¨ç¤ºã§ãã‚‹ã€‚AWS CLIã§æ¯å›ç¢ºèªã™ã‚‹æ‰‹é–“ãŒçœã‘ã€ä»–ã®Terraformæ§‹æˆã®å…¥åŠ›ã¨ã—ã¦ã‚‚åˆ©ç”¨å¯èƒ½ã€‚\n4-1. å¤‰æ•°ã‚’è¿½åŠ  # variable \u0026#34;server_port\u0026#34; { description = \u0026#34;The port the server will use for HTTP requests\u0026#34; type = number default = 8080 } 4-2. å¤‰æ•°ã‚’ä½¿ã† # ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚°ãƒ«ãƒ¼ãƒ—ã‚’ä¿®æ­£ï¼š\nresource \u0026#34;aws_security_group\u0026#34; \u0026#34;instance\u0026#34; { name = \u0026#34;terraform-example-instance\u0026#34; ingress { from_port = var.server_port to_port = var.server_port protocol = \u0026#34;tcp\u0026#34; cidr_blocks = [\u0026#34;0.0.0.0/0\u0026#34;] } } user_dataã‚‚ä¿®æ­£ï¼š\nuser_data = \u0026lt;\u0026lt;-EOF #!/bin/bash cd /home/ec2-user echo \u0026#34;Hello, World\u0026#34; \u0026gt; index.html nohup python3 -m http.server ${var.server_port} \u0026amp; EOF 4-3. å‡ºåŠ›å¤‰æ•°ã‚’è¿½åŠ  # output \u0026#34;public_ip\u0026#34; { value = aws_instance.example.public_ip description = \u0026#34;The public IP of the web server\u0026#34; } 4-4. é©ç”¨ã¨ç¢ºèª # terraform apply # å‡ºåŠ›å¤‰æ•°ã‚’ç¢ºèª terraform output public_ip ã“ã“ã¾ã§ã§å­¦ã‚“ã ã“ã¨ # è¦ç´  èª¬æ˜ variable å…¥åŠ›å¤‰æ•°ã®å®šç¾© var.xxx å¤‰æ•°ã®å‚ç…§ ${var.xxx} æ–‡å­—åˆ—å†…ã§ã®è£œé–“ output å‡ºåŠ›å¤‰æ•°ï¼ˆapplyå¾Œã«è¡¨ç¤ºï¼‰ 5. Webã‚µãƒ¼ãƒã®ã‚¯ãƒ©ã‚¹ã‚¿ã®ãƒ‡ãƒ—ãƒ­ã‚¤ # 1å°ã ã‘ã§ã¯å˜ä¸€éšœå®³ç‚¹ã§ã™ã€‚Auto Scaling Groupï¼ˆASGï¼‰ã§è¤‡æ•°å°ã‚’ç®¡ç†ã—ã¾ã™ã€‚\nãªãœASGãŒå¿…è¦ãªã®ã‹ï¼Ÿ ã‚µãƒ¼ãƒ1å°ã®ã¿ã®é‹ç”¨ã¯å˜ä¸€éšœå®³ç‚¹ï¼ˆSPOFï¼‰ã¨ãªã‚Šã€éšœå®³ç™ºç”Ÿæ™‚ã«ã‚µãƒ¼ãƒ“ã‚¹ãŒå®Œå…¨åœæ­¢ã™ã‚‹ãƒªã‚¹ã‚¯ãŒã‚ã‚‹ã€‚ASGã‚’ä½¿ãˆã°ã€è¤‡æ•°å°ã®EC2ã‚’è‡ªå‹•ç®¡ç†ã—ã€éšœå®³æ™‚ã‚‚è‡ªå‹•å¾©æ—§ã§ãã‚‹ã€‚\nãªãœãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ï¼ˆdataï¼‰ã‚’ä½¿ã†ã®ã‹ï¼Ÿ ASGã¯EC2ã‚’è¤‡æ•°ã®ã‚µãƒ–ãƒãƒƒãƒˆï¼ˆã‚¢ãƒ™ã‚¤ãƒ©ãƒ“ãƒªãƒ†ã‚£ã‚¾ãƒ¼ãƒ³ï¼‰ã«åˆ†æ•£é…ç½®ã™ã‚‹ã€‚æ—¢å­˜ã®VPC/ã‚µãƒ–ãƒãƒƒãƒˆæƒ…å ±ã‚’Terraformã§å–å¾—ã™ã‚‹ãŸã‚ã«dataãƒ–ãƒ­ãƒƒã‚¯ã‚’ä½¿ç”¨ã™ã‚‹ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€1ã¤ã®AZã«éšœå®³ãŒç™ºç”Ÿã—ã¦ã‚‚ä»–ã®AZã§ç¨¼åƒã‚’ç¶™ç¶šã§ãã‚‹ã€‚\nLaunch Templateã¨ã¯ï¼Ÿ ASGãŒæ–°ã—ã„EC2ã‚’èµ·å‹•ã™ã‚‹éš›ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã€‚AMIã€ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚¿ã‚¤ãƒ—ã€ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚°ãƒ«ãƒ¼ãƒ—ã€user_dataãªã©ã‚’å®šç¾©ã™ã‚‹ã€‚\n5-1. ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ã‚’è¿½åŠ  # VPCã¨ã‚µãƒ–ãƒãƒƒãƒˆã®æƒ…å ±ã‚’å–å¾—ï¼š\ndata \u0026#34;aws_vpc\u0026#34; \u0026#34;default\u0026#34; { default = true } data \u0026#34;aws_subnets\u0026#34; \u0026#34;default\u0026#34; { filter { name = \u0026#34;vpc-id\u0026#34; values = [data.aws_vpc.default.id] } } 5-2. Launch Templateã‚’è¿½åŠ  # ASGãŒèµ·å‹•ã™ã‚‹ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®è¨­å®šï¼š\nresource \u0026#34;aws_launch_template\u0026#34; \u0026#34;example\u0026#34; { image_id = \u0026#34;ami-03852a41f1e05c8e4\u0026#34; # Amazon Linux 2023ï¼ˆ2025å¹´11æœˆæ™‚ç‚¹ï¼‰ instance_type = \u0026#34;t2.micro\u0026#34; vpc_security_group_ids = [aws_security_group.instance.id] user_data = base64encode(\u0026lt;\u0026lt;-EOF #!/bin/bash cd /home/ec2-user echo \u0026#34;Hello, World\u0026#34; \u0026gt; index.html nohup python3 -m http.server ${var.server_port} \u0026amp; EOF ) } 5-3. ASGã‚’è¿½åŠ  # resource \u0026#34;aws_autoscaling_group\u0026#34; \u0026#34;example\u0026#34; { vpc_zone_identifier = data.aws_subnets.default.ids launch_template { id = aws_launch_template.example.id version = \u0026#34;$Latest\u0026#34; } min_size = 2 max_size = 10 tag { key = \u0026#34;Name\u0026#34; value = \u0026#34;terraform-asg-example\u0026#34; propagate_at_launch = true } } 5-4. å¤ã„EC2ãƒªã‚½ãƒ¼ã‚¹ã‚’å‰Šé™¤ # aws_instance \u0026quot;example\u0026quot; ãƒ–ãƒ­ãƒƒã‚¯ã¯å‰Šé™¤ã—ã¦ãã ã•ã„ã€‚ASGãŒEC2ã‚’ç®¡ç†ã™ã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚\n5-5. é©ç”¨ã¨ç¢ºèª # terraform apply # 2å°ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ç¢ºèª aws ec2 describe-instances \\ --filters \u0026#34;Name=tag:Name,Values=terraform-asg-example\u0026#34; \u0026#34;Name=instance-state-name,Values=running\u0026#34; \\ --query \u0026#34;Reservations[].Instances[].{ID:InstanceId,IP:PublicIpAddress}\u0026#34; \\ --output table ã“ã“ã¾ã§ã§å­¦ã‚“ã ã“ã¨ # è¦ç´  èª¬æ˜ data æ—¢å­˜ãƒªã‚½ãƒ¼ã‚¹ã®æƒ…å ±ã‚’å–å¾—ï¼ˆèª­ã¿å–ã‚Šå°‚ç”¨ï¼‰ aws_launch_template EC2ã®èµ·å‹•è¨­å®š aws_autoscaling_group è‡ªå‹•ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°è¨­å®š 6. ãƒ­ãƒ¼ãƒ‰ãƒãƒ©ãƒ³ã‚µã®ãƒ‡ãƒ—ãƒ­ã‚¤ # è¤‡æ•°å°ã®EC2ã«1ã¤ã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã§ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ã‚ˆã†ã€ALBã‚’è¿½åŠ ã—ã¾ã™ã€‚\nãªãœãƒ­ãƒ¼ãƒ‰ãƒãƒ©ãƒ³ã‚µãŒå¿…è¦ãªã®ã‹ï¼Ÿ ASGã§è¤‡æ•°å°ã®EC2ã‚’èµ·å‹•ã—ã¦ã‚‚ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯å„EC2ã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’çŸ¥ã‚‰ãªã„ã€‚ãƒ­ãƒ¼ãƒ‰ãƒãƒ©ãƒ³ã‚µã‚’ä½¿ãˆã°ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯1ã¤ã®DNSåï¼ˆã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆï¼‰ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã ã‘ã§ã€ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ãŒè‡ªå‹•çš„ã«è¤‡æ•°ã®EC2ã«åˆ†æ•£ã•ã‚Œã‚‹ã€‚\nALBã®æ§‹æˆè¦ç´ \nãƒªã‚¹ãƒŠï¼šç‰¹å®šã®ãƒãƒ¼ãƒˆï¼ˆ80ï¼‰ã¨ãƒ—ãƒ­ãƒˆã‚³ãƒ«ï¼ˆHTTPï¼‰ã§ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å—ã‘ä»˜ã‘ã‚‹ ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚°ãƒ«ãƒ¼ãƒ—ï¼šãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’è»¢é€ã™ã‚‹å…ˆã®EC2ç¾¤ã€‚ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ã§æ­£å¸¸ãªã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®ã¿ã«è»¢é€ ãƒªã‚¹ãƒŠãƒ«ãƒ¼ãƒ«ï¼šãƒªã‚¯ã‚¨ã‚¹ãƒˆã®ãƒ‘ã‚¹ã‚„ãƒ›ã‚¹ãƒˆã«åŸºã¥ã„ã¦ã€ã©ã®ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚°ãƒ«ãƒ¼ãƒ—ã«è»¢é€ã™ã‚‹ã‹æ±ºå®š ãªãœALBç”¨ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚°ãƒ«ãƒ¼ãƒ—ãŒåˆ¥é€”å¿…è¦ãªã®ã‹ï¼Ÿ ALBã‚‚AWSãƒªã‚½ãƒ¼ã‚¹ãªã®ã§ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ã‚’è¨±å¯ã—ãªã„ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‹ã‚‰ã®HTTPã‚¢ã‚¯ã‚»ã‚¹ï¼ˆã‚¤ãƒ³ãƒã‚¦ãƒ³ãƒ‰80ï¼‰ã¨ã€EC2ã¸ã®ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ï¼ˆã‚¢ã‚¦ãƒˆãƒã‚¦ãƒ³ãƒ‰å…¨ãƒãƒ¼ãƒˆï¼‰ã‚’è¨±å¯ã™ã‚‹è¨­å®šãŒå¿…è¦ã€‚\n6-1. ALBç”¨ã®å¤‰æ•°ã‚’è¿½åŠ  # variable \u0026#34;alb_name\u0026#34; { description = \u0026#34;The name of the ALB\u0026#34; type = string default = \u0026#34;terraform-asg-example\u0026#34; } variable \u0026#34;alb_security_group_name\u0026#34; { description = \u0026#34;The name of the security group for the ALB\u0026#34; type = string default = \u0026#34;terraform-example-alb\u0026#34; } 6-2. ALBç”¨ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚°ãƒ«ãƒ¼ãƒ—ã‚’è¿½åŠ  # resource \u0026#34;aws_security_group\u0026#34; \u0026#34;alb\u0026#34; { name = var.alb_security_group_name # ã‚¤ãƒ³ãƒã‚¦ãƒ³ãƒ‰ï¼šHTTPè¨±å¯ ingress { from_port = 80 to_port = 80 protocol = \u0026#34;tcp\u0026#34; cidr_blocks = [\u0026#34;0.0.0.0/0\u0026#34;] } # ã‚¢ã‚¦ãƒˆãƒã‚¦ãƒ³ãƒ‰ï¼šã™ã¹ã¦è¨±å¯ egress { from_port = 0 to_port = 0 protocol = \u0026#34;-1\u0026#34; cidr_blocks = [\u0026#34;0.0.0.0/0\u0026#34;] } } 6-3. ALBæœ¬ä½“ã‚’è¿½åŠ  # resource \u0026#34;aws_lb\u0026#34; \u0026#34;example\u0026#34; { name = var.alb_name load_balancer_type = \u0026#34;application\u0026#34; subnets = data.aws_subnets.default.ids security_groups = [aws_security_group.alb.id] } 6-4. ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚°ãƒ«ãƒ¼ãƒ—ã‚’è¿½åŠ  # resource \u0026#34;aws_lb_target_group\u0026#34; \u0026#34;asg\u0026#34; { name = var.alb_name port = var.server_port protocol = \u0026#34;HTTP\u0026#34; vpc_id = data.aws_vpc.default.id health_check { path = \u0026#34;/\u0026#34; protocol = \u0026#34;HTTP\u0026#34; matcher = \u0026#34;200\u0026#34; interval = 15 timeout = 3 healthy_threshold = 2 unhealthy_threshold = 2 } } 6-5. ãƒªã‚¹ãƒŠã¨ãƒ«ãƒ¼ãƒ«ã‚’è¿½åŠ  # resource \u0026#34;aws_lb_listener\u0026#34; \u0026#34;http\u0026#34; { load_balancer_arn = aws_lb.example.arn port = 80 protocol = \u0026#34;HTTP\u0026#34; default_action { type = \u0026#34;fixed-response\u0026#34; fixed_response { content_type = \u0026#34;text/plain\u0026#34; message_body = \u0026#34;404: page not found\u0026#34; status_code = 404 } } } resource \u0026#34;aws_lb_listener_rule\u0026#34; \u0026#34;asg\u0026#34; { listener_arn = aws_lb_listener.http.arn priority = 100 condition { path_pattern { values = [\u0026#34;*\u0026#34;] } } action { type = \u0026#34;forward\u0026#34; target_group_arn = aws_lb_target_group.asg.arn } } 6-6. ASGã«ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚°ãƒ«ãƒ¼ãƒ—ã‚’ç´ä»˜ã‘ # ASGãƒªã‚½ãƒ¼ã‚¹ã«2è¡Œè¿½åŠ ï¼š\nresource \u0026#34;aws_autoscaling_group\u0026#34; \u0026#34;example\u0026#34; { vpc_zone_identifier = data.aws_subnets.default.ids launch_template { id = aws_launch_template.example.id version = \u0026#34;$Latest\u0026#34; } target_group_arns = [aws_lb_target_group.asg.arn] # è¿½åŠ  health_check_type = \u0026#34;ELB\u0026#34; # è¿½åŠ  min_size = 2 max_size = 10 tag { key = \u0026#34;Name\u0026#34; value = \u0026#34;terraform-asg-example\u0026#34; propagate_at_launch = true } } 6-7. å‡ºåŠ›å¤‰æ•°ã‚’è¿½åŠ  # output \u0026#34;alb_dns_name\u0026#34; { value = aws_lb.example.dns_name description = \u0026#34;The domain name of the load balancer\u0026#34; } 6-8. é©ç”¨ã¨ç¢ºèª # terraform apply # ALBã®DNSåã‚’å–å¾— terraform output alb_dns_name # ã‚¢ã‚¯ã‚»ã‚¹ç¢ºèªï¼ˆALBèµ·å‹•ã«æ•°åˆ†ã‹ã‹ã‚‹ï¼‰ curl http://$(terraform output -raw alb_dns_name) # â†’ \u0026#34;Hello, World\u0026#34; ãŒè¡¨ç¤ºã•ã‚Œã‚Œã°OK ã“ã“ã¾ã§ã§å­¦ã‚“ã ã“ã¨ # è¦ç´  èª¬æ˜ aws_lb Application Load Balancer aws_lb_listener ã©ã®ãƒãƒ¼ãƒˆã§ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å—ã‘ã‚‹ã‹ aws_lb_target_group ãƒªã‚¯ã‚¨ã‚¹ãƒˆè»¢é€å…ˆã®ã‚°ãƒ«ãƒ¼ãƒ— aws_lb_listener_rule ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãƒ«ãƒ¼ãƒ« 7. å¾Œç‰‡ä»˜ã‘ï¼ˆç’°å¢ƒå‰Šé™¤ï¼‰ # IaCã®å¤§ããªãƒ¡ãƒªãƒƒãƒˆï¼šä½œã£ãŸç’°å¢ƒã‚’ä¸€ç™ºã§å‰Šé™¤ã§ãã¾ã™ã€‚\nãªãœterraform destroyãŒé‡è¦ãªã®ã‹ï¼Ÿ AWSãƒªã‚½ãƒ¼ã‚¹ã¯èµ·å‹•ã—ã¦ã„ã‚‹é™ã‚Šèª²é‡‘ãŒç™ºç”Ÿã™ã‚‹ã€‚å­¦ç¿’ã‚„ãƒ†ã‚¹ãƒˆå¾Œã¯å¿…ãšå‰Šé™¤ã—ã¦ã‚³ã‚¹ãƒˆã‚’æŠ‘ãˆã‚‹ã€‚æ‰‹å‹•ã§å‰Šé™¤ã™ã‚‹ã¨é–¢é€£ãƒªã‚½ãƒ¼ã‚¹ã®å‰Šé™¤æ¼ã‚ŒãŒç™ºç”Ÿã—ã‚„ã™ã„ãŒã€terraform destroyãªã‚‰TerraformãŒä¾å­˜é–¢ä¿‚ã‚’è€ƒæ…®ã—ã¦æ­£ã—ã„é †åºã§å…¨ãƒªã‚½ãƒ¼ã‚¹ã‚’å‰Šé™¤ã—ã¦ãã‚Œã‚‹ã€‚\nIaCã®çœŸä¾¡ main.tfã•ãˆã‚ã‚Œã°ã€terraform applyã§ã„ã¤ã§ã‚‚åŒã˜ç’°å¢ƒã‚’å†æ§‹ç¯‰ã§ãã‚‹ã€‚ã€Œç’°å¢ƒæ§‹ç¯‰æ‰‹é †æ›¸ã€ãŒä¸è¦ã«ãªã‚Šã€ç’°å¢ƒã®ä½œæˆãƒ»å‰Šé™¤ãŒæ•°åˆ†ã§å®Œäº†ã™ã‚‹ã€‚\n7-1. å…¨ãƒªã‚½ãƒ¼ã‚¹ã‚’å‰Šé™¤ # terraform destroy # â†’ \u0026#34;yes\u0026#34; ã¨å…¥åŠ› 7-2. ç¢ºèª # aws ec2 describe-instances \\ --filters \u0026#34;Name=tag:Name,Values=terraform-asg-example\u0026#34; \\ --query \u0026#34;Reservations[].Instances[].{ID:InstanceId,State:State.Name}\u0026#34; \\ --output table # â†’ terminated ã¾ãŸã¯ç©º ã¾ã¨ã‚ # Terraformã®åŸºæœ¬ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ # terraform init â†’ terraform plan â†’ terraform apply â†’ terraform destroy (åˆæœŸåŒ–) (è¨ˆç”»ç¢ºèª) (é©ç”¨) (å‰Šé™¤) ä»Šå›æ§‹ç¯‰ã—ãŸãƒªã‚½ãƒ¼ã‚¹ # ãƒªã‚½ãƒ¼ã‚¹ ç”¨é€” EC2 Webã‚µãƒ¼ãƒ Security Group ãƒ•ã‚¡ã‚¤ã‚¢ã‚¦ã‚©ãƒ¼ãƒ« Launch Template EC2ã®èµ·å‹•è¨­å®š Auto Scaling Group EC2ã®è‡ªå‹•ç®¡ç† ALB ãƒ­ãƒ¼ãƒ‰ãƒãƒ©ãƒ³ã‚µ Target Group ALBã®è»¢é€å…ˆ IaCï¼ˆInfrastructure as Codeï¼‰ã®ãƒ¡ãƒªãƒƒãƒˆ # å†ç¾æ€§ï¼šmain.tfãŒã‚ã‚Œã°ã„ã¤ã§ã‚‚åŒã˜ç’°å¢ƒã‚’æ§‹ç¯‰å¯èƒ½ å¯è¦–æ€§ï¼šã‚¤ãƒ³ãƒ•ãƒ©æ§‹æˆãŒã‚³ãƒ¼ãƒ‰ã¨ã—ã¦æ˜ç¢º åŠ¹ç‡æ€§ï¼šç’°å¢ƒã®ä½œæˆãƒ»å‰Šé™¤ãŒæ•°åˆ†ã§å®Œäº† ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†ï¼šGitã§å¤‰æ›´å±¥æ­´ã‚’ç®¡ç†å¯èƒ½ ã‚³ãƒãƒ³ãƒ‰ãƒãƒ¼ãƒˆã‚·ãƒ¼ãƒˆ # ã‚³ãƒãƒ³ãƒ‰ ç”¨é€” terraform init åˆæœŸåŒ– terraform plan å®Ÿè¡Œè¨ˆç”»ç¢ºèª terraform apply é©ç”¨ terraform destroy å…¨å‰Šé™¤ terraform output å‡ºåŠ›å¤‰æ•°è¡¨ç¤º terraform validate æ§‹æ–‡ãƒã‚§ãƒƒã‚¯ å®Œæˆç‰ˆã‚³ãƒ¼ãƒ‰ # ã‚¯ãƒªãƒƒã‚¯ã—ã¦å±•é–‹ï¼šæœ€çµ‚çš„ãªmain.tf provider \u0026#34;aws\u0026#34; { region = \u0026#34;ap-northeast-1\u0026#34; } # --- å¤‰æ•° --- variable \u0026#34;server_port\u0026#34; { description = \u0026#34;The port the server will use for HTTP requests\u0026#34; type = number default = 8080 } variable \u0026#34;alb_name\u0026#34; { description = \u0026#34;The name of the ALB\u0026#34; type = string default = \u0026#34;terraform-asg-example\u0026#34; } variable \u0026#34;alb_security_group_name\u0026#34; { description = \u0026#34;The name of the security group for the ALB\u0026#34; type = string default = \u0026#34;terraform-example-alb\u0026#34; } # --- ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ --- data \u0026#34;aws_vpc\u0026#34; \u0026#34;default\u0026#34; { default = true } data \u0026#34;aws_subnets\u0026#34; \u0026#34;default\u0026#34; { filter { name = \u0026#34;vpc-id\u0026#34; values = [data.aws_vpc.default.id] } } # --- ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚°ãƒ«ãƒ¼ãƒ— --- resource \u0026#34;aws_security_group\u0026#34; \u0026#34;instance\u0026#34; { name = \u0026#34;terraform-example-instance\u0026#34; ingress { from_port = var.server_port to_port = var.server_port protocol = \u0026#34;tcp\u0026#34; cidr_blocks = [\u0026#34;0.0.0.0/0\u0026#34;] } } resource \u0026#34;aws_security_group\u0026#34; \u0026#34;alb\u0026#34; { name = var.alb_security_group_name ingress { from_port = 80 to_port = 80 protocol = \u0026#34;tcp\u0026#34; cidr_blocks = [\u0026#34;0.0.0.0/0\u0026#34;] } egress { from_port = 0 to_port = 0 protocol = \u0026#34;-1\u0026#34; cidr_blocks = [\u0026#34;0.0.0.0/0\u0026#34;] } } # --- Launch Template \u0026amp; ASG --- resource \u0026#34;aws_launch_template\u0026#34; \u0026#34;example\u0026#34; { image_id = \u0026#34;ami-03852a41f1e05c8e4\u0026#34; # Amazon Linux 2023ï¼ˆ2025å¹´11æœˆæ™‚ç‚¹ï¼‰ instance_type = \u0026#34;t2.micro\u0026#34; vpc_security_group_ids = [aws_security_group.instance.id] user_data = base64encode(\u0026lt;\u0026lt;-EOF #!/bin/bash cd /home/ec2-user echo \u0026#34;Hello, World\u0026#34; \u0026gt; index.html nohup python3 -m http.server ${var.server_port} \u0026amp; EOF ) } resource \u0026#34;aws_autoscaling_group\u0026#34; \u0026#34;example\u0026#34; { vpc_zone_identifier = data.aws_subnets.default.ids launch_template { id = aws_launch_template.example.id version = \u0026#34;$Latest\u0026#34; } target_group_arns = [aws_lb_target_group.asg.arn] health_check_type = \u0026#34;ELB\u0026#34; min_size = 2 max_size = 10 tag { key = \u0026#34;Name\u0026#34; value = \u0026#34;terraform-asg-example\u0026#34; propagate_at_launch = true } } # --- ALB --- resource \u0026#34;aws_lb\u0026#34; \u0026#34;example\u0026#34; { name = var.alb_name load_balancer_type = \u0026#34;application\u0026#34; subnets = data.aws_subnets.default.ids security_groups = [aws_security_group.alb.id] } resource \u0026#34;aws_lb_target_group\u0026#34; \u0026#34;asg\u0026#34; { name = var.alb_name port = var.server_port protocol = \u0026#34;HTTP\u0026#34; vpc_id = data.aws_vpc.default.id health_check { path = \u0026#34;/\u0026#34; protocol = \u0026#34;HTTP\u0026#34; matcher = \u0026#34;200\u0026#34; interval = 15 timeout = 3 healthy_threshold = 2 unhealthy_threshold = 2 } } resource \u0026#34;aws_lb_listener\u0026#34; \u0026#34;http\u0026#34; { load_balancer_arn = aws_lb.example.arn port = 80 protocol = \u0026#34;HTTP\u0026#34; default_action { type = \u0026#34;fixed-response\u0026#34; fixed_response { content_type = \u0026#34;text/plain\u0026#34; message_body = \u0026#34;404: page not found\u0026#34; status_code = 404 } } } resource \u0026#34;aws_lb_listener_rule\u0026#34; \u0026#34;asg\u0026#34; { listener_arn = aws_lb_listener.http.arn priority = 100 condition { path_pattern { values = [\u0026#34;*\u0026#34;] } } action { type = \u0026#34;forward\u0026#34; target_group_arn = aws_lb_target_group.asg.arn } } # --- å‡ºåŠ› --- output \u0026#34;alb_dns_name\u0026#34; { value = aws_lb.example.dns_name description = \u0026#34;The domain name of the load balancer\u0026#34; } å‚è€ƒ # è©³è§£ Terraform ç¬¬3ç‰ˆ â€•Infrastructure as Codeã‚’å®Ÿç¾ã™ã‚‹ è‘—è€…ï¼šYevgeniy Brikman è¨³è€…ï¼šæ¾æµ¦ éš¼äºº å‡ºç‰ˆç¤¾ï¼šã‚ªãƒ©ã‚¤ãƒªãƒ¼ã‚¸ãƒ£ãƒ‘ãƒ³ å‡ºç‰ˆå¹´ï¼š2023å¹´ Terraformå…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ AWSãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ ","date":"2025å¹´ 11æœˆ 28æ—¥","externalUrl":null,"permalink":"/posts/251128004323_terraform-aws-environment-setup-and-teardown-hands-on/","section":"Posts","summary":"","title":"Terraformã§AWSç’°å¢ƒã‚’æ§‹ç¯‰ã—ã¦å‰Šé™¤ã™ã‚‹ã¾ã§ - å…¥é–€ãƒãƒ³ã‚ºã‚ªãƒ³","type":"posts"},{"content":" ã¯ã˜ã‚ã«ï¼šTerraformã¨ã¯ï¼Ÿ # Terraformã¯HashiCorpç¤¾ãŒé–‹ç™ºã—ãŸã‚ªãƒ¼ãƒ—ãƒ³ã‚½ãƒ¼ã‚¹ã®Infrastructure as Codeï¼ˆIaCï¼‰ãƒ„ãƒ¼ãƒ«ã€‚\nã‚µãƒ¼ãƒã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãªã©ã®ã‚¤ãƒ³ãƒ•ãƒ©ã‚’ã‚³ãƒ¼ãƒ‰ã§å®šç¾©ã—ã€è‡ªå‹•çš„ã«æ§‹ç¯‰ãƒ»å¤‰æ›´ãƒ»ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†ã§ãã‚‹ã€‚\nTerraformã¯IaCãƒ„ãƒ¼ãƒ«ã®ä¸­ã§ã©ã“ã«ä½ç½®ã™ã‚‹ã‹ # IaCãƒ„ãƒ¼ãƒ«ã¯å¤§ãã5ã¤ã«åˆ†é¡ã•ã‚Œã‚‹\nåˆ†é¡ ä¸»ãªç”¨é€” ä»£è¡¨ä¾‹ ã‚¢ãƒ‰ãƒ›ãƒƒã‚¯ãªã‚¹ã‚¯ãƒªãƒ—ãƒˆ ã‚·ãƒ³ãƒ—ãƒ«ãªè‡ªå‹•åŒ– Bash, Python è¨­å®šç®¡ç†ãƒ„ãƒ¼ãƒ« æ—¢å­˜ã‚µãƒ¼ãƒã®è¨­å®š Ansible, Chef ã‚µãƒ¼ãƒãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒ†ã‚£ãƒ³ã‚° ã‚¤ãƒ¡ãƒ¼ã‚¸ã‹ã‚‰ã‚µãƒ¼ãƒæ§‹ç¯‰ Docker, Packer ã‚ªãƒ¼ã‚±ã‚¹ãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ ã‚³ãƒ³ãƒ†ãƒŠç®¡ç† Kubernetes ãƒ—ãƒ­ãƒ“ã‚¸ãƒ§ãƒ‹ãƒ³ã‚°ãƒ„ãƒ¼ãƒ« ã‚¤ãƒ³ãƒ•ãƒ©å…¨ä½“ã®ä½œæˆ Terraform, CloudFormation Terraformã¯ãƒ—ãƒ­ãƒ“ã‚¸ãƒ§ãƒ‹ãƒ³ã‚°ãƒ„ãƒ¼ãƒ«ã«åˆ†é¡ã•ã‚Œã‚‹ã€‚\nã‚µãƒ¼ãƒã€Œä¸Šã€ã«ä½•ã‹ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã®ã§ã¯ãªãã€ã‚µãƒ¼ãƒã€Œè‡ªä½“ã€ã‚’ä½œæˆã™ã‚‹ãƒ„ãƒ¼ãƒ«ã€‚\nTerraformã®ç‰¹å¾´ # å‹•ä½œã®ä»•çµ„ã¿ # Terraformã¯Goè¨€èªã§æ›¸ã‹ã‚ŒãŸOSSã€‚\nå„ç«¯æœ«ã®terraformãƒã‚¤ãƒŠãƒªã‹ã‚‰ã€AWSã‚„Azureãªã©ã®ã‚¯ãƒ©ã‚¦ãƒ‰ãƒ—ãƒ­ãƒã‚¤ãƒ€ã¸APIã‚³ãƒ¼ãƒ«ã—ã¦å‹•ä½œã™ã‚‹ã€‚\nä»–ã®IaCãƒ„ãƒ¼ãƒ«ã¨ã®é•ã„ # æ¯”è¼ƒè»¸ Terraform Ansible CloudFormation ãƒ„ãƒ¼ãƒ«ç¨®åˆ¥ ãƒ—ãƒ­ãƒ“ã‚¸ãƒ§ãƒ‹ãƒ³ã‚° è¨­å®šç®¡ç† ãƒ—ãƒ­ãƒ“ã‚¸ãƒ§ãƒ‹ãƒ³ã‚° ã‚¤ãƒ³ãƒ•ãƒ©ã®æ‰±ã„ ã‚¤ãƒŸãƒ¥ãƒ¼ã‚¿ãƒ–ãƒ« ãƒŸãƒ¥ãƒ¼ã‚¿ãƒ–ãƒ« ã‚¤ãƒŸãƒ¥ãƒ¼ã‚¿ãƒ–ãƒ« è¨€èªã‚¹ã‚¿ã‚¤ãƒ« å®£è¨€å‹ æ‰‹ç¶šãå‹/å®£è¨€å‹ å®£è¨€å‹ è¨€èª HCLï¼ˆDSLï¼‰ YAML JSON/YAML ãƒã‚¹ã‚¿ã‚µãƒ¼ãƒ ä¸è¦ ä¸è¦ ä¸è¦ï¼ˆAWSç®¡ç†ï¼‰ ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ ä¸è¦ ä¸è¦ ä¸è¦ ãƒãƒ«ãƒã‚¯ãƒ©ã‚¦ãƒ‰ â—¯ â—¯ âœ•ï¼ˆAWSå°‚ç”¨ï¼‰ Terraformã‚’é¸ã¶ç†ç”± # ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãƒ¬ã‚¹ï¼šã‚¯ãƒ©ã‚¦ãƒ‰ãƒ—ãƒ­ãƒã‚¤ãƒ€ã®APIã‚’ç›´æ¥å‘¼ã³å‡ºã™ãŸã‚ã€å„ã‚µãƒ¼ãƒã«ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹å¿…è¦ãŒãªã„ ãƒã‚¹ã‚¿ãƒ¬ã‚¹ï¼šãƒã‚¹ã‚¿ã‚µãƒ¼ãƒã®é‹ç”¨ãƒ»ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ãŒä¸è¦ å®£è¨€å‹è¨€èªï¼šã€Œã“ã†ãªã£ã¦ã»ã—ã„ã€ã‚’æ›¸ãã ã‘ã§ã€TerraformãŒå·®åˆ†ã‚’è¨ˆç®—ã—ã¦é©ç”¨ã—ã¦ãã‚Œã‚‹ ãƒãƒ«ãƒã‚¯ãƒ©ã‚¦ãƒ‰å¯¾å¿œï¼šAWSã€Azureã€GCPãªã©è¤‡æ•°ã®ãƒ—ãƒ­ãƒã‚¤ãƒ€ã‚’åŒã˜è¨€èªã§ç®¡ç†ã§ãã‚‹ å®Ÿéš›ã®ä½¿ã‚ã‚Œæ–¹ # Terraformã¯å˜ä½“ã§ä½¿ã†ã“ã¨ã‚‚ã‚ã‚‹ãŒã€ä»–ã®ãƒ„ãƒ¼ãƒ«ã¨çµ„ã¿åˆã‚ã›ã‚‹ã“ã¨ãŒå¤šã„ï¼š\nPacker + Terraformï¼šPackerã§ã‚µãƒ¼ãƒã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ä½œæˆ â†’ Terraformã§ãã®ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ä½¿ã£ã¦ã‚¤ãƒ³ãƒ•ãƒ©æ§‹ç¯‰ Docker + Kubernetes + Terraformï¼šTerraformã§ã‚¤ãƒ³ãƒ•ãƒ©æ§‹ç¯‰ï¼ˆK8sã‚¯ãƒ©ã‚¹ã‚¿å«ã‚€ï¼‰ â†’ Kubernetesã§ã‚³ãƒ³ãƒ†ãƒŠç®¡ç† ã¾ã¨ã‚ # Terraformã¯ã‚¤ãƒ³ãƒ•ãƒ©ã‚’ã‚³ãƒ¼ãƒ‰ã§ç®¡ç†ã™ã‚‹ãƒ—ãƒ­ãƒ“ã‚¸ãƒ§ãƒ‹ãƒ³ã‚°ãƒ„ãƒ¼ãƒ« å®£è¨€å‹ãƒ»ãƒã‚¹ã‚¿ãƒ¬ã‚¹ãƒ»ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãƒ¬ã‚¹ã¨ã„ã†ç‰¹å¾´ã‚’æŒã¤ ã‚¯ãƒ©ã‚¦ãƒ‰ãƒ—ãƒ­ãƒã‚¤ãƒ€ã®APIã‚’ç›´æ¥å‘¼ã³å‡ºã™ã‚·ãƒ³ãƒ—ãƒ«ãªä»•çµ„ã¿ ä»–ã®IaCãƒ„ãƒ¼ãƒ«ï¼ˆDockerã€Kubernetesãªã©ï¼‰ã¨çµ„ã¿åˆã‚ã›ã¦ä½¿ã‚ã‚Œã‚‹ã“ã¨ãŒå¤šã„ å‚è€ƒè³‡æ–™ # è©³è§£ Terraform ç¬¬3ç‰ˆ â€•Infrastructure as Codeã‚’å®Ÿç¾ã™ã‚‹ è‘—è€…ï¼šYevgeniy Brikman è¨³è€…ï¼šæ¾æµ¦ éš¼äºº å‡ºç‰ˆç¤¾ï¼šã‚ªãƒ©ã‚¤ãƒªãƒ¼ã‚¸ãƒ£ãƒ‘ãƒ³ å‡ºç‰ˆå¹´ï¼š2023å¹´ ","date":"2025å¹´ 11æœˆ 27æ—¥","externalUrl":null,"permalink":"/posts/251127233855_what-is-terraform/","section":"Posts","summary":"","title":"Terraformã¨ã¯ï¼Ÿ","type":"posts"},{"content":"","date":"2025å¹´ 11æœˆ 26æ—¥","externalUrl":null,"permalink":"/tags/chrome/","section":"Tags","summary":"","title":"Chrome","type":"tags"},{"content":" ã¯ã˜ã‚ã« # ä»•äº‹ã®åŠ¹ç‡åŒ–ã®ãŸã‚ã«ã€Googleãƒ‰ãƒ©ã‚¤ãƒ–å†…ã®æ¤œç´¢ã‚’ã‚‚ã£ã¨ã‚¹ãƒãƒ¼ãƒˆã«ã§ããªã„ã‹ãªã¨è€ƒãˆã¦ã€ Chromeã®ã‚¢ãƒ‰ãƒ¬ã‚¹ãƒãƒ¼ã‹ã‚‰ç›´æ¥æ¤œç´¢ã§ãã‚‹æ©Ÿèƒ½ã‚’å®Ÿè£…ã—ã¾ã—ãŸã€‚ ãã®çµæœã€è³‡æ–™ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ãŒåŠ‡çš„ã«å‘ä¸Šã—ãŸã®ã§ã€è¨­å®šæ–¹æ³•ã‚’ãƒ¡ãƒ¢ã—ã¾ã™ã€‚\nChromeã‚«ã‚¹ã‚¿ãƒ æ¤œç´¢ã‚¨ãƒ³ã‚¸ãƒ³ã®è¨­å®šæ‰‹é † # ã‚¹ãƒ†ãƒƒãƒ—1ï¼šè¨­å®šç”»é¢ã‚’é–‹ã # ä»¥ä¸‹ã®ã„ãšã‚Œã‹ã®æ–¹æ³•ã§è¨­å®šç”»é¢ã‚’é–‹ãã¾ã™\næ–¹æ³•Aï¼šURLchrome://settings/searchEnginesã¸ç›´æ¥ã‚¢ã‚¯ã‚»ã‚¹\næ–¹æ³•Bï¼šãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‹ã‚‰æ“ä½œ\nChromeã®å³ä¸Šã®ã€Œâ‹®ã€ï¼ˆ3ç‚¹ãƒ¡ãƒ‹ãƒ¥ãƒ¼ï¼‰ã‚’ã‚¯ãƒªãƒƒã‚¯ ã€Œè¨­å®šã€ã‚’é¸æŠ å·¦å´ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‹ã‚‰ã€Œæ¤œç´¢ã‚¨ãƒ³ã‚¸ãƒ³ã€ã‚’é¸æŠ ã€Œæ¤œç´¢ã‚¨ãƒ³ã‚¸ãƒ³ã¨ã‚µã‚¤ãƒˆå†…æ¤œç´¢ã‚’ç®¡ç†ã™ã‚‹ã€ã‚’ã‚¯ãƒªãƒƒã‚¯ æ³¨æ„ï¼šChromeã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«ã‚ˆã£ã¦è¡¨è¨˜ãŒã€Œã‚µã‚¤ãƒˆæ¤œç´¢ã‚’ç®¡ç†ã€ãªã©å¾®å¦™ã«ç•°ãªã‚‹å ´åˆãŒã‚ã‚Šã¾ã™\nã‚¹ãƒ†ãƒƒãƒ—2ï¼šæ¤œç´¢ã‚¨ãƒ³ã‚¸ãƒ³ã‚’è¿½åŠ  # ã€Œã‚µã‚¤ãƒˆå†…æ¤œç´¢ã€ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®ã€Œè¿½åŠ ã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã€ä»¥ä¸‹ã®é …ç›®ã‚’å…¥åŠ›ã—ã¾ã™\né …ç›® èª¬æ˜ ä¾‹ æ¤œç´¢ã‚¨ãƒ³ã‚¸ãƒ³å ç®¡ç†ç”¨ã®åå‰ï¼ˆä»»æ„ï¼‰ Drive Title Search ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆ ã‚¢ãƒ‰ãƒ¬ã‚¹ãƒãƒ¼ã§ä½¿ã†çŸ­ç¸®ã‚³ãƒãƒ³ãƒ‰ d URLï¼ˆ%s=æ¤œç´¢èªå¥ï¼‰ æ¤œç´¢ç”¨URLï¼ˆ%sãŒæ¤œç´¢ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã«ç½®ãæ›ã‚ã‚‹ï¼‰ https://drive.google.com/drive/search?q=title:%s ã‚¹ãƒ†ãƒƒãƒ—3ï¼šå‹•ä½œç¢ºèª # Chromeã®ã‚¢ãƒ‰ãƒ¬ã‚¹ãƒãƒ¼ã«ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆï¼ˆä¾‹ï¼šdï¼‰ã‚’å…¥åŠ› ã‚¹ãƒšãƒ¼ã‚¹ã¾ãŸã¯Tabã‚’æŠ¼ã™ â†’ æ¤œç´¢ãƒ¢ãƒ¼ãƒ‰ã«åˆ‡ã‚Šæ›¿ã‚ã‚‹ æ¤œç´¢ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã—ã¦Enter ã‚«ã‚¹ã‚¿ãƒ æ¤œç´¢ä¸€è¦§ # è‡ªåˆ†ãŒå®Ÿéš›ã«ç™»éŒ²ã—ãŸè¨­å®šä¸€è¦§ãŒä¸‹è¨˜ã§ã™ã€‚\nGoogleãƒ‰ãƒ©ã‚¤ãƒ–æ¤œç´¢ # ã‚³ãƒãƒ³ãƒ‰ è¨­å®šå URL ç”¨é€” d Drive Title Search https://drive.google.com/drive/search?q=title:%s ã‚¿ã‚¤ãƒˆãƒ«æ¤œç´¢ da Drive All Search https://drive.google.com/drive/search?q=%s å…¨æ–‡æ¤œç´¢ ds Drive Sheets https://drive.google.com/drive/search?q=type:spreadsheet+%s ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆé™å®š dd Drive Docs https://drive.google.com/drive/search?q=type:document+%s ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆé™å®š URLå†…ã®+ã¯ã‚¹ãƒšãƒ¼ã‚¹æ‰±ã„ã«ãªã‚Šã¾ã™ï¼ˆä¾‹ï¼štype:spreadsheet+%s â†’ type:spreadsheet æ¤œç´¢èªï¼‰\nAIæ¤œç´¢ãƒ»é–‹ç™ºãƒ„ãƒ¼ãƒ« # ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆ æ¤œç´¢ã‚¨ãƒ³ã‚¸ãƒ³å URL ç”¨é€” pa Perplexity AI https://www.perplexity.ai/?q=%s AIå¯¾è©±å‹æ¤œç´¢ gh GitHub https://github.com/search?q=%s ãƒªãƒã‚¸ãƒˆãƒªãƒ»ã‚³ãƒ¼ãƒ‰æ¤œç´¢ qi Qiita https://qiita.com/search?q=%s æŠ€è¡“è¨˜äº‹æ¤œç´¢ wiki Wikipedia https://ja.wikipedia.org/wiki/Special:Search?search=%s Wikipediaå†…æ¤œç´¢ æ¤œç´¢æ¼”ç®—å­ã®æ´»ç”¨ # ä»¥ä¸‹ã®æ¼”ç®—å­ã‚’çµ„ã¿åˆã‚ã›ã‚‹ã“ã¨ã§æ¤œç´¢ã®ç²¾åº¦ã‚’ä¸Šã’ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚\ntitle: - ã‚¿ã‚¤ãƒˆãƒ«é™å®šæ¤œç´¢ title:VPNï¼šãƒ•ã‚¡ã‚¤ãƒ«åã«ã€ŒVPNã€ã‚’å«ã‚€ã‚‚ã®ã ã‘ã‚’è¡¨ç¤º \u0026quot;\u0026quot; - å®Œå…¨ä¸€è‡´æ¤œç´¢ï¼ˆãƒ•ãƒ¬ãƒ¼ã‚ºæ¤œç´¢ï¼‰ \u0026quot;ã‚¨ãƒ©ãƒ¼ 503\u0026quot;ï¼šãã®ä¸¦ã³é †ã®ãƒ•ãƒ¬ãƒ¼ã‚ºã—ã‹ãƒ’ãƒƒãƒˆã—ãªã„ - - é™¤å¤–æ¤œç´¢ VPN -æ—§æ‰‹é † -2023ï¼šã€Œæ—§æ‰‹é †ã€ã€Œ2023ã€ã‚’å«ã‚€ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é™¤å¤– ä»–ã®ã‚µãƒ¼ãƒ“ã‚¹ã‚’ã‚«ã‚¹ã‚¿ãƒ æ¤œç´¢ã«è¿½åŠ ã™ã‚‹æ–¹æ³• # URLã®èª¿ã¹æ–¹ # è¿½åŠ ã—ãŸã„ã‚µã‚¤ãƒˆã§å®Ÿéš›ã«æ¤œç´¢ã‚’å®Ÿè¡Œï¼ˆä¾‹ï¼šã€Œtestã€ã§æ¤œç´¢ï¼‰ æ¤œç´¢çµæœãƒšãƒ¼ã‚¸ã®URLã‚’ã‚³ãƒ”ãƒ¼ URLå†…ã®æ¤œç´¢ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰éƒ¨åˆ†ï¼ˆtestãªã©ï¼‰ã‚’%sã«ç½®ãæ›ãˆã‚‹ ã¾ã¨ã‚ # Chromeã®ã‚«ã‚¹ã‚¿ãƒ æ¤œç´¢ã‚¨ãƒ³ã‚¸ãƒ³æ©Ÿèƒ½ã‚’æ´»ç”¨ã™ã‚‹ã“ã¨ã§ã€ã‚¢ãƒ‰ãƒ¬ã‚¹ãƒãƒ¼ã‹ã‚‰ç›´æ¥æ¤œç´¢ã§ãã‚‹ç’°å¢ƒã‚’æ§‹ç¯‰ã—ã¾ã—ãŸã€‚\nå®Ÿç¾ã§ããŸã“ã¨ # Googleãƒ‰ãƒ©ã‚¤ãƒ–æ¤œç´¢ã®é«˜é€ŸåŒ–\nã‚¿ã‚¤ãƒˆãƒ«æ¤œç´¢ï¼ˆdï¼‰ã€å…¨æ–‡æ¤œç´¢ï¼ˆdaï¼‰ã€ãƒ•ã‚¡ã‚¤ãƒ«ç¨®åˆ¥æ¤œç´¢ï¼ˆds, ddï¼‰ã‚’è¨­å®š è³‡æ–™ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹æ™‚é–“ã‚’ä½“æ„Ÿ10ï½15ç§’çŸ­ç¸® AIæ¤œç´¢ãƒ»é–‹ç™ºãƒ„ãƒ¼ãƒ«ã¸ã®å³åº§ã‚¢ã‚¯ã‚»ã‚¹\nPerplexity AIã€GitHubã€Qiitaã€Wikipediaãªã©ã‚’ç™»éŒ² æƒ…å ±åé›†ãƒ»æŠ€è¡“èª¿æŸ»ã®åŠ¹ç‡åŒ– æ¤œç´¢æ¼”ç®—å­ã¨ã®çµ„ã¿åˆã‚ã›\ntitle:, \u0026quot;\u0026quot;, - ã‚’æ´»ç”¨ã—ã¦æ¤œç´¢ç²¾åº¦ã‚’å‘ä¸Š ãƒã‚¤ã‚ºã®å¤šã„æ¤œç´¢çµæœã‹ã‚‰å¿…è¦ãªæƒ…å ±ã‚’ç´ æ—©ãæŠ½å‡º ","date":"2025å¹´ 11æœˆ 26æ—¥","externalUrl":null,"permalink":"/posts/251126031004_implement-custom-search-feature-in-chrome/","section":"Posts","summary":"","title":"Chromeã«ã‚«ã‚¹ã‚¿ãƒ æ¤œç´¢æ©Ÿèƒ½ã‚’å®Ÿè£…ã™ã‚‹æ–¹æ³•","type":"posts"},{"content":" ã¯ã˜ã‚ã« # Terraformã®å‹‰å¼·ã®ãŸã‚ã«ã€Œè©³è§£Terraformã€ã‚’è³¼å…¥ã€‚ ã™ã“ã—ãšã¤å†…å®¹ã‚’TILã¨ã—ã¦ã‚¢ã‚¦ãƒˆãƒ—ãƒƒãƒˆã—ã¦çŸ¥è­˜ã‚’å®šç€ã•ã›ã¾ã™ã€‚ ä»Šå›ã®ãƒ†ãƒ¼ãƒã¯ã€ŒIaCï¼ˆInfrastructure as Codeï¼‰ã®5ã¤ã®åˆ†é¡ã€ â€»IaCã¨ã¯ã€ã‚¤ãƒ³ãƒ•ãƒ©ãªã©ã®ç’°å¢ƒã‚’ã‚³ãƒ¼ãƒ‰ã§è¨˜è¿°ã§ãã‚‹ã‚ˆã†ã«ã—ãŸãƒ„ãƒ¼ãƒ«å…¨èˆ¬ã‚’æŒ‡ã™ã€‚\næ›¸ç±æƒ…å ± # è©³è§£ Terraform ç¬¬3ç‰ˆ â€•Infrastructure as Codeã‚’å®Ÿç¾ã™ã‚‹ è‘—è€…ï¼šYevgeniy Brikman è¨³è€…ï¼šæ¾æµ¦ éš¼äºº å‡ºç‰ˆç¤¾ï¼šã‚ªãƒ©ã‚¤ãƒªãƒ¼ã‚¸ãƒ£ãƒ‘ãƒ³ å‡ºç‰ˆå¹´ï¼š2023å¹´ 5ã¤ã®åˆ†é¡ # IaCãƒ„ãƒ¼ãƒ«ã¯ä»¥ä¸‹ã®5ã¤ã®ã‚«ãƒ†ã‚´ãƒªã«åˆ†é¡ã•ã‚Œã¾ã™ã€‚ã“ã‚Œã‚‰ã¯å¯¾ç«‹ã™ã‚‹ã‚‚ã®ã§ã¯ãªãã€ãã‚Œãã‚Œç•°ãªã‚‹å½¹å‰²ã‚’æŒã¡ã€å®Ÿéš›ã®é–‹ç™ºç¾å ´ã§ã¯çµ„ã¿åˆã‚ã›ã¦ä½¿ç”¨ã™ã‚‹ã“ã¨ãŒä¸€èˆ¬çš„ã§ã™ã€‚\nã‚¢ãƒ‰ãƒ›ãƒƒã‚¯ãªã‚¹ã‚¯ãƒªãƒ—ãƒˆ è¨­å®šç®¡ç†ãƒ„ãƒ¼ãƒ« ã‚µãƒ¼ãƒãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãƒ„ãƒ¼ãƒ« ã‚ªãƒ¼ã‚±ã‚¹ãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ„ãƒ¼ãƒ« ãƒ—ãƒ­ãƒ“ã‚¸ãƒ§ãƒ‹ãƒ³ã‚°ãƒ„ãƒ¼ãƒ« ã‚¢ãƒ‰ãƒ›ãƒƒã‚¯ãªã‚¹ã‚¯ãƒªãƒ—ãƒˆ # ä½œæ¥­ã‚„å‡¦ç†ã‚’pythonã‚„shãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦ä½œæˆã—ã¦å®Ÿè¡Œã™ã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆ\næœ€ã‚‚ã‚·ãƒ³ãƒ—ãƒ«ãªè‡ªå‹•åŒ–ã®æ–¹æ³• å˜ç´”ãªå‡¦ç†ã‚’å®Ÿè£…ã™ã‚‹ãªã‚‰å‘ã„ã¦ã„ã‚‹ãŒã€ã‚µãƒ¼ãƒè¨­å®šã‹ã‚‰ãƒ‡ãƒ—ãƒ­ã‚¤ã¾ã§å‡¦ç†ã™ã‚‹ã‚ˆã†ãªè¤‡é›‘ãª å‡¦ç†ã‚’å®Ÿè£…ã™ã‚‹å ´åˆã¯ã€ä¸€ã‹ã‚‰è‡ªåŠ›ã§ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ãå¿…è¦ãŒã‚ã‚‹ãŸã‚ã€åŠ´åŠ›ãŒã‹ã‹ã‚‹ã€‚\nè¨­å®šç®¡ç†ãƒ„ãƒ¼ãƒ« # æ—¢å­˜ã®ã‚µãƒ¼ãƒä¸Šã«ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ãªã©ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ãŸã‚ã®ãƒ„ãƒ¼ãƒ«\nä¾‹ï¼šChefãƒ»Puppetãƒ»Ansible ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¦ç´„ã«ã‚ˆã‚Šãƒ•ã‚¡ã‚¤ãƒ«å†…å®¹ã«ä¸€è²«æ€§ã‚’æŒãŸã›ã‚‹ã“ã¨ãŒå¯èƒ½ å†ªç­‰æ€§ãŒã‚ã‚‹ 1å›é™ã‚Šã®å‡¦ç†ã§ã‚ã‚Œã°ã‚¢ãƒ‰ãƒ›ãƒƒã‚¯ãªã‚¹ã‚¯ãƒªãƒ—ãƒˆã§ã‚‚ååˆ†ã ãŒã€ä½•åº¦å®Ÿè¡Œã—ã¦ã‚‚åŒã˜çµæœã‚’ã‚‚ãŸã‚‰ã™å†ªç­‰æ€§ãŒå¿…è¦ãªå ´åˆã¯ã€Ansibleãªã©ã®è¨­å®šç®¡ç†ãƒ„ãƒ¼ãƒ«ã®ã»ã†ãŒå‘ã„ã¦ã„ã‚‹ Ansibleã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã«ã¯å†ªç­‰æ€§ãŒçµ„ã¿è¾¼ã¾ã‚Œã¦ã„ã‚‹ãŸã‚ é…å¸ƒ ã‚³ãƒ¼ãƒ‰ã®é…å¸ƒã«ã‚ˆã‚Šã€ãƒ­ãƒ¼ãƒªãƒ³ã‚°ãƒ‡ãƒ—ãƒ­ã‚¤ãªã©è¤‡æ•°ã®ãƒªãƒ¢ãƒ¼ãƒˆã‚µãƒ¼ãƒã‚’ã¾ã¨ã‚ã¦ç®¡ç†ã™ã‚‹ã“ã¨ãŒå¯èƒ½ã€‚ ã‚µãƒ¼ãƒãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãƒ„ãƒ¼ãƒ« # OSã‚„ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã‚’ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸åŒ–ã—ãŸã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ä½œæˆã—ã€ãã®ã‚¤ãƒ¡ãƒ¼ã‚¸ã‹ã‚‰ç’°å¢ƒã‚’æ§‹ç¯‰ã™ã‚‹ãƒ„ãƒ¼ãƒ«\nä¾‹ï¼šDockerãƒ»Packerãƒ»Vagrant ã€Œã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆã€ã¨å‘¼ã°ã‚Œã‚‹OSã‚„ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ãªã©ã‚’å«ã‚“ã ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ä½œæˆã—ã¦ã€ã“ã®ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆã‚’ä½¿ã£ã¦ã‚µãƒ¼ãƒç’°å¢ƒã‚’æ§‹ç¯‰ã™ã‚‹ ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’æ‰±ã†ãƒ„ãƒ¼ãƒ«ã«ã¯å¤§åˆ¥ã™ã‚‹ã¨2ã¤ã®ã‚«ãƒ†ã‚´ãƒªãŒã‚ã‚‹ã€‚\nä»®æƒ³ãƒã‚·ãƒ³\nãƒãƒ¼ãƒ‰ã‚¦ã‚§ã‚¢ã‚’å«ã‚€ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ã‚·ã‚¹ãƒ†ãƒ å…¨ä½“ã‚’ã‚¨ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆã™ã‚‹ä»•çµ„ã¿ ä¾‹ï¼šVMwareãƒ»VirtualBox ãƒã‚¤ãƒ‘ãƒ¼ãƒã‚¤ã‚¶ã‚’å‹•ã‹ã—ã¦CPUã‚„ãƒ¡ãƒ¢ãƒªãªã©ã‚’ä»®æƒ³åŒ–ã™ã‚‹ ã“ã‚Œã«ã‚ˆã‚Šãƒã‚¤ãƒ‘ãƒ¼ãƒã‚¤ã‚¶ä¸Šã§å‹•ã‹ã™ä»®æƒ³ãƒã‚·ãƒ³ã‚¤ãƒ¡ãƒ¼ã‚¸ã‹ã‚‰ã¯ä»®æƒ³åŒ–ã•ã‚Œã¦ãƒãƒ¼ãƒ‰ã‚¦ã‚§ã‚¢ã®ã¿è¦‹ãˆã‚‹ã‚ˆã†ã«ãªã‚‹ã€‚ ä»®æƒ³ç’°å¢ƒã¨ãƒ›ã‚¹ãƒˆãƒã‚·ãƒ³ã‚’åˆ†é›¢ã™ã‚‹ã“ã¨ãŒå¯èƒ½ ä»®æƒ³ãƒã‚·ãƒ³ã‚¤ãƒ¡ãƒ¼ã‚¸ã¯Packerã‚„Vagrantãªã©ã®ãƒ„ãƒ¼ãƒ«ã§å®šç¾©å¯èƒ½ ã‚³ãƒ³ãƒ†ãƒŠ\nOSã®ãƒ¦ãƒ¼ã‚¶ã‚¹ãƒšãƒ¼ã‚¹ã‚’ã‚¨ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆã™ã‚‹ä»•çµ„ã¿ ãƒ—ãƒ­ã‚»ã‚¹ã‚„ãƒ¡ãƒ¢ãƒªãªã©ã‚’åˆ†é›¢ã™ã‚‹ãŸã‚ã«Dockerãªã©ã®ã‚³ãƒ³ãƒ†ãƒŠã‚¨ãƒ³ã‚¸ãƒ³ã‚’å‹•ä½œã•ã›ã‚‹å¿…è¦ãŒã‚ã‚‹ ã‚³ãƒ³ãƒ†ãƒŠã¯ãƒ¦ãƒ¼ã‚¶ã‚¹ãƒšãƒ¼ã‚¹ã®ã¿è¦‹ãˆã‚‹ã‚ˆã†ã«ãªã‚‹ã€‚ ä»®æƒ³ãƒã‚·ãƒ³ã¨ã‚³ãƒ³ãƒ†ãƒŠã®é•ã„\nä»®æƒ³ãƒã‚·ãƒ³ï¼šãƒãƒ¼ãƒ‰ã‚¦ã‚§ã‚¢ãƒ¬ãƒ™ãƒ«ã§ä»®æƒ³åŒ–ãƒ»é«˜åº¦ãªåˆ†é›¢æ€§ãŒã‚ã‚Šã€ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚„ã‚³ãƒ³ãƒ—ãƒ©ã‚¤ã‚¢ãƒ³ã‚¹é¢ã§æœ‰åˆ© ã‚³ãƒ³ãƒ†ãƒŠï¼šOSãƒ¬ãƒ™ãƒ«ã§ä»®æƒ³åŒ–ãƒ»ãƒ¡ãƒ¢ãƒªæ¶ˆè²»ãŒå°‘ãªã„ ã‚¤ãƒŸãƒ¥ãƒ¼ã‚¿ãƒ–ãƒ«ã‚¤ãƒ³ãƒ•ãƒ© ä¸€åº¦æ§‹ç¯‰ãƒ»ãƒ‡ãƒ—ãƒ­ã‚¤ã•ã‚ŒãŸã‚¤ãƒ³ãƒ•ãƒ©ç’°å¢ƒï¼ˆã‚µãƒ¼ãƒã‚„ã‚³ãƒ³ãƒ†ãƒŠãªã©ï¼‰ã‚’å¤‰æ›´ã›ãšã€æ›´æ–°ãŒå¿…è¦ãªå ´åˆã¯æ–°ã—ã„ç’°å¢ƒã‚’ä¸¸ã”ã¨ä½œã‚Šç›´ã—ã¦æ—¢å­˜ç’°å¢ƒã¨å…¥ã‚Œæ›¿ãˆã‚‹é‹ç”¨æ€æƒ³\nã‚µãƒ¼ãƒãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãƒ„ãƒ¼ãƒ«ã«ãŠã„ã¦é‡è¦ãªè€ƒãˆ ãƒ—ãƒ­ãƒ“ã‚¸ãƒ§ãƒ‹ãƒ³ã‚°ãƒ„ãƒ¼ãƒ«ï¼ˆTerraformãªã©ï¼‰ã¨çµ„ã¿åˆã‚ã›ã‚‹ã“ã¨ã§ã€ã‚¤ãƒ³ãƒ•ãƒ©å…¨ä½“ã®ã‚¤ãƒŸãƒ¥ãƒ¼ã‚¿ãƒ–ãƒ«åŒ–ã‚‚å®Ÿç¾å¯èƒ½ ã‚ªãƒ¼ã‚±ã‚¹ãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ„ãƒ¼ãƒ« # è¤‡æ•°ã®ã‚·ã‚¹ãƒ†ãƒ ã‚„ã‚µãƒ¼ãƒ“ã‚¹ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³é–“ã§è¡Œã‚ã‚Œã‚‹å¤šæ•°ã®ã‚¿ã‚¹ã‚¯ã‚„ ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’è‡ªå‹•çš„ã«çµ±åˆãƒ»ç®¡ç†ã—ã€åŠ¹ç‡çš„ã«å®Ÿè¡Œã™ã‚‹ãŸã‚ã®ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢\nä¾‹ï¼šKubernetes ãƒ—ãƒ­ãƒ“ã‚¸ãƒ§ãƒ‹ãƒ³ã‚°ãƒ„ãƒ¼ãƒ« # ã‚µãƒ¼ãƒè‡ªä½“ã‚’ä½œæˆã™ã‚‹ã‚ˆã†ãªãƒ„ãƒ¼ãƒ«\nã‚¤ãƒ³ãƒ•ãƒ©ã«é–¢ä¿‚ã—ã¦ã„ã‚‹ãŸã„ã¦ã„ã®ã‚‚ã®ã‚’ä½œæˆã§ãã‚‹ï¼ˆã‚µãƒ¼ãƒã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯æ§‹æˆã€ãƒ­ãƒ¼ãƒ‰ãƒãƒ©ãƒ³ã‚µãƒ¼ãªã©ï¼‰ ä¾‹ï¼šTerraformãƒ»CloudFormation ã¾ã¨ã‚ï¼šIaCã®æ¦‚è¦ # IaCã¨ã¯ã€ã‚¤ãƒ³ãƒ•ãƒ©ç’°å¢ƒã‚’ã‚³ãƒ¼ãƒ‰ã§è¨˜è¿°ãƒ»ç®¡ç†ã§ãã‚‹ãƒ„ãƒ¼ãƒ«å…¨èˆ¬ã‚’æŒ‡ã™ã€‚å¤§åˆ¥ã™ã‚‹ã¨5ã¤ã®ã‚«ãƒ†ã‚´ãƒªãŒã‚ã‚‹ã€‚\nå„ãƒ„ãƒ¼ãƒ«ã®ç‰¹å¾´ã¨ä½¿ã„åˆ†ã‘ # ãƒ„ãƒ¼ãƒ«åˆ†é¡ ä¸»ãªç”¨é€” ä»£è¡¨ä¾‹ å‘ã„ã¦ã„ã‚‹å ´é¢ ã‚¢ãƒ‰ãƒ›ãƒƒã‚¯ãªã‚¹ã‚¯ãƒªãƒ—ãƒˆ ã‚·ãƒ³ãƒ—ãƒ«ãªè‡ªå‹•åŒ– Bash, Python 1å›é™ã‚Šã®å‡¦ç†ã€å˜ç´”ãªä½œæ¥­ã®è‡ªå‹•åŒ– è¨­å®šç®¡ç†ãƒ„ãƒ¼ãƒ« æ—¢å­˜ã‚µãƒ¼ãƒã®è¨­å®šãƒ»ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« Ansible, Chef, Puppet è¤‡æ•°ã‚µãƒ¼ãƒã¸ã®ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ãƒ‡ãƒ—ãƒ­ã‚¤ã€å†ªç­‰æ€§ãŒå¿…è¦ãªè¨­å®šä½œæ¥­ ã‚µãƒ¼ãƒãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãƒ„ãƒ¼ãƒ« ã‚¤ãƒ¡ãƒ¼ã‚¸ã‹ã‚‰ã‚µãƒ¼ãƒç’°å¢ƒã‚’æ§‹ç¯‰ Docker, Packer, Vagrant ç’°å¢ƒã®å†ç¾æ€§ç¢ºä¿ã€ã‚¤ãƒŸãƒ¥ãƒ¼ã‚¿ãƒ–ãƒ«ã‚¤ãƒ³ãƒ•ãƒ©ã®å®Ÿç¾ ã‚ªãƒ¼ã‚±ã‚¹ãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ„ãƒ¼ãƒ« è¤‡æ•°ã‚·ã‚¹ãƒ†ãƒ ãƒ»ã‚µãƒ¼ãƒ“ã‚¹ã®çµ±åˆç®¡ç† Kubernetes ã‚³ãƒ³ãƒ†ãƒŠã®èµ·å‹•ãƒ»åœæ­¢ãƒ»ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°ã€ãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹ç®¡ç† ãƒ—ãƒ­ãƒ“ã‚¸ãƒ§ãƒ‹ãƒ³ã‚°ãƒ„ãƒ¼ãƒ« ã‚¤ãƒ³ãƒ•ãƒ©å…¨ä½“ã®ä½œæˆãƒ»ç®¡ç† Terraform, CloudFormation ã‚µãƒ¼ãƒãƒ»ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãƒ»DBç­‰ã®ã‚¤ãƒ³ãƒ•ãƒ©ãƒªã‚½ãƒ¼ã‚¹ä½œæˆ ãƒ„ãƒ¼ãƒ«é¸æŠã®åŸºæœ¬æ–¹é‡ # ã‚·ãƒ³ãƒ—ãƒ«ãªè‡ªå‹•åŒ–ï¼šã‚¢ãƒ‰ãƒ›ãƒƒã‚¯ãªã‚¹ã‚¯ãƒªãƒ—ãƒˆ æ—¢å­˜ç’°å¢ƒã®è¨­å®šå¤‰æ›´ï¼šè¨­å®šç®¡ç†ãƒ„ãƒ¼ãƒ« ç’°å¢ƒã®å†ç¾æ€§é‡è¦–ï¼šã‚µãƒ¼ãƒãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãƒ„ãƒ¼ãƒ« ã‚³ãƒ³ãƒ†ãƒŠç®¡ç†ï¼šã‚ªãƒ¼ã‚±ã‚¹ãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ„ãƒ¼ãƒ« ã‚¤ãƒ³ãƒ•ãƒ©å…¨ä½“ã®æ§‹ç¯‰ï¼šãƒ—ãƒ­ãƒ“ã‚¸ãƒ§ãƒ‹ãƒ³ã‚°ãƒ„ãƒ¼ãƒ«ï¼ˆTerraformç­‰ï¼‰ å®Ÿéš›ã®é–‹ç™ºç¾å ´ã§ã¯ã€ã“ã‚Œã‚‰ã®ãƒ„ãƒ¼ãƒ«ã‚’çµ„ã¿åˆã‚ã›ã¦ä½¿ç”¨ã™ã‚‹ã“ã¨ãŒå¤šã„ã€‚ ä¾‹ï¼šTerraformã§ã‚¤ãƒ³ãƒ•ãƒ©ã‚’æ§‹ç¯‰ â†’ Ansibleã§ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« â†’ Dockerã§ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å‹•ã‹ã™ â†’ Kubernetesã§ç®¡ç†\n","date":"2025å¹´ 11æœˆ 24æ—¥","externalUrl":null,"permalink":"/posts/251124162641_iac-five-classifications/","section":"Posts","summary":"","title":"IaCï¼ˆInfrastructure as Codeï¼‰ã®5ã¤ã®åˆ†é¡","type":"posts"},{"content":" ã¯ã˜ã‚ã« # æœ¬å±‹ã§ä½•æ°—ãªãèª­ã‚“ã§ã¿ã¦ã€æˆé•·ã—ãªã„ã‚±ãƒ¼ã‚¹ã¨ã—ã¦ã€Œã‚¹ã‚­ãƒ«ãƒãƒ‹ã‚¢ã€ãŒç´¹ä»‹ã•ã‚Œã¦ã„ãŸã€‚æ€ã„ã£ãã‚Šè‡ªåˆ†ã«å½“ã¦ã¯ã¾ã‚‹ãªã¨è€ƒãˆã€åˆºã•ã£ãŸã€‚ã“ã®æˆé•·ã—ãªã„ã‚¹ã‚­ãƒ«ãƒãƒ‹ã‚¢ã‹ã‚‰ã©ã†ã™ã‚Œã°æˆé•·ã™ã‚‹ã‚ˆã†ã«ãªã‚Œã‚‹ã‹ã‚’çŸ¥ã‚ŠãŸãã¦ã“ã®æœ¬ã‚’è³¼å…¥ã—ãŸã€‚\nã“ã®ãƒ¡ãƒ¢ã®ç›®çš„ï¼šæˆé•·ã—ãªã„ã‚¹ã‚­ãƒ«ãƒãƒ‹ã‚¢ã‹ã‚‰æˆé•·ã§ãã‚‹äººç‰©ã¸å¤‰ã‚ã‚‹ãŸã‚ã®å…·ä½“çš„ãªã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’çŸ¥ã‚‹\næ›¸ç±æƒ…å ± # BCGã®è‚²ã¤åŠ›ãƒ»è‚²ã¦ã‚‹åŠ› è‘—è€…ï¼šæœ¨æ‘äº®ç¤ºãƒ»æœ¨å±±è¡ å‡ºç‰ˆç¤¾ï¼šæ—¥çµŒBP å‡ºç‰ˆå¹´ï¼š2024å¹´ BCGã¨ã¯ï¼Ÿ # ã‚¢ãƒ¡ãƒªã‚«ã‚’æœ¬æ‹ åœ°ã¨ã—ã¦ã„ã‚‹æœ‰åãªã‚³ãƒ³ã‚µãƒ«ãƒ†ã‚£ãƒ³ã‚°ã‚°ãƒ«ãƒ¼ãƒ—\nåŸºæœ¬æƒ…å ±æŠ€è¡“è€…è©¦é¨“ã§ã‚‚å‡ºé¡Œã•ã‚Œã‚‹ã€ŒPPMã€ã¯ã“ã“ãŒç™ºæ¡ˆã—ãŸã‚‰ã—ã„ ãã‚‚ãã‚‚ã‚¹ã‚­ãƒ«ãƒãƒ‹ã‚¢ã¨ã¯ï¼Ÿ # æŠ€è¡“ã‚„è³‡æ ¼ã ã‘ã‚’é›†ã‚ã¦ã€æº€è¶³ã—ã¦ã„ã‚‹ã‚¿ã‚¤ãƒ—ã®äºº\nã„ã‚ã‚†ã‚‹å„ªç­‰ç”Ÿã‚¿ã‚¤ãƒ—ãŒãªã‚Šã‚„ã™ã„ ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³å‹ï¼šã„ã‚ã„ã‚ãªè³‡æ ¼ã‚’å…¥æ‰‹ã™ã‚‹ çªãè©°ã‚å‹ï¼šç‰¹å®šã®åˆ†é‡ã‚’æ·±å €ã‚Šã—ã¤ã¥ã‘ã‚‹ è‡ªåˆ†ã®æŒ¯ã‚Šè¿”ã‚Šï¼šã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³å‹ã ã¨æ€ã†ã€‚è³‡æ ¼ã‚’é›†ã‚ã¦ã„ã‚‹ãŒã€å®Ÿå‹™ã«æ´»ã‹ã›ã¦ã„ã‚‹ã‹ã¨ãªã‚‹ã¨ç–‘å•ç‚¹ãŒã‚ã‚‹ æˆé•·ã™ã‚‹ãŸã‚ã«å¿…è¦ãªã®ã¯ï¼Ÿ # ãƒã‚¤ãƒ³ãƒ‰ã‚»ãƒƒãƒˆã¨ã‚¹ã‚­ãƒ«ã®2ã¤ãŒå¿…è¦ã€‚ ã‚¹ã‚­ãƒ«ãŒä¸è¦ã¨ã„ã†ã‚ã‘ã§ã¯ãªã„ã€‚ãŸã ã—ã€ã‚¹ã‚­ãƒ«ã ã‘ã§ã¯ä¸è¶³ã€‚\nå…·ä½“çš„ãªãƒã‚¤ãƒ³ãƒ‰ã‚»ãƒƒãƒˆ # æ€ã„ã‚„ã‚Šï¼šè‡ªåˆ†ã ã‘ã‚’æº€è¶³ã•ã›ã‚‹ã“ã¨ã§ã¯ç›´ãã«é™ç•ŒãŒæ¥ã‚‹ ç´ ç›´ã•ï¼šè‡ªåˆ†ã®è¡Œå‹•ã‚’åˆ†æãƒ»åçœã—ã¦è¡Œå‹•ã™ã‚‹ æŠ˜ã‚Œãªã„å¿ƒï¼šã§ãã‚‹ã‹ã§ããªã„ã‹ä¸å®‰ã§ã‚‚ã€ã‚„ã‚‹ã—ã‹ãªã„ æœ¬ã®ä¾‹ãˆè©±ï¼ˆé‡çƒã®ãƒ”ãƒƒãƒãƒ£ãƒ¼ï¼‰ # çƒé€Ÿã‚’ä¸Šã’ãŸã‚Šã€å¤‰åŒ–çƒã‚’è¦šãˆã‚‹ã ã‘ã§ã¯å‹ã¦ãªã„ã€‚ä½¿ã„æ–¹ã‚’å­¦ã¶ã¹ãã€‚ å®Ÿå‹™çµŒé¨“ã‚’ç©ã¿ãªãŒã‚‰è©¦è¡ŒéŒ¯èª¤ã—ã¦æˆé•·ã—ã¦ã„ãå¿…è¦ãŒã‚ã‚‹ã€‚ ä¸­èº«ã¨ãªã‚‹ã‚¢ã‚¤ãƒ‡ã‚¢ã‚„æ€ã„ãŒãªã„ã¨ã„ãã‚‰ã‚¹ã‚­ãƒ«ãŒã‚ã£ã¦ã‚‚æ„å‘³ãªã„ã€‚\nå®Ÿè·µã«å‘ã‘ãŸã‚¢ã‚¯ã‚·ãƒ§ãƒ³ # å®Ÿå‹™ã§ã®è©¦è¡ŒéŒ¯èª¤ã‚’é‡è¦–ã™ã‚‹\nè³‡æ ¼å‹‰å¼·ã§å¾—ãŸçŸ¥è­˜ã‚’å®Ÿå‹™ã§è©¦ã—ã€åçœã¨æ”¹å–„ã‚’ç¹°ã‚Šè¿”ã™ è·å ´ã®å®Ÿéš›ã®èª²é¡Œã«å¯¾ã—ã¦å­¦ã‚“ã ã‚¹ã‚­ãƒ«ã‚’é©ç”¨ã—ã¦ã¿ã‚‹ è³‡æ ¼ãƒ»å­¦ç¿’ã®ä½ç½®ã¥ã‘ã‚’è¦‹ç›´ã™\nè³‡æ ¼å‹‰å¼·ã¯ã‚ãã¾ã§çŸ¥è­˜ã‚„ã‚¹ã‚­ãƒ«ã®å…¥é–€ã¨ã—ã¦ä½ç½®ã¥ã‘ã‚‹ ã€Œè³‡æ ¼ã‚’å–ã‚‹ã“ã¨ã€ã§ã¯ãªãã€Œå­¦ã‚“ã ã“ã¨ã‚’æ´»ã‹ã™ã“ã¨ã€ã‚’ç›®æ¨™ã«ã™ã‚‹ ä»–è€…ã¸ã®è²¢çŒ®ã‚’æ„è­˜ã™ã‚‹\nãƒãƒ¼ãƒ ã‚„çµ„ç¹”ã®èª²é¡Œã‚’è¦‹ã¤ã‘ã€è§£æ±ºã«å–ã‚Šçµ„ã‚€ å­¦ã‚“ã çŸ¥è­˜ã‚’åŒåƒšã¨å…±æœ‰ã—ã€ãƒãƒ¼ãƒ å…¨ä½“ã®ãƒ¬ãƒ™ãƒ«ã‚¢ãƒƒãƒ—ã«è²¢çŒ®ã™ã‚‹ å‚è€ƒè³‡æ–™ # Wikipediaï¼šãƒœã‚¹ãƒˆãƒ³ãƒ»ã‚³ãƒ³ã‚µãƒ«ãƒ†ã‚£ãƒ³ã‚°ãƒ»ã‚°ãƒ«ãƒ¼ãƒ— ","date":"2025å¹´ 11æœˆ 23æ—¥","externalUrl":null,"permalink":"/posts/251123232747_bcg-ikiru-chikara-sodateru-chikara-skill-mania-karano-dasshutsu/","section":"Posts","summary":"","title":"ã€èª­æ›¸ãƒ¡ãƒ¢ã€‘BCGã®è‚²ã¤åŠ›ãƒ»è‚²ã¦ã‚‹åŠ›ï¼šã‚¹ã‚­ãƒ«ãƒãƒ‹ã‚¢ã‹ã‚‰ã®è„±å´","type":"posts"},{"content":" ã¯ã˜ã‚ã« # ãƒ˜ãƒ«ãƒ—ãƒ‡ã‚¹ã‚¯ãƒ»ç›£è¦–é‹ç”¨ã§Teratermã‚’ä½¿ã£ã¦ãƒ­ã‚°èª¿æŸ»ã‚’è¡Œã†éš›ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å‚™å¿˜éŒ²ã¨ã—ã¦ã¾ã¨ã‚ã‚‹ã€‚\nå‰ææ¡ä»¶ # ã‚µãƒ¼ãƒ“ã‚¹ãƒ­ã‚°ã¯.logãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦ä¿ç®¡ 1æ—¥çµŒéã—ãŸãƒ­ã‚°ã¯.gzå½¢å¼ã§åœ§ç¸®ä¿å­˜ å®Ÿæ–½ã—ãŸã“ã¨ # ç‰¹å®šã®ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸(ERROR)ãŒãƒ­ã‚°ã«å«ã¾ã‚Œã¦ã„ã‚‹ã‹ç¢ºèªã—ãŸã„ã€‚\nã‚µãƒ³ãƒ—ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ã®å†…å®¹ # service.log (é€šå¸¸ã®ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«) # 2024-11-20 10:15:32 INFO Application started successfully 2024-11-20 10:15:45 INFO User login: user_id=12345 2024-11-20 10:16:03 WARN High memory usage detected: 85% 2024-11-20 10:16:15 INFO Processing request: /api/users 2024-11-20 10:16:28 ERROR Database connection timeout 2024-11-20 10:16:30 ERROR Failed to execute query: SELECT * FROM users 2024-11-20 10:17:12 INFO Request completed: status=200 2024-11-20 10:18:45 WARN Response time exceeded threshold: 3.5s 2024-11-20 10:19:03 INFO User logout: user_id=12345 2024-11-20 10:20:15 ERROR Network unreachable: host=192.168.1.100 2024-11-20 10:21:30 INFO Backup process started 2024-11-20 10:22:45 INFO Backup completed successfully ãƒ•ã‚¡ã‚¤ãƒ«ã®ä¸€è¦§è¡¨ç¤º # $ ls -lh service.log* -rw-r--r-- 1 root root 696 Nov 23 13:03 service.log -rw-r--r-- 1 root root 375 Nov 23 13:03 service.log.gz ä½¿ç”¨ã‚³ãƒãƒ³ãƒ‰ã¨å®Ÿè¡Œä¾‹ # 1. é€šå¸¸ã®ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«(.log)ã‹ã‚‰ERRORã‚’æ¤œç´¢ # ã‚³ãƒãƒ³ãƒ‰:\ngrep ERROR service.log å®Ÿè¡Œçµæœ:\n2024-11-20 10:16:28 ERROR Database connection timeout 2024-11-20 10:16:30 ERROR Failed to execute query: SELECT * FROM users 2024-11-20 10:20:15 ERROR Network unreachable: host=192.168.1.100 2. åœ§ç¸®ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«(.gz)ã‹ã‚‰ERRORã‚’æ¤œç´¢ # ã‚³ãƒãƒ³ãƒ‰:\nzgrep ERROR service.log.gz å®Ÿè¡Œçµæœ:\n2024-11-20 10:16:28 ERROR Database connection timeout 2024-11-20 10:16:30 ERROR Failed to execute query: SELECT * FROM users 2024-11-20 10:20:15 ERROR Network unreachable: host=192.168.1.100 ğŸ’¡ .logã§ã‚‚.gzã§ã‚‚åŒã˜çµæœãŒå¾—ã‚‰ã‚Œã‚‹!\n3. è¡Œç•ªå·ä»˜ãã§æ¤œç´¢ # ã‚³ãƒãƒ³ãƒ‰:\ngrep -n ERROR service.log å®Ÿè¡Œçµæœ:\n5:2024-11-20 10:16:28 ERROR Database connection timeout 6:2024-11-20 10:16:30 ERROR Failed to execute query: SELECT * FROM users 10:2024-11-20 10:20:15 ERROR Network unreachable: host=192.168.1.100 4. è¤‡æ•°ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’åŒæ™‚ã«æ¤œç´¢ (ERROR ã¾ãŸã¯ WARN) # ã‚³ãƒãƒ³ãƒ‰:\ngrep -E \u0026#34;ERROR|WARN\u0026#34; service.log å®Ÿè¡Œçµæœ:\n2024-11-20 10:16:03 WARN High memory usage detected: 85% 2024-11-20 10:16:28 ERROR Database connection timeout 2024-11-20 10:16:30 ERROR Failed to execute query: SELECT * FROM users 2024-11-20 10:18:45 WARN Response time exceeded threshold: 3.5s 2024-11-20 10:20:15 ERROR Network unreachable: host=192.168.1.100 5. æ¤œç´¢çµæœã®ä»¶æ•°ã‚’ã‚«ã‚¦ãƒ³ãƒˆ # ã‚³ãƒãƒ³ãƒ‰:\ngrep -c ERROR service.log å®Ÿè¡Œçµæœ:\n3 ã‚ˆãä½¿ã†grepã‚ªãƒ—ã‚·ãƒ§ãƒ³ # ã‚ªãƒ—ã‚·ãƒ§ãƒ³ èª¬æ˜ ä½¿ç”¨ä¾‹ -n è¡Œç•ªå·ã‚’è¡¨ç¤º grep -n ERROR service.log -i å¤§æ–‡å­—å°æ–‡å­—ã‚’åŒºåˆ¥ã—ãªã„ grep -i error service.log -c ãƒãƒƒãƒã—ãŸè¡Œæ•°ã‚’ã‚«ã‚¦ãƒ³ãƒˆ grep -c ERROR service.log -v ãƒãƒƒãƒã—ãªã„è¡Œã‚’è¡¨ç¤º grep -v INFO service.log -A æ•°å­— ãƒãƒƒãƒè¡Œã®å¾Œã‚Nè¡Œã‚‚è¡¨ç¤º grep -A 3 ERROR service.log -B æ•°å­— ãƒãƒƒãƒè¡Œã®å‰Nè¡Œã‚‚è¡¨ç¤º grep -B 2 ERROR service.log -C æ•°å­— ãƒãƒƒãƒè¡Œã®å‰å¾ŒNè¡Œã‚’è¡¨ç¤º grep -C 2 ERROR service.log -E æ‹¡å¼µæ­£è¦è¡¨ç¾ã‚’ä½¿ç”¨ grep -E \u0026quot;ERROR|WARN\u0026quot; service.log moreã¨lessã®é•ã„ # é …ç›® more less ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«æ–¹å‘ å‰æ–¹ã®ã¿(ä¸‹æ–¹å‘) å‰å¾Œè‡ªç”±(ä¸Šä¸‹ä¸¡æ–¹å‘) æ¤œç´¢æ©Ÿèƒ½ é™å®šçš„ å……å®Ÿ(å‰æ–¹/å¾Œæ–¹æ¤œç´¢å¯èƒ½) ãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿è¾¼ã¿ å…¨ä½“ã‚’èª­ã¿è¾¼ã‚€ å¿…è¦ãªéƒ¨åˆ†ã®ã¿èª­ã¿è¾¼ã‚€ å¤§å®¹é‡ãƒ•ã‚¡ã‚¤ãƒ« é…ã„ é«˜é€Ÿ æ“ä½œ ã‚·ãƒ³ãƒ—ãƒ« é«˜æ©Ÿèƒ½(viãƒ©ã‚¤ã‚¯) çµ‚äº†æ™‚ã®è¡¨ç¤º ç”»é¢ã«æ®‹ã‚‹ ç”»é¢ã‹ã‚‰æ¶ˆãˆã‚‹ ä¸»ãªæ“ä½œæ–¹æ³• # more:\nSpace: æ¬¡ã®ãƒšãƒ¼ã‚¸ Enter: 1è¡Œé€²ã‚€ q: çµ‚äº† less:\nSpace/f: æ¬¡ã®ãƒšãƒ¼ã‚¸ b: å‰ã®ãƒšãƒ¼ã‚¸ â†‘/â†“: 1è¡Œãšã¤ç§»å‹• /æ–‡å­—åˆ—: å‰æ–¹æ¤œç´¢ ?æ–‡å­—åˆ—: å¾Œæ–¹æ¤œç´¢ n: æ¬¡ã®æ¤œç´¢çµæœ N: å‰ã®æ¤œç´¢çµæœ q: çµ‚äº† lessã§ã®æ¤œç´¢å®Ÿä¾‹ # less service.log lesså†…ã§:\n/ERROR # ã€ŒERRORã€ã‚’å‰æ–¹æ¤œç´¢ n # æ¬¡ã®ERRORã¸ã‚¸ãƒ£ãƒ³ãƒ— N # å‰ã®ERRORã¸æˆ»ã‚‹ ä½¿ã„åˆ†ã‘ã®ãƒã‚¤ãƒ³ãƒˆ # more: ã‚·ãƒ³ãƒ—ãƒ«ã«å‰ã‹ã‚‰é †ã«è¦‹ãŸã„å ´åˆ less: å¤§ããªãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ã®èª¿æŸ»ã€æ¤œç´¢ãŒå¿…è¦ãªå ´åˆ ğŸ’¡ è±†çŸ¥è­˜: \u0026ldquo;less is more\u0026quot;ã¨ã„ã†è¨€è‘‰éŠã³ã‹ã‚‰ã€moreã®æ”¹è‰¯ç‰ˆã¨ã—ã¦lessãŒèª•ç”Ÿã—ãŸ\nå„ã‚³ãƒãƒ³ãƒ‰ã®èª¬æ˜ # ã‚³ãƒãƒ³ãƒ‰ èª¬æ˜ å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ« grep ãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰æ–‡å­—åˆ—ã‚’æ¤œç´¢ .logãªã© zgrep åœ§ç¸®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä¸€æ™‚çš„ã«è§£å‡ã—ã¦æ¤œç´¢ï¼ˆè§£å‡ãƒ•ã‚¡ã‚¤ãƒ«ã¯ä½œæˆã—ãªã„ï¼‰ .gz less ãƒšãƒ¼ã‚¸å˜ä½ã§ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è¡¨ç¤º(æ¤œç´¢æ©Ÿèƒ½ä»˜ã) .logãªã© zless åœ§ç¸®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’lessã§è¡¨ç¤º .gz more ã‚·ãƒ³ãƒ—ãƒ«ãªãƒšãƒ¼ã‚¸ãƒ£ãƒ¼(å‰æ–¹ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã®ã¿) .logãªã© ã‚ˆãã‚ã‚‹é–“é•ã„ # âŒ ãƒ‘ã‚¤ãƒ—ã®èª¤ç”¨\nmore service.log | zgrep ERROR â†’ zgrepã¯åœ§ç¸®ãƒ•ã‚¡ã‚¤ãƒ«å°‚ç”¨ã€‚ãƒ‘ã‚¤ãƒ—ã§æ¸¡ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã¯åœ§ç¸®ã•ã‚Œã¦ã„ãªã„\nâ­• æ­£ã—ã„ä½¿ã„æ–¹\n# é€šå¸¸ãƒ•ã‚¡ã‚¤ãƒ« grep ERROR service.log # åœ§ç¸®ãƒ•ã‚¡ã‚¤ãƒ« zgrep ERROR service.log.gz âŒ å¤§ããªãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ã«more\nmore huge_file.log # èª­ã¿è¾¼ã¿ãŒé…ã„ â­• lessã‚’ä½¿ã†\nless huge_file.log # é«˜é€Ÿã«èµ·å‹• å­¦ã‚“ã ã“ã¨ # åœ§ç¸®ãƒ•ã‚¡ã‚¤ãƒ«ã«ã¯zç³»ã‚³ãƒãƒ³ãƒ‰(zgrep, zless)ã‚’ç›´æ¥ä½¿ã†æ–¹ãŒåŠ¹ç‡çš„ lessã¯moreã‚ˆã‚Šé«˜æ©Ÿèƒ½ã§æ¤œç´¢ã‚‚å¯èƒ½ ãƒ­ã‚°èª¿æŸ»ã§ã¯lessã®æ–¹ãŒå®Ÿç”¨çš„(å‰å¾Œã«ç§»å‹•ã§ãã‚‹ãŸã‚) grep -nã§è¡Œç•ªå·ã‚’è¡¨ç¤ºã™ã‚‹ã¨ã€lessã§è©²å½“è¡Œã«ã‚¸ãƒ£ãƒ³ãƒ—ã—ã‚„ã™ã„ -A, -B, -Cã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§å‰å¾Œã®æ–‡è„ˆã‚‚ç¢ºèªã§ãã‚‹ å‚è€ƒ: ã‚ˆãä½¿ã†ãƒ­ã‚°èª¿æŸ»ãƒ‘ã‚¿ãƒ¼ãƒ³ # # ãƒ‘ã‚¿ãƒ¼ãƒ³1: ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°ã‚’æŠ½å‡ºã—ã¦åˆ¥ãƒ•ã‚¡ã‚¤ãƒ«ã«ä¿å­˜ grep ERROR service.log \u0026gt; error_only.log # ãƒ‘ã‚¿ãƒ¼ãƒ³2: æœ€æ–°ã®ã‚¨ãƒ©ãƒ¼ã‚’ç¢ºèª grep ERROR service.log | tail -5 # ãƒ‘ã‚¿ãƒ¼ãƒ³3: ã‚¨ãƒ©ãƒ¼ã¨ãã®å‰å¾Œ2è¡Œã‚’è¡¨ç¤º grep -C 2 ERROR service.log # ãƒ‘ã‚¿ãƒ¼ãƒ³4: è¤‡æ•°ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ã‚¨ãƒ©ãƒ¼ã‚’æ¤œç´¢ grep ERROR service*.log # ãƒ‘ã‚¿ãƒ¼ãƒ³5: åœ§ç¸®ãƒ•ã‚¡ã‚¤ãƒ«ã‚‚å«ã‚ã¦æ¤œç´¢ zgrep ERROR service.log.gz ","date":"2025å¹´ 11æœˆ 23æ—¥","externalUrl":null,"permalink":"/posts/251123221331_log-investigation-more-less-grep-zgrep/","section":"Posts","summary":"","title":"ãƒ­ã‚°èª¿æŸ»_moreãƒ»lessãƒ»grepãƒ»zgrep","type":"posts"},{"content":" ã¯ã˜ã‚ã« # ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæŒ‡å‘ã«ã¤ã„ã¦ã€è¬›å¸«å½¹ã¨ã—ã¦è§£èª¬ã™ã‚‹æ©Ÿä¼šãŒã‚ã‚‹ãŸã‚ã€ æŒ¯ã‚Šè¿”ã‚Šã¨ã—ã¦ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæŒ‡å‘ã‚’å†å­¦ç¿’ã™ã‚‹ã€‚\nã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæŒ‡å‘ã¨ã¯ï¼Ÿ # ãƒ‡ãƒ¼ã‚¿ã¨é–¢é€£ã™ã‚‹å‡¦ç†ã‚’ã€Œã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã€ã¨ã„ã†å˜ä½ã«ã¾ã¨ã‚ã¦ç®¡ç†ã™ã‚‹ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢é–‹ç™ºæ‰‹æ³• ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¯ã€ã‚¯ãƒ©ã‚¹ã‹ã‚‰ç”Ÿæˆã•ã‚Œã‚‹å®Ÿä½“ï¼ˆã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ï¼‰ ï¼ˆä¸€éƒ¨ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°è¨€èªï¼ˆPythonã€Rubyãªã©ï¼‰ã§ã¯ã‚¯ãƒ©ã‚¹è‡ªä½“ã‚‚ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¨ã—ã¦æ‰±ã‚ã‚Œã‚‹ãŒã€ã“ã®ãƒ¡ãƒ¢ã§ã¯ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ=ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã¨ã™ã‚‹ï¼‰ ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæŒ‡å‘ãŒèª•ç”Ÿã—ãŸçµŒç·¯ # 1960ï½1970å¹´ä»£ã¯ã€Œæ‰‹ç¶šãå‹ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã€ãŒä¸»æµã€‚ ãƒ‡ãƒ¼ã‚¿ã¨å‡¦ç†ã‚’åˆ¥ã€…ã§è¨˜è¿°ã™ã‚‹æ‰‹æ³•ã§ã€å„ãƒ‡ãƒ¼ã‚¿ã‚„å‡¦ç†ã®ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã«é›†ä¸­ã§ãã‚‹åé¢ã€ãƒ—ãƒ­ã‚°ãƒ©ãƒ ãŒå¤§è¦æ¨¡åŒ–ã™ã‚‹ã¨ã€ãƒ‡ãƒ¼ã‚¿ã¨å‡¦ç†ã®é–¢ä¿‚æ€§ã‚’æŠŠæ¡ã™ã‚‹ã®ã«å¤šå¤§ãªã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚’å¿…è¦ã¨ã—ã¦ã„ãŸã€‚ æ§‹é€ åŒ–ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã¯åˆ¶å¾¡æ§‹é€ ï¼ˆé †æ¬¡ãƒ»é¸æŠãƒ»åå¾©ï¼‰ã‚’æ•´ç†ã™ã‚‹æ‰‹æ³•ã¨ã—ã¦åŒæ™‚æœŸã«ç™ºå±•ã—ãŸãŒã€ãƒ‡ãƒ¼ã‚¿ã¨å‡¦ç†ã®ç®¡ç†ã«ã¤ã„ã¦ã¯åˆ¥ã®èª²é¡Œã¨ã—ã¦æ®‹ã£ã¦ã„ãŸã€‚ ã“ã®å•é¡Œã‚’è§£æ±ºã™ã‚‹ãŸã‚ã«ã€Œãƒ‡ãƒ¼ã‚¿ã€ã¨ã€Œå‡¦ç†ã€ã‚’ã¾ã¨ã‚ã¦ç®¡ç†ã™ã‚‹ã€Œã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã€ãŒèª•ç”Ÿã€‚ã“ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ç®¡ç†ã«ä¸»çœ¼ã‚’ç½®ã„ãŸã®ãŒã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæŒ‡å‘ã§ã‚ã‚‹ã€‚ ã‚¯ãƒ©ã‚¹ãƒ»ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ # ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæŒ‡å‘ã‚’æˆç«‹ã•ã›ã‚‹ãŸã‚ã®åŸºæœ¬çš„ãªæ¦‚å¿µãŒã‚¯ãƒ©ã‚¹ã¨ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹\nã‚¯ãƒ©ã‚¹ï¼šè¨­è¨ˆå›³ã‚„ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ï¼šã‚¯ãƒ©ã‚¹ã‹ã‚‰ç”Ÿæˆã•ã‚Œã‚‹å®Ÿä½“ï¼ˆã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆï¼‰ è»Šã§ä¾‹ãˆã‚‹ã¨ã€è¨­è¨ˆå›³ã‹ã‚‰è»Šã‚’è£½é€ ã™ã‚‹ã‚ˆã†ãªã‚¤ãƒ¡ãƒ¼ã‚¸\nã‚¯ãƒ©ã‚¹ï¼šè»Šã®è¨­è¨ˆå›³ ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ï¼šè£½é€ ã•ã‚ŒãŸè»Š åŸºæœ¬ç”¨èª # ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæŒ‡å‘ã‚’ç†è§£ã™ã‚‹ä¸Šã§é‡è¦ãªåŸºæœ¬ç”¨èªã‚’èª¬æ˜ã—ã¾ã™ã€‚\nãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ï¼ˆå±æ€§ï¼‰ # ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒæŒã¤ãƒ‡ãƒ¼ã‚¿ãƒ»çŠ¶æ…‹ã‚’è¡¨ã™å¤‰æ•° è»Šã®ä¾‹ï¼šè‰²ã€é€Ÿåº¦ã€èµ°è¡Œè·é›¢ã€ç‡ƒæ–™æ®‹é‡ãªã© ä¾‹ï¼šcar.color = \u0026quot;red\u0026quot; ï¼ˆè»Šã®è‰²ã¯èµ¤ï¼‰ ãƒ¡ã‚½ãƒƒãƒ‰ # ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒã§ãã‚‹å‹•ä½œãƒ»å‡¦ç†ã‚’è¡¨ã™é–¢æ•° è»Šã®ä¾‹ï¼šèµ°ã‚‹ã€æ­¢ã¾ã‚‹ã€ã‚¯ãƒ©ã‚¯ã‚·ãƒ§ãƒ³ã‚’é³´ã‚‰ã™ã€çµ¦æ²¹ã™ã‚‹ãªã© ä¾‹ï¼šcar.drive() ï¼ˆè»Šã‚’é‹è»¢ã™ã‚‹ï¼‰ ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ # ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ç”Ÿæˆã™ã‚‹éš›ã«åˆæœŸåŒ–å‡¦ç†ã‚’è¡Œã†ç‰¹åˆ¥ãªãƒ¡ã‚½ãƒƒãƒ‰ æ–°ã—ã„è»Šã‚’è£½é€ ã™ã‚‹éš›ã®åˆæœŸè¨­å®šã®ã‚ˆã†ãªã‚‚ã® è»Šã®ä¾‹ï¼šè£½é€ æ™‚ã«è‰²ã€ã‚¨ãƒ³ã‚¸ãƒ³ã‚¿ã‚¤ãƒ—ã€ã‚·ãƒ¼ãƒˆæ•°ãªã©ã‚’è¨­å®š ä¾‹ï¼šcar = Car(\u0026quot;red\u0026quot;, \u0026quot;hybrid\u0026quot;, 5) ï¼ˆèµ¤ã„ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰5äººä¹—ã‚Šã®è»Šã‚’ä½œã‚‹ï¼‰ ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæŒ‡å‘ã®3å¤§è¦ç´  # ç¶™æ‰¿ ã‚«ãƒ—ã‚»ãƒ«åŒ– ãƒãƒªãƒ¢ãƒ¼ãƒ•ã‚£ã‚ºãƒ  ã‚¯ãƒ©ã‚¹ã¨ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ä½¿ã£ã¦ä¸Šè¨˜ã®3è¦ç´ ãŒå®Ÿç¾ã§ãã‚‹ã€‚\nç¶™æ‰¿ # è¦ªã‚¯ãƒ©ã‚¹ã‹ã‚‰å†…å®¹ã‚’å¼•ãç¶™ã„ã§æ–°ã—ã„å­ã‚¯ãƒ©ã‚¹ã‚’ä½œæˆã™ã‚‹ã€‚\nä¾‹ãˆã°ã€è¦ªã‚¯ãƒ©ã‚¹ã¨ã—ã¦ã€Œè»Šã€ãŒã‚ã‚‹ã¨ã—ãŸå ´åˆã€å­ã‚¯ãƒ©ã‚¹ã¨ã—ã¦ã€Œä¹—ç”¨è»Šã€ã€Œãƒˆãƒ©ãƒƒã‚¯ã€ã€Œãƒã‚¹ã€ã‚’è¨­å®šå¯èƒ½ã€‚ ã•ã‚‰ã«ã€Œä¹—ç”¨è»Šã€ã‹ã‚‰ã€Œã‚¿ã‚¯ã‚·ãƒ¼ã€ã‚„ã€Œãƒ‘ãƒˆã‚«ãƒ¼ã€ã‚’ä½œã‚‹ã“ã¨ã‚‚ã§ãã‚‹ã€‚ ã“ã®ã¨ãã€ã€Œãƒˆãƒ©ãƒƒã‚¯ã€ã«ã¯ã€Œè·ç‰©ã‚’ç©ã‚€ã€ã€ã€Œãƒã‚¹ã€ã«ã¯ã€Œä¹—å®¢ã‚’ä¹—ã›ã‚‹ã€ãªã©ã®å€‹åˆ¥æ©Ÿèƒ½ã‚’å®Ÿè£…ã§ãã‚‹ã€‚\nã‚«ãƒ—ã‚»ãƒ«åŒ– # ãƒ‡ãƒ¼ã‚¿ã¨å‡¦ç†ã‚’å¤–éƒ¨ã‹ã‚‰éš è”½ã—ã¦ä¿è­·ã™ã‚‹æ©Ÿèƒ½\nè»Šã®ä¾‹ã‚’å¼•ãç¶šãåˆ©ç”¨ã™ã‚‹ã¨ã€ã€Œè»Šã®èµ°è¡Œè·é›¢è¨˜éŒ²ï¼ˆã‚ªãƒ‰ãƒ¡ãƒ¼ã‚¿ãƒ¼ï¼‰ã€ãŒã‚ã‚‹ã€‚ ã“ã®ã‚ªãƒ‰ãƒ¡ãƒ¼ã‚¿ãƒ¼ã¯æ‰‹å‹•ã§ã„ã˜ã‚‹ã“ã¨ã¯é•æ³•è¡Œç‚ºã«ã‚ãŸã‚‹ã€‚èµ°è¡Œè·é›¢ã‚’ã—ã£ã‹ã‚Šæ¸¬å®šã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã®ã§ã€ ã€Œè»Šã®èµ°è¡Œè·é›¢è¨˜éŒ²ï¼ˆã‚ªãƒ‰ãƒ¡ãƒ¼ã‚¿ãƒ¼ï¼‰ã€ã«å¯¾ã—ã¦ã€ç›´æ¥ã‚¢ã‚¯ã‚»ã‚¹ã§ããªã„ã‚ˆã†ã«ã—ã¦ã€ã€Œè»Šã§é‹è»¢ã€ã—ãŸå ´åˆã®ã¿ ã€Œã‚ªãƒ‰ãƒ¡ãƒ¼ã‚¿ãƒ¼ã€ã«è¿½åŠ ã™ã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚ã“ã®å‡¦ç†ã‚’ã‚«ãƒ—ã‚»ãƒ«åŒ–ã§å®Ÿç¾ã§ãã‚‹ã€‚\nãƒãƒªãƒ¢ãƒ¼ãƒ•ã‚£ã‚ºãƒ  # åŒã˜å‘½ä»¤ã§ã€å¯¾è±¡ã«ã‚ˆã£ã¦ç•°ãªã‚‹å‹•ä½œã‚’ã™ã‚‹æ©Ÿèƒ½\nè»Šã®ä¾‹ï¼šã€Œã‚µã‚¤ãƒ¬ãƒ³ã‚’é³´ã‚‰ã™ã€ã¨ã„ã†åŒã˜å‘½ä»¤ã§ã‚‚\nãƒ‘ãƒˆã‚«ãƒ¼ â†’ ã€Œã‚¦ãƒ¼ã‚¦ãƒ¼ã€ æ•‘æ€¥è»Š â†’ ã€Œãƒ”ãƒ¼ãƒãƒ¼ãƒ”ãƒ¼ãƒãƒ¼ã€ æ¶ˆé˜²è»Š â†’ ã€Œã‚¦ãƒ¼ã‚«ãƒ³ã‚«ãƒ³ã€ ãã‚Œãã‚Œé•ã†éŸ³ãŒé³´ã‚‹ã€‚\nã“ã‚ŒãŒä¾¿åˆ©ãªç†ç”±ã¯ã€ã€Œã‚µã‚¤ãƒ¬ãƒ³ã‚’é³´ã‚‰ã™ã€ã¨ã„ã†å…±é€šã®å‘½ä»¤ã‚’è¦šãˆã‚‹ã ã‘ã§ã€ è»Šç¨®ã”ã¨ã®ç´°ã‹ã„é•ã„ã‚’æ„è­˜ã›ãšã«ä½¿ãˆã‚‹ã“ã¨ã§ã‚ã‚‹ã€‚\nã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæŒ‡å‘ã®ãƒ¡ãƒªãƒƒãƒˆãƒ»ãƒ‡ãƒ¡ãƒªãƒƒãƒˆ # ãƒ¡ãƒªãƒƒãƒˆ # å†åˆ©ç”¨ã—ã‚„ã™ã„\nä¸€åº¦ä½œã£ãŸã€Œè»Šã€ã‚¯ãƒ©ã‚¹ã‹ã‚‰ã€ä½•å°ã§ã‚‚è»Šã‚’ä½œã‚Œã‚‹ ä¿®æ­£ãŒæ¥½\nã€Œè»Šã€ã‚¯ãƒ©ã‚¹ã‚’ä¿®æ­£ã™ã‚Œã°ã€å…¨ã¦ã®è»Šã«åæ˜ ã•ã‚Œã‚‹ ç¾å®Ÿä¸–ç•Œã«è¿‘ã„\nè»Šã€äººã€å»ºç‰©ãªã©ã€èº«è¿‘ãªãƒ¢ãƒã¨ã—ã¦è€ƒãˆã‚‰ã‚Œã‚‹ ãƒ‡ãƒ¡ãƒªãƒƒãƒˆ # å°ã•ãªãƒ—ãƒ­ã‚°ãƒ©ãƒ ã«ã¯å¤§ã’ã•\nç°¡å˜ãªè¨ˆç®—ã ã‘ãªã‚‰ã€ã‚¯ãƒ©ã‚¹ãªã—ã®æ–¹ãŒæ—©ã„ æœ€åˆã¯é›£ã—ã„\næ¦‚å¿µã®ç†è§£ã«æ™‚é–“ãŒã‹ã‹ã‚‹ è¨­è¨ˆãƒŸã‚¹ã®å½±éŸ¿ãŒå¤§ãã„\nã‚¯ãƒ©ã‚¹ã®ä½œã‚Šæ–¹ã‚’é–“é•ãˆã‚‹ã¨ã€å¤§å¹…ãªä¿®æ­£ãŒå¿…è¦ ã¾ã¨ã‚ # ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæŒ‡å‘ # ãƒ‡ãƒ¼ã‚¿ã¨é–¢é€£ã™ã‚‹å‡¦ç†ã‚’ã€Œã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã€ã¨ã„ã†å˜ä½ã«ã¾ã¨ã‚ã¦ç®¡ç†ã™ã‚‹ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢é–‹ç™ºæ‰‹æ³•\nã‚¯ãƒ©ã‚¹ã¨ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ # ã‚¯ãƒ©ã‚¹ï¼šè¨­è¨ˆå›³ãƒ»ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ï¼šã‚¯ãƒ©ã‚¹ã‹ã‚‰ç”Ÿæˆã•ã‚ŒãŸå®Ÿç‰© ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæŒ‡å‘ã®3å¤§è¦ç´  # ç¶™æ‰¿ï¼šæ—¢å­˜ã®ã‚¯ãƒ©ã‚¹ã‚’æ‹¡å¼µã—ã¦å†åˆ©ç”¨ ã‚«ãƒ—ã‚»ãƒ«åŒ–ï¼šãƒ‡ãƒ¼ã‚¿ã¨æ©Ÿèƒ½ã‚’ã¾ã¨ã‚ã¦ã€å¤–éƒ¨ã‹ã‚‰ä¿è­· ãƒãƒªãƒ¢ãƒ¼ãƒ•ã‚£ã‚ºãƒ ï¼šåŒã˜æ“ä½œã§ç•°ãªã‚‹æŒ¯ã‚‹èˆã„ ã•ã‚‰ã«æ·±ãå­¦ã¶ãŸã‚ã« # ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæŒ‡å‘é–‹ç™ºã®åˆæœŸã«æ´»èºã—ãŸã€Œã‚¢ãƒ©ãƒ³ãƒ»ã‚±ã‚¤ã€ã«ã‚ˆã‚‹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæŒ‡å‘ã®è§£èª¬ã‚’èª­ã‚€ã¨ ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæŒ‡å‘ã«ã¤ã„ã¦æ·±æ˜ã‚Šã§ãã‚‹ã¨æ€ã„ã¾ã™ã€‚å†…å®¹ãŒé›£ã—ã„ã®ã§ã€ã“ã®ãƒ¡ãƒ¢ã§ã¯è©³ç´°ã«ã¾ã¨ã‚ãªã„ãŒã€å‚è€ƒã¨ã—ã¦ãƒªãƒ³ã‚¯ã‚’ç´¹ä»‹ã—ã¾ã™ã€‚\nnoteï¼šã‚¢ãƒ©ãƒ³ãƒ»ã‚±ã‚¤ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæŒ‡å‘ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚° Dr. Alan Kay on the Meaning of â€œObject-Oriented Programmingâ€ Qiitaï¼šã‚¢ãƒ©ãƒ³ãƒ»ã‚±ã‚¤ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæŒ‡å‘ã¨ã¯ä½•ã ã£ãŸã‹ï¼Ÿå…ƒå“²å­¦è€…ã®ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãŒã¾ã¨ã‚ã¦ã¿ãŸ å‚è€ƒè³‡æ–™ # ã„ã¡ã°ã‚“ã‚„ã•ã—ã„åŸºæœ¬æƒ…å ±æŠ€è¡“è€… çµ¶å¯¾åˆæ ¼ã®æ•™ç§‘æ›¸ï¼‹å‡ºã‚‹é †å•é¡Œé›† è‘—è€…ï¼šé«˜æ©‹ äº¬ä»‹ å‡ºç‰ˆç¤¾ï¼šSBã‚¯ãƒªã‚¨ã‚¤ãƒ†ã‚£ãƒ– å‡ºç‰ˆå¹´ï¼š2024å¹´ Qiitaï¼š[Python] Pythonã§ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæŒ‡å‘ã‚’å®Œå…¨ç†è§£ã—ã¦ã¿ã‚‹ ","date":"2025å¹´ 11æœˆ 23æ—¥","externalUrl":null,"permalink":"/posts/251123211627_object-oriented-programming-introduction-memo/","section":"Posts","summary":"","title":"ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæŒ‡å‘ã®å…¥é–€ç”¨ãƒ¡ãƒ¢","type":"posts"},{"content":"","date":"2025å¹´ 11æœˆ 23æ—¥","externalUrl":null,"permalink":"/tags/%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%9F%E3%83%B3%E3%82%B0/","section":"Tags","summary":"","title":"ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°","type":"tags"},{"content":" ã¯ã˜ã‚ã« # ãƒ¡ãƒ¢ã‚’ã¾ã¨ã‚ã‚‹æ–¹æ³•ã¨ã—ã¦ã€ã€Œãƒ„ã‚§ãƒƒãƒ†ãƒ«ã‚«ã‚¹ãƒ†ãƒ³ã€ã‚’å‹‰å¼·ã™ã‚‹ãŸã‚ã«ã“ã®æœ¬ã§å­¦ç¿’ã€‚\næ›¸ç±æƒ…å ± # æ›¸ç±å: TAKE NOTES!â€•â€•ãƒ¡ãƒ¢ã§ã€ã‚ãªãŸã ã‘ã®ã‚¢ã‚¦ãƒˆãƒ—ãƒƒãƒˆãŒè‡ªç„¶ã«ã§ãã‚‹ã‚ˆã†ã«ãªã‚‹ è‘—è€…: ã‚ºãƒ³ã‚¯ãƒ»ã‚¢ãƒ¼ãƒ¬ãƒ³ã‚¹ï¼ˆç¿»è¨³ï¼šäºŒæœ¨ å¤¢å­ï¼‰ å‡ºç‰ˆ: æ—¥çµŒBPã€2021å¹´10æœˆ å‡ºç‰ˆç¤¾ãƒšãƒ¼ã‚¸ æœ¬æ›¸ã®è¦ç‚¹ # ãƒ„ã‚§ãƒƒãƒ†ãƒ«ã‚«ã‚¹ãƒ†ãƒ³ã¨ã¯ # ç¤¾ä¼šå­¦è€…ãƒ«ãƒ¼ãƒãƒ³ãŒå®Ÿè·µã—ãŸãƒ¡ãƒ¢è¡“ã€‚å°ã•ãªå˜ä½ã®ãƒ¡ãƒ¢ã‚’ä½œã‚Šã€\nç›¸äº’ã«ãƒªãƒ³ã‚¯ã•ã›ã‚‹ã“ã¨ã§çŸ¥è­˜ã®ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚’æ§‹ç¯‰ã™ã‚‹æ‰‹æ³•ã€‚\nãƒ¡ãƒ¢ã®å‡¦ç†ãƒ•ãƒ­ãƒ¼ # èµ°ã‚Šæ›¸ããƒ»æ–‡çŒ®ãƒ¡ãƒ¢: æ—¥å¸¸ã®ã‚¢ã‚¤ãƒ‡ã‚¢ã‚„èª­æ›¸å†…å®¹ã‚’ä¸€æ™‚è¨˜éŒ² æ°¸ä¹…ä¿å­˜ãƒ¡ãƒ¢: è‡ªåˆ†ã®è¨€è‘‰ã§å†æ§‹æˆã—ãŸç‹¬ç«‹ã—ãŸãƒ¡ãƒ¢ é–¢é€£ã¥ã‘: æ—¢å­˜ãƒ¡ãƒ¢ã¨ãƒªãƒ³ã‚¯ã—ã€çŸ¥è­˜ä½“ç³»ã‚’è‚²ã¦ã‚‹ ã‚¢ã‚¦ãƒˆãƒ—ãƒƒãƒˆ: è“„ç©ã—ãŸãƒ¡ãƒ¢ã‹ã‚‰æ–‡ç« ã‚„ç ”ç©¶ã¸å±•é–‹ é‡è¦ãªè€ƒãˆæ–¹ # ã‚¢ã‚¦ãƒˆãƒ—ãƒƒãƒˆå‰æã®ã‚¤ãƒ³ãƒ—ãƒƒãƒˆ: å¸¸ã«ã‚¢ã‚¦ãƒˆãƒ—ãƒƒãƒˆã‚’æ„è­˜ã—ã¦æƒ…å ±ã‚’å–ã‚Šè¾¼ã‚€ è‡ªåˆ†ã®è¨€è‘‰ã§æ›¸ã: ç†è§£åº¦ã‚’ç¢ºèªã—ã€æ€è€ƒã‚’æ·±ã‚ã‚‹ ã¤ãªãŒã‚Šã‚’æ„è­˜: ãƒ¡ãƒ¢åŒå£«ã®é–¢é€£æ€§ã‚’æ•´ç†ã™ã‚‹ã“ã¨ãŒæ´å¯Ÿã«ã¤ãªãŒã‚‹ æ‰€æ„Ÿ # ãƒ¡ãƒ¢è¡“ã«é–¢ã™ã‚‹è‡ªå·±å•“ç™ºæ›¸ã€‚ã‚·ã‚¹ãƒ†ãƒãƒ†ã‚£ãƒƒã‚¯ã«ãƒ¡ãƒ¢ã‚’è“„ç©ã™ã‚‹ã“ã¨ã§è³ªã®é«˜ã„ã‚¢ã‚¦ãƒˆãƒ—ãƒƒãƒˆãŒå¯èƒ½ã«ãªã‚‹ã¨ã„ã†ææ¡ˆã¯æœ‰ç›Šã ãŒã€å…·ä½“çš„ãªãƒã‚¦ãƒ„ãƒ¼ã‚ˆã‚Šæ¦‚å¿µçš„ãªèª¬æ˜ãŒä¸­å¿ƒã€‚ãƒ¡ãƒ¢ã®æ„ç¾©ã‚’å†ç¢ºèªã—ã€ãƒ¢ãƒãƒ™ãƒ¼ã‚·ãƒ§ãƒ³ã‚’é«˜ã‚ã‚‹ã®ã«é©ã—ã¦ã„ã‚‹ã€‚\nå®Ÿè·µã™ã‚‹3ã¤ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ # æ—¥å¸¸çš„ãªãƒ¡ãƒ¢å–ã‚Šã®ç¿’æ…£åŒ– ãƒ¡ãƒ¢é–“ã®ã¤ãªãŒã‚Šã‚’æ„è­˜ã—ãŸæ•´ç† è‡ªåˆ†ã®è¨€è‘‰ã§ã®è¨€ã„æ›ãˆã®å¾¹åº• ","date":"2025å¹´ 11æœˆ 20æ—¥","externalUrl":null,"permalink":"/posts/251120230822_take-notes-output-naturally-with-memos/","section":"Posts","summary":"","title":"ã€èª­æ›¸ãƒ¡ãƒ¢ã€‘TAKE NOTES!â€•â€•ãƒ¡ãƒ¢ã§ã€ã‚ãªãŸã ã‘ã®ã‚¢ã‚¦ãƒˆãƒ—ãƒƒãƒˆãŒè‡ªç„¶ã«ã§ãã‚‹ã‚ˆã†ã«ãªã‚‹","type":"posts"},{"content":"","date":"2025å¹´ 11æœˆ 20æ—¥","externalUrl":null,"permalink":"/tags/claude/","section":"Tags","summary":"","title":"Claude","type":"tags"},{"content":" å‰å›ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ã¯å¼•ãç¶™ã’ã‚‹ã®ã‹ï¼Ÿ # å›ç­”ã¨ã—ã¦ã¯ ä¸å¯ æ¯å›ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³æ¯ã«æ–°ã—ãä¼šè©±å†…å®¹ãªã©ãŒæ›´æ–°ã•ã‚Œã‚‹ã€‚\nã‚‚ã—ã‚‚å‰å›ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ã®å†…å®¹ã‚’å¼•ãç¶™ã„ã§ã»ã—ã„å ´åˆã¯\nå‰å›ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ã®å†…å®¹ã‚’ãƒ¡ãƒ¢ã‚„è­°äº‹éŒ²ã«ã¾ã¨ã‚ã¦ã€\næ–°ã—ãå§‹ã‚ãŸã‚»ãƒƒã‚·ãƒ§ãƒ³ã«ã¦ã€Œã“ã®ãƒ¡ãƒ¢ã‚’èª­ã‚“ã§ç¶šãã‚’ã€ã¨ã„ã†æ—¨ã‚’æŒ‡ç¤ºã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚\nã‚»ãƒƒã‚·ãƒ§ãƒ³ã®ãƒˆãƒ¼ã‚¯ãƒ³é‡ãŒå°‘ãªããªã£ã¦ããŸã‚‰ã€ãƒ¡ãƒ¢ã«ã¾ã¨ã‚ã¦ã€\næ¬¡ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ã§å†é–‹ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚\nTodoWriteãƒ„ãƒ¼ãƒ«ã¨ã¯ï¼Ÿ # åº¦ã€…ã€Claudeã«ã¦ã€ŒTodoWriteãƒ„ãƒ¼ãƒ«ã€ã¨ã„ã†æ–‡è¨€ãŒã§ã¦ãã‚‹ãŸã‚ã€claudeã¸è³ªå•ã—ã¦ã¿ãŸã€‚ claudeã®å†…éƒ¨ç®¡ç†ç”¨ãƒ„ãƒ¼ãƒ«ã‚‰ã—ã„ã€‚ï¼ˆclaudeã«ã‚‚ToDoç®¡ç†ãƒ„ãƒ¼ãƒ«ã£ã¦ã‚ã‚‹ã‚“ã ã€‚ï¼‰\nClaudeã‚ˆã‚Š ClaudeãŒå†…éƒ¨çš„ã«ä½¿ã†ã‚¿ã‚¹ã‚¯ç®¡ç†ãƒ„ãƒ¼ãƒ« è¤‡é›‘ãªã‚¿ã‚¹ã‚¯ã‚’é€²ã‚ã‚‹éš›ã€é€²æ—ã‚’å¯è¦–åŒ– ã‚ãªãŸã®ç”»é¢ã« â–¡ â†’ â— â†’ âœ“ ã§è¡¨ç¤ºã•ã‚Œã‚‹ ã‚»ãƒƒã‚·ãƒ§ãƒ³çµ‚äº†ã§æ¶ˆãˆã‚‹ï¼ˆç¶™ç¶šã—ãŸã„ãªã‚‰ãƒ¡ãƒ¢ã«è»¢è¨˜ï¼‰ ã‚ãªãŸã¯ä½•ã‚‚ã—ãªãã¦ã„ã„ï¼ˆClaude ãŒè‡ªå‹•ã§ä½¿ã†ï¼‰\n","date":"2025å¹´ 11æœˆ 20æ—¥","externalUrl":null,"permalink":"/posts/251120225449_claude-specification-session-continuity-check/","section":"Posts","summary":"","title":"Claudeã®ä»•æ§˜ç¢ºèªï¼šå‰å›ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ã¯å¼•ãç¶™ã’ã‚‹ã®ã‹ï¼Ÿ","type":"posts"},{"content":"","date":"2025å¹´ 11æœˆ 20æ—¥","externalUrl":null,"permalink":"/tags/%E4%BB%95%E6%A7%98%E7%A2%BA%E8%AA%8D/","section":"Tags","summary":"","title":"ä»•æ§˜ç¢ºèª","type":"tags"},{"content":" ã¯ã˜ã‚ã« # git commitã‚’å®Ÿè¡Œã™ã‚‹éš›ã®ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ä½œæˆã™ã‚‹ãŸã‚ã«\nå¤‰æ›´å†…å®¹ã‚’ç¢ºèªã™ã‚‹ã‚³ãƒãƒ³ãƒ‰ã‚„æ‰‹é †ã‚’æ•´ç†ã—ã¦ãƒ¡ãƒ¢ã¨ã™ã‚‹ã€‚\nçŠ¶æ³ç¢ºèªã‚³ãƒãƒ³ãƒ‰ # # å…¨ä½“æŠŠæ¡ git status # ã™ã¹ã¦ã®å¤‰æ›´ã‚’ç¢ºèª git diff HEAD --stat # ã¾ã  git add ã—ã¦ã„ãªã„å¤‰æ›´ã‚’ç¢ºèª git diff --stat # git add ã—ãŸå¤‰æ›´ã‚’ç¢ºèª git diff --staged --stat git diff --cached --stat å¤‰æ›´ã‚’ç¢ºå®šã™ã‚‹ã‚³ãƒãƒ³ãƒ‰ # # ã‚³ãƒŸãƒƒãƒˆ git commit -m \u0026#34;...\u0026#34; # ãƒªãƒ¢ãƒ¼ãƒˆãƒªãƒã‚¸ãƒˆãƒªã¸ãƒ—ãƒƒã‚·ãƒ¥ git push æ—¥æœ¬èªãƒ•ã‚¡ã‚¤ãƒ«åã®è¡¨ç¤ºè¨­å®š # ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯æ—¥æœ¬èªãƒ•ã‚¡ã‚¤ãƒ«åãŒã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ã•ã‚Œã¦è¡¨ç¤ºã•ã‚Œã‚‹å•é¡Œã‚’è§£æ±º å®Ÿè¡Œå¾Œã€æ—¥æœ¬èªãƒ•ã‚¡ã‚¤ãƒ«åãŒæ­£å¸¸ã«è¡¨ç¤ºã•ã‚Œã‚‹ã€‚\n# ã‚°ãƒ­ãƒ¼ãƒãƒ«è¨­å®šï¼ˆå…¨ãƒªãƒã‚¸ãƒˆãƒªã«é©ç”¨ï¼‰ git config --global core.quotePath false # ã¾ãŸã¯ã€ã“ã®ãƒªãƒã‚¸ãƒˆãƒªã ã‘è¨­å®š git config core.quotePath false ãã®ä»–ã®æœ‰ç”¨ãªè¨­å®šï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰ # # æ—¥æœ¬èªã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚‚æ­£å¸¸è¡¨ç¤º git config --global core.pager \u0026#34;less -R\u0026#34; # git log ã§æ—¥æœ¬èªã‚’æ­£ã—ãè¡¨ç¤º git config --global i18n.logOutputEncoding utf-8 ã¾ã¨ã‚ # ã‚³ãƒŸãƒƒãƒˆå‰ã®å¤‰æ›´ç¢ºèªã«ã¯ git diff HEAD \u0026ndash;stat ãŒä¾¿åˆ© ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°æ¸ˆã¿ã®å¤‰æ›´ã¯ \u0026ndash;staged ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§ç¢ºèª æ—¥æœ¬èªè¡¨ç¤ºå•é¡Œã¯ core.quotePath false ã§è§£æ±º ","date":"2025å¹´ 11æœˆ 20æ—¥","externalUrl":null,"permalink":"/posts/251120224617_git-change-check-commands/","section":"Posts","summary":"","title":"Gitã‚³ãƒŸãƒƒãƒˆå‰ã®å¤‰æ›´ç¢ºèªã‚¬ã‚¤ãƒ‰","type":"posts"}]